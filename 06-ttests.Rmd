# t-Tests



```{r, echo=FALSE}
library(ggplot2)
```

One day, many moons ago, William Sealy Gosset got a job working for Guinness Breweries. They make that really dark and famous Irish beer called Guinness. What happens next went something like this (total fabrication, but mostly on point). 

Guinness wanted all of its beers to the best beers. No mistakes, No bad beers. They wanted to improve their quality control, so that wherever you pour a Guiness, anywhere in the world, it always comes out just fantastic, let's say 5 stars out of 5 every time. They want to be the best.

Guiness had some beer tasters, who were super-experts. Everytime they tasted a Guiness from the factor that wasn't 5 out of 5, they knew right away.

But, Guiness had a big problem. They would make a keg of beer, and they would want to know if every single pint that would come out would be a 5 out of 5. So, the beer tasters drank pint after pint out of the keg, until it was gone. Some kegs were all 5 out of 5s. Some weren't, Guiness needed to fix that. But, the biggest problem was that, after the testing, there **was no beer left to sell**, the testers drank it all (remember I'm kind of making this part up to illustrate a point, they probably still had beer to sell).

Guiness had a sampling and population problem. They wanted to know that the entire population of the beers they made were all 5 out of 5 stars. But, if they sampled the entire population, they would drink all of their beer, and wouldn't have any left to sell.

Enter William Sealy Gosset. Gosset figured out the solution to the problem. He asked questions like this:

1. How many samples do I really need to take to know the whole population is 5 out of 5?
2. What's the fewest amount of samples I need to take to know the above, that would mean Guiness could test fewer beers for quality, and sell more beers for profit, and making the product testing time shorter.

Gosset solved those questions, and he invented something called the *Student's t-test*. Gosset was working for Guinness, and could be fired for releasing trade-secrets that he invented (the t-test). But, Gosset published the work anyways, under a pseudonym. He called himself Student, hence Student's t-test. Now you know the rest of the story.

It turns out this was a very nice thing for Gosset to have done. t-tests are used all the time, and they are useful, that's why they are used. In this chapter we learn how they work.

You'll be surprised to learn that what we've already talked about, (the Crump Test, and the Randomization Test), are both very very similar to the t-test. So, in general, you have already been thinking about the things you need to think about to understand t-tests. You're probably wondering what is this $t$, what does $t$ mean? We will tell you. Before we tell what it means, we first tell you about one more idea.

## Check your confidence in your mean

We've talked about getting a sample of data. We know we can find the mean, we know can find the standard deviation. We know we can look at the data in a histogram. These are all useful things to do for us to learn something about the properties of our data.

You might be thinking about these things, like mean and standard deviation, as very different things. The mean is about central tendency (where most of the data is), and the standard deviation is about variance (where most of the data isn't). Yes, they are different things, but we can use them together to create useful new things.

What if I told you my sample mean was 50, and I told you nothing else about my sample. Would you be confident that most of the numbers were near 50? Would you wonder if there was a lot of variability in the sample, and many of the numbers were very different from 50. You should wonder all of those things. The mean alone, just by itself, doesn't tell you anything about how confident you should be that the number represents all of the numbers in the sample.

It could be a representative number, when the standard deviation is very small, and all the numbers are close to 50. It could be a non-representative number, when the standard deviation is large, and many of the numbers are not near 50. You need to know the standard deviation in order to be confident in how well the mean represents the data.

How can we put the mean and the standard deviation together, to give us a new number that tells us about confidence in the mean?

We can do this using a ratio:

$\frac{mean}{\text{standard deviation}}$

Think about what happens here. We are dividing a number by a number. Look at what happens:

$\frac{number}{\text{same number}} = 1$ 

$\frac{number}{\text{smaller number}} = \text{big number}$ 

compared to:

$\frac{number}{\text{bigger number}} = \text{smaller number}$ 

Imagine we have a mean of 50, and a truly small standard deviation of 1. What do we get with our formula?

$\frac{50}{1} = 50 $

Imgaine we have a mean of 50, and a big standard deviation of 100. What do we get with our formula?

$\frac{50}{100} = 0.5 $

Notice, when we have a mean paired with a small standard deviation, our formula gives us a big number, like 50. When we have a mean paired with a large standard deviation, our formula gives us a small number, like 0.5. These numbers can tell us something about confidence in our mean, in a general way. We can be 50 confident in our mean in the first case, and only 0.5 (not at a lot) confident in the second case.

What did we do here? We created a descriptive statistic by dividing the mean by the standard deviation. And, we have a sense of how to interpet this number, when it's big we're more confident that the mean represents all of the numbers, when it's small we are less confident. This is a useful kind of number, a ratio between what we think about our sample (the mean), and the variability in our sample (the standard deviation). Get used to this idea. Almost everything that follows in this textbook is based on this kind of ratio. We will see that our ratio becomes different kinds of "statistics", and the ratios will look like this in general:

$\text{name of statistic} = \frac{\text{measure of what we know}}{\text{measure of what we don't know}}$

or, to say it using different words:

$\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}$

In fact, this is the general formula for the t-test. Big surprise!

## One-sample t-test: A new t-test

Now we are ready to talk about t-test. We will talk about three of them. We start with the one-sample t-test.

Commonly, the one-sample t-test is used to estimate the chances that your sample came from a particular popualtion. Specifically, you might want to know whether the mean that you found from your sample, could have come from a particular population having a particular mean. 

Straight away, the one-sample t-test becomes a little confusing (and I haven't even described it yet). Offically, the uses known parameters from the population, like the mean of the population and the standard deviation of the population. However, most times you don't know those parameters of the population! So, you have to estimate them from your sample. Remember, from the chapter on descriptive statistics, our sample mean is an unbiased estimate of the population mean. And, our sample standard deviation (the one where we divide by n-1) is an unbiased estimate of the population standard deviation. When Gosset developed the t-test, he recognized that he could use these estimates from his samples, to make the t-test. Here is the formula for the one sample t-test, we first use words, and then become more specific:

### Formulas for one-sample t-test

$\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}$

$\text{t} = \frac{\text{measure of effect}}{\text{measure of error}}$

$\text{t} = \frac{\text{Mean difference}}{\text{standard error}}$

$\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}}$

$\text{t} = \frac{\text{Sample Mean  - Population Mean}}{\text{Sample Standard Error}}$

$\text{Estimated Standard Error} = \text{Standard Error of Sample} = \frac{s}{\sqrt{N}}$

Where, s is the sample standard deviation.

Some of you may have gone cross-eyed looking at all of this. Remember, we've seen it before when we divided our mean by the standard deviation in the first bit. The t-test is just a measure of a sample mean, divided by the standard error of the sample mean. That is it.

### What does t represent?

$t$ gives us a measure of confidence, just like our previous ratio for dividing the mean by a standard deviations.

<div class="marginnote">
What does the t in t-test stand for? Apparently nothing. Gosset originally labelled it z. And, Fisher later called it t, perhaps because t comes after s, which is often used for the sample standard deviation.
</div>

$t$ is a property of the data that you collect. You compute it with a sample mean, and a sample standard error (there's one more thing in the one-sample formula, the population mean, which we get to in a moment). This is why we call $t$, a sample-statistic. It's a statistic we compute from the sample.

What kinds of numbers should we expect to find for these $ts$? Well, wouldn't that depend on a lot of things, how could we know that?

Let's start small, and work through some examples. Imagine your sample mean is 5. You want to know if it came from a  population that also has a mean of 5. In this case, what would t be? It would be zero, because we first subtract sample mean from the population mean, 5-5=0. So, t can be zero, when there is no difference. 

Let's say you take another sample, do you think the mean will be 5 every time, probably not. Let's say the mean is 6. So, what can t be here? It will be a positive number, because 6-5= +1. But, will t be +1? That depends on the standard error of the sample. If the standard error of the sample is 1, then t could be 1, because 1/1 = 1.

If the sample standard error is smaller than 1, what happens to $t$? It get's bigger right? For example, 1 divided by 0.5 = 2. If the sample standard error was 0.5, t would be 2. And, what could we do with this information? Well, it be like a measure of confidence. As t get's bigger we could be more confident in the mean difference we are measuring.

Can $t$ be smaller than 1? Sure, it can. If the sample standard error is big, say like 2, then $t$ will be smaller than one (in our case), e.g., 1/2 = .5. The direction of the difference between the sample mean and population mean, can also make the $t$ become negative. What if our sample mean was 4. Well, then $t$ will be negative, because the mean difference in the numerator will be negative, and the number in the bottom (denominator) will always be positive (remember why, it's the standard error, computed from the sample standard deviation, which is always positive because of the squaring that we did.).

So, that is some intutions about what the kinds of values t can take. $t$ can be positive or negative, and big or small. Fine then, what can we do with this?

### Calculating t from data

Let's briefly calculate a t-value from a small sample. Let's say we had 10 students do a true/false quiz 5 questions on it. There's a 50% chance of getting each answer correct. 

Every student completes the 5 questions, we grade them, and then we find their performance (mean percent correct). Want we want to know is whether the students were guessing. If they were all guessing, then the sample mean should be about 50%, it shouldn't be different from chance, which is 50%. Let's look at the table:

```{r, echo=FALSE}
library(dplyr)
students <- 1:10
scores <- c(50,70,60,40,80,30,90,60,70,60)

mean_scores <- mean(scores)
Difference_from_Mean <- scores-mean_scores
Squared_Deviations <- Difference_from_Mean^2
the_df<-data.frame(students,
                   scores,
                   mean=rep(mean_scores,10),
                   Difference_from_Mean,
                   Squared_Deviations)

the_df <- the_df %>%
  rbind(c("Sums",colSums(the_df[1:10,2:5]))) %>%
  rbind(c("Means",colMeans(the_df[1:10,2:5]))) %>%
  rbind(c(" "," "," ","sd ",round(sd(the_df[1:10,2]),digits=2))) %>%
  rbind(c(" "," "," ","SEM ",round(sd(the_df[1:10,2])/sqrt(10), digits=2))) %>%
  rbind(c(" "," "," ","t",(61-50)/round(sd(the_df[1:10,2])/sqrt(10), digits=2)))
knitr::kable(the_df)


```

You can see the column column has all of the test scores for each of the 10 students. We did the things we need to do to compute the standard deviation. 

Remember the sample standard deviation is the square root of the sample variance, or:

$\text{sample standard deviation} = \sqrt{\frac{\sum_{i}^{n}({x_{i}-\bar{x})^2}}{N-1}}$

$\text{sd} = \sqrt{\frac{2890}{10-1}} = 17.92$

The standard error of the mean, is the standard deviation divided by the square root of N

$\text{SEM} = \frac{s}{\sqrt{N}} = \frac{17.92}{10} = 5.67 $

$t$ is the difference between our sample mean (61), and our population mean (50, assuming chance), divided by the standard error of the mean.

$\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}} = \frac{\bar{X}-u}{SEM} = \frac{61-50}{5.67} = 1.94$

And, that is you how calculate $t$, by hand. It's a pain. I was annoyed doing it this way. In the lab, you learn how to calculate $t$ using software, so it will just spit out $t$. For example in R, all you have to do is this:

```{r, echo=TRUE}
t.test(scores, mu=50)
```


### How does $t$ behave?

If $t$ is just a number that we can from our sample (it is), what can we do with it? How can we use $t$ for statistical inference?

Remember back to the chapter on sampling and distributions, that's where we discussed the sampling distribution of the sample mean. Remember, we made a lot of samples, then computed the mean for each sample, then we plotted a histogram of the sample means. Later, in that same section, we mentioned that we could generate sampling distributions for any statistic. That, for each sample, we could compute the mean, the standard deviation, the standard error, and now even $t$, if we wanted to. We could generate 10,000 samples, and draw four histograms, one for each sampling distribution for each statistic.

This is exactly what I did, and the results are shown in the four figures below. I used a sample size of 20, and drew random observations for each sample from a normal distribution, with mean = 0, and standard deviation  = 1. Let's look at the sampling distributions for each of the statistics. $t$ was computed assuming with the population mean assumed to be 0.

```{r, cache=TRUE}
all_df<-data.frame()
for(i in 1:10000){
  sample<-rnorm(20,0,1)
  sample_mean<-mean(sample)
  sample_sd<-sd(sample)
  sample_se<-sd(sample)/sqrt(length(sample))
  sample_t<-as.numeric(t.test(sample, mu=0)$statistic)
  t_df<-data.frame(i,sample_mean,sample_sd,sample_se,sample_t)
  all_df<-rbind(all_df,t_df)
}

library(ggpubr)
a<-ggplot(all_df,aes(x=sample_mean))+
  geom_histogram(color="white")+
  theme_classic()
b<-ggplot(all_df,aes(x=sample_sd))+
  geom_histogram(color="white")+
  theme_classic()
c<-ggplot(all_df,aes(x=sample_se))+
  geom_histogram(color="white")+
  theme_classic()
d<-ggplot(all_df,aes(x=sample_t))+
  geom_histogram(color="white")+
  theme_classic()

ggarrange(a,b,c,d,
          ncol = 2, nrow = 2)

```

We see four sampling distributions. This is how statistical summaries of these summaries behave. We have used the word chance windows before. These are four chance windows, measuring different aspects of the sample. In this case, all of the samples came from the same normal distribution. Because of sampling error, each sample is not identical. The means are not identical, the standard deviations are not identical, sample standard error of the means are not identical, and the $t$s of the samples are not identical. They all have some variation, as shown by the histograms. This is how samples, of size 20 behave.

We can see straight away, that in this case, we are unlikely to get a sample mean of 2. That's way outside the window. The range for the sampling distribution of the mean is around -.5 to +.5, and is centered on 0 (the population mean, would you believe!).

We are unlikely to get sample standard deviations of between .6 and 1.5, that is a different range, specific to the sample standard deviation.

Same thing with the sample standard error of the mean, the range here is even smaller, mostly between .1, and .3. You would rarely find a sample with a standard error of the mean greater than .3. Virtually never would you find one of say 1 (for this situation).

Now, look at $t$. It's range is basically between -3 and +3 here. 3s barely happen at all. you pretty much never see a 5 or -5 in this situation.

All of these sampling windows are chance windows, and they can all be used in the same way as we have used similar sampling distributions before (e.g., Crump Test, and Randomization Test) for statistical inference. For all of them we would follow the same process:

1. Generate these distributions
2. Look at your sample statistics for the dat you have (mean, sd, sem, and $t$)
3. Find out how likely each value (or greater than that value) is
4. Obtain that probability
5. See if you think your sample statistics were probable or improbable.

We'll formalize this in a second. I just want you to know that what you will be doing is something that you have already done before. For example, in the Crump test and the Randomization test we focused on the distribution of mean differences. We could do that again here, but instead, we will focus on the distribution of $t$ values. We then apply the same kinds of decision rules to the $t$ distribution, as we did for the other distributions. Below you will see a graph you have already seen, except this time it is a distribution of $t$s, not mean differences:

Remember, if we obtained a single $t$ from one sample we collected, we could consult this chance window below to find out the $t$ we obtained from the sample was likely or unlikely to occur by chance.

```{r}

sample_t<-all_df$sample_t

ggplot(all_df,aes(x=sample_t))+
  annotate("rect", xmin=min(sample_t), xmax=max(sample_t), ymin=0, ymax=Inf, alpha=0.5, fill="red") +
  annotate("rect", xmin=min(sample_t), xmax=-1.94, ymin=0, ymax=Inf, alpha=0.7, fill="light grey") +
  annotate("rect", xmin=1.94, xmax=max(sample_t), ymin=0, ymax=Inf, alpha=0.7, fill="light grey") +
  geom_rect(aes(xmin=-Inf, xmax=min(sample_t), ymin=0, ymax=Inf), alpha=.5, fill="lightgreen")+
  geom_rect(aes(xmin=max(sample_t), xmax=Inf, ymin=0, ymax=Inf), alpha=.5, fill="lightgreen")+
  geom_histogram(bins=50, color="white")+
  theme_classic()+
  geom_vline(xintercept = min(sample_t))+
  geom_vline(xintercept = max(sample_t))+
   geom_vline(xintercept = -1.94)+
  geom_vline(xintercept = 1.94)+
  ggtitle("Histogram of mean sample_ts between two samples (n=20) \n
          both drawn from the same normal distribution (u=0, sd=1)")+
   xlim(-8,8)+
  geom_label(data = data.frame(x = 0, y = 250, label = "CHANCE"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = -7, y = 250, label = "NOT \n CHANCE"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = 7, y = 250, label = "NOT \n CHANCE"), aes(x = x, y = y, label = label))+
#  geom_label(data = data.frame(x = min(sample_t), y = 600,
 #                              label = paste0("min \n",round(min(sample_t)))),
  #                             aes(x = x, y = y, label = label))+
   #geom_label(data = data.frame(x = max(sample_t), y = 600,
   #                            label = paste0("max \n",round(max(sample_t)))),
    #                           aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = -4, y = 250,
                               label = "?"),
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = 4, y = 250,
                               label = "?"),
                               aes(x = x, y = y, label = label))+
  xlab("mean sample_t")

```


### Making a decision

From our early example involving the TRUE/FALSE quizzes, we are not ready to make some kind of decision about what happended there. We found a mean difference of `r mean(scores)-50`. We found a $t$ = `r t.test(scores, mu=50)$statistic`. The probability of this $t$ or larger occuring is $p$ = `r t.test(scores, mu=50)$p.value`. We were testing the idea that our sample mean of `r mean(scores)` could have come from a normal distribution with mean = 50. The $t$ test tells us that the $t$ for our sample, or a larger one, would happen with p = `r t.test(scores, mu=50)$p.value`. In other words, chance can do it a kind of small amount of time, but not often. In english, this means that all of the students could have been, guessing, but it wasn't that likely that were just guessing. 

We're guessing that you are still a little bit confused about $t$ values, and what we are doing here. We are going to skip ahead to the next $t$-test, called a **paired samples t-test**. We will also fill in some more things about $t$-tests that are more obvious when discussing paired samples t-test. In fact, spoiler alert, we will find out that paired samples t-test is actually a one-sample t-test in disguise (WHAT!), yes it is. If the one-sample $t$-test didn't make sense to you, read the next section.

## Paired-samples $t$-test

For me (Crump), many analyses often boil down to a paired samples t-test. It just happens that many things I do reduce down to a test like this.

I am a cognitive psychologist, I conduct research learn how people do things like remember, pay attention, and learn skills. There are lots of Psychologists like me, who do very similar things. 

We all often conduct the same kinds of experiments. They go like this, and they are called **repeated measures** designs. They are called **repeated measures** designs, because we measure how one person does something more than once, we **repeat** the measure.

So, I might measure somebody doing something in condition A, and measure somebody doing something in Condition B, and then I see that same person does different things in the two conditions. I **repeatedly measure** the same person in both conditions. I am interested in whether the experimental manipulation changes something about how people perform the task in question. 

### Mehr, Song, and Spelke (2016)

We will introduce the paired-samples t-test with an example using real data, from a real study. Mehr, Song, and Spelke (2016) were interested in whether singing songs to infants helps infants become more sensitive to social cues. For example, infants might need to learn to direct their attention toward people, as a part of learning how to interact socially with people. Perhaps singing songs to infants aids this process of directing attention. When an infant hears a familiar song, they might start to pay more attention to the person singing that song, even after they are done singing the song. The person who sang the song, might become more socially important to the infant. You will learn more about this study in the lab for this week. This example, prepares you for the lab activities. Here is a brief summary of what they did:

First, parents were trained to sing a song to their infants. After many days of singing this song to the infants, the parent came into the lab with their infants. In the first session, parents sat with their infants on their knees, so the infant could watch two video presentations. There were two videos. Each video involved two unfamiliar new people the infant had never seen before. Each new person in the video (the singers) sang one song to the infant. One singer sang the "familiar" song the infant had learned from their parents. The other singer sang an "unfamiliar" song the infant had not hear before. 

There were two really important measurement phases, the baseline phase, and the test phase. The baseline phase occured before the infants saw and heard each singer sing a song. During the baseline phase, the infants watched a video of both singers at the same time. The researchers recorded the proportion of time that the infant looked at each singer. The baseline phase was conducted to determine whether infants had a preference to look at either person (who would later sing them a song).


The test phase occurred after infants saw and heard each song, sung by each singer.
During the test phase, each infant had an opportunity to watch silent videos of both singers. The researchers measured the proportion of time the infants spent looking at each person. The question of interest, was whether the infants would spend a greater proportion of time looking at the singer who sang the familiar song, compared to the singer who sang the unfamiliar song. 

There is more than one way to describe the design of this study. We will describe it like this. It was a repeated measures design, with one independent (manipulation) variable called Viewing phase: Baseline versus Test. There was one dependent variable (the measurement), which was proportion looking time (to singer who sung familiar song). This was a repeated measures design because the researchers measured proportion looking time twice (they repeated the measure), once during baseline (before infants heard each singer sing a song), and again during test (after infants head each singer sing a song).

The important question was whether infants would change their looking time, and look more at the singer who sang the familiar song during the test phase, than they did during the baseline phase. This is a question about a change within individual infants. In general, the possible outcomes for the study are:

1. No change: The difference between looking time toward the singer of the familiar song during baseline and test is zero, no difference.

2. Positive change: Infants will look longer toward the singer of the familiar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a positive difference if we use the formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).

3. Negative change: Infants will look longer toward the singer of the unfamiliar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a negative difference if we use the same formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).

### The data

Let's take a look at the data for the first 5 infants in the study. This will help us better understand some properties of the data before we anlayze it. We will see that the data is stuctured in a particular way, that we can take advantage of with a paired samples t-test. Note, we look at the first 5 infants to show how the computations work. The results of the paired-samples t-test change when we use all of the data from the study.


Here is a table of the data:

```{r, echo=FALSE}
library(data.table)
all_data <- fread("data/MehrSongSpelke2016.csv")
library(dplyr)
experiment_one <- all_data %>% filter(exp1==1)

paired_sample_df <-  data.frame(infant=1:5, 
                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), 
                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))

# mean_scores <- mean(scores)
# Difference_from_Mean <- scores-mean_scores
# Squared_Deviations <- Difference_from_Mean^2
# the_df<-data.frame(students,
#                    scores,
#                    mean=rep(mean_scores,10),
#                    Difference_from_Mean,
#                    Squared_Deviations)
# 
# the_df <- the_df %>%
#   rbind(c("Sums",colSums(the_df[1:10,2:5]))) %>%
#   rbind(c("Means",colMeans(the_df[1:10,2:5]))) %>%
#   rbind(c(" "," "," ","sd ",round(sd(the_df[1:10,2]),digits=2))) %>%
#   rbind(c(" "," "," ","SEM ",round(sd(the_df[1:10,2])/sqrt(10), digits=2))) %>%
#   rbind(c(" "," "," ","t",(61-50)/round(sd(the_df[1:10,2])/sqrt(10), digits=2)))
knitr::kable(paired_sample_df)





```

The table shows proportion looking times toward the singer of the familiar song during the Baseline and Test phases. Notice there are five different infants, (1 to 5). Each infant is measured twice, once during the Baseline phase, and once during the Test phase. To repeat from before, this is a repeated-measures design, because the infants are measured repeatedly (twice in this case). Or, this kind of design is also called a **paired-samples** design. Why? because each participant comes with a pair of samples (two samples), one for each level of the design.

Great, so what are we really interested in here? We want to know if the mean looking time toward the singer of the familiar song for the Test phase is higher than the Baseline phase. We are comparing the two sample means against each other and looking for a difference. We already know that differences could be obtained by chance alone, simply because we took two sets of samples, and we know that samples can be different. So, we are interested in knowing whether chance was likely or unlikely to have produced any difference we might observe. . 

In other words, we are interested in looking at the difference scores between the baseline and test phase for each infant. The question here is, for each infant, did their proportion looking time to the singer of the familiar song, increase during the test phase as compared to the baseline phase.

### The difference scores

Let's look add the difference scores to the table of data so it is easier to see what we are talking about. The first step in creating difference scores is to decide how you will take the difference, there are two options:

1. Test phase score - Baseline Phase Score
2. Baseline phase score - Test Phase score

Let's use the first formula. Why? Because it will give us positive differences when the test phase score is higher than the baseline phsae score. This makes a positive score meaningful with respect to the study design, we know (because we defined it to be this way), that positive scores will mean longer proportion looking times (to singer of familiar song) during the test phase compared to the baseline phase. 

```{r}
paired_sample_df <- cbind(paired_sample_df, 
                          differences = (paired_sample_df$Test-
                                           paired_sample_df$Baseline))
knitr::kable(paired_sample_df)

```


There we have it, the difference scores. The first thing we can do here is look at the difference scores, and ask how many infants showed the effect of interest. Specifically, how many infants showed a positive difference score. We can see that three of five infants showed a positive difference (they looked more at the  singer of the familiar song during the test than baseline phase), and two the infants showed the opposite effect (negative difference, they looked more at the singer of the familiar song during baseline than test).

### The mean difference

As we have been discussing, the effect of interest in this study is the mean difference between the baseline and test phase proportion looking times. We can calculate the mean difference, by finding the mean of the difference scores. Let's do that, in fact, for fun let's calculate the mean of the baseline scores, the test scores, and the difference scores. 


```{r}
paired_sample_df <- paired_sample_df %>%
   rbind(c("Sums",colSums(paired_sample_df[1:5,2:4]))) %>%
   rbind(c("Means",colMeans(paired_sample_df[1:5,2:4])))
  
knitr::kable(paired_sample_df)

```

We can see there was a positive mean difference of 0.054, between the test and baseline phases.

Now, can we rush to judgment and conclude that infants are more socially attracted to individuals who have sung them a familiar song? I would hope not based on this very small sample. First, the difference in proportion looking isn't very large, and of course we recognize that this difference could have been produced by chance.

We will more formally evaluate whether this difference could have been caused by chance with the paired-samples t-test. But, before we do that, let's again calculate $t$ and discuss what $t$ tells us over and above what our measure of the mean of the difference scores tells us.

### Calculate $t$

Ok, so how do we calculate $t$ for a paired-samples $t$-test? Surprise, we use the one-sample t-test formula that you already learned about! Specifically, we use the one-sample $t$-test formula on the difference scores. We have one sample of difference scores (you can see they are in one column), so we can use the one-sample $t$-test on the difference scores. Specifically, we are interested in comparing whether the mean of our difference scores came from a distibrution with mean difference = 0. This is a special distribution we refer to as the **null distribution**. It is the distribution no differences. Of course, this **null distribution** can produce differences due to to sampling error, but those differences are not caused by any experimental manipulation, they caused by the random sampling process.

We calculate $t$ in a moment. Let's now consider again why we want to calculate $t$? Why don't we just stick with the mean difference we already have?

Remember, the whole concept behind $t$, is that it gives an indication of how confident we should be in our mean. Remember, $t$ involves a measure of the mean in the numerator, divided by a measure of variation (standard error of the sample mean) in the denonimator. The resulting $t$ value is small when the mean difference is small, or when the variation is large. So small $t$-values tell us that we shouldn't be that confident in the estimate of our mean difference. Large $t$-values occur when the mean difference is large and/or when the measure of variation is small. So, large $t$-values tell us that we can be more confident in the estimate of our mean difference. Let's find $t$ for the mean difference scores. We use the same formulas as we did last time:

```{r, echo=FALSE}

paired_sample_df <-  data.frame(infant=1:5, 
                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), 
                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))

differences <-  paired_sample_df$Test-paired_sample_df$Baseline
diff_from_mean <- differences-mean(differences)
Squared_differences <- diff_from_mean^2
paired_sample_df <- cbind(paired_sample_df, 
                          differences,
                          diff_from_mean,
                          Squared_differences)
 

 paired_sample_df <- paired_sample_df %>%
   rbind(c("Sums",colSums(paired_sample_df[1:5,2:6]))) %>%
   rbind(c("Means",colMeans(paired_sample_df[1:5,2:6]))) %>%
   rbind(c(" "," "," "," ","sd ",round(sd(paired_sample_df[1:5,4]),digits=3))) %>%
   rbind(c(" "," "," "," ","SEM ",round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3))) %>%
   rbind(c(" "," "," "," ","t",mean(differences)/round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3)))
 paired_sample_df[6,5]<-0
  paired_sample_df[7,5]<-0
knitr::kable(paired_sample_df)

#t.test(round(differences, digits=2), mu=0)$statistic


```


If we did this test using R, we would obtain almost the same numbers (there is a little bit of rounding in the table).

```{r}
t.test(differences,mu=0)
```

Here is a quick write up of our t-test results, t(4) = .72, p = .509.

What does all of that tell us? There's a few things we haven't gotten into much yet. For example, the 4 represents degrees of freedom, which we discuss later. The important part, the $t$ value should start to be a little bit more meaningful. We got a kind of small t-value didn't we. It's .72. What can we tell from this value? First, it is positive, so we know the mean difference is positive. The sign of the $t$-value is always the same as the sign of the mean difference (ours was +0.054). We can also see that the p-value was .509. We've seen p-values before. This tells us that our $t$ value or larger, occurs about 50.9% of the time... Actually it means more than this. And, to understand it, we need to talk about the concept of two-tailed and one-tailed tests.

### Interpreting $t$s

Remember what it is we are doing here. We are evaluating whether our sample data could have come from a particular kind of distribution. The null distribution of no differences. This is the distribution of $t$-values that would occur for samples of size 5, with a mean difference of 0, and a standard error of the sample mean of .075 (this is the SEM that we calculated from our sample). We can see what this particular null-distribution looks like by plotting it like this:

```{r}
range <- seq(-3,3, .1)
null_distribution <- dt(range, 4, log = FALSE)
plot_df <- data.frame(range,null_distribution)

ggplot(plot_df,aes(x=range, y=null_distribution))+
  geom_line()+
  xlab("t-values")+
  ylab("Probability")+
  theme(axis.text.y=element_blank(),axis.ticks=element_blank())+
  scale_x_continuous(breaks=(seq(-3,3,.5)))+
  ggtitle("Null-distribution of t-values for our data")+
    geom_label(data = data.frame(x = -.7, y = .1, label = "50% \n (-)"), aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = .7, y = .1, label = "50% \n (+)"), aes(x = x, y = y, label = label))+
  geom_vline(xintercept=0)


```

The $t$-distribution above shows us the kinds of values $t$ will will take by chance alone, when we measure the mean differences for pairs of 5 samples (like our current). $t$ is most likely to be zero, which is good, because we are looking at the distribution of no-differences, which should most often be 0! But, sometimes, due to sampling error, we can get $t$s that are bigger than 0, either in the positive or negative direction. Notice the distribution is symmetrical, a $t$ from the null-distribution will be positive half of the time, and negative half of the time, that is what we would expect by chance. 


So, what kind of information do we want know when we find a particular $t$ value from our sample? We want to know how likely the $t$ value like the one we found occurs just by chance. This is actually a subtly nuanced kind of question. For example, any particular $t$ value doesn't have a specific probability of occuring. When we talk about probabilities, we are talking about ranged of probabilities. Let's consider some probabilities. We will use the letter $p$, to talk about the probabilites of particulat $t$ values.

1. What is the probability that $t$ is zero or positive or negative? The answer is p=1, or 100%. We will always have a $t$ value that is zero or non-zero...Actually, if we can't compute the t-value, for example when the standard deviaion is undefined, I guess then we would have a non-number. But, assuming we can calculate $t$, then it will always be 0 or positive or negative.

2. What is the probability of $t$ = 0 or greater than 0? The answer is p=.5, or 50%. 50% of $t$-values are 0 or greater.

3. What is the of $t$ = 0 or smaller than 0? The answer is p=.5, or 50%. 50% of $t$-values are 0 or smaller. 

We can answer all of those questions just by looking at our t-distribution, an dividing it into two eqal regions, the left side (containing 50% of the $t values), and the right side containing 50% of the $t-values).

What if we wanted to take a more fine-grained approach, let's say we were interested in regions of 10%. What kinds of $t$s occur 10% of the time. We would apply lines like the following. Notice, the likelihood of bigger numbers (positive or negative) gets smaller, so we have to increase the width of the bars for each of the intervals between the bars to contain 10% of the t-values, it looks like this:


```{r}
range <- seq(-3,3, .1)
null_distribution <- dt(range, 4, log = FALSE)
plot_df <- data.frame(range,null_distribution)

t_ps <- qt(seq(.1,.9,.1),4)

ggplot(plot_df,aes(x=range, y=null_distribution))+
  geom_line()+
  xlab("t-values")+
  ylab("Probability")+
  geom_vline(xintercept=t_ps)+
  ggtitle("10% of ts occur between each bar")+
  theme_classic(base_size = 10)+
  theme(axis.text.y=element_blank(),axis.ticks=element_blank())+
  scale_x_continuous(breaks=round(t_ps, digits=1))+
  geom_label(data = data.frame(x = -2.5, y = .2, label = "10%"), aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = -1.3, y = .2, label = "10%"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = 2.5, y = .2, label = "10%"), aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = 1.3, y = .2, label = "10%"), aes(x = x, y = y, label = label))


```

Consider the probabilities (p) of $t$ for the different ranges.
 
1. $t$ <= -1.5 (t is les than or equal to -1.5), p = 10%
2. -1.5 >= $t$ <= -0.9 (t is equal to or between -1.5 and -.9), p = 10%
3. -.9 >= $t$ <= -0.6 (t is equal to or between -.9 and -.6), p = 10%
4. $t$ >= 1.5 (t is greater than or equal to 1.5), p = 10%

Notice, that the $p$s are always 10%. $t$s occur in these ranges with 10% probability.

### Getting the p-values for t-values

You might be wondering where I am getting some of these values from. For example, how do I know that 10% of $t$ values (for this null distribution) have a value of approximately 1.5 or greater than 1.5? The answer is I used R to tell me.

In most statistics textbooks the answer would be, there is a table at the back of the book where you can look these things up...This textbook has no such table. We could make one for you. And, we might do that. But, we didn't do that yet...

So, where do these values come from, how can you figure out what they are? The complicated answer is that we are not going to explain the math behind finding these values because 1) the authors (some of) admittedly don't know the math well enough to explain it, and 2) it would sidetrack us to much, 3) you will learn how to get these numbers in the lab with software, 4) you will learn how to get these numbers in lab without the math, just by doing a simulation, and 5) you can do it in R, or excel, or you can use an [online calculator](http://www.socscistatistics.com/pvalues/tdistribution.aspx).

This is all to say that you can find the $ts$ and their associated $ps$ using software. But, the software won't tell you what these values mean. That's we are doing here. You will also see that software wants to know a few more things from you, such as the degrees of freedom for the test, and whether the test is one-tailed or two tailed. We haven't explained any of these things yet. That's what we are going to do now. Note, we explain degrees of freedom last. First, we start with a one-tailed test.

### One-tailed tests

A **one-tailed test** is sometimes also called a directional test. It is called a directional test, because a researcher might have a hypothesis in mind suggesting that the difference they observe in their means is going to have a particualr direction, either a positive difference, or a negative difference. 

Typically, a researcher would set an alpha criterion. The alpha criterion describes a line in the sand for the researcher. Often, the alpha criterion is set at p=.05. What does this mean? Let's look at again at the graph of the t-distribution, and show the alpha criterion.

```{r}
range <- seq(-3,3, .1)
null_distribution <- dt(range, 4, log = FALSE)
plot_df <- data.frame(range,null_distribution)

t_ps <- qt(seq(.1,.9,.1),4)

ggplot(plot_df,aes(x=range, y=null_distribution))+
  geom_line()+
  xlab("t-values")+
  ylab("Probability")+
  geom_vline(xintercept=qt(.95,4, lower.tail=TRUE))+
  ggtitle("Critical t for one-tailed test")+
  theme_classic(base_size = 10)+
  theme(axis.text.y=element_blank(),axis.ticks=element_blank())+
  annotate("rect", xmin=qt(.95,4, lower.tail=TRUE),xmax=3, ymin=0, ymax=Inf, alpha=0.5, fill="green")+
  geom_label(data = data.frame(x = 2.5, y = .2, label = "5%"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = qt(.95,4, lower.tail=TRUE), y = .3, 
                               label = "Critical t"), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = qt(.95,4, lower.tail=TRUE), y = .25, 
                               label = round(qt(.95,4, lower.tail=TRUE), digits=2)), 
                               aes(x = x, y = y, label = label))


```


The figure shows that $t$ values of +2.13 or greater occur 5% of the time. Because the t-distribution is symmetrical, we also know that $t$ values of -2.13 or smaller also occur 5% of the time. Both of these properties are true under the null distribution of no differences. This means, that when there really are no differences, a researcher can expect to find $t$ values of 2.13 or larger 5% of the time.

Let's review and connect some of the terms:

1. **alpha criterion**: the criterion set by the researcher to make decisions about whether the believe chance did or did not cause the difference. The alpha criterion here is set to p=.05

2. **Critical $t$**. The critical $t$ is the $t$-value associated with the alpha-criterion. In this case for a one-tailed test, it is the $t$ value where 5% of all $t$s are this number or greater. In our example, the critical $t$ is 2.13. 5% of all $t$ values (with degrees of freedom = 4) are +2.13, or greater than +2.13.

3. **Observed $t$**. The observed $t$ is the one that you calculated from your sample. In our example about the infants, the observed $t$ was $t$ (4) = 0.72.

4. **p-value**. The **p-value** is the probability of obtaining the observed $t$ value or larger. Now, you could look back at our previous example, and find that the p-value for $t$ (4) = .72, was p=.509. HOWEVER, this p-value was not calculated for a one-directional test...(we talk about what .509 means in the next section).

Let's see what p-value for $t$ (4) = .72 using a one-directional test would be, and what it would look like:


```{r}
range <- seq(-3,3, .1)
null_distribution <- dt(range, 4, log = FALSE)
plot_df <- data.frame(range,null_distribution)

t_ps <- qt(seq(.1,.9,.1),4)

ggplot(plot_df,aes(x=range, y=null_distribution))+
  geom_line()+
  xlab("t-values")+
  ylab("Probability")+
  geom_vline(xintercept=.72)+
  geom_vline(xintercept=qt(.95,4, lower.tail=TRUE))+
  ggtitle("t value and p-range for one-directional test")+
  theme_classic(base_size = 10)+
  theme(axis.text.y=element_blank(),axis.ticks=element_blank())+
  annotate("rect", xmin=.72,xmax=3, ymin=0, ymax=Inf, alpha=0.5, fill="grey")+
  annotate("rect", xmin=qt(.95,4, lower.tail=TRUE),xmax=3, ymin=0, ymax=.25, alpha=0.5, fill="green")+
  geom_label(data = data.frame(x = 2.5, y = .2, label = "5%"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = qt(.95,4, lower.tail=TRUE), y = .3, 
                               label = "Critical t"), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = qt(.95,4, lower.tail=TRUE), y = .25, 
                               label = round(qt(.95,4, lower.tail=TRUE), digits=2)), 
                               aes(x = x, y = y, label = label))+
    geom_label(data = data.frame(x = .72, y = .1, 
                               label = "Observed t"), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = .72, y = .05, 
                               label = ".72, p="), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = 1.5, y = .05, 
                               label = round(pt(.72, 4, lower.tail=FALSE), digits=3)), 
                               aes(x = x, y = y, label = label))


```

Let's take this one step at a time. We have located the observed $t$ of .72 on the graph. We shaded right region all grey. What we see is that the grey region represents .256 or 25.6% of all $t$ values. In other words, 25.6% of $t$ values are .72 or larger than .72. You could expect, by chance alone, to a find a $t$ value of .72 or larger, 25.6% of the time. That's fairly often. We did find a $t$ value of .72. Now that you know this kind of $t$ value or larger occurs 25.6% of the time, would you be confident that the mean difference was not due to chance? Probably not, given that chance can produce this difference fairly often. 

Following the "standard" decision making procedure, we would claim that our $t$ value was **not statistically significant**, because it was not large enough. If our observed value was larger than the critical $t$ (larger than 2.13), defined by our alpha criterion, then we would claim that our $t$ value was **statistically signicant**. This would be equivalent to saying that we believe it is unlikely that the difference we observed was due to chance. In general, for any observed $t$ value, the associated p-value tells you how likely a $t$ of the observed size or larger would be observed. The p-value **always** refers to a **range** of t-values, never to a single t-value. Researchers use the alpha criterion of .05, as a matter of convenience and convention. There are other ways to interpret these values that do not rely on a strict (significant versus not) dichotomy.

### Two-tailed tests

Ok so that is one-tailed tests... What are two tailed tests, what is that? The p-value that we orginally calculated from our paired-samples t-test was for a 2-tailed test. Often, the default is that the p-value is for a two-tailed test.

The two-tailed test, is asking a more general question about whether a difference is likely to have been produced by chance. The question is, what is probability of any difference. It is also called a **non-directional** test, because here we don't care about the direction or sign of the difference (positive or negative), we just care if there is any kind of difference. 

The same basic things as before are involved. We define an alpha criterion ($\alpha = 0.05$). And, we say that any observed $t$ value that has a probability of p<.05 (p is less than .05) will be called **statistically signficant**, and ones that are more likely (p>.05, p is greater than .05) will be called null-results, or not statistically significant. The only difference is how we draw the alpha range. Before it was on the right side of the $t$ distribution (we were conducting a one-sided test remember, so we were only interested in one side).

Let's just take a look at what the most extreme 5% of the t-values are, when we ignore if they are positive or negative:


```{r}
range <- seq(-4,4, .1)
null_distribution <- dt(range, 4, log = FALSE)
plot_df <- data.frame(range,null_distribution)

t_ps <- qt(seq(.1,.9,.1),4)

ggplot(plot_df,aes(x=range, y=null_distribution))+
  geom_line()+
  xlab("t-values")+
  ylab("Probability")+
  geom_vline(xintercept=qt(.975,4, lower.tail=TRUE))+
  geom_vline(xintercept=qt(.025,4, lower.tail=TRUE))+
  ggtitle("Critical ts for two-tailed test")+
  theme_classic(base_size = 10)+
  theme(axis.text.y=element_blank(),axis.ticks=element_blank())+
  annotate("rect", xmin=qt(.975,4, lower.tail=TRUE),xmax=4, ymin=0, ymax=Inf, alpha=0.5, fill="green")+
  geom_label(data = data.frame(x = 3.5, y = .2, label = "2.5%"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = qt(.975,4, lower.tail=TRUE), y = .3, 
                               label = "Critical t"), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = qt(.975,4, lower.tail=TRUE), y = .25, 
                               label = round(qt(.975,4, lower.tail=TRUE), digits=2)), 
                               aes(x = x, y = y, label = label))+
   annotate("rect", xmin=-4,xmax=qt(.025,4, lower.tail=TRUE), ymin=0, ymax=Inf, alpha=0.5, fill="green")+
  geom_label(data = data.frame(x = -3.5, y = .2, label = "2.5%"), aes(x = x, y = y, label = label))+
  geom_label(data = data.frame(x = qt(.025,4, lower.tail=TRUE), y = .3, 
                               label = "Critical t"), 
                               aes(x = x, y = y, label = label))+
   geom_label(data = data.frame(x = qt(.025,4, lower.tail=TRUE), y = .25, 
                               label = round(qt(.025,4, lower.tail=TRUE), digits=2)), 
                               aes(x = x, y = y, label = label))


```

Here is what we are seeing. A distribution of no differences (the null, which is what we are looking at), will produce $t$s that are 2.78 or greater 2.5% of the time, and $t$s that are -2.78 or smaller 2.5% of the time. 2.5% + 2.5% is a total of 5% of the time. We could also say that $t$s large than +/- 2.78 occur 5% of the time.

As a result, the critical $t$ value is (+/-) 2.78 for a two-tailed test. As you can see, the two-tailed test is blind to the direction or sign of the difference. Because of this, the critical $t$ value is also higher for a two-tailed test, than for the one-tailed test that we did earlier. Hopefully, now you can see why it is called a two-tailed test. There are two tails of the distribution, one on the left and right, both shaded in green.

### One or two tailed, which one?

Now that you know there are two kinds of tests, one-tailed, and two-tailed, which one should you use? There is some conventional wisdom on this, but also some debate. In the end, it is up to you to be able to justify your choice and why it is appropriate for you data. That is the real answer.

The conventional answer is that you use you one-tailed test when you have a theory or hypothesis that is making a directional prediction (the theory predicts that the difference will be positive, or negative). Similarly, use a two-tailed test when you are looking for any difference, and you don't have a theory that makes a directional prediction (it just makes the prediction that there will be a difference, either postive or negative).

Also, people appear to choose a one or two-tailed test based on how risky they are as researchers. If you always ran one-tailed tests, your critical $t$ values for your set alpha criterion would always be smaller than the critical $t$s for a two-tailed test. Over the long run, you would make more type I errors, because the criterion to detect an effect is a lower bar for one than two tailed tests. Similarly, if you always ran two-tailed tests, even when you had a directional prediction, you would make fewer type I errors over the long run, because the $t$ for a two-tailed test is higher than the $t$ for a one-tailed test. It seems quite common for researchers to use a more conservative two-tailed test, even when they are making a directional prediction based on theory. In practice, researchers tend to adopt a standard for reporting that is common in their field. Whether or not the practice is justifiable can sometimes be an open question. The important task for any researcer, or student learning statistics, is to be able to justify their choice of test. 

### Degrees of freedom

Before we finsih up with paired-samples t-tests, we should talk about degrees of freedom. Our sense is that students don't really understand degrees of freedom very well. If you are reading this textbook, you are probably still wondering what is degrees of freedom, seeing as we haven't really talked about it all. 

For the t-test, there is a formula for degrees of freedom. For the one-sample and paired sample t-tests, the formula is:

$\text{Degrees of Freedom} = \text{df} = n-1$. Where n is the number of samples in the test.

In our paired t-test example, there were 5 infants. Therefore, degrees of freedom = 5-1 = 4. 

Ok, that's formula. Who cares about degrees of freedom, what does the number mean? And why do we report it when we report a t-test...you've probably noticed the number in parentheses e.g., t(4)=.72, the 4 is the df, or degrees of freedom.

Degrees of freedom is both a concept, and a correction. The concept is that if you estimate a property of the numbers, and you use this estimate, you will be forcing some contraints on your numbers.

Consider the numbers: 1, 2, 3. The mean of these numbers is 2. Now, let's say I told you that the mean of three numbers is 2. Then, how many of these three numbers have freedom? Funny question right. What we mean is, how many of the three numbers could be any number...has the freedom to be any number.

The first two numbers could be any number. But, once those two numbers are set, the final number (the third number), MUST be a particular number that makes the mean 2. The first two numbers have freedom. The third number has no freedom. It is forced...

To illustrate. Let's freely pick two numbers: 51 and -3. I used my personal freedom to pick those two numbers. Now, if our three numbers are 51, -3, and x, and the mean of these three numbers is 2. There is only one solution, x has to be -42, otherwise the mean won't be 2. This is one way to think about degrees of freedom. The degrees of freedom for these three numbers is n-1 = 3-1= 2, because 2 of the numbers can be free, but the last number has no freedom, it becomes fixed after the first two are decided.

Now, statisticians often apply degrees of freedom to their calculations, especially when a second calculation relies on an estimated value. For example, when we calculate the standard deviation of a sample, we first calculate the mean of the sample right! By estimating the mean, we are fixing an aspect of our sample, and so, our sample now has n-1 degrees of freedom when we calculate the standard deviation (remember for the sample standard deviation, we divide by n-1...there's that n-1 again.)

#### Simulating how degrees of freedom affects the t distribution

There are at least two ways to think the degrees of freedom for a t-test. For example, if you want to use math to compute aspects of the $t$ distribution, then you need the degrees of freedom to plug in to the formula... If you want to see the formulas I'm talking about, scroll down on the [t-test wikipedia page](https://en.wikipedia.org/wiki/Student%27s_t-distribution) and look for the probability density or cumulative distribution functions...We think that is quite scary for most people, and one reason why degrees of freedom are not well-understood.

If we wanted to simulate the t distribution we could more easily see what influence degrees of freedom has on the shape of the distribution. Remember, $t$ is a sample statistic, it is something we measure from the sample. So, we could simulate the process of measuring $t$ from many different samples, then plot the histogram of $t$ to show us the simualted $t$ distribution.


```{r}
ts<-c(rt(1000,4), rt(1000,100))
dfs<-as.factor(rep(c(4,100), each=1000))

t_df<-data.frame(dfs,ts)
t_df<-t_df[abs(t_df$ts)<5,]

ggplot(t_df,aes(x=ts, group=dfs, color=dfs))+
  geom_histogram()+
  theme_classic()+
  facet_wrap(~dfs)+
  ggtitle("t distributions for df = 4 and 100")


```


Notice that the red distribution for df =4, is a little bit shorter, and a little bit wider than the bluey-green distribution for df = 100. As degrees of freedom increase, the $t$-distribution gets taller (in the middle), and narrower in the range. It get's more peaky. Can you guess the reason for this? Remember, we are estimating a sample statistic, and degrees of freedom is really just a number that refers to the number of subjects (well minus). And, we already know that as we increase n, our sample statistics become better estimates (less variance) of the distributional parameters they are estimating. So, $t$ becomes a better estimate of it's "true" value as sample size increase, and which results in a more narrow distribution of $t$s.

There is a slightly different $t$ distribution for every degrees of freedom, and the critical regions associated with 5% of the extreme values are thus slightly different everytime. This is why we report the degrees of freedom for each t-test, they define the distribution of $t$ values for the sample-size in question. Why do we use n-1 and not n? Well, we calcualte $t$ using the sample standard deviation to estimate the standard error or the mean, that estimate uses n-1 in the denominator, so our $t$ distribution is built assuming n-1. That's enough for degrees of freedom...

## The paired samples t-test strikes back

You must be wondering if we will ever be finished talking about paired samples t-tests...why are we doing round 2, oh no! Don't worry, we're just going to 1) remind you about what we were doing with infant study, and 2) do a paired samples t-test on the entire data set and discuss. 

Remember, we were wondering if the infants would look longer toward the singer who sang the familiar song during the test phase compared to the baseline phase. We showed you data from 5 infants, and walked through the computations for the t-test. As a reminder, it looked like this:


```{r, echo=FALSE}

paired_sample_df <-  data.frame(infant=1:5, 
                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), 
                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))

differences <-  paired_sample_df$Test-paired_sample_df$Baseline
diff_from_mean <- differences-mean(differences)
Squared_differences <- diff_from_mean^2
paired_sample_df <- cbind(paired_sample_df, 
                          differences,
                          diff_from_mean,
                          Squared_differences)
 

 paired_sample_df <- paired_sample_df %>%
   rbind(c("Sums",colSums(paired_sample_df[1:5,2:6]))) %>%
   rbind(c("Means",colMeans(paired_sample_df[1:5,2:6]))) %>%
   rbind(c(" "," "," "," ","sd ",round(sd(paired_sample_df[1:5,4]),digits=3))) %>%
   rbind(c(" "," "," "," ","SEM ",round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3))) %>%
   rbind(c(" "," "," "," ","t",mean(differences)/round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3)))
 paired_sample_df[6,5]<-0
  paired_sample_df[7,5]<-0
knitr::kable(paired_sample_df)

t.test(round(differences, digits=2), mu=0)


```

Let's write down the finding one more time: The mean difference was 0.054, $t$(4) = .72, p=.509. We can also now confirm, that the p-value was from a two-tailed test. So, what does this all really mean.

Well, we can say that a $t$ value of with an absolute of .72 or larger occurs 50.9%  of the time. More precisaly, the distribution of no differences (the null), will produce a $t$ value this large or larger 50.9% of the time. In other words, chance alone good have easily produced the $t$ value from our sample, and the mean difference we observed or .054, could easily have been a result of chance.

Let's quickly put all of the data in the t-test, and re-run the test using all of the infant subjects.

```{r}

paired_sample_df <-  data.frame(infant=1:32, 
                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:32],digits=2), 
                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:32], digits=2))

differences <-  paired_sample_df$Test-paired_sample_df$Baseline
t.test(differences,mu=0)

```

Now we get a very different answer. We would summarise the results saying the mean difference was .073, t(31) = 2.44, p = 0.020. How many total infants were their? Well the degrees of freedrom was 31, so there must have been 32 infants in the study. Now we see a much smaller p-value. This was also a two-tailed test, so we that observing a $t$ value of 2.4 or greater (absolute value) only occurs 2% of the time. In other words, the distribution of no differences will produce the observed t-value very rarely. So, it is unlikely that the observed mean difference of .073 was due to chance (it could have been due to chance, but that is very unlikely). As a result, we can be somewhat confident in concluding that something about seeing and hearing a unfamiliar person sing a familiar song, causes an infant to draw their attention toward the singer, and this potentially benefits social learning on the part of the infant.

## Independent samples t-test: The return of the t-test?

If you've been following the Star Wars references, we are on last movie...the independent t-test. This were basically the same plot happens, only slightly different.

Remember there are different t-tests for different kinds of research designs. When your design is a **between-subjects** design, you use an **independent samples t-test**. Between-subjects design involve different people or subjects in each experimental condition. If there are two conditions, and 10 people in each, then there are 20 total people. And, there are no paired scores, because every single person is measured once, not twice, no repeated measures. Because there are no repeated measures we can not look at the difference scores between conditions one and two. The scores are not paired in any meaningful way, to it doesn't make sense to subtract them. So what do we do?

The logic of the independent samples t-test is the very same as the other t tests. We calculated the means for each group, then we find the difference. That goes into the numerator of the t formala. Then we get an estimate of the variation for the denominator. We divide the mean difference by the estimate of the variation, and we get t. It's the same as before.

The only wrinkly here is what goes into the denominator? How should we calculate the estimate of the variance? It would be nice if we could do seomething very straightforward like this, say for a n experiment with two groups A and B:

$t = \frac{\bar{A}-\bar{B}}{(\frac{SEM_A+SEM_B}{2})}$

In plain language, this is just:

1. Find the mean difference for the top part
2. Compute the SEM (standard error of the mean) for each group, and average them together to make a single estimate, pooling over both samples.

This would be nice, but unfortunately, it turns out that finding the average of two standard errors of the mean is not the best way to do it. This would create a biased estimator of the variation in for the hypothesized distribution of no differences. We won't go into the math here, but instead of the above formula, we an use a different one that gives as an **unbiased estimate of the pooled standard error of the sample mean**. Our new and improved t formula would look like this:

$t = \frac{\bar{X_A}-\bar{X_B}}{s_p * \sqrt{\frac{1}{n_A} + \frac{1}{n_B}}}$

and, $s_p$, which is the pooled sample standard deviation is defined as, note the s's in the formula are variances: 

$s_p = \sqrt{\frac{(n_A-1)s_A^2 + (n_B-1)s^2_B}{n_A +n_B -2}}$

Believe you me, that is so much more formula than I wanted to type out. Shall we do one independent t-test example by hand, just to see the computations? Let's do it...but in a slightly different way than you expect. I show the steps using R. I made some fake scores for groups A and B. Then, I followed all of the steps from the formula, but made R do each of the calculations. This shows you the needed steps by following the code. At the end, I print the t-test values I computed "by hand", and then the t-test value that the R software outputs using the t-test function. You should be able to get the same values for $t$, if you were brave enough to compute $t$ by hand.

```{r, echo=TRUE }

## By "hand" using R r code
a <- c(1,2,3,4,5)
b <- c(3,5,4,7,9)

mean_difference <- mean(a)-mean(b) # compute mean difference

variance_a <- var(a) # compute variance for A
variance_b <- var(b) # compute variance for B

# Compute top part and bottom part of sp formula

sp_numerator <- (4*variance_a + 4* variance_b) 
sp_denominator <- 5+5-2
sp <- sqrt(sp_numerator/sp_denominator) # compute sp


# compute t following formulat

t <- mean_difference / ( sp * sqrt( (1/5) +(1/5) ) )

t # print results


# using the R function t.test
t.test(a,b, paired=FALSE, var.equal = TRUE)


```


<!--

Chapters[FoundationForInference] and[inferenceForCategoricalData] introduced us to inference for proportions using the normal model, and in Section[oneWayChiSquare], we encountered the chi-square distribution, which is useful for working with categorical data with many levels. In this chapter, our focus will be on numerical data, where we will encounter two more distributions: the $t$ distribution (looks a lot like the normal distribution) and the $F$ distribution. Our general approach will be:

1.  Determine which point estimate or test statistic is useful.

2.  Identify an appropriate distribution for the point estimate or test statistic.

3.  Apply the hypothesis and confidence interval techniques from Chapter[FoundationForInference] using the distribution from step 2.

## One-sample means with the $t$ distribution {#oneSampleMeansWithTDistribution}

The sampling distribution associated with a sample mean or difference of two sample means is, if certain conditions are satisfied, nearly normal. However, this becomes more complex when the sample size is small, where *small* here typically means a sample size smaller than 30 observations. For this reason, well use a new distribution called the $t$ distribution that will often work for both small and large samples of numerical data.

### Two examples using the normal distribution

Before we get started with the $t$ distribution, lets take a look at two applications where it is okay to use the normal model for the sample mean. For the case of a single mean, the standard error of the sample mean can be calculated as

$$\begin{aligned}
SE = \frac{\sigma}{\sqrt{n}}\end{aligned}$$

where $\sigma$ is the population standard deviation and $n$ is the sample size. Generally we use the sample standard deviation, denoted by $s$, in place of the population standard deviation when we compute the standard error:

$$\begin{aligned}
SE \approx \frac{s}{\sqrt{n}}\end{aligned}$$

If we look at this formula, there are some characteristics that we can think about intuitively.

-   If we examine the standard error formula, we would see that a larger $s$ corresponds to a larger $SE$. This makes intuitive sense: if the data are more volatile, then well be less certain of the location of the true mean, so the standard error should be bigger. On the other hand, if the observations all fall very close together, then $s$ will be small, and the sample mean should be a more precise estimate of the true mean.

-   In the formula, the larger the sample size $n$, the smaller the standard error. This matches our intuition: we expect estimates to be more precise when we have more data, so the standard error $SE$ should get smaller when $n$ gets bigger.

As we did with proportions, well also need to check a few conditions before using the normal model. Well forgo describing those details until later this section, but these conditions have been verified for the two examples below.

<span>Weve taken a random sample of 100 runners from a race called the Cherry Blossom Run in Washington, DC, which was a race with 16,924 participants.[^4.1] The sample data for the 100 runners is summarized in Table[run10SampDF], histograms of the run time and age of participants are in Figure[run10SampHistograms], and summary statistics are available in Table[ptEstimatesNetTimeAge]. Create a 95% confidence interval for the average time it takes runners in the Cherry Blossom Run to complete the race.</span> We can use the same confidence interval formula for the mean that we used for a proportion:

$$\begin{aligned}
\text{point estimate}\ \pm\ 1.96 \times SE\end{aligned}$$

In this case, the best estimate of the overall mean is the sample mean, $\bar{x} = 95.61$ minutes. The standard error can be calculated using sample standard deviation ($s = 15.78$), the sample size ($n=100$), and the standard error formula:

$$\begin{aligned}
SE = \frac{s}{\sqrt{n}} = \frac{15.78}{\sqrt{100}} = 1.578\end{aligned}$$

Finally, we can calculate a 95% confidence interval:

$$\begin{aligned}
\text{point estimate}\ \pm\ z^{\star} \times SE \quad\rightarrow\quad
95.61 \pm 1.96 \times 1.578 \quad\rightarrow\quad
(92.52, 98.70)\end{aligned}$$

We are 95% confident that the average time for all runners in the 2012 Cherry Blossom Run is between 92.52 and 98.70 minutes.

          ID       time        age     gender      state
  ---------- ---------- ---------- ---------- ----------
           1      88.31         59          M         MD
           2     100.67         32          M         VA
           3     109.52         33          F         VA
    $\vdots$   $\vdots$   $\vdots$   $\vdots$   $\vdots$
         100      89.49         26          M         DC

  : Four observations for the **run10Samp** data set, which represents a simple random sample of 100 runners from the 2012 Cherry Blossom Run.

[run10SampDF]

![Histograms of **time** and **age** for the sample Cherry Blossom Run data. The average time is in the mid-90s, and the average age is in the mid-30s. The age distribution is moderately skewed to the right.](04/figures/run10SampHistograms/run10SampHistograms)

[run10SampHistograms]

  ----------------- ------- -------
  sample mean         95.61   35.05
  sample median       95.37   32.50
  sample st. dev.     15.78    8.97
  ----------------- ------- -------

  : Point estimates and parameter values for the **time** variable.

[ptEstimatesNetTimeAge]

Use the data to calculate a 90% confidence interval for the average age of participants in the 2012 Cherry Blossom Run. The conditions for applying the normal model have already been verified.[^4.2]

<span>The nutrition label on a bag of potato chips says that a one ounce (28 gram) serving of potato chips has 130 calories and contains ten grams of fat, with three grams of saturated fat. A random sample of 35 bags yielded a sample mean of 134 calories with a standard deviation of 17 calories. Is there evidence that the nutrition label does not provide an accurate measure of calories in the bags of potato chips? The conditions necessary for applying the normal model have been checked and are satisfied.</span> The question has been framed in terms of two possibilities: the nutrition label accurately lists the correct average calories per bag of chips or it does not, which may be framed as a hypothesis test:

-   The average is listed correctly. $\mu = 130$

-   The nutrition label is incorrect. $\mu \neq 130$

The observed average is $\bar{x} = 134$ and the standard error may be calculated as $SE = \frac{17}{\sqrt{35}} = 2.87$. First, we draw a picture summarizing this scenario.

![image](04/figures/potatoChips/potatoChips)

We can compute a test statistic as the Z score:

$$\begin{aligned}
Z = \frac{134 - 130}{2.87} = 1.39\end{aligned}$$

The upper-tail area is 0.0823, so the p-value is $2 \times 0.0823 = 0.1646$. Since the p-value is larger than 0.05, we do not reject the null hypothesis. That is, there is not enough evidence to show the nutrition label has incorrect information.

The normal model works well when the sample size is larger than about 30. For smaller sample sizes, we run into a problem: our estimate of $s$, which is used to compute the standard error, isnt as reliable when the sample size is small. To solve this problem, well use a new distribution: the $t$ distribution.

### Introducing the $t$ distribution {#introducingTheTDistribution}

A $t$ distribution, shown as a solid line in Figure[tDistCompareToNormalDist], has a bell shape that looks very similar to a normal distribution (dotted line). However, its tails are thicker, which means observations are more likely to fall beyond two standard deviations from the mean than under the normal distribution.[^4.3] When our sample is small, the value $s$ used to compute the standard error isnt very reliable. The extra thick tails of the $t$ distribution are exactly the correction we need to resolve this problem.

![Comparison of a $t$ distribution (solid line) and a normal distribution (dotted line).](04/figures/tDistCompareToNormalDist/tDistCompareToNormalDist)

[tDistCompareToNormalDist]

The $t$ distribution, always centered at zero, has a single parameter: degrees of freedom. The describe the precise form of the bell-shaped $t$ distribution. Several $t$ distributions are shown in Figure[tDistConvergeToNormalDist] with various degrees of freedom. When there are more degrees of freedom, the $t$distribution looks very much like the standard normal distribution.

![The larger the degrees of freedom, the more closely the $t$ distribution resembles the standard normal model.](04/figures/tDistConvergeToNormalDist/tDistConvergeToNormalDist)

[tDistConvergeToNormalDist]

<span> The degrees of freedom describe the shape of the $t$ distribution. The larger the degrees of freedom, the more closely the distribution approximates the normal model.</span>

When the degrees of freedom is about 30 or more, the $t$ distribution is nearly indistinguishable from the normal distribution, e.g. see Figure[tDistConvergeToNormalDist]. In Section[tDistSolutionToSEProblem], we relate degrees of freedom to sample size.

We will find it very useful to become familiar with the $t$ distribution, because it plays a very similar role to the normal distribution during inference for numerical data. We use a , partially shown in Table[tTableSample], in place of the normal probability table for small sample numerical data. A larger table is presented in Appendix. Alternatively, we could use statistical software to get this same information.

<span>r | rrr rr</span> one tail &

0.100 &

0.050 &

0.025 &

0.010 &

0.005\
two tails & 0.200 & 0.100 & 0.050 & 0.020 & 0.010\
 1 & <span>3.08</span> & <span>6.31</span> & <span>12.71</span> & <span>31.82</span> & <span>63.66</span>\
2 & <span>1.89</span> & <span>2.92</span> & <span>4.30</span> & <span>6.96</span> & <span>9.92</span>\
3 & <span>1.64</span> & <span>2.35</span> & <span>3.18</span> & <span>4.54</span> & <span>5.84</span>\
$\vdots$ & $\vdots$ &$\vdots$ &$\vdots$ &$\vdots$ &\
17 & <span>1.33</span> & <span>1.74</span> & <span>2.11</span> & <span>2.57</span> & <span>2.90</span>\
 & & & & &\
19 & <span>1.33</span> & <span>1.73</span> & <span>2.09</span> & <span>2.54</span> & <span>2.86</span>\
20 & <span>1.33</span> & <span>1.72</span> & <span>2.09</span> & <span>2.53</span> & <span>2.85</span>\
$\vdots$ & $\vdots$ &$\vdots$ &$\vdots$ &$\vdots$ &\
400 & <span>1.28</span> & <span>1.65</span> & <span>1.97</span> & <span>2.34</span> & <span>2.59</span>\
500 & <span>1.28</span> & <span>1.65</span> & <span>1.96</span> & <span>2.33</span> & <span>2.59</span>\
$\infty$ & <span>1.28</span> & <span>1.65</span> & <span>1.96</span> & <span>2.33</span> & <span>2.58</span>\

[tTableSample]

Each row in the $t$ table represents a $t$ distribution with different degrees of freedom. The columns correspond to tail probabilities. For instance, if we know we are working with the $t$ distribution with $df=18$, we can examine row 18, which is in Table[tTableSample]. If we want the value in this row that identifies the cutoff for an upper tail of 10%, we can look in the column where *one tail* is 0.100. This cutoff is 1.33. If we had wanted the cutoff for the lower 10%, we would use -1.33. Just like the normal distribution, all $t$ distributions are symmetric.

<span>What proportion of the $t$ distribution with 18 degrees of freedom falls below -2.10?</span> Just like a normal probability problem, we first draw the picture in Figure[tDistDF18LeftTail2Point10] and shade the area below -2.10. To find this area, we identify the appropriate row: $df=18$. Then we identify the column containing the absolute value of -2.10; it is the third column. Because we are looking for just one tail, we examine the top line of the table, which shows that a one tail area for a value in the third row corresponds to 0.025. About 2.5% of the distribution falls below -2.10. In the next example we encounter a case where the exact $t$ value is not listed in the table.

![The $t$ distribution with 18 degrees of freedom. The area below -2.10 has been shaded.](04/figures/tDistDF18LeftTail2Point10/tDistDF18LeftTail2Point10)

[tDistDF18LeftTail2Point10]

<span>A $t$ distribution with 20 degrees of freedom is shown in the left panel of Figure[tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling above 1.65.</span> We identify the row in the $t$ table using the degrees of freedom: $df=20$. Then we look for 1.65; it is not listed. It falls between the first and second columns. Since these values bound 1.65, their tail areas will bound the tail area corresponding to 1.65. We identify the one tail area of the first and second columns, 0.050 and 0.10, and we conclude that between 5% and 10% of the distribution is more than 1.65 standard deviations above the mean. If we like, we can identify the precise area using statistical software: 0.0573.

![Left: The $t$ distribution with 20 degrees of freedom, with the area above 1.65 shaded. Right: The $t$ distribution with 2 degrees of freedom, with the area further than 3 units from 0 shaded.](04/figures/tDistDF20RightTail1Point65/tDistDF20RightTail1Point65)

[tDistDF20RightTail1Point65]

<span>A $t$ distribution with 2 degrees of freedom is shown in the right panel of Figure[tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling more than 3 units from the mean (above or below).</span> As before, first identify the appropriate row: $df=2$. Next, find the columns that capture 3; because $2.92 < 3 < 4.30$, we use the second and third columns. Finally, we find bounds for the tail areas by looking at the two tail values: 0.05 and 0.10. We use the two tail values because we are looking for two (symmetric) tails.

What proportion of the $t$ distribution with 19 degrees of freedom falls above -1.79 units?[^4.4]

### Applying the $t$ distribution to the single-mean situation {#tDistSolutionToSEProblem}

When estimating the mean and standard error from a sample of numerical data, the $t$ distribution is a little more accurate than the normal model. This is true for both small and large samples, though the benefits for larger samples are limited.

<span> Use the $t$ distribution for inference of the sample mean when observations are independent and nearly normal. You may relax the nearly normal condition as the sample size increases. For example, the data distribution may be moderately skewed when the sample size is at least30. </span>

Before applying the $t$ distribution for inference about a single mean, we check two conditions.

Independence of observations.

:   We verify this condition just as we did before. We collect a simple random sample from less than 10% of the population, or if the data are from an experiment or random process, we carefully check to the best of our abilities that the observations were independent.

Observations come from a nearly normal distribution.

:   This second condition is difficult to verify with small data sets. We often (i) take a look at a plot of the data for obvious departures from the normal model, usually in the form of prominent outliers, and (ii) consider whether any previous experiences alert us that the data may not be nearly normal. However, if the sample size is somewhat large, then we can relax this condition, e.g. moderate skew is acceptable when the sample size is 30 or more, and strong skew is acceptable when the size is about 60 or more.

When examining a sample mean and estimated standard error from a sample of $n$ independent and nearly normal observations, we use a $t$ distribution with $n-1$ degrees of freedom($df$). For example, if the sample size was 19, then we would use the $t$ distribution with $df=19-1=18$ degrees of freedom and proceed in the same way as we did in Chapter[inferenceForCategoricalData], except that *now we use the $t$ table*.

<span> If the sample has $n$ observations and we are examining a single mean, then we use the $t$ distribution with $df=n-1$ degrees of freedom.</span>

### One sample $t$ confidence intervals {#oneSampleTConfidenceIntervals}

Dolphins are at the top of the oceanic food chain, which causes dangerous substances such as mercury to concentrate in their organs and muscles. This is an important problem for both dolphins and other animals, like humans, who occasionally eat them. For instance, this is particularly relevant in Japan where school meals have included dolphin at times.

![A Rissos dolphin.](04/figures/rissosDolphin/rissosDolphin.jpg "fig:")\

[rissosDolphin]

Here we identify a confidence interval for the average mercury content in dolphin muscle using a sample of 19 Rissos dolphins from the Taiji area in Japan.[^4.5] The data are summarized in Table[summaryStatsOfHgInMuscleOfRissosDolphins]. The minimum and maximum observed values can be used to evaluate whether or not there are obvious outliers or skew.

  ----- ----------- ----- --------- ---------
   $n$   $\bar{x}$   $s$   minimum   maximum
   19       4.4      2.3     1.7       9.2
  ----- ----------- ----- --------- ---------

  : Summary of mercury content in the muscle of 19 Rissos dolphins from the Taiji area. Measurements are in $\mu$g/wet g (micrograms of mercury per wet gram of muscle).

[summaryStatsOfHgInMuscleOfRissosDolphins]

<span>Are the independence and normality conditions satisfied for this dataset?</span> The observations are a simple random sample and consist of less than 10% of the population, therefore independence is reasonable. Ideally we would see a visualization of the data to check for skew and outliers. However, we can instead examine the summary statistics in Table[summaryStatsOfHgInMuscleOfRissosDolphins], which do not suggest any skew or outliers. All observations are within 2.5 standard deviations of the mean. Based on this evidence, the normality assumption seems reasonable.

In the normal model, we used $z^{\star}$ and the standard error to determine the width of a confidence interval. We revise the confidence interval formula slightly when using the $t$ distribution:

$$\begin{aligned}
\bar{x} \ \pm\  t^{\star}_{df} \times SE\end{aligned}$$

[

$t^{\star}_{df}$

\
Multiplication\
factor for\
$t$ conf. interval]

$t^{\star}_{df}$

\
Multiplication\
factor for\
$t$ conf. interval

The sample mean and estimated standard error are computed just as in our earlier examples that used the normal model ($\bar{x} = 4.4$ and $SE = s/\sqrt{n} = 0.528$). The value $t^{\star}_{df}$ is a cutoff we obtain based on the confidence level and the $t$ distribution with $df$ degrees of freedom. Before determining this cutoff, we will first need the degrees of freedom.

In our current example, we should use the $t$ distribution with $df = n - 1 = 19 - 1 = 18$ degrees of freedom. Then identifying $t_{18}^{\star}$ is similar to how we found $z^{\star}$:

-   For a 95% confidence interval, we want to find the cutoff $t^{\star}_{18}$ such that 95% of the $t$ distribution is between -$t^{\star}_{18}$ and $t^{\star}_{18}$.

-   We look in the $t$ table on page, find the column with area totaling 0.05 in the two tails (third column), and then the row with 18 degrees of freedom: $t^{\star}_{18} = 2.10$.

Generally the value of $t^{\star}_{df}$ is slightly larger than what we would get under the normal model with$z^{\star}$.

Finally, we can substitute all the values into the confidence interval equation to create the 95% confidence interval for the average mercury content in muscles from Rissos dolphins that pass through the Taiji area:

$$\begin{aligned}
\bar{x} \ \pm\  t^{\star}_{18} \times SE
    \quad \to \quad
4.4 \ \pm\  2.10 \times 0.528
    \quad \to \quad
(3.29, 5.51)\end{aligned}$$

We are 95% confident the average mercury content of muscles in Rissos dolphins is between 3.29 and 5.51 $\mu$g/wet gram, which is considered extremely high.

Based on a sample of $n$ independent and nearly normal observations, a confidence interval for the population mean is

$$\begin{aligned}
\bar{x} \ \pm\  t^{\star}_{df} \times SE\end{aligned}$$

where $\bar{x}$ is the sample mean, $t^{\star}_{df}$ corresponds to the confidence level and degrees of freedom, and $SE$ is the standard error as estimated by the sample. The normality condition may be relaxed for larger sample sizes.

[croakerWhiteFishPacificExerConditions] The FDAs webpage provides some data on mercury content of fish.[^4.6] Based on a sample of 15 croaker white fish (Pacific), a sample mean and standard deviation were computed as 0.287 and 0.069 ppm (parts per million), respectively. The 15 observations ranged from 0.18 to 0.41 ppm. We will assume these observations are independent. Based on the summary statistics of the data, do you have any objections to the normality condition of the individual observations?[^4.7]

<span>Estimate the standard error of the sample mean using the data summaries in Guided Practice[croakerWhiteFishPacificExerConditions]. If we are to use the $t$ distribution to create a 90% confidence interval for the actual mean of the mercury content, identify the degrees of freedom we should use and also find $t^{\star}_{df}$.</span> [croakerWhiteFishPacificExerSEDFTStar] The standard error: $SE = \frac{0.069}{\sqrt{15}} = 0.0178$. Degrees of freedom: $df = n - 1 = 14$.

Looking in the column where two tails is 0.100 (for a 90% confidence interval) and row $df=14$, we identify $t^{\star}_{14} = 1.76$.

Using the results of Guided Practice[croakerWhiteFishPacificExerConditions] and Example[croakerWhiteFishPacificExerSEDFTStar], compute a 90% confidence interval for the average mercury content of croaker white fish (Pacific).[^4.8]

### One sample $t$ tests {#oneSampleTTests}

Is the typical US runner getting faster or slower over time? We consider this question in the context of the Cherry Blossom Run, comparing runners in 2006 and 2012. Technological advances in shoes, training, and diet might suggest runners would be faster in 2012. An opposing viewpoint might say that with the average body mass index on the rise, people tend to run slower. In fact, all of these components might be influencing run time.

The average time for all runners who finished the Cherry Blossom Run in 2006 was 93.29 minutes (93 minutes and about 17 seconds). We want to determine using data from 100 participants in the 2012 Cherry Blossom Run whether runners in this race are getting faster or slower, versus the other possibility that there has been no change.

What are appropriate hypotheses for this context?[^4.9]

The data come from a simple random sample from less than 10% of all participants, so the observations are independent. However, should we be worried about skew in the data? A histogram of the differences was shown in the left panel of Figure.[^4.10]

With independence satisfied and skew not a concern, we can proceed with performing a hypothesis test using the $t$ distribution.

The sample mean and sample standard deviation are 95.61 and 15.78 minutes, respectively. Recall that the sample size is 100. What is the p-value for the test, and what is your conclusion?[^4.11]

<span> To help us remember to use the $t$ distribution, we use a $T$ to represent the test statistic, and we often call this a **T score**. The Z score and T score are computed in the exact same way and are conceptually identical: each represents how many standard errors the observed value is from the null value.</span>

## Paired data {#pairedData}

Are textbooks actually cheaper online? Here we compare the price of textbooks at the University of California, Los Angeles (UCLAs) bookstore and prices at Amazon.com. Seventy-three UCLA courses were randomly sampled in Spring 2010, representing less than 10% of all UCLA courses.[^4.12] A portion of the data set is shown in Table[textbooksDF].

             dept       course           ucla     amazon       diff
  ---------- ---------- ---------- ---------- ---------- ----------
           1 Am Ind     C170            27.67      27.95      -0.28
           2 Anthro     9               40.59      31.14       9.45
           3 Anthro     135T            31.68      32.00      -0.32
           4 Anthro     191HB           16.00      11.52       4.48
    $\vdots$ $\vdots$   $\vdots$     $\vdots$   $\vdots$   $\vdots$
          72 Wom Std    M144            23.76      18.72       5.04
          73 Wom Std    285             27.70      18.22       9.48

  : Six cases of the **textbooks** data set.

[textbooksDF]

### Paired observations

Each textbook has two corresponding prices in the data set: one for the UCLA bookstore and one for Amazon. Therefore, each textbook price from the UCLA bookstore has a natural correspondence with a textbook price from Amazon. When two sets of observations have this special correspondence, they are said to be **paired**.

<span> Two sets of observations are *paired* if each observation in one set has a special correspondence or connection with exactly one observation in the other data set.</span>

To analyze paired data, it is often useful to look at the difference in outcomes of each pair of observations. In the **textbook** data set, we look at the difference in prices, which is represented as the **diff** variable in the **textbooks** data. Here the differences are taken as

$$\begin{aligned}
\text{UCLA price} - \text{Amazon price}\end{aligned}$$

for each book. It is important that we always subtract using a consistent order; here Amazon prices are always subtracted from UCLA prices. A histogram of these differences is shown in Figure[diffInTextbookPricesS10]. Using differences between paired observations is a common and useful way to analyze paired data.

![Histogram of the difference in price for each book sampled. These data are strongly skewed.](04/figures/textbooksS10/diffInTextbookPricesS10)

[diffInTextbookPricesS10]

The first difference shown in Table[textbooksDF] is computed as $27.67-27.95=-0.28$. Verify the differences are calculated correctly for observations 2 and3.[^4.13]

### Inference for paired data

To analyze a paired data set, we simply analyze the differences. We can use the same $t$ distribution techniques we applied in the last section.

<span>ccccc</span> $n_{_{diff}}$ &

& $\bar{x}_{_{diff}}$ &

& $s_{_{diff}}$

\
73 && 12.76 && 14.26\

[textbooksSummaryStats]

<span>Set up and implement a hypothesis test to determine whether, on average, there is a difference between Amazons price for a book and the UCLA bookstores price.</span> [htForDiffInUCLAAndAmazonTextbookPrices] We are considering two scenarios: there is no difference or there is some difference in average prices.

-   $\mu_{diff}=0$. There is no difference in the average textbook price.

-   $\mu_{diff} \neq 0$. There is a difference in average prices.

Can the $t$ distribution be used for this application? The observations are based on a simple random sample from less than 10% of all books sold at the bookstore, so independence is reasonable. While the distribution is strongly skewed, the sample is reasonably large ($n=73$), so we can proceed. Because the conditions are reasonably satisfied, we can apply the $t$ distribution to this setting.

We compute the standard error associated with $\bar{x}_{diff}$ using the standard deviation of the differences ($s_{_{diff}}=14.26$) and the number of differences ($n_{_{diff}}=73$): $$SE_{\bar{x}_{diff}} = \frac{s_{diff}}{\sqrt{n_{diff}}} = \frac{14.26}{\sqrt{73}} = 1.67$$ To visualize the p-value, the sampling distribution of $\bar{x}_{diff}$ is drawn as though $H_0$ is true, which is shown in Figure[textbooksS10HTTails]. The p-value is represented by the two (very) small tails.

To find the tail areas, we compute the test statistic, which is the T score of $\bar{x}_{diff}$ under the null condition that the actual mean difference is 0: $$T = \frac{\bar{x}_{diff} - 0}{SE_{x_{diff}}} = \frac{12.76 - 0}{1.67} = 7.59$$ The degrees of freedom are $df = 73 - 1 = 72$. If we examined Appendix, we would see that this value is larger than any in the 70 df row (we round down for $df$ when using the table), meaning the two-tailed p-value is less than 0.01. If we used statistical software, we would find the p-value is less than 1-in-10 billion! Because the p-value is less than 0.05, we reject the null hypothesis. We have found convincing evidence that Amazon is, on average, cheaper than the UCLA bookstore for UCLA course textbooks.

![Sampling distribution for the mean difference in book prices, if the true average difference is zero.](04/figures/textbooksS10/textbooksS10HTTails)

[textbooksS10HTTails]

Create a 95% confidence interval for the average price difference between books at the UCLA bookstore and books on Amazon.[^4.14]

In the textbook price example, we applied the $t$ distribution. However, as we mentioned in the last section, the $t$ distribution looks a lot like the normal distribution when the degrees of freedom are larger than about 30. In such cases, including this one, it would be reasonable to use the normal distribution in place of the $t$ distribution.

## Difference of two means {#differenceOfTwoMeans}

In this section we consider a difference in two population means, $\mu_1 - \mu_2$, under the condition that the data are not paired. Just as with a single sample, we identify conditions to ensure we can use the $t$ distribution with a point estimate of the difference, $\bar{x}_1 - \bar{x}_2$.

We apply these methods in three contexts: determining whether stem cells can improve heart function, exploring the impact of pregnant womens smoking habits on birth weights of newborns, and exploring whether there is statistically significant evidence that one variations of an exam is harder than another variation. This section is motivated by questions like Is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who dont smoke?

### Confidence interval for a differences of means

Does treatment using embryonic stem cells (ESCs) help improve heart function following a heart attack? Table[summaryStatsForSheepHeartDataWhoReceivedMiceESCs] contains summary statistics for an experiment to test ESCs in sheep that had a heart attack. Each of these sheep was randomly assigned to the ESC or control group, and the change in their hearts pumping capacity was measured in the study. Apositive value corresponds to increased pumping capacity, which generally suggests a stronger recovery. Our goal will be to identify a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity relative to the control group.

A point estimate of the difference in the heart pumping variable can be found using the difference in the sample means:

$$\begin{aligned}
\bar{x}_{esc} - \bar{x}_{control}\ =\ 3.50 - (-4.33)\ =\ 7.83\end{aligned}$$

<span>l rrrrr</span>

& $n$ & $\bar{x}$ & $s$\
ESCs & 9 & 3.50 & 5.17\
control & 9 & -4.33 & 2.76\

[summaryStatsForSheepHeartDataWhoReceivedMiceESCs]

![Histograms for both the embryonic stem cell group and the control group. Higher values are associated with greater improvement. We dont see any evidence of skew in these data; however, it is worth noting that skew would be difficult to detect with such a small sample.](04/figures/stemCellTherapyForHearts/stemCellTherapyForHearts)

[stemCellTherapyForHearts]

<span> [ConditionsForTwoSampleTDist]The $t$ distribution can be used for inference when working with the standardized difference of two means if (1) each sample meets the conditions for using the $t$ distribution and (2) the samples are independent.</span>

<span>Can the point estimate, $\bar{x}_{esc} - \bar{x}_{control} = 7.83$, be analyzed using the $t$ distribution?</span> We check the two required conditions:

1.  In this study, the sheep were independent of each other. Additionally, the distributions in Figure[stemCellTherapyForHearts] dont show any clear deviations from normality, where we watch for prominent outliers in particular for such small samples. These findings imply each sample mean could itself be modeled using a $t$ distribution.

2.  The sheep in each group were also independent of each other.

Because both conditions are met, we can use the $t$ distribution to model the difference of the two sample means.

Before we construct a confidence interval, we must calculate the standard error of the point estimate of the difference. For this, we use the following formula, where just as before we substitute the sample standard deviations into the formula:

$$\begin{aligned}
SE_{\bar{x}_{esc} - \bar{x}_{control}}
    &= \sqrt{\frac{\sigma_{esc}^2}{n_{esc}} + \frac{\sigma_{control}^2}{n_{control}}} \\
    &\approx \sqrt{\frac{s_{esc}^2}{n_{esc}} + \frac{s_{control}^2}{n_{control}}}
    = \sqrt{\frac{5.17^2}{9} + \frac{2.76^2}{9}} = 1.95\end{aligned}$$

Because we will use the $t$ distribution, we also must identify the appropriate degrees of freedom. This can be done using computer software. An alternative technique is to use the smaller of $n_1 - 1$ and $n_2 - 1$, which is the method we will typically apply in the examples and guided practice.[^4.15]

The sample difference of two means, $\bar{x}_1 - \bar{x}_2$, can be modeled using the $t$ distribution and the standard error

$$\begin{aligned}
\textstyle
SE_{\bar{x}_{1} - \bar{x}_{2}} = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}
\label{seOfDifferenceInMeans}\end{aligned}$$

when each sample mean can itself be modeled using a $t$ distribution and the samples are independent. To calculate the degrees of freedom, use statistical software or the smaller of $n_1 - 1$ and $n_2 - 1$.

<span>Calculate a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity of sheep after theyve suffered a heart attack.</span> We will use the sample difference and the standard error for that point estimate from our earlier calculations:

$$\begin{aligned}
& \bar{x}_{esc} - \bar{x}_{control} = 7.83 \\
& SE = \sqrt{\frac{5.17^2}{9} + \frac{2.76^2}{9}} = 1.95\end{aligned}$$

Using $df = 8$, we can identify the appropriate $t^{\star}_{df} = t^{\star}_{8}$ for a 95% confidence interval as 2.31. Finally, we can enter the values into the confidence interval formula:

$$\begin{aligned}
\text{point estimate} \ \pm\ z^{\star}SE \quad\rightarrow\quad
7.83 \ \pm\ 2.31\times 1.95 \quad\rightarrow\quad (3.38, 12.38)\end{aligned}$$

We are 95% confident that embryonic stem cells improve the hearts pumping function in sheep that have suffered a heart attack by 3.38% to 12.38%.

### Hypothesis tests based on a difference in means

A data set called represents a random sample of 150 cases of mothers and their newborns in North Carolina over a year. Four cases from this data set are represented in Table[babySmokeDF]. We are particularly interested in two variables: **weight** and **smoke**. The **weight** variable represents the weights of the newborns and the **smoke** variable describes which mothers smoked during pregnancy. We would like to know, is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who dont smoke? We will use the North Carolina sample to try to answer this question. The smoking group includes 50 cases and the nonsmoking group contains 100 cases, represented in Figure[babySmokePlotOfTwoGroupsToExamineSkew].

                   fAge       mAge      weeks     weight sexBaby    smoke
  ---------- ---------- ---------- ---------- ---------- ---------- -----------
           1         NA         13         37       5.00 female     nonsmoker
           2         NA         14         36       5.88 female     nonsmoker
           3         19         15         41       8.13 male       smoker
    $\vdots$   $\vdots$   $\vdots$   $\vdots$   $\vdots$ $\vdots$   
         150         45         50         36       9.25 female     nonsmoker

  : Four cases from the data set. The value NA, shown for the first two entries of the first variable, indicates that piece of data is missing.

[babySmokeDF]

![The top panel represents birth weights for infants whose mothers smoked. The bottom panel represents the birth weights for infants whose mothers who did not smoke. The distributions exhibit moderate-to-strong and strongskew, respectively.](04/figures/babySmokePlotOfTwoGroupsToExamineSkew/babySmokePlotOfTwoGroupsToExamineSkew)

[babySmokePlotOfTwoGroupsToExamineSkew]

<span>Set up appropriate hypotheses to evaluate whether there is a relationship between a mother smoking and average birth weight.</span>[babySmokeHTForWeight] The null hypothesis represents the case of no difference between the groups.

-   There is no difference in average birth weight for newborns from mothers who did and did not smoke. In statistical notation: $\mu_{n} - \mu_{s} = 0$, where $\mu_{n}$ represents non-smoking mothers and $\mu_s$ represents mothers who smoked.

-   There is some difference in average newborn weights from mothers who did and did not smoke ($\mu_{n} - \mu_{s} \neq 0$).

We check the two conditions necessary to apply the $t$ distribution to the difference in sample means. (1) Because the data come from a simple random sample and consist of less than 10% of all such cases, the observations are independent. Additionally, while each distribution is strongly skewed, the sample sizes of 50 and 100 would make it reasonable to model each mean separately using a $t$ distribution. The skew is reasonable for these sample sizes of 50 and 100. (2) The independence reasoning applied in (1) also ensures the observations in each sample are independent. Since both conditions are satisfied, the difference in sample means may be modeled using a $t$ distribution.

  ------------ ------ ------
  mean           6.78   7.18
  st. dev.       1.43   1.60
  samp. size       50    100
  ------------ ------ ------

  : Summary statistics for the data set.

[summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers]

The summary statistics in Table[summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers] may be useful for this exercise. (a)What is the point estimate of the population difference, $\mu_{n} - \mu_{s}$? (b)Compute the standard error of the point estimate from part (a).[^4.16]

<span>Draw a picture to represent the p-value for the hypothesis test from Example[babySmokeHTForWeight].</span> [pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights] To depict the p-value, we draw the distribution of the point estimate as though $H_0$ were true and shade areas representing at least as much evidence against $H_0$ as what was observed. Both tails are shaded because it is a two-sided test.

![image](04/figures/distOfDiffOfSampleMeansForBWOfBabySmokeData/distOfDiffOfSampleMeansForBWOfBabySmokeData)

<span>Compute the p-value of the hypothesis test using the figure in Example[pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights], and evaluate the hypotheses using a significance level of $\alpha=0.05$.</span> [babySmokeHTForWeightComputePValueAndEvalHT] We start by computing the T score:

$$\begin{aligned}
T = \frac{\ 0.40 - 0\ }{0.26} = 1.54\end{aligned}$$

Next, we compare this value to values in the $t$ table in Appendix, where we use the smaller of $n_n - 1 = 99$ and $n_s - 1 = 49$ as the degrees of freedom: $df = 49$. The T score falls between the first and second columns in the $df = 49$ row of the $t$ table, meaning the two-tailed p-value falls between 0.10 and 0.20 (reminder, find tail areas along the top of the table). This p-value is larger than the significance value, 0.05, so we fail to reject the null hypothesis. There is insufficient evidence to say there is a difference in average birth weight of newborns from North Carolina mothers who did smoke during pregnancy and newborns from North Carolina mothers who did not smoke during pregnancy.

Does the conclusion to Example[babySmokeHTForWeightComputePValueAndEvalHT] mean that smoking and average birth weight are unrelated?[^4.17]

[babySmokeHTIDingHowToDetectDifferences] If we made a Type 2 Error and there is a difference, what could we have done differently in data collection to be more likely to detect such a difference?[^4.18]

### Case study: two versions of a course exam

An instructor decided to run two slight variations of the same exam. Prior to passing out the exams, she shuffled the exams together to ensure each student received a random version. Summary statistics for how students performed on these two exams are shown in Table[summaryStatsForTwoVersionsOfExams]. Anticipating complaints from students who took VersionB, she would like to evaluate whether the difference observed in the groups is so large that it provides convincing evidence that VersionB was more difficult (on average) than VersionA.

<span>l rrrrr</span> Version

& $n$ & $\bar{x}$ & $s$ & min & max\
A & 30 & 79.4 & 14 & 45 & 100\
B & 27 & 74.1 & 20 & 32 & 100\

[summaryStatsForTwoVersionsOfExams]

[htSetupForEvaluatingTwoExamVersions] Construct a hypotheses to evaluate whether the observed difference in sample means, $\bar{x}_A - \bar{x}_B=5.3$, is due to chance.[^4.19]

[conditionsForTDistForEvaluatingTwoExamVersions] To evaluate the hypotheses in Guided Practice[htSetupForEvaluatingTwoExamVersions] using the $t$ distribution, we must first verify assumptions. (a) Does it seem reasonable that the scores are independent within each group? (b) What about the normality / skew condition for observations in each group? (c) Do you think scores from the two groups would be independent of each other, i.e. the two samples are independent?[^4.20]

After verifying the conditions for each sample and confirming the samples are independent of each other, we are ready to conduct the test using the $t$ distribution. In this case, we are estimating the true difference in average test scores using the sample data, so the point estimate is $\bar{x}_A - \bar{x}_B = 5.3$. The standard error of the estimate can be calculatedas

$$\begin{aligned}
SE = \sqrt{\frac{s_A^2}{n_A} + \frac{s_B^2}{n_B}} = \sqrt{\frac{14^2}{30} + \frac{20^2}{27}} = 4.62\end{aligned}$$

Finally, we construct the test statistic:

$$\begin{aligned}
T = \frac{\text{point estimate} - \text{null value}}{SE} = \frac{(79.4-74.1) - 0}{4.62} = 1.15\end{aligned}$$

If we have a computer handy, we can identify the degrees of freedom as 45.97. Otherwise we use the smaller of $n_1-1$ and $n_2-1$: $df=26$.

![The $t$ distribution with 26 degrees of freedom. The shaded right tail represents values with $T \geq 1.15$. Because it is a two-sided test, we also shade the corresponding lower tail.](04/figures/pValueOfTwoTailAreaOfExamVersionsWhereDFIs26/pValueOfTwoTailAreaOfExamVersionsWhereDFIs26)

[pValueOfTwoTailAreaOfExamVersionsWhereDFIs26]

<span>Identify the p-value using $df = 26$ and provide a conclusion in the context of the case study.</span> We examine row $df=26$ in the $t$ table. Because this value is smaller than the value in the left column, the p-value is larger than 0.200 (two tails!). Because the p-value is so large, we do not reject the null hypothesis. That is, the data do not convincingly show that one exam version is more difficult than the other, and the teacher should not be convinced that she should add points to the Version B exam scores.

### Summary for inference using the $t$ distribution

**Hypothesis tests.** When applying the $t$ distribution for a hypothesis test, we proceed as follows:

-   Write appropriate hypotheses.

-   Verify conditions for using the $t$ distribution.

    -   One-sample or differences from paired data: the observations (or differences) must be independent and nearly normal. For larger sample sizes, we can relax the nearly normal requirement, e.g. slight skew is okay or sample sizes of 15, moderate skew for sample sizes of 30, and strong skew for sample sizes of 60.

    -   For a difference of means when the data are not paired: each sample mean must separately satisfy the one-sample conditions for the $t$ distribution, and the data in the groups must also be independent.

-   Compute the point estimate of interest, the standard error, and the degrees of freedom. For $df$, use $n-1$ for one sample, and for two samples use either statistical software or the smaller of $n_1 - 1$ and $n_2 - 1$.

-   Compute the T score and p-value.

-   Make a conclusion based on the p-value, and write a conclusion in context and in plain language so anyone can understand the result.

**Confidence intervals.** Similarly, the following is how we generally computed a confidence interval using a $t$ distribution:

-   Verify conditions for using the $t$ distribution. (See above.)

-   Compute the point estimate of interest, the standard error, the degrees of freedom, and $t^{\star}_df$.

-   Calculate the confidence interval using the general formula, point estimate $\pm t_{df}^{\star} SE$.

-   Put the conclusions in context and in plain language so even non-statisticians can understand the results.

### Pooled standard deviation estimate (special topic) {#pooledStandardDeviations}

Occasionally, two populations will have standard deviations that are so similar that they can be treated as identical. For example, historical data or a well-understood biological mechanism may justify this strong assumption. In such cases, we can make the $t$ distribution approach slightly more precise by using a pooled standard deviation.

The **pooled standard deviation** of two groups is a way to use data from both samples to better estimate the standard deviation and standard error. If $s_1^{}$ and $s_2^{}$ are the standard deviations of groups 1 and 2 and there are good reasons to believe that the population standard deviations are equal, then we can obtain an improved estimate of the group variances by pooling their data:

$$\begin{aligned}
s_{pooled}^2 = \frac{s_1^2\times (n_1-1) + s_2^2\times (n_2-1)}{n_1 + n_2 - 2}\end{aligned}$$

where $n_1$ and $n_2$ are the sample sizes, as before. To use this new statistic, we substitute $s_{pooled}^2$ in place of $s_1^2$ and $s_2^2$ in the standard error formula, and we use an updated formula for the degrees of freedom:

$$\begin{aligned}
df = n_1 + n_2 - 2\end{aligned}$$

The benefits of pooling the standard deviation are realized through obtaining a better estimate of the standard deviation for each group and using a larger degrees of freedom parameter for the $t$ distribution. Both of these changes may permit a more accurate model of the sampling distribution of $\bar{x}_1 - \bar{x}_2$.

<span>Pooling standard deviations should be done only after careful research</span> <span>A pooled standard deviation is only appropriate when background research indicates the population standard deviations are nearly equal. When the sample size is large and the condition may be adequately checked with data, the benefits of pooling the standard deviations greatly diminishes.</span>

[^4.1]: See [www.cherryblossom.org](http://www.cherryblossom.org).

[^4.2]: As before, we identify the point estimate, $\bar{x} = 35.05$, and the standard error, $SE = 8.97 / \sqrt{100} = 0.897$. Next, we apply the formula for a 90% confidence interval, which uses $z^{\star} = 1.65$: $35.05 \pm 1.65\times 0.897 \to (33.57, 36.53)$. We are 90% confident that the average age of all participants in the 2012 Cherry Blossom Run is between 33.57 and 36.53 years.

[^4.3]: The standard deviation of the $t$ distribution is actually a little more than 1. However, it is useful to always think of the $t$ distribution as having a standard deviation of 1 in all of our applications.

[^4.4]: We find the shaded area *above* -1.79 (we leave the picture to you). The small left tail is between 0.025 and 0.05, so the larger upper region must have an area between 0.95 and 0.975.

[^4.5]: Taiji was featured in the movie *The Cove*, and it is a significant source of dolphin and whale meat in Japan. Thousands of dolphins pass through the Taiji area annually, and we will assume these 19 dolphins represent a simple random sample from those dolphins. Data reference: Endo T and Haraguchi K. 2009. High mercury levels in hair samples from residents of Taiji, a Japanese whaling town. Marine Pollution Bulletin 60(5):743-747.

[^4.6]: http://www.fda.gov/food/foodborneillnesscontaminants/metals/ucm115644.htm

[^4.7]: There are no obvious outliers; all observations are within 2 standard deviations of the mean. If there is skew, it is not evident. There are no red flags for the normal model based on this (limited) information, and we do not have reason to believe the mercury content is not nearly normal in this type of fish.

[^4.8]: $\bar{x} \ \pm\ t^{\star}_{14} \times SE \ \to\  0.287 \ \pm\  1.76\times 0.0178\ \to\ (0.256, 0.318)$. We are 90% confident that the average mercury content of croaker white fish (Pacific) is between 0.256 and 0.318 ppm.

[^4.9]: $H_0$: The average 10 mile run time was the same for 2006 and 2012. $\mu = 93.29$ minutes. $H_A$: The average 10 mile run time for 2012 was *different* than that of 2006. $\mu \neq 93.29$ minutes.

[^4.10]: With a sample of 100, we should only be concerned if there is extreme skew. The histogram of the data suggest, at worst, slight skew.

[^4.11]: With the conditions satisfied for the $t$ distribution, we can compute the standard error ($SE = 15.78 / \sqrt{100} = 1.58$ and the *T score*: $T = \frac{95.61 - 93.29}{1.58} = 1.47$. (There is more on this after the guided practice, but a T score and Z score are basically the same thing.) For $df = 100 - 1 = 99$, we would find $T = 1.47$ to fall between the first and second column, which means the p-value is between 0.05 and 0.10 (use $df = 90$ and consider two tails since the test is two-sided). Because the p-value is greater than 0.05, we do not reject the null hypothesis. That is, the data do not provide strong evidence that the average run time for the Cherry Blossom Run in 2012 is any different than the 2006 average.

[^4.12]: When a class had multiple books, only the most expensive text was considered.

[^4.13]: Observation 2: $40.59 - 31.14 = 9.45$. Observation 3: $31.68 - 32.00 = -0.32$.

[^4.14]: Conditions have already verified and the standard error computed in Example[htForDiffInUCLAAndAmazonTextbookPrices]. To find the interval, identify $t^{\star}_{72}$ (use $df=70$ in the table, $t^{\star}_{70} = 1.99$) and plug it, the point estimate, and the standard error into the confidence interval formula: $$\text{point estimate} \ \pm\ z^{\star}SE \quad\to\quad 12.76 \ \pm\ 1.99\times 1.67 \quad\to\quad (9.44, 16.08)$$ We are 95% confident that Amazon is, on average, between \$9.44 and \$16.08 cheaper than the UCLA bookstore for UCLA course books.

[^4.15]: This technique for degrees of freedom is conservative with respect to a Type 1 Error; it is more difficult to reject the null hypothesis using this $df$ method. In this example, computer software would have provided us a more precise degrees of freedom of $df = 12.225$.

[^4.16]: (a)The difference in sample means is an appropriate point estimate: $\bar{x}_{n} - \bar{x}_{s} = 0.40$. (b)The standard error of the estimate can be estimated using Equation([seOfDifferenceInMeans]):

    $$\begin{aligned}
    SE = \sqrt{\frac{\sigma_n^2}{n_n} + \frac{\sigma_s^2}{n_s}}
        \approx \sqrt{\frac{s_n^2}{n_n} + \frac{s_s^2}{n_s}}
        = \sqrt{\frac{1.60^2}{100} + \frac{1.43^2}{50}}
        = 0.26\end{aligned}$$

[^4.17]: Absolutely not. It is possible that there is some difference but we did not detect it. If there is a difference, we made a Type 2 Error. Notice: we also dont have enough information to, if there is an actual difference difference, confidently say which direction that difference would be in.

[^4.18]: We could have collected more data. If the sample sizes are larger, we tend to have a better shot at finding a difference if one exists.

[^4.19]: Because the teacher did not expect one exam to be more difficult prior to examining the test results, she should use a two-sided hypothesis test. $H_0$: the exams are equally difficult, on average. $\mu_A - \mu_B = 0$. $H_A$: one exam was more difficult than the other, on average. $\mu_A - \mu_B \neq 0$.

[^4.20]: \(a) It is probably reasonable to conclude the scores are independent, provided there was no cheating. (b) The summary statistics suggest the data are roughly symmetric about the mean, and it doesnt seem unreasonable to suggest the data might be normal. Note that since these samples are each nearing 30, moderate skew in the data would be acceptable. (c) It seems reasonable to suppose that the samples are independent since the exams were handed out randomly.

-->

