[
["index.html", "Answering questions with data Preface 0.1 Important notes", " Answering questions with data Matthew J. C. Crump Anjali Krishnan Stephen Volz Alla Chavarga Jeffrey Suzuki 2018-07-16 Preface Draft in progress 0.1 Important notes This is a working revision of the OER statistics textbook titled: Introductory Statistics with Randomization and Simulation, by Diaz, Barr, &amp; Cetinkaya-Rundel. The original source latex files were obtained from : https://www.openintro.org/stat/textbook.php?stat_book=isrs The original textbook is licensed under a Creative Commons license. The original latex were converted to Markdown using pandoc. Some minimal typesetting was completed on the first chapter. The plan is to use this textbook as a starting point for developing another OER textbook for tailored for undergraduate psychology students. The Github changelog from this point forward reflects all of our changes to the original textbook. The github repository for this project is https://github.com/CrumpLab/statistics Contributing to the textbook Use Hypothes.is, an amazing tool for annotating the web. Go to Hypothes.is, and “get-started” Install the the add-on for chrome, or other browser That’s it, turn on Hypothes.is when you are reading this textbook, and you will see all public annotations made by anyone else. The source code for this textbook is available in my github repo statsforpsych Edit the .Rmd files, and push them back The edit link in the top bar of the textbook should automatically take you to the source .Rmd file "],
["why-statistics.html", "Chapter 1 Why Statistics? 1.1 On the psychology of statistics 1.2 The cautionary tale of Simpson’s paradox 1.3 Statistics in psychology 1.4 Statistics in everyday life 1.5 There’s more to research methods than statistics 1.6 A brief introduction to research design[ch:studydesign]", " Chapter 1 Why Statistics? To call in statisticians after the experiment is done may be no more than asking them to perform a post-mortem examination: They may be able to say what the experiment died of. —Sir Ronald Fisher 1.1 On the psychology of statistics Adapted nearly verbatim from Chapters 1 and 2 in Navarro, D. “Learning Statistics with R.” https://compcogscisydney.org/learning-statistics-with-r/ To the surprise of many students, statistics is a fairly significant part of a psychological education. To the surprise of no-one, statistics is very rarely the favourite part of one’s psychological education. After all, if you really loved the idea of doing statistics, you’d probably be enrolled in a statistics class right now, not a psychology class. So, not surprisingly, there’s a pretty large proportion of the student base that isn’t happy about the fact that psychology has so much statistics in it. In view of this, I thought that the right place to start might be to answer some of the more common questions that people have about stats… A big part of this issue at hand relates to the very idea of statistics. What is it? What’s it there for? And why are scientists so bloody obsessed with it? These are all good questions, when you think about it. So let’s start with the last one. As a group, scientists seem to be bizarrely fixated on running statistical tests on everything. In fact, we use statistics so often that we sometimes forget to explain to people why we do. It’s a kind of article of faith among scientists – and especially social scientists – that your findings can’t be trusted until you’ve done some stats. Undergraduate students might be forgiven for thinking that we’re all completely mad, because no-one takes the time to answer one very simple question: Why do you do statistics? Why don’t scientists just use ? It’s a naive question in some ways, but most good questions are. There’s a lot of good answers to it, but for my money, the best answer is a really simple one: we don’t trust ourselves enough. We worry that we’re human, and susceptible to all of the biases, temptations and frailties that humans suffer from. Much of statistics is basically a safeguard. Using “common sense” to evaluate evidence means trusting gut instincts, relying on verbal arguments and on using the raw power of human reason to come up with the right answer. Most scientists don’t think this approach is likely to work. In fact, come to think of it, this sounds a lot like a psychological question to me, and since I do work in a psychology department, it seems like a good idea to dig a little deeper here. Is it really plausible to think that this “common sense” approach is very trustworthy? Verbal arguments have to be constructed in language, and all languages have biases – some things are harder to say than others, and not necessarily because they’re false (e.g., quantum electrodynamics is a good theory, but hard to explain in words). The instincts of our “gut” aren’t designed to solve scientific problems, they’re designed to handle day to day inferences – and given that biological evolution is slower than cultural change, we should say that they’re designed to solve the day to day problems for a different world than the one we live in. Most fundamentally, reasoning sensibly requires people to engage in “induction”, making wise guesses and going beyond the immediate evidence of the senses to make generalisations about the world. If you think that you can do that without being influenced by various distractors, well, I have a bridge in Brooklyn I’d like to sell you. Heck, as the next section shows, we can’t even solve “deductive” problems (ones where no guessing is required) without being influenced by our pre-existing biases. 1.1.1 The curse of belief bias People are mostly pretty smart. We’re certainly smarter than the other species that we share the planet with (though many people might disagree). Our minds are quite amazing things, and we seem to be capable of the most incredible feats of thought and reason. That doesn’t make us perfect though. And among the many things that psychologists have shown over the years is that we really do find it hard to be neutral, to evaluate evidence impartially and without being swayed by pre-existing biases. A good example of this is the belief bias effect in logical reasoning: if you ask people to decide whether a particular argument is logically valid (i.e., conclusion would be true if the premises were true), we tend to be influenced by the believability of the conclusion, even when we shouldn’t. For instance, here’s a valid argument where the conclusion is believable: No cigarettes are inexpensive (Premise 1) Some addictive things are inexpensive (Premise 2) Therefore, some addictive things are not cigarettes (Conclusion) And here’s a valid argument where the conclusion is not believable: No addictive things are inexpensive (Premise 1) Some cigarettes are inexpensive (Premise 2) Therefore, some cigarettes are not addictive (Conclusion) The logical structure of argument #2 is identical to the structure of argument #1, and they’re both valid. However, in the second argument, there are good reasons to think that premise 1 is incorrect, and as a result it’s probably the case that the conclusion is also incorrect. But that’s entirely irrelevant to the topic at hand: an argument is deductively valid if the conclusion is a logical consequence of the premises. That is, a valid argument doesn’t have to involve true statements. On the other hand, here’s an invalid argument that has a believable conclusion: No addictive things are inexpensive (Premise 1) Some cigarettes are inexpensive (Premise 2) Therefore, some addictive things are not cigarettes (Conclusion) And finally, an invalid argument with an unbelievable conclusion: No cigarettes are inexpensive (Premise 1) Some addictive things are inexpensive (Premise 2) Therefore, some cigarettes are not addictive (Conclusion) Now, suppose that people really are perfectly able to set aside their pre-existing biases about what is true and what isn’t, and purely evaluate an argument on its logical merits. We’d expect 100% of people to say that the valid arguments are valid, and 0% of people to say that the invalid arguments are valid. So if you ran an experiment looking at this, you’d expect to see data like this: argument is valid 100% say “valid” 100% say “valid” argument is invalid 0% say “valid” 0% say “valid” If the psychological data looked like this (or even a good approximation to this), we might feel safe in just trusting our gut instincts. That is, it’d be perfectly okay just to let scientists evaluate data based on their common sense, and not bother with all this murky statistics stuff. However, you guys have taken psych classes, and by now you probably know where this is going. In a classic study, ran an experiment looking at exactly this. What they found is that when pre-existing biases (i.e., beliefs) were in agreement with the structure of the data, everything went the way you’d hope: argument is valid 92% say “valid” – argument is invalid – 8% say “valid” Not perfect, but that’s pretty good. But look what happens when our intuitive feelings about the truth of the conclusion run against the logical structure of the argument: argument is valid 92% say “valid” 46% say “valid” argument is invalid 92% say “valid” 8% say “valid” Oh dear, that’s not as good. Apparently, when people are presented with a strong argument that contradicts our pre-existing beliefs, we find it pretty hard to even perceive it to be a strong argument (people only did so 46% of the time). Even worse, when people are presented with a weak argument that agrees with our pre-existing biases, almost no-one can see that the argument is weak (people got that one wrong 92% of the time!) If you think about it, it’s not as if these data are horribly damning. Overall, people did do better than chance at compensating for their prior biases, since about 60% of people’s judgements were correct (you’d expect 50% by chance). Even so, if you were a professional “evaluator of evidence”, and someone came along and offered you a magic tool that improves your chances of making the right decision from 60% to (say) 95%, you’d probably jump at it, right? Of course you would. Thankfully, we actually do have a tool that can do this. But it’s not magic, it’s statistics. So that’s reason #1 why scientists love statistics. It’s just too easy for us to “believe what we want to believe”; so if we want to “believe in the data” instead, we’re going to need a bit of help to keep our personal biases under control. That’s what statistics does: it helps keep us honest. 1.2 The cautionary tale of Simpson’s paradox The following is a true story (I think…). In 1973, the University of California, Berkeley had some worries about the admissions of students into their postgraduate courses. Specifically, the thing that caused the problem was that the gender breakdown of their admissions, which looked like this: Number of applicants Percent admitted Males 8442 44% Females 4321 35% and they were worried about being sued. Given that there were nearly 13,000 applicants, a difference of 9% in admission rates between males and females is just way too big to be a coincidence. Pretty compelling data, right? And if I were to say to you that these data actually reflect a weak bias in favour of women (sort of!), you’d probably think that I was either crazy or sexist. Earlier versions of these notes incorrectly suggested that they actually were sued – apparently that’s not true. There’s a nice commentary on this here: https://www.refsmmat.com/posts/2016-05-08-simpsons-paradox-berkeley.html. A big thank you to Wilfried Van Hirtum for pointing this out to me! When people started looking more carefully at the admissions data Bickel, Hammel, and O’Connell (1975) they told a rather different story. Specifically, when they looked at it on a department by department basis, it turned out that most of the departments actually had a slightly higher success rate for female applicants than for male applicants. The table below shows the admission figures for the six largest departments (with the names of the departments removed for privacy reasons): Department Applicants Percent admitted Applicants Percent admitted A 825 62% 108 82% B 560 63% 25 68% C 325 37% 593 34% D 417 33% 375 35% E 191 28% 393 24% F 272 6% 341 7% ———— ———— —————— ———— —————— Remarkably, most departments had a higher rate of admissions for females than for males! Yet the overall rate of admission across the university for females was lower than for males. How can this be? How can both of these statements be true at the same time? Here’s what’s going on. Firstly, notice that the departments are not equal to one another in terms of their admission percentages: some departments (e.g., engineering, chemistry) tended to admit a high percentage of the qualified applicants, whereas others (e.g., English) tended to reject most of the candidates, even if they were high quality. So, among the six departments shown above, notice that department A is the most generous, followed by B, C, D, E and F in that order. Next, notice that males and females tended to apply to different departments. If we rank the departments in terms of the total number of male applicants, we get A\\(&gt;\\)B\\(&gt;\\)D\\(&gt;\\)C\\(&gt;\\)F\\(&gt;\\)E (the “easy” departments are in bold). On the whole, males tended to apply to the departments that had high admission rates. Now compare this to how the female applicants distributed themselves. Ranking the departments in terms of the total number of female applicants produces a quite different ordering C\\(&gt;\\)E\\(&gt;\\)D\\(&gt;\\)F\\(&gt;\\)A\\(&gt;\\)B. In other words, what these data seem to be suggesting is that the female applicants tended to apply to “harder” departments. And in fact, if we look at all Figure [fig:berkeley] we see that this trend is systematic, and quite striking. This effect is known as Simpson’s paradox. It’s not common, but it does happen in real life, and most people are very surprised by it when they first encounter it, and many people refuse to even believe that it’s real. It is very real. And while there are lots of very subtle statistical lessons buried in there, I want to use it to make a much more important point …doing research is hard, and there are lots of subtle, counterintuitive traps lying in wait for the unwary. That’s reason #2 why scientists love statistics, and why we teach research methods. Because science is hard, and the truth is sometimes cunningly hidden in the nooks and crannies of complicated data. [fig:berkeley] Before leaving this topic entirely, I want to point out something else really critical that is often overlooked in a research methods class. Statistics only solves partof the problem. Remember that we started all this with the concern that Berkeley’s admissions processes might be unfairly biased against female applicants. When we looked at the “aggregated” data, it did seem like the university was discriminating against women, but when we “disaggregate” and looked at the individual behaviour of all the departments, it turned out that the actual departments were, if anything, slightly biased in favour of women. The gender bias in total admissions was caused by the fact that women tended to self-select for harder departments. From a legal perspective, that would probably put the university in the clear. Postgraduate admissions are determined at the level of the individual department (and there are good reasons to do that), and at the level of individual departments, the decisions are more or less unbiased (the weak bias in favour of females at that level is small, and not consistent across departments). Since the university can’t dictate which departments people choose to apply to, and the decision making takes place at the level of the department it can hardly be held accountable for any biases that those choices produce. That was the basis for my somewhat glib remarks earlier, but that’s not exactly the whole story, is it? After all, if we’re interested in this from a more sociological and psychological perspective, we might want to ask why there are such strong gender differences in applications. Why do males tend to apply to engineering more often than females, and why is this reversed for the English department? And why is it it the case that the departments that tend to have a female-application bias tend to have lower overall admission rates than those departments that have a male-application bias? Might this not still reflect a gender bias, even though every single department is itself unbiased? It might. Suppose, hypothetically, that males preferred to apply to “hard sciences” and females prefer “humanities”. And suppose further that the reason for why the humanities departments have low admission rates is because the government doesn’t want to fund the humanities (Ph.D. places, for instance, are often tied to government funded research projects). Does that constitute a gender bias? Or just an unenlightened view of the value of the humanities? What if someone at a high level in the government cut the humanities funds because they felt that the humanities are “useless chick stuff”. That seems pretty blatantly gender biased. None of this falls within the purview of statistics, but it matters to the research project. If you’re interested in the overall structural effects of subtle gender biases, then you probably want to look at both the aggregated and disaggregated data. If you’re interested in the decision making process at Berkeley itself then you’re probably only interested in the disaggregated data. In short there are a lot of critical questions that you can’t answer with statistics, but the answers to those questions will have a huge impact on how you analyse and interpret data. And this is the reason why you should always think of statistics as a tool to help you learn about your data, no more and no less. It’s a powerful tool to that end, but there’s no substitute for careful thought. 1.3 Statistics in psychology I hope that the discussion above helped explain why science in general is so focused on statistics. But I’m guessing that you have a lot more questions about what role statistics plays in psychology, and specifically why psychology classes always devote so many lectures to stats. So here’s my attempt to answer a few of them… Why does psychology have so much statistics? To be perfectly honest, there’s a few different reasons, some of which are better than others. The most important reason is that psychology is a statistical science. What I mean by that is that the “things” that we study are people. Real, complicated, gloriously messy, infuriatingly perverse people. The “things” of physics include objects like electrons, and while there are all sorts of complexities that arise in physics, electrons don’t have minds of their own. They don’t have opinions, they don’t differ from each other in weird and arbitrary ways, they don’t get bored in the middle of an experiment, and they don’t get angry at the experimenter and then deliberately try to sabotage the data set. At a fundamental level psychology is harder than physics. Basically, we teach statistics to you as psychologists because you need to be better at stats than physicists. There’s actually a saying used sometimes in physics, to the effect that “if your experiment needs statistics, you should have done a better experiment”. They have the luxury of being able to say that because their objects of study are pathetically simple in comparison to the vast mess that confronts social scientists. It’s not just psychology, really: most social sciences are desperately reliant on statistics. Not because we’re bad experimenters, but because we’ve picked a harder problem to solve. We teach you stats because you really, really need it. Can’t someone else do the statistics? To some extent, but not completely. It’s true that you don’t need to become a fully trained statistician just to do psychology, but you do need to reach a certain level of statistical competence. In my view, there’s three reasons that every psychological researcher ought to be able to do basic statistics: There’s the fundamental reason: statistics is deeply intertwined with research design. If you want to be good at designing psychological studies, you need to at least understand the basics of stats. If you want to be good at the psychological side of the research, then you need to be able to understand the psychological literature, right? But almost every paper in the psychological literature reports the results of statistical analyses. So if you really want to understand the psychology, you need to be able to understand what other people did with their data. And that means understanding a certain amount of statistics. There’s a big practical problem with being dependent on other people to do all your statistics: statistical analysis is expensive. In almost any real life situation where you want to do psychological research, the cruel facts will be that you don’t have enough money to afford a statistician. So the economics of the situation mean that you have to be pretty self-sufficient. Note that a lot of these reasons generalise beyond researchers. If you want to be a practicing psychologist and stay on top of the field, it helps to be able to read the scientific literature, which relies pretty heavily on statistics. I don’t care about jobs, research, or clinical work. Do I need statistics? Okay, now you’re just messing with me. Still, I think it should matter to you too. Statistics should matter to you in the same way that statistics should matter to everyone: we live in the 21st century, and data are everywhere. Frankly, given the world in which we live these days, a basic knowledge of statistics is pretty damn close to a survival tool! Which is the topic of the next section… 1.4 Statistics in everyday life “We are drowning in information, but we are starved for knowledge” – Various authors, original probably John Naisbitt When I started writing up my lecture notes I took the 20 most recent news articles posted to the ABC news website. Of those 20 articles, it turned out that 8 of them involved a discussion of something that I would call a statistical topic; 6 of those made a mistake. The most common error, if you’re curious, was failing to report baseline data (e.g., the article mentions that 5% of people in situation X have some characteristic Y, but doesn’t say how common the characteristic is for everyone else!) The point I’m trying to make here isn’t that journalists are bad at statistics (though they almost always are), it’s that a basic knowledge of statistics is very helpful for trying to figure out when someone else is either making a mistake or even lying to you. Perhaps, one of the biggest things that a knowledge of statistics does to you is cause you to get angry at the newspaper or the internet on a far more frequent basis :). 1.5 There’s more to research methods than statistics So far, most of what I’ve talked about is statistics, and so you’d be forgiven for thinking that statistics is all I care about in life. To be fair, you wouldn’t be far wrong, but research methodology is a broader concept than statistics. So most research methods courses will cover a lot of topics that relate much more to the pragmatics of research design, and in particular the issues that you encounter when trying to do research with humans. However, about 99% of student fears relate to the statistics part of the course, so I’ve focused on the stats in this discussion, and hopefully I’ve convinced you that statistics matters, and more importantly, that it’s not to be feared. That being said, it’s pretty typical for introductory research methods classes to be very stats-heavy. This is not (usually) because the lecturers are evil people. Quite the contrary, in fact. Introductory classes focus a lot on the statistics because you almost always find yourself needing statistics before you need the other research methods training. Why? Because almost all of your assignments in other classes will rely on statistical training, to a much greater extent than they rely on other methodological tools. It’s not common for undergraduate assignments to require you to design your own study from the ground up (in which case you would need to know a lot about research design), but it is common for assignments to ask you to analyse and interpret data that were collected in a study that someone else designed (in which case you need statistics). In that sense, from the perspective of allowing you to do well in all your other classes, the statistics is more urgent. But note that “urgent” is different from “important” – they both matter. I really do want to stress that research design is just as important as data analysis, and this book does spend a fair amount of time on it. However, while statistics has a kind of universality, and provides a set of core tools that are useful for most types of psychological research, the research methods side isn’t quite so universal. There are some general principles that everyone should think about, but a lot of research design is very idiosyncratic, and is specific to the area of research that you want to engage in. To the extent that it’s the details that matter, those details don’t usually show up in an introductory stats and research methods class. 1.6 A brief introduction to research design[ch:studydesign] To consult the statistician after an experiment is finished is often merely to ask him to conduct a post mortem examination. He can perhaps say what the experiment died of. – Sir Ronald Fisher In this chapter, we’re going to start thinking about the basic ideas that go into designing a study, collecting data, checking whether your data collection works, and so on. It won’t give you enough information to allow you to design studies of your own, but it will give you a lot of the basic tools that you need to assess the studies done by other people. However, since the focus of this book is much more on data analysis than on data collection, I’m only giving a very brief overview. Note that this chapter is “special” in two ways. Firstly, it’s much more psychology-specific than the later chapters. Secondly, it focuses much more heavily on the scientific problem of research methodology, and much less on the statistical problem of data analysis. Nevertheless, the two problems are related to one another, so it’s traditional for stats textbooks to discuss the problem in a little detail. This chapter relies heavily on for the discussion of study design, and for the discussion of scales of measurement. Later versions will attempt to be more precise in the citations. 1.6.1 Introduction to psychological measurement [sec:measurement] The first thing to understand is data collection can be thought of as a kind of measurement. That is, what we’re trying to do here is measure something about human behaviour or the human mind. What do I mean by “measurement”? 1.6.1.1 Some thoughts about psychological measurement Measurement itself is a subtle concept, but basically it comes down to finding some way of assigning numbers, or labels, or some other kind of well-defined descriptions to “stuff”. So, any of the following would count as a psychological measurement: My age is 33 years. I do not like anchovies. My chromosomal gender is male. My self-identified gender is male.1 In the short list above, the bolded part is “the thing to be measured”, and the italicised part is “the measurement itself”. In fact, we can expand on this a little bit, by thinking about the set of possible measurements that could have arisen in each case: My age (in years) could have been 0, 1, 2, 3 …, etc. The upper bound on what my age could possibly be is a bit fuzzy, but in practice you’d be safe in saying that the largest possible age is 150, since no human has ever lived that long. When asked if I like anchovies, I might have said that I do, or I do not, or I have no opinion, or I sometimes do. My chromosomal gender is almost certainly going to be male (XY) or female (XX), but there are a few other possibilities. I could also have Klinfelter’s syndrome (XXY), which is more similar to male than to female. And I imagine there are other possibilities too. My self-identified gender is also very likely to be male or female, but it doesn’t have to agree with my chromosomal gender. I may also choose to identify with neither, or to explicitly call myself transgender. As you can see, for some things (like age) it seems fairly obvious what the set of possible measurements should be, whereas for other things it gets a bit tricky. But I want to point out that even in the case of someone’s age, it’s much more subtle than this. For instance, in the example above, I assumed that it was okay to measure age in years. But if you’re a developmental psychologist, that’s way too crude, and so you often measure age in years and months (if a child is 2 years and 11 months, this is usually written as “2;11”). If you’re interested in newborns, you might want to measure age in days since birth, maybe even hours since birth. In other words, the way in which you specify the allowable measurement values is important. Looking at this a bit more closely, you might also realise that the concept of “age” isn’t actually all that precise. In general, when we say “age” we implicitly mean “the length of time since birth”. But that’s not always the right way to do it. Suppose you’re interested in how newborn babies control their eye movements. If you’re interested in kids that young, you might also start to worry that “birth” is not the only meaningful point in time to care about. If Baby Alice is born 3 weeks premature and Baby Bianca is born 1 week late, would it really make sense to say that they are the “same age” if we encountered them “2 hours after birth”? In one sense, yes: by social convention, we use birth as our reference point for talking about age in everyday life, since it defines the amount of time the person has been operating as an independent entity in the world, but from a scientific perspective that’s not the only thing we care about. When we think about the biology of human beings, it’s often useful to think of ourselves as organisms that have been growing and maturing since conception, and from that perspective Alice and Bianca aren’t the same age at all. So you might want to define the concept of “age” in two different ways: the length of time since conception, and the length of time since birth. When dealing with adults, it won’t make much difference, but when dealing with newborns it might. Moving beyond these issues, there’s the question of methodology. What specific “measurement method” are you going to use to find out someone’s age? As before, there are lots of different possibilities: You could just ask people “how old are you?” The method of self-report is fast, cheap and easy, but it only works with people old enough to understand the question, and some people lie about their age. You could ask an authority (e.g., a parent) “how old is your child?” This method is fast, and when dealing with kids it’s not all that hard since the parent is almost always around. It doesn’t work as well if you want to know “age since conception”, since a lot of parents can’t say for sure when conception took place. For that, you might need a different authority (e.g., an obstetrician). You could look up official records, like birth certificates. This is time consuming and annoying, but it has its uses (e.g., if the person is now dead). 1.6.1.2 Operationalisation: defining your measurement All of the ideas discussed in the previous section all relate to the concept of operationalisation. To be a bit more precise about the idea, operationalisation is the process by which we take a meaningful but somewhat vague concept, and turn it into a precise measurement. The process of operationalisation can involve several different things: Being precise about what you are trying to measure. For instance, does “age” mean “time since birth” or “time since conception” in the context of your research? Determining what method you will use to measure it. Will you use self-report to measure age, ask a parent, or look up an official record? If you’re using self-report, how will you phrase the question? Defining the set of the allowable values that the measurement can take. Note that these values don’t always have to be numerical, though they often are. When measuring age, the values are numerical, but we still need to think carefully about what numbers are allowed. Do we want age in years, years and months, days, hours? Etc. For other types of measurements (e.g., gender), the values aren’t numerical. But, just as before, we need to think about what values are allowed. If we’re asking people to self-report their gender, what options to we allow them to choose between? Is it enough to allow only “male” or “female”? Do you need an “other” option? Or should we not give people any specific options, and let them answer in their own words? And if you open up the set of possible values to include all verbal response, how will you interpret their answers? Operationalisation is a tricky business, and there’s no “one, true way” to do it. The way in which you choose to operationalise the informal concept of “age” or “gender” into a formal measurement depends on what you need to use the measurement for. Often you’ll find that the community of scientists who work in your area have some fairly well-established ideas for how to go about it. In other words, operationalisation needs to be thought through on a case by case basis. Nevertheless, while there a lot of issues that are specific to each individual research project, there are some aspects to it that are pretty general. Before moving on, I want to take a moment to clear up our terminology, and in the process introduce one more term. Here are four different things that are closely related to each other: A theoretical construct. This is the thing that you’re trying to take a measurement of, like “age”, “gender” or an “opinion”. A theoretical construct can’t be directly observed, and often they’re actually a bit vague. A measure. The measure refers to the method or the tool that you use to make your observations. A question in a survey, a behavioural observation or a brain scan could all count as a measure. An operationalisation. The term “operationalisation” refers to the logical connection between the measure and the theoretical construct, or to the process by which we try to derive a measure from a theoretical construct. A variable. Finally, a new term. A variable is what we end up with when we apply our measure to something in the world. That is, variables are the actual “data” that we end up with in our data sets. In practice, even scientists tend to blur the distinction between these things, but it’s very helpful to try to understand the differences. 1.6.2 Scales of measurement[sec:scales] As the previous section indicates, the outcome of a psychological measurement is called a variable. But not all variables are of the same qualitative type, and it’s very useful to understand what types there are. A very useful concept for distinguishing between different types of variables is what’s known as scales of measurement. 1.6.2.1 Nominal scale A nominal scale variable (also referred to as a categorical variable) is one in which there is no particular relationship between the different possibilities: for these kinds of variables it doesn’t make any sense to say that one of them is ``bigger’ or “better” than any other one, and it absolutely doesn’t make any sense to average them. The classic example for this is “eye colour”. Eyes can be blue, green and brown, among other possibilities, but none of them is any “better” than any other one. As a result, it would feel really weird to talk about an “average eye colour”. Similarly, gender is nominal too: male isn’t better or worse than female, neither does it make sense to try to talk about an “average gender”. In short, nominal scale variables are those for which the only thing you can say about the different possibilities is that they are different. That’s it. Let’s take a slightly closer look at this. Suppose I was doing research on how people commute to and from work. One variable I would have to measure would be what kind of transportation people use to get to work. This “transport type” variable could have quite a few possible values, including: “train”, “bus”, “car”, “bicycle”, etc. For now, let’s suppose that these four are the only possibilities, and suppose that when I ask 100 people how they got to work today, and I get this: Transportation Number of people (1) Train 12 (2) Bus 30 (3) Car 48 (4) Bicycle 10 So, what’s the average transportation type? Obviously, the answer here is that there isn’t one. It’s a silly question to ask. You can say that travel by car is the most popular method, and travel by train is the least popular method, but that’s about all. Similarly, notice that the order in which I list the options isn’t very interesting. I could have chosen to display the data like this Transportation Number of people (3) Car 48 (1) Train 12 (4) Bicycle 10 (2) Bus 30 and nothing really changes. 1.6.2.2 Ordinal scale Ordinal scale variables have a bit more structure than nominal scale variables, but not by a lot. An ordinal scale variable is one in which there is a natural, meaningful way to order the different possibilities, but you can’t do anything else. The usual example given of an ordinal variable is “finishing position in a race”. You can say that the person who finished first was faster than the person who finished second, but you don’t know how much faster. As a consequence we know that 1st \\(&gt;\\) 2nd, and we know that 2nd \\(&gt;\\) 3rd, but the difference between 1st and 2nd might be much larger than the difference between 2nd and 3rd. Here’s an more psychologically interesting example. Suppose I’m interested in people’s attitudes to climate change, and I ask them to pick one of these four statements that most closely matches their beliefs: Temperatures are rising, because of human activity Temperatures are rising, but we don’t know why Temperatures are rising, but not because of humans Temperatures are not rising Notice that these four statements actually do have a natural ordering, in terms of “the extent to which they agree with the current science”. Statement 1 is a close match, statement 2 is a reasonable match, statement 3 isn’t a very good match, and statement 4 is in strong opposition to the science. So, in terms of the thing I’m interested in (the extent to which people endorse the science), I can order the items as \\(1 &gt; 2 &gt; 3 &gt; 4\\). Since this ordering exists, it would be very weird to list the options like this… Temperatures are rising, but not because of humans Temperatures are rising, because of human activity Temperatures are not rising Temperatures are rising, but we don’t know why …because it seems to violate the natural “structure” to the question. So, let’s suppose I asked 100 people these questions, and got the following answers: Number (1) Temperatures are rising, because of human activity 51 (2) Temperatures are rising, but we don’t know why 20 (3) Temperatures are rising, but not because of humans 10 (4) Temperatures are not rising 19 When analysing these data, it seems quite reasonable to try to group (1), (2) and (3) together, and say that 81 of 100 people were willing to at least partially endorse the science. And it’s also quite reasonable to group (2), (3) and (4) together and say that 49 of 100 people registered at least some disagreement with the dominant scientific view. However, it would be entirely bizarre to try to group (1), (2) and (4) together and say that 90 of 100 people said…what? There’s nothing sensible that allows you to group those responses together at all. That said, notice that while we can use the natural ordering of these items to construct sensible groupings, what we can’t do is average them. For instance, in my simple example here, the “average” response to the question is 1.97. If you can tell me what that means, I’d love to know. Because that sounds like gibberish to me! 1.6.2.3 Interval scale In contrast to nominal and ordinal scale variables, interval scale and ratio scale variables are variables for which the numerical value is genuinely meaningful. In the case of interval scale variables, the differences between the numbers are interpretable, but the variable doesn’t have a “natural” zero value. A good example of an interval scale variable is measuring temperature in degrees celsius. For instance, if it was 15\\(^\\circ\\) yesterday and 18\\(^\\circ\\) today, then the 3\\(^\\circ\\) difference between the two is genuinely meaningful. Moreover, that 3\\(^\\circ\\) difference is exactly the same as the 3\\(^\\circ\\) difference between \\(7^\\circ\\) and \\(10^\\circ\\). In short, addition and subtraction are meaningful for interval scale variables. However, notice that the \\(0^\\circ\\) does not mean “no temperature at all”: it actually means “the temperature at which water freezes”, which is pretty arbitrary. As a consequence, it becomes pointless to try to multiply and divide temperatures. It is wrong to say that \\(20^\\circ\\) is twice as hot as \\(10^\\circ\\), just as it is weird and meaningless to try to claim that \\(20^\\circ\\) is negative two times as hot as \\(-10^\\circ\\). Again, lets look at a more psychological example. Suppose I’m interested in looking at how the attitudes of first-year university students have changed over time. Obviously, I’m going to want to record the year in which each student started. This is an interval scale variable. A student who started in 2003 did arrive 5 years before a student who started in 2008. However, it would be completely insane for me to divide 2008 by 2003 and say that the second student started “1.0024 times later” than the first one. That doesn’t make any sense at all. 1.6.2.4 Ratio scale The fourth and final type of variable to consider is a ratio scale variable, in which zero really means zero, and it’s okay to multiply and divide. A good psychological example of a ratio scale variable is response time (RT). In a lot of tasks it’s very common to record the amount of time somebody takes to solve a problem or answer a question, because it’s an indicator of how difficult the task is. Suppose that Alan takes 2.3 seconds to respond to a question, whereas Ben takes 3.1 seconds. As with an interval scale variable, addition and subtraction are both meaningful here. Ben really did take \\(3.1 - 2.3 = 0.8\\) seconds longer than Alan did. However, notice that multiplication and division also make sense here too: Ben took \\(3.1 / 2.3 = 1.35\\) times as long as Alan did to answer the question. And the reason why you can do this is that, for a ratio scale variable such as RT, “zero seconds” really does mean “no time at all”. 1.6.2.5 Continuous versus discrete variables [sec:continuousdiscrete] There’s a second kind of distinction that you need to be aware of, regarding what types of variables you can run into. This is the distinction between continuous variables and discrete variables. The difference between these is as follows: A continuous variable is one in which, for any two values that you can think of, it’s always logically possible to have another value in between. A discrete variable is, in effect, a variable that isn’t continuous. For a discrete variable, it’s sometimes the case that there’s nothing in the middle. These definitions probably seem a bit abstract, but they’re pretty simple once you see some examples. For instance, response time is continuous. If Alan takes 3.1 seconds and Ben takes 2.3 seconds to respond to a question, then it’s possible for Cameron’s response time to lie in between, by taking 3.0 seconds. And of course it would also be possible for David to take 3.031 seconds to respond, meaning that his RT would lie in between Cameron’s and Alan’s. And while in practice it might be impossible to measure RT that precisely, it’s certainly possible in principle. Because we can always find a new value for RT in between any two other ones, we say that RT is continuous. Discrete variables occur when this rule is violated. For example, nominal scale variables are always discrete: there isn’t a type of transportation that falls “in between” trains and bicycles, not in the strict mathematical way that 2.3 falls in between 2 and 3. So transportation type is discrete. Similarly, ordinal scale variables are always discrete: although “2nd place” does fall between “1st place” and “3rd place”, there’s nothing that can logically fall in between “1st place” and “2nd place”. Interval scale and ratio scale variables can go either way. As we saw above, response time (a ratio scale variable) is continuous. Temperature in degrees celsius (an interval scale variable) is also continuous. However, the year you went to school (an interval scale variable) is discrete. There’s no year in between 2002 and 2003. The number of questions you get right on a true-or-false test (a ratio scale variable) is also discrete: since a true-or-false question doesn’t allow you to be “partially correct”, there’s nothing in between 5/10 and 6/10. Table [tab:scalescont] summarises the relationship between the scales of measurement and the discrete/continuity distinction. Cells with a tick mark correspond to things that are possible. I’m trying to hammer this point home, because (a) some textbooks get this wrong, and (b) people very often say things like “discrete variable” when they mean “nominal scale variable”. It’s very unfortunate. [tab:scalescont] The relationship between the scales of measurement and the discrete/continuity distinction. Cells with a tick mark correspond to things that are possible. continuous discrete nominal ordinal interval ratio 1.6.2.6 Some complexities Okay, I know you’re going to be shocked to hear this, but …the real world is much messier than this little classification scheme suggests. Very few variables in real life actually fall into these nice neat categories, so you need to be kind of careful not to treat the scales of measurement as if they were hard and fast rules. It doesn’t work like that: they’re guidelines, intended to help you think about the situations in which you should treat different variables differently. Nothing more. So let’s take a classic example, maybe the classic example, of a psychological measurement tool: the Likert scale. The humble Likert scale is the bread and butter tool of all survey design. You yourself have filled out hundreds, maybe thousands of them, and odds are you’ve even used one yourself. Suppose we have a survey question that looks like this: Which of the following best describes your opinion of the statement that “all pirates are freaking awesome” … and then the options presented to the participant are these: (1) Strongly disagree (2) Disagree (3) Neither agree nor disagree (4) Agree (5) Strongly agree This set of items is an example of a 5-point Likert scale: people are asked to choose among one of several (in this case 5) clearly ordered possibilities, generally with a verbal descriptor given in each case. However, it’s not necessary that all items be explicitly described. This is a perfectly good example of a 5-point Likert scale too: (1) Strongly disagree (2) (3) (4) (5) Strongly agree Likert scales are very handy, if somewhat limited, tools. The question is, what kind of variable are they? They’re obviously discrete, since you can’t give a response of 2.5. They’re obviously not nominal scale, since the items are ordered; and they’re not ratio scale either, since there’s no natural zero. But are they ordinal scale or interval scale? One argument says that we can’t really prove that the difference between “strongly agree” and “agree” is of the same size as the difference between “agree” and “neither agree nor disagree”. In fact, in everyday life it’s pretty obvious that they’re not the same at all. So this suggests that we ought to treat Likert scales as ordinal variables. On the other hand, in practice most participants do seem to take the whole “on a scale from 1 to 5” part fairly seriously, and they tend to act as if the differences between the five response options were fairly similar to one another. As a consequence, a lot of researchers treat Likert scale data as if it were interval scale. It’s not interval scale, but in practice it’s close enough that we usually think of it as being quasi-interval scale. 1.6.3 Assessing the reliability of a measurement [sec:reliability] At this point we’ve thought a little bit about how to operationalise a theoretical construct and thereby create a psychological measure; and we’ve seen that by applying psychological measures we end up with variables, which can come in many different types. At this point, we should start discussing the obvious question: is the measurement any good? We’ll do this in terms of two related ideas: reliability and validity. Put simply, the reliability of a measure tells you how precisely you are measuring something, whereas the validity of a measure tells you how accurate the measure is. In this section I’ll talk about reliability; we’ll talk about validity in the next chapter. Reliability is actually a very simple concept: it refers to the repeatability or consistency of your measurement. The measurement of my weight by means of a “bathroom scale” is very reliable: if I step on and off the scales over and over again, it’ll keep giving me the same answer. Measuring my intelligence by means of “asking my mum” is very unreliable: some days she tells me I’m a bit thick, and other days she tells me I’m a complete moron. Notice that this concept of reliability is different to the question of whether the measurements are correct (the correctness of a measurement relates to it’s validity). If I’m holding a sack of potatos when I step on and off of the bathroom scales, the measurement will still be reliable: it will always give me the same answer. However, this highly reliable answer doesn’t match up to my true weight at all, therefore it’s wrong. In technical terms, this is a reliable but invalid measurement. Similarly, while my mum’s estimate of my intelligence is a bit unreliable, she might be right. Maybe I’m just not too bright, and so while her estimate of my intelligence fluctuates pretty wildly from day to day, it’s basically right. So that would be an unreliable but valid measure. Of course, to some extent, notice that if my mum’s estimates are too unreliable, it’s going to be very hard to figure out which one of her many claims about my intelligence is actually the right one. To some extent, then, a very unreliable measure tends to end up being invalid for practical purposes; so much so that many people would say that reliability is necessary (but not sufficient) to ensure validity. Okay, now that we’re clear on the distinction between reliability and validity, let’s have a think about the different ways in which we might measure reliability: Test-retest reliability. This relates to consistency over time: if we repeat the measurement at a later date, do we get a the same answer? Inter-rater reliability. This relates to consistency across people: if someone else repeats the measurement (e.g., someone else rates my intelligence) will they produce the same answer? Parallel forms reliability. This relates to consistency across theoretically-equivalent measurements: if I use a different set of bathroom scales to measure my weight, does it give the same answer? Internal consistency reliability. If a measurement is constructed from lots of different parts that perform similar functions (e.g., a personality questionnaire result is added up across several questions) do the individual parts tend to give similar answers. Not all measurements need to possess all forms of reliability. For instance, educational assessment can be thought of as a form of measurement. One of the subjects that I teach, Computational Cognitive Science, has an assessment structure that has a research component and an exam component (plus other things). The exam component is intended to measure something different from the research component, so the assessment as a whole has low internal consistency. However, within the exam there are several questions that are intended to (approximately) measure the same things, and those tend to produce similar outcomes; so the exam on its own has a fairly high internal consistency. Which is as it should be. You should only demand reliability in those situations where you want to be measure the same thing! 1.6.4 The “role” of variables: predictors and outcomes [sec:ivdv] Okay, I’ve got one last piece of terminology that I need to explain to you before moving away from variables. Normally, when we do some research we end up with lots of different variables. Then, when we analyse our data we usually try to explain some of the variables in terms of some of the other variables. It’s important to keep the two roles “thing doing the explaining” and “thing being explained” distinct. So let’s be clear about this now. Firstly, we might as well get used to the idea of using mathematical symbols to describe variables, since it’s going to happen over and over again. Let’s denote the “to be explained” variable \\(Y\\), and denote the variables “doing the explaining” as \\(X_1\\), \\(X_2\\), etc. Now, when we doing an analysis, we have different names for \\(X\\) and \\(Y\\), since they play different roles in the analysis. The classical names for these roles are independent variable (IV) and dependent variable (DV). The IV is the variable that you use to do the explaining (i.e., \\(X\\)) and the DV is the variable being explained (i.e., \\(Y\\)). The logic behind these names goes like this: if there really is a relationship between \\(X\\) and \\(Y\\) then we can say that \\(Y\\) depends on \\(X\\), and if we have designed our study “properly” then \\(X\\) isn’t dependent on anything else. However, I personally find those names horrible: they’re hard to remember and they’re highly misleading, because (a) the IV is never actually “independent of everything else” and (b) if there’s no relationship, then the DV doesn’t actually depend on the IV. And in fact, because I’m not the only person who thinks that IV and DV are just awful names, there are a number of alternatives that I find more appealing. The terms that I’ll use in these notes are predictors and outcomes. The idea here is that what you’re trying to do is use \\(X\\) (the predictors) to make guesses about \\(Y\\) (the outcomes). This is summarised in Table [tab:ivdv]. [tab:ivdv] The terminology used to distinguish between different roles that a variable can play when analysing a data set. Note that this book will tend to avoid the classical terminology in favour of the newer names. role of the variable classical name modern name “to be explained” dependent variable (DV) outcome “to do the explaining” independent variable (IV) predictor 1.6.5 Experimental and non-experimental research [sec:researchdesigns] One of the big distinctions that you should be aware of is the distinction between “experimental research” and “non-experimental research”. When we make this distinction, what we’re really talking about is the degree of control that the researcher exercises over the people and events in the study. 1.6.5.1 Experimental research The key features of experimental research is that the researcher controls all aspects of the study, especially what participants experience during the study. In particular, the researcher manipulates or varies the predictor variables (IVs), and then allows the outcome variable (DV) to vary naturally. The idea here is to deliberately vary the predictors (IVs) to see if they have any causal effects on the outcomes. Moreover, in order to ensure that there’s no chance that something other than the predictor variables is causing the outcomes, everything else is kept constant or is in some other way “balanced” to ensure that they have no effect on the results. In practice, it’s almost impossible to think of everything else that might have an influence on the outcome of an experiment, much less keep it constant. The standard solution to this is randomisation: that is, we randomly assign people to different groups, and then give each group a different treatment (i.e., assign them different values of the predictor variables). We’ll talk more about randomisation later in this course, but for now, it’s enough to say that what randomisation does is minimise (but not eliminate) the chances that there are any systematic difference between groups. Let’s consider a very simple, completely unrealistic and grossly unethical example. Suppose you wanted to find out if smoking causes lung cancer. One way to do this would be to find people who smoke and people who don’t smoke, and look to see if smokers have a higher rate of lung cancer. This is not a proper experiment, since the researcher doesn’t have a lot of control over who is and isn’t a smoker. And this really matters: for instance, it might be that people who choose to smoke cigarettes also tend to have poor diets, or maybe they tend to work in asbestos mines, or whatever. The point here is that the groups (smokers and non-smokers) actually differ on lots of things, not just smoking. So it might be that the higher incidence of lung cancer among smokers is caused by something else, not by smoking per se. In technical terms, these other things (e.g. diet) are called “confounds”, and we’ll talk about those in just a moment. In the meantime, let’s now consider what a proper experiment might look like. Recall that our concern was that smokers and non-smokers might differ in lots of ways. The solution, as long as you have no ethics, is to control who smokes and who doesn’t. Specifically, if we randomly divide participants into two groups, and force half of them to become smokers, then it’s very unlikely that the groups will differ in any respect other than the fact that half of them smoke. That way, if our smoking group gets cancer at a higher rate than the non-smoking group, then we can feel pretty confident that (a) smoking does cause cancer and (b) we’re murderers. 1.6.5.2 Non-experimental research Non-experimental research is a broad term that covers “any study in which the researcher doesn’t have quite as much control as they do in an experiment”. Obviously, control is something that scientists like to have, but as the previous example illustrates, there are lots of situations in which you can’t or shouldn’t try to obtain that control. Since it’s grossly unethical (and almost certainly criminal) to force people to smoke in order to find out if they get cancer, this is a good example of a situation in which you really shouldn’t try to obtain experimental control. But there are other reasons too. Even leaving aside the ethical issues, our “smoking experiment” does have a few other issues. For instance, when I suggested that we “force” half of the people to become smokers, I must have been talking about starting with a sample of non-smokers, and then forcing them to become smokers. While this sounds like the kind of solid, evil experimental design that a mad scientist would love, it might not be a very sound way of investigating the effect in the real world. For instance, suppose that smoking only causes lung cancer when people have poor diets, and suppose also that people who normally smoke do tend to have poor diets. However, since the “smokers” in our experiment aren’t “natural” smokers (i.e., we forced non-smokers to become smokers; they didn’t take on all of the other normal, real life characteristics that smokers might tend to possess) they probably have better diets. As such, in this silly example they wouldn’t get lung cancer, and our experiment will fail, because it violates the structure of the “natural” world (the technical name for this is an “artifactual” result; see later). One distinction worth making between two types of non-experimental research is the difference between quasi-experimental research and case studies. The example I discussed earlier – in which we wanted to examine incidence of lung cancer among smokers and non-smokers, without trying to control who smokes and who doesn’t – is a quasi-experimental design. That is, it’s the same as an experiment, but we don’t control the predictors (IVs). We can still use statistics to analyse the results, it’s just that we have to be a lot more careful. The alternative approach, case studies, aims to provide a very detailed description of one or a few instances. In general, you can’t use statistics to analyse the results of case studies, and it’s usually very hard to draw any general conclusions about “people in general” from a few isolated examples. However, case studies are very useful in some situations. Firstly, there are situations where you don’t have any alternative: neuropsychology has this issue a lot. Sometimes, you just can’t find a lot of people with brain damage in a specific area, so the only thing you can do is describe those cases that you do have in as much detail and with as much care as you can. However, there’s also some genuine advantages to case studies: because you don’t have as many people to study, you have the ability to invest lots of time and effort trying to understand the specific factors at play in each case. This is a very valuable thing to do. As a consequence, case studies can complement the more statistically-oriented approaches that you see in experimental and quasi-experimental designs. We won’t talk much about case studies in these lectures, but they are nevertheless very valuable tools! 1.6.6 Assessing the validity of a study [sec:validity] More than any other thing, a scientist wants their research to be “valid”. The conceptual idea behind validity is very simple: can you trust the results of your study? If not, the study is invalid. However, while it’s easy to state, in practice it’s much harder to check validity than it is to check reliability. And in all honesty, there’s no precise, clearly agreed upon notion of what validity actually is. In fact, there’s lots of different kinds of validity, each of which raises it’s own issues, and not all forms of validity are relevant to all studies. I’m going to talk about five different types: Internal validity External validity Construct validity Face validity Ecological validity To give you a quick guide as to what matters here…(1) Internal and external validity are the most important, since they tie directly to the fundamental question of whether your study really works. (2) Construct validity asks whether you’re measuring what you think you are. (3) Face validity isn’t terribly important except insofar as you care about “appearances”. (4) Ecological validity is a special case of face validity that corresponds to a kind of appearance that you might care about a lot. 1.6.6.1 Internal validity Internal validity refers to the extent to which you are able draw the correct conclusions about the causal relationships between variables. It’s called “internal” because it refers to the relationships between things “inside” the study. Let’s illustrate the concept with a simple example. Suppose you’re interested in finding out whether a university education makes you write better. To do so, you get a group of first year students, ask them to write a 1000 word essay, and count the number of spelling and grammatical errors they make. Then you find some third-year students, who obviously have had more of a university education than the first-years, and repeat the exercise. And let’s suppose it turns out that the third-year students produce fewer errors. And so you conclude that a university education improves writing skills. Right? Except… the big problem that you have with this experiment is that the third-year students are older, and they’ve had more experience with writing things. So it’s hard to know for sure what the causal relationship is: Do older people write better? Or people who have had more writing experience? Or people who have had more education? Which of the above is the true cause of the superior performance of the third-years? Age? Experience? Education? You can’t tell. This is an example of a failure of internal validity, because your study doesn’t properly tease apart the causal relationships between the different variables. 1.6.6.2 External validity External validity relates to the generalisability of your findings. That is, to what extent do you expect to see the same pattern of results in “real life” as you saw in your study. To put it a bit more precisely, any study that you do in psychology will involve a fairly specific set of questions or tasks, will occur in a specific environment, and will involve participants that are drawn from a particular subgroup. So, if it turns out that the results don’t actually generalise to people and situations beyond the ones that you studied, then what you’ve got is a lack of external validity. The classic example of this issue is the fact that a very large proportion of studies in psychology will use undergraduate psychology students as the participants. Obviously, however, the researchers don’t care only about psychology students; they care about people in general. Given that, a study that uses only psych students as participants always carries a risk of lacking external validity. That is, if there’s something “special” about psychology students that makes them different to the general populace in some relevant respect, then we may start worrying about a lack of external validity. That said, it is absolutely critical to realise that a study that uses only psychology students does not necessarily have a problem with external validity. I’ll talk about this again later, but it’s such a common mistake that I’m going to mention it here. The external validity is threatened by the choice of population if (a) the population from which you sample your participants is very narrow (e.g., psych students), and (b) the narrow population that you sampled from is systematically different from the general population, in some respect that is relevant to the psychological phenomenon that you intend to study. The italicised part is the bit that lots of people forget: it is true that psychology undergraduates differ from the general population in lots of ways, and so a study that uses only psych students may have problems with external validity. However, if those differences aren’t very relevant to the phenomenon that you’re studying, then there’s nothing to worry about. To make this a bit more concrete, here’s two extreme examples: You want to measure “attitudes of the general public towards psychotherapy”, but all of your participants are psychology students. This study would almost certainly have a problem with external validity. You want to measure the effectiveness of a visual illusion, and your participants are all psychology students. This study is very unlikely to have a problem with external validity Having just spent the last couple of paragraphs focusing on the choice of participants (since that’s the big issue that everyone tends to worry most about), it’s worth remembering that external validity is a broader concept. The following are also examples of things that might pose a threat to external validity, depending on what kind of study you’re doing: People might answer a “psychology questionnaire” in a manner that doesn’t reflect what they would do in real life. Your lab experiment on (say) “human learning” has a different structure to the learning problems people face in real life. 1.6.6.3 Construct validity Construct validity is basically a question of whether you’re measuring what you want to be measuring. A measurement has good construct validity if it is actually measuring the correct theoretical construct, and bad construct validity if it doesn’t. To give very simple (if ridiculous) example, suppose I’m trying to investigate the rates with which university students cheat on their exams. And the way I attempt to measure it is by asking the cheating students to stand up in the lecture theatre so that I can count them. When I do this with a class of 300 students, 0 people claim to be cheaters. So I therefore conclude that the proportion of cheaters in my class is 0%. Clearly this is a bit ridiculous. But the point here is not that this is a very deep methodological example, but rather to explain what construct validity is. The problem with my measure is that while I’m trying to measure “the proportion of people who cheat” what I’m actually measuring is “the proportion of people stupid enough to own up to cheating, or bloody minded enough to pretend that they do”. Obviously, these aren’t the same thing! So my study has gone wrong, because my measurement has very poor construct validity. 1.6.6.4 Face validity Face validity simply refers to whether or not a measure “looks like” it’s doing what it’s supposed to, nothing more. If I design a test of intelligence, and people look at it and they say “no, that test doesn’t measure intelligence”, then the measure lacks face validity. It’s as simple as that. Obviously, face validity isn’t very important from a pure scientific perspective. After all, what we care about is whether or not the measure actually does what it’s supposed to do, not whether it looks like it does what it’s supposed to do. As a consequence, we generally don’t care very much about face validity. That said, the concept of face validity serves three useful pragmatic purposes: Sometimes, an experienced scientist will have a “hunch” that a particular measure won’t work. While these sorts of hunches have no strict evidentiary value, it’s often worth paying attention to them. Because often times people have knowledge that they can’t quite verbalise, so there might be something to worry about even if you can’t quite say why. In other words, when someone you trust criticises the face validity of your study, it’s worth taking the time to think more carefully about your design to see if you can think of reasons why it might go awry. Mind you, if you don’t find any reason for concern, then you should probably not worry: after all, face validity really doesn’t matter much. Often (very often), completely uninformed people will also have a “hunch” that your research is crap. And they’ll criticise it on the internet or something. On close inspection, you’ll often notice that these criticisms are actually focused entirely on how the study “looks”, but not on anything deeper. The concept of face validity is useful for gently explaining to people that they need to substantiate their arguments further. Expanding on the last point, if the beliefs of untrained people are critical (e.g., this is often the case for applied research where you actually want to convince policy makers of something or other) then you have to care about face validity. Simply because – whether you like it or not – a lot of people will use face validity as a proxy for real validity. If you want the government to change a law on scientific, psychological grounds, then it won’t matter how good your studies “really” are. If they lack face validity, you’ll find that politicians ignore you. Of course, it’s somewhat unfair that policy often depends more on appearance than fact, but that’s how things go. 1.6.6.5 Ecological validity Ecological validity is a different notion of validity, which is similar to external validity, but less important. The idea is that, in order to be ecologically valid, the entire set up of the study should closely approximate the real world scenario that is being investigated. In a sense, ecological validity is a kind of face validity – it relates mostly to whether the study “looks” right, but with a bit more rigour to it. To be ecologically valid, the study has to look right in a fairly specific way. The idea behind it is the intuition that a study that is ecologically valid is more likely to be externally valid. It’s no guarantee, of course. But the nice thing about ecological validity is that it’s much easier to check whether a study is ecologically valid than it is to check whether a study is externally valid. An simple example would be eyewitness identification studies. Most of these studies tend to be done in a university setting, often with fairly simple array of faces to look at rather than a line up. The length of time between seeing the “criminal” and being asked to identify the suspect in the “line up” is usually shorter. The “crime” isn’t real, so there’s no chance that the witness being scared, and there’s no police officers present, so there’s not as much chance of feeling pressured. These things all mean that the study definitely lacks ecological validity. They might (but might not) mean that it also lacks external validity. 1.6.7 Confounds, artifacts and other threats to validity If we look at the issue of validity in the most general fashion, the two biggest worries that we have are confounds and artifact. These two terms are defined in the following way: Confound: A confound is an additional, often unmeasured variable that turns out to be related to both the predictors and the outcomes. The existence of confounds threatens the internal validity of the study because you can’t tell whether the predictor causes the outcome, or if the confounding variable causes it, etc. Artifact: A result is said to be “artifactual” if it only holds in the special situation that you happened to test in your study. The possibility that your result is an artifact describes a threat to your external validity, because it raises the possibility that you can’t generalise your results to the actual population that you care about. As a general rule confounds are a bigger concern for non-experimental studies, precisely because they’re not proper experiments: by definition, you’re leaving lots of things uncontrolled, so there’s a lot of scope for confounds working their way into your study. Experimental research tends to be much less vulnerable to confounds: the more control you have over what happens during the study, the more you can prevent confounds from appearing. However, there’s always swings and roundabouts, and when we start thinking about artifacts rather than confounds, the shoe is very firmly on the other foot. For the most part, artifactual results tend to be a concern for experimental studies than for non-experimental studies. To see this, it helps to realise that the reason that a lot of studies are non-experimental is precisely because what the researcher is trying to do is examine human behaviour in a more naturalistic context. By working in a more real-world context, you lose experimental control (making yourself vulnerable to confounds) but because you tend to be studying human psychology “in the wild” you reduce the chances of getting an artifactual result. Or, to put it another way, when you take psychology out of the wild and bring it into the lab (which we usually have to do to gain our experimental control), you always run the risk of accidentally studying something different than you wanted to study: which is more or less the definition of an artifact. Be warned though: the above is a rough guide only. It’s absolutely possible to have confounds in an experiment, and to get artifactual results with non-experimental studies. This can happen for all sorts of reasons, not least of which is researcher error. In practice, it’s really hard to think everything through ahead of time, and even very good researchers make mistakes. But other times it’s unavoidable, simply because the researcher has ethics (e.g., see “differential attrition”). Okay. There’s a sense in which almost any threat to validity can be characterised as a confound or an artifact: they’re pretty vague concepts. So let’s have a look at some of the most common examples… 1.6.7.1 History effects History effects refer to the possibility that specific events may occur during the study itself that might influence the outcomes. For instance, something might happen in between a pre-test and a post-test. Or, in between testing participant 23 and participant 24. Alternatively, it might be that you’re looking at an older study, which was perfectly valid for its time, but the world has changed enough since then that the conclusions are no longer trustworthy. Examples of things that would count as history effects: You’re interested in how people think about risk and uncertainty. You started your data collection in December 2010. But finding participants and collecting data takes time, so you’re still finding new people in February 2011. Unfortunately for you (and even more unfortunately for others), the Queensland floods occurred in January 2011, causing billions of dollars of damage and killing many people. Not surprisingly, the people tested in February 2011 express quite different beliefs about handling risk than the people tested in December 2010. Which (if any) of these reflects the “true” beliefs of participants? I think the answer is probably both: the Queensland floods genuinely changed the beliefs of the Australian public, though possibly only temporarily. The key thing here is that the “history” of the people tested in February is quite different to people tested in December. You’re testing the psychological effects of a new anti-anxiety drug. So what you do is measure anxiety before administering the drug (e.g., by self-report, and taking physiological measures, let’s say), then you administer the drug, and then you take the same measures afterwards. In the middle, however, because your labs are in Los Angeles, there’s an earthquake, which increases the anxiety of the participants. 1.6.7.2 Maturation effects As with history effects, maturational effects are fundamentally about change over time. However, maturation effects aren’t in response to specific events. Rather, they relate to how people change on their own over time: we get older, we get tired, we get bored, etc. Some examples of maturation effects: When doing developmental psychology research, you need to be aware that children grow up quite rapidly. So, suppose that you want to find out whether some educational trick helps with vocabulary size among 3 year olds. One thing that you need to be aware of is that the vocabulary size of children that age is growing at an incredible rate (multiple words per day), all on its own. If you design your study without taking this maturational effect into account, then you won’t be able to tell if your educational trick works. When running a very long experiment in the lab (say, something that goes for 3 hours), it’s very likely that people will begin to get bored and tired, and that this maturational effect will cause performance to decline, regardless of anything else going on in the experiment 1.6.7.3 Repeated testing effects An important type of history effect is the effect of repeated testing. Suppose I want to take two measurements of some psychological construct (e.g., anxiety). One thing I might be worried about is if the first measurement has an effect on the second measurement. In other words, this is a history effect in which the “event” that influences the second measurement is the first measurement itself! This is not at all uncommon. Examples of this include: Learning and practice: e.g., “intelligence” at time 2 might appear to go up relative to time 1 because participants learned the general rules of how to solve “intelligence-test-style” questions during the first testing session. Familiarity with the testing situation: e.g., if people are nervous at time 1, this might make performance go down; after sitting through the first testing situation, they might calm down a lot precisely because they’ve seen what the testing looks like. Auxiliary changes caused by testing: e.g., if a questionnaire assessing mood is boring, then mood at measurement at time 2 is more likely to become “bored”, precisely because of the boring measurement made at time 1. 1.6.7.4 Selection bias Selection bias is a pretty broad term. Suppose that you’re running an experiment with two groups of participants, where each group gets a different “treatment”, and you want to see if the different treatments lead to different outcomes. However, suppose that, despite your best efforts, you’ve ended up with a gender imbalance across groups (say, group A has 80% females and group B has 50% females). It might sound like this could never happen, but trust me, it can. This is an example of a selection bias, in which the people “selected into” the two groups have different characteristics. If any of those characteristics turns out to be relevant (say, your treatment works better on females than males) then you’re in a lot of trouble. 1.6.7.5 Differential attrition One quite subtle danger to be aware of is called differential attrition, which is a kind of selection bias that is caused by the study itself. Suppose that, for the first time ever in the history of psychology, I manage to find the perfectly balanced and representative sample of people. I start running “Dan’s incredibly long and tedious experiment” on my perfect sample, but then, because my study is incredibly long and tedious, lots of people start dropping out. I can’t stop this: as we’ll discuss later in the chapter on research ethics, participants absolutely have the right to stop doing any experiment, any time, for whatever reason they feel like, and as researchers we are morally (and professionally) obliged to remind people that they do have this right. So, suppose that “Dan’s incredibly long and tedious experiment” has a very high drop out rate. What do you suppose the odds are that this drop out is random? Answer: zero. Almost certainly, the people who remain are more conscientious, more tolerant of boredom etc than those that leave. To the extent that (say) conscientiousness is relevant to the psychological phenomenon that I care about, this attrition can decrease the validity of my results. When thinking about the effects of differential attrition, it is sometimes helpful to distinguish between two different types. The first is homogeneous attrition, in which the attrition effect is the same for all groups, treatments or conditions. In the example I gave above, the differential attrition would be homogeneous if (and only if) the easily bored participants are dropping out of all of the conditions in my experiment at about the same rate. In general, the main effect of homogeneous attrition is likely to be that it makes your sample unrepresentative. As such, the biggest worry that you’ll have is that the generalisability of the results decreases: in other words, you lose external validity. The second type of differential attrition is heterogeneous attrition, in which the attrition effect is different for different groups. This is a much bigger problem: not only do you have to worry about your external validity, you also have to worry about your internal validity too. To see why this is the case, let’s consider a very dumb study in which I want to see if insulting people makes them act in a more obedient way. Why anyone would actually want to study that I don’t know, but let’s suppose I really, deeply cared about this. So, I design my experiment with two conditions. In the “treatment” condition, the experimenter insults the participant and then gives them a questionnaire designed to measure obedience. In the “control” condition, the experimenter engages in a bit of pointless chitchat and then gives them the questionnaire. Leaving aside the questionable scientific merits and dubious ethics of such a study, let’s have a think about what might go wrong here. As a general rule, when someone insults me to my face, I tend to get much less co-operative. So, there’s a pretty good chance that a lot more people are going to drop out of the treatment condition than the control condition. And this drop out isn’t going to be random. The people most likely to drop out would probably be the people who don’t care all that much about the importance of obediently sitting through the experiment. Since the most bloody minded and disobedient people all left the treatment group but not the control group, we’ve introduced a confound: the people who actually took the questionnaire in the treatment group were already more likely to be dutiful and obedient than the people in the control group. In short, in this study insulting people doesn’t make them more obedient: it makes the more disobedient people leave the experiment! The internal validity of this experiment is completely shot. 1.6.7.6 Non-response bias Non-response bias is closely related to selection bias, and to differential attrition. The simplest version of the problem goes like this. You mail out a survey to 1000 people, and only 300 of them reply. The 300 people who replied are almost certainly not a random subsample. People who respond to surveys are systematically different to people who don’t. This introduces a problem when trying to generalise from those 300 people who replied, to the population at large; since you now have a very non-random sample. The issue of non-response bias is more general than this, though. Among the (say) 300 people that did respond to the survey, you might find that not everyone answers every question. If (say) 80 people chose not to answer one of your questions, does this introduce problems? As always, the answer is maybe. If the question that wasn’t answered was on the last page of the questionnaire, and those 80 surveys were returned with the last page missing, there’s a good chance that the missing data isn’t a big deal: probably the pages just fell off. However, if the question that 80 people didn’t answer was the most confrontational or invasive personal question in the questionnaire, then almost certainly you’ve got a problem. In essence, what you’re dealing with here is what’s called the problem of missing data. If the data that is missing was “lost” randomly, then it’s not a big problem. If it’s missing systematically, then it can be a big problem. 1.6.7.7 Regression to the mean Regression to the mean is a curious variation on selection bias. It refers to any situation where you select data based on an extreme value on some measure. Because the measure has natural variation, it almost certainly means that when you take a subsequent measurement, that later measurement will be less extreme than the first one, purely by chance. Here’s an example. Suppose I’m interested in whether a psychology education has an adverse effect on very smart kids. To do this, I find the 20 psych I students with the best high school grades and look at how well they’re doing at university. It turns out that they’re doing a lot better than average, but they’re not topping the class at university, even though they did top their classes at high school. What’s going on? The natural first thought is that this must mean that the psychology classes must be having an adverse effect on those students. However, while that might very well be the explanation, it’s more likely that what you’re seeing is an example of “regression to the mean”. To see how it works, let’s take a moment to think about what is required to get the best mark in a class, regardless of whether that class be at high school or at university. When you’ve got a big class, there are going to be lots of very smart people enrolled. To get the best mark you have to be very smart, work very hard, and be a bit lucky. The exam has to ask just the right questions for your idiosyncratic skills, and you have to not make any dumb mistakes (we all do that sometimes) when answering them. And that’s the thing: intelligence and hard work are transferrable from one class to the next. Luck isn’t. The people who got lucky in high school won’t be the same as the people who get lucky at university. That’s the very definition of “luck”. The consequence of this is that, when you select people at the very extreme values of one measurement (the top 20 students), you’re selecting for hard work, skill and luck. But because the luck doesn’t transfer to the second measurement (only the skill and work), these people will all be expected to drop a little bit when you measure them a second time (at university). So their scores fall back a little bit, back towards everyone else. This is regression to the mean. Regression to the mean is surprisingly common. For instance, if two very tall people have kids, their children will tend to be taller than average, but not as tall as the parents. The reverse happens with very short parents: two very short parents will tend to have short children, but nevertheless those kids will tend to be taller than the parents. It can also be extremely subtle. For instance, there have been studies done that suggested that people learn better from negative feedback than from positive feedback. However, the way that people tried to show this was to give people positive reinforcement whenever they did good, and negative reinforcement when they did bad. And what you see is that after the positive reinforcement, people tended to do worse; but after the negative reinforcement they tended to do better. But! Notice that there’s a selection bias here: when people do very well, you’re selecting for “high” values, and so you should expect (because of regression to the mean) that performance on the next trial should be worse, regardless of whether reinforcement is given. Similarly, after a bad trial, people will tend to improve all on their own. The apparent superiority of negative feedback is an artifact caused by regression to the mean &lt;see&gt;[for discussion]Kahneman1973. 1.6.7.8 Experimenter bias Experimenter bias can come in multiple forms. The basic idea is that the experimenter, despite the best of intentions, can accidentally end up influencing the results of the experiment by subtly communicating the “right answer” or the “desired behaviour” to the participants. Typically, this occurs because the experimenter has special knowledge that the participant does not – either the right answer to the questions being asked, or knowledge of the expected pattern of performance for the condition that the participant is in, and so on. The classic example of this happening is the case study of “Clever Hans”, which dates back to 1907 Pfungst (1911; Hothersall 2004). Clever Hans was a horse that apparently was able to read and count, and perform other human like feats of intelligence. After Clever Hans became famous, psychologists started examining his behaviour more closely. It turned out that – not surprisingly – Hans didn’t know how to do maths. Rather, Hans was responding to the human observers around him. Because they did know how to count, and the horse had learned to change its behaviour when people changed theirs. The general solution to the problem of experimenter bias is to engage in double blind studies, where neither the experimenter nor the participant knows which condition the participant is in, or knows what the desired behaviour is. This provides a very good solution to the problem, but it’s important to recognise that it’s not quite ideal, and hard to pull off perfectly. For instance, the obvious way that I could try to construct a double blind study is to have one of my Ph.D. students (one who doesn’t know anything about the experiment) run the study. That feels like it should be enough. The only person (me) who knows all the details (e.g., correct answers to the questions, assignments of participants to conditions) has no interaction with the participants, and the person who does all the talking to people (the Ph.D. student) doesn’t know anything. Except, that last part is very unlikely to be true. In order for the Ph.D. student to run the study effectively, they need to have been briefed by me, the researcher. And, as it happens, the Ph.D. student also knows me, and knows a bit about my general beliefs about people and psychology (e.g., I tend to think humans are much smarter than psychologists give them credit for). As a result of all this, it’s almost impossible for the experimenter to avoid knowing a little bit about what expectations I have. And even a little bit of knowledge can have an effect: suppose the experimenter accidentally conveys the fact that the participants are expected to do well in this task. Well, there’s a thing called the “Pygmalion effect”: if you expect great things of people, they’ll rise to the occasion; but if you expect them to fail, they’ll do that too. In other words, the expectations become a self-fulfilling prophesy. 1.6.7.9 Demand effects and reactivity When talking about experimenter bias, the worry is that the experimenter’s knowledge or desires for the experiment are communicated to the participants, and that these effect people’s behaviour Rosenthal (1966). However, even if you manage to stop this from happening, it’s almost impossible to stop people from knowing that they’re part of a psychological study. And the mere fact of knowing that someone is watching/studying you can have a pretty big effect on behaviour. This is generally referred to as reactivity or demand effects. The basic idea is captured by the Hawthorne effect: people alter their performance because of the attention that the study focuses on them. The effect takes its name from a the “Hawthorne Works” factory outside of Chicago &lt;see&gt;Adair1984. A study done in the 1920s looking at the effects of lighting on worker productivity at the factory turned out to be an effect of the fact that the workers knew they were being studied, rather than the lighting. To get a bit more specific about some of the ways in which the mere fact of being in a study can change how people behave, it helps to think like a social psychologist and look at some of the roles that people might adopt during an experiment, but might not adopt if the corresponding events were occurring in the real world: The good participant tries to be too helpful to the researcher: he or she seeks to figure out the experimenter’s hypotheses and confirm them. The negative participant does the exact opposite of the good participant: he or she seeks to break or destroy the study or the hypothesis in some way. The faithful participant is unnaturally obedient: he or she seeks to follow instructions perfectly, regardless of what might have happened in a more realistic setting. The apprehensive participant gets nervous about being tested or studied, so much so that his or her behaviour becomes highly unnatural, or overly socially desirable. 1.6.7.10 Placebo effects The placebo effect is a specific type of demand effect that we worry a lot about. It refers to the situation where the mere fact of being treated causes an improvement in outcomes. The classic example comes from clinical trials: if you give people a completely chemically inert drug and tell them that it’s a cure for a disease, they will tend to get better faster than people who aren’t treated at all. In other words, it is people’s belief that they are being treated that causes the improved outcomes, not the drug. 1.6.7.11 Situation, measurement and subpopulation effects In some respects, these terms are a catch-all term for “all other threats to external validity”. They refer to the fact that the choice of subpopulation from which you draw your participants, the location, timing and manner in which you run your study (including who collects the data) and the tools that you use to make your measurements might all be influencing the results. Specifically, the worry is that these things might be influencing the results in such a way that the results won’t generalise to a wider array of people, places and measures. 1.6.7.12 Fraud, deception and self-deception It is difficult to get a man to understand something, when his salary depends on his not understanding it. – Upton Sinclair One final thing that I feel like I should mention. While reading what the textbooks often have to say about assessing the validity of the study, I couldn’t help but notice that they seem to make the assumption that the researcher is honest. I find this hilarious. While the vast majority of scientists are honest, in my experience at least, some are not. Not only that, as I mentioned earlier, scientists are not immune to belief bias – it’s easy for a researcher to end up deceiving themselves into believing the wrong thing, and this can lead them to conduct subtly flawed research, and then hide those flaws when they write it up. So you need to consider not only the (probably unlikely) possibility of outright fraud, but also the (probably quite common) possibility that the research is unintentionally “slanted”. I opened a few standard textbooks and didn’t find much of a discussion of this problem, so here’s my own attempt to list a few ways in which these issues can arise are: Data fabrication. Sometimes, people just make up the data. This is occasionally done with “good” intentions. For instance, the researcher believes that the fabricated data do reflect the truth, and may actually reflect “slightly cleaned up” versions of actual data. On other occasions, the fraud is deliberate and malicious. Some high-profile examples where data fabrication has been alleged or shown include Cyril Burt (a psychologist who is thought to have fabricated some of his data), Andrew Wakefield (who has been accused of fabricating his data connecting the MMR vaccine to autism) and Hwang Woo-suk (who falsified a lot of his data on stem cell research). Hoaxes. Hoaxes share a lot of similarities with data fabrication, but they differ in the intended purpose. A hoax is often a joke, and many of them are intended to be (eventually) discovered. Often, the point of a hoax is to discredit someone or some field. There’s quite a few well known scientific hoaxes that have occurred over the years (e.g., Piltdown man) some of were deliberate attempts to discredit particular fields of research (e.g., the Sokal affair). Data misrepresentation. While fraud gets most of the headlines, it’s much more common in my experience to see data being misrepresented. When I say this, I’m not referring to newspapers getting it wrong (which they do, almost always). I’m referring to the fact that often, the data don’t actually say what the researchers think they say. My guess is that, almost always, this isn’t the result of deliberate dishonesty, it’s due to a lack of sophistication in the data analyses. For instance, think back to the example of Simpson’s paradox that I discussed in the beginning of these notes. It’s very common to see people present “aggregated” data of some kind; and sometimes, when you dig deeper and find the raw data yourself, you find that the aggregated data tell a different story to the disaggregated data. Alternatively, you might find that some aspect of the data is being hidden, because it tells an inconvenient story (e.g., the researcher might choose not to refer to a particular variable). There’s a lot of variants on this; many of which are very hard to detect. Study “misdesign”. Okay, this one is subtle. Basically, the issue here is that a researcher designs a study that has built-in flaws, and those flaws are never reported in the paper. The data that are reported are completely real, and are correctly analysed, but they are produced by a study that is actually quite wrongly put together. The researcher really wants to find a particular effect, and so the study is set up in such a way as to make it “easy” to (artifactually) observe that effect. One sneaky way to do this – in case you’re feeling like dabbling in a bit of fraud yourself – is to design an experiment in which it’s obvious to the participants what they’re “supposed” to be doing, and then let reactivity work its magic for you. If you want, you can add all the trappings of double blind experimentation etc. It won’t make a difference, since the study materials themselves are subtly telling people what you want them to do. When you write up the results, the fraud won’t be obvious to the reader: what’s obvious to the participant when they’re in the experimental context isn’t always obvious to the person reading the paper. Of course, the way I’ve described this makes it sound like it’s always fraud: probably there are cases where this is done deliberately, but in my experience the bigger concern has been with unintentional misdesign. The researcher believes …and so the study just happens to end up with a built in flaw, and that flaw then magically erases itself when the study is written up for publication. Data mining &amp; post hoc hypothesising. Another way in which the authors of a study can more or less lie about what they found is by engaging in what’s referred to as “data mining”. As we’ll discuss later in the class, if you keep trying to analyse your data in lots of different ways, you’ll eventually find something that “looks” like a real effect but isn’t. This is referred to as “data mining”. It used to be quite rare because data analysis used to take weeks, but now that everyone has very powerful statistical software on their computers, it’s becoming very common. Data mining per se isn’t “wrong”, but the more that you do it, the bigger the risk you’re taking. The thing that is wrong, and I suspect is very common, is unacknowledged data mining. That is, the researcher run every possible analysis known to humanity, finds the one that works, and then pretends that this was the only analysis that they ever conducted. Worse yet, they often “invent” a hypothesis after looking at the data, to cover up the data mining. To be clear: it’s not wrong to change your beliefs after looking at the data, and to reanalyse your data using your new “post hoc” hypotheses. What is wrong (and, I suspect, common) is failing to acknowledge that you’ve done so. If you acknowledge that you did it, then other researchers are able to take your behaviour into account. If you don’t, then they can’t. And that makes your behaviour deceptive. Bad! Publication bias &amp; self-censoring. Finally, a pervasive bias is “non-reporting” of negative results. This is almost impossible to prevent. Journals don’t publish every article that is submitted to them: they prefer to publish articles that find “something”. So, if 20 people run an experiment looking at whether reading Finnegans Wake causes insanity in humans, and 19 of them find that it doesn’t, which one do you think is going to get published? Obviously, it’s the one study that did find that Finnegans Wake causes insanity. This is an example of a publication bias: since no-one ever published the 19 studies that didn’t find an effect, a naive reader would never know that they existed. Worse yet, most researchers “internalise” this bias, and end up self-censoring their research. Knowing that negative results aren’t going to be accepted for publication, they never even try to report them. As a friend of mine says “for every experiment that you get published, you also have 10 failures”. And she’s right. The catch is, while some (maybe most) of those studies are failures for boring reasons (e.g. you stuffed something up) others might be genuine “null” results that you ought to acknowledge when you write up the “good” experiment. And telling which is which is often hard to do. A good place to start is a paper by with the depressing title “Why most published research findings are false”. I’d also suggest taking a look at work by presenting statistical evidence that this actually happens in psychology. There’s probably a lot more issues like this to think about, but that’ll do to start with. What I really want to point out is the blindingly obvious truth that real world science is conducted by actual humans, and only the most gullible of people automatically assumes that everyone else is honest and impartial. Actual scientists aren’t usually that naive, but for some reason the world likes to pretend that we are, and the textbooks we usually write seem to reinforce that stereotype. 1.6.8 Summary This chapter isn’t really meant to provide a comprehensive discussion of psychological research methods: it would require another volume just as long as this one to do justice to the topic. However, in real life statistics and study design are tightly intertwined, so it’s very handy to discuss some of the key topics. In this chapter, I’ve briefly discussed the following topics: Introduction to psychological measurement (Section [sec:measurement]). What does it mean to operationalise a theoretical construct? What does it mean to have variables and take measurements? Scales of measurement and types of variables (Section [sec:scales]). Remember that there are two different distinctions here: there’s the difference between discrete and continuous data, and there’s the difference between the four different scale types (nominal, ordinal, interval and ratio). Reliability of a measurement (Section [sec:reliability]). If I measure the “same” thing twice, should I expect to see the same result? Only if my measure is reliable. But what does it mean to talk about doing the “same” thing? Well, that’s why we have different types of reliability. Make sure you remember what they are. Terminology: predictors and outcomes (Section [sec:ivdv]). What roles do variables play in an analysis? Can you remember the difference between predictors and outcomes? Dependent and independent variables? Etc. Experimental and non-experimental research designs (Section [sec:researchdesigns]). What makes an experiment an experiment? Is it a nice white lab coat, or does it have something to do with researcher control over variables? Validity and its threats (Section [sec:validity]). Does your study measure what you want it to? How might things go wrong? And is it my imagination, or was that a very long list of possible ways in which things can go wrong? All this should make clear to you that study design is a critical part of research methodology. I built this chapter from the classic little book by , but there are of course a large number of textbooks out there on research design. Spend a few minutes with your favourite search engine and you’ll find dozens. References "],
["DescribingData.html", "Chapter 2 Describing Data 2.1 This is what too many numbers looks like 2.2 Look at the data 2.3 Important Ideas: Distribution, Central Tendency, and Variance 2.4 Measures of Central Tendency (Sameness) 2.5 Measures of Variation (Differentness) 2.6 Using Descriptive Statistics with data 2.7 Rolling your own descriptive statistics", " Chapter 2 Describing Data Far better an approximate answer to the right question, which is often vague, than an exact answer to the wrong question, which can always be made precise. —John W. Tukey Chapter by Matthew Crump This chapter is about descriptive statistics. These are tools for describing data. Some things to keep in mind as we go along are: There are lots of different ways to describe data There is more than one “correct” way, and you get to choose the most “useful” way for the data that you are describing It is possible to invent new ways of describing data, all of the ways we discuss were previously invented by other people, and they are commonly used because they are useful. Describing data is necessary because there is usually too much of it, so it doesn’t make any sense by itself. 2.1 This is what too many numbers looks like Let’s say you wanted to konw how happy people are. So, you ask thousands of people on the street how happy they are. You let them pick any number they want from negative infinity to positive infinity. Then you record all the numbers. Now what? Well, how about you look at the numbers and see if that helps you determine anything about how happy people are. What could the numbers look like. Perhaps something like this: 276 207 949 1111 540 -397 285 486 597 300 535 1082 119 148 18 -393 173 168 -237 898 169 -358 -1036 -122 1081 -813 822 387 375 96 468 -308 329 -317 971 -544 -636 143 278 832 102 -428 416 -162 -637 235 343 173 32 1046 733 448 515 535 407 532 -95 74 328 210 -416 1123 -330 -1177 393 1150 328 -51 859 -188 500 495 10 -148 -343 -860 202 -430 518 20 -139 -683 871 559 248 495 -563 -401 -224 -119 -968 -313 127 355 1027 -1178 714 -710 105 -141 454 334 205 50 -83 328 -907 -283 237 723 391 -312 501 215 496 -200 745 836 191 -335 649 -68 491 383 1193 646 450 654 186 380 -5 86 434 -370 849 702 263 405 542 105 -184 220 382 -570 1917 -988 -273 -1076 802 779 281 508 -156 289 319 -613 -360 -1025 -356 -54 317 367 86 -931 1 361 -495 -204 453 -430 173 -164 -204 541 -165 -108 -158 323 255 -193 -482 420 -33 276 -239 -503 704 -107 123 -382 -3 -76 71 -351 310 312 328 -490 -462 344 -1249 -439 162 209 333 6 201 591 1215 325 213 452 -9 376 669 733 259 -493 -162 678 -321 208 -331 509 -459 568 138 491 674 278 829 776 290 -735 -372 -447 528 -612 -390 672 522 48 612 -574 520 87 847 -137 -500 -23 283 315 681 -267 -252 236 827 -100 457 197 -853 473 -444 -252 501 -206 -253 -347 -325 202 712 687 -228 -31 -851 431 98 -74 -170 -220 -61 1604 -85 -1054 410 1001 -185 -562 404 1084 619 604 -623 970 172 -144 -229 -424 396 -651 390 -268 -64 244 -97 347 1232 -521 311 -39 -101 767 223 367 223 639 624 1040 -292 -34 -16 446 661 153 588 -418 113 1116 -440 -52 -97 470 799 488 6 964 -451 315 222 443 754 1121 -816 257 1070 1019 -353 133 -599 591 721 -47 38 340 956 936 137 366 -334 3 141 854 1028 -404 362 16 -312 -131 -314 1121 -417 -19 -338 -32 -346 -35 714 -721 267 111 -118 607 423 680 -577 -650 -643 -119 30 52 983 137 -26 734 52 215 589 274 -683 -432 295 -185 373 -712 -567 -373 484 394 -96 394 -153 453 -495 7 -569 -16 756 -751 599 -269 39 715 -98 749 -445 -191 366 549 1101 63 61 -34 836 195 519 627 183 -580 819 527 -462 811 -606 -768 905 -468 -622 -338 445 442 350 -895 89 994 881 96 1487 -167 -1025 -895 -352 595 320 935 -464 104 -211 -701 -1002 -120 254 29 59 739 279 508 -442 -516 -429 85 -582 452 -476 -10 88 -198 -784 787 -527 706 -65 1316 808 110 -485 -380 -136 664 593 1080 Now, what are you going to with that big pile of numbers? Look at it all day long?. When you deal with data, it will deal so many numbers to you that you will be overwhelmed by them. That is why we need ways to describe the data in a more manageable fashion. The complete description on the data is always the data itself. Descriptive statistics and other tools for describing data go one step further to summarize aspects of the data. Summaries are a way to compress the important bits of a thing down to a useful and manageable tidbit. It’s like telling your friends why they should watch a movie. When they ask what it is about, you don’t replay the entire movie for them, instead you hit the highlights. Summarizing the data is just like a movie preview, only for data. 2.2 Look at the data We already tried one way of looking at the numbers, and it wasn’t useful. Let’s look at some other ways of looking at the numbers in graphs. Graphing data by putting them in plots or figures can help us see the data. 2.2.1 Stop, plotting time (o o oh) U can plot this Let’s turn all of the numbers into dots, then show them in a graph. Note, when we do this we have not yet summarized anything about the data. Instead, in this step we just look at all of the data in a visual format, rather than looking at the numbers. Figure 2.1: Pretend happiness ratings from 500 people Figure 2.1 shows 500 measurements of happiness. The graph has two axes. The horizontal x-axis, going from left to right is labeled “Index”. The vertical y-axis, going up and down, is labelled “happiness”. Each dot represents one measurement of every person’s happiness from our pretend study. Before we talk about what we can and cannot see about the data, it is worth mentioning that the way you plot the data will make some things easier to see and some things harder to see. So, what can we now see about the data? There are lots of dots everywhere. It looks like there are 500 of them because the index goes to 500. It looks like some dots go as high as 1000-1500 and as low as -1500. It looks like there are more dots in the middleish area of the plot, sort of spread about 0. Take home: we can see all the numbers at once by putting them in a plot, and that is much easier and more helpful than looking at the raw numbers. Ok, so if these dots represent how happy 500 people are, what can we say about those people? First, the dots are kind of all over the place, so different people have different levels of happiness. Are there any trends? Are more people happy than unhappy, or vice versa? It’s hard to see that in the graph, so let’s make a different one, called a histogram 2.2.2 Histograms Making a histogram will be our first act of officially summarizing something about the data. We will no longer the individual bits of data, instead we will see how the numbers group together. Let’s look at a histogram of the happiness data, and then explain it. Figure 2.2: A histrogram of the happiness ratings The dots have disappeared, and now we some bars. Each bar is a summary of the dots, representing the number of dots (frequency count) inside a particular range of happiness, also called bins. For example, how many people gave a happiness rating between 0 and 500? Well, the fifth bar, the one between 0 and 500 and the x-xaxis, tells you how many? Look how tall that bar is. How tall is it? Well, the height is shown on the y-axis, which provides a frequency count (the number of dots or data points). It looks like around 150 people sad their happiness was between 0-500. More generally, we see there are many bins on the x-axis. We have divided the data into bins of 500. Bin #1 goes from -2000 to -1500, bin #2 goes from -1500 to -1000, and so until the last bin. To make the histogram, we just count up the number of data points falling inside each bin, then plot those frequency counts as a function of the bins. Voila, a histogram. What does the histogram help us see about the data? First, we can see the shape of data. The shape of the histogram refers to how it goes up and down. The shape tells us where the data is. For example, when the bars are low we know there isn’t much data there. When the bars are high, we know there is more data there. So, where is most of the data? It looks like it’s mostly in the middle two bins, between -500 and 500. We can also see the range of the data. This tells us the minimums and the maximums of the data. Most of the data is between -1500 and +1500, so no infite sadness or infinite happiness in our dataset. 2.3 Important Ideas: Distribution, Central Tendency, and Variance Let’s introduce a three important terms we will use alot, distribution, central tendency, and variance. These terms are similar to their everyday meanings (although I suspect most people don’t say central tendency very often). Distribution. When you order something from Amazon, where does it come from, and how does it get to your place? That stuff comes from one of Amazon’s distribution centers. They distribute all sorts of things by spreading them around to your doorstep. Distribute is spreading something. Notice, the histogram, distributes the data by spreading the numbers across the bins. We can also talk about a distribution as a noun. The histogram is a distribution of the frequency counts across the bins. Distributions are very, very, very, very, very important. They can have many different shapes. They can describe data, like in the histogram above. And as we will learn in later chapters, they can produce data. Many times we will be asking questions about where our data came from, and this usually means asking what kind of distribution could have created our data (more on that later.) Central Tendency is all about sameness. Is there anything similar about all of the numbers in the histogram? Yes, we can say that most of them are near 0. There is a tendency for most of the numbers to be centered near 0. Notice we are being cautious about our generalization about the numbers. We are not saying they are all 0. We are saying there is a tendency for many of them to be near zero. There are lots of ways to talk about the central tendency of some numbers. There can even be more than one kind of tendency. For example, if lots of the numbers were around -1000, and a simlar large amount of numbers were grouped around 1000, we could say there was two tendencies. Variance is all about differentness. Is there anything different about all of the numbers in the histogram? YES!!! The numbers are not all the same! When the numbers are not all the same, they must vary. So, the variance in the numbers refers to how the numbers are different. There are many ways to summarize the amount of variance in the numbers, and we discuss these very soon. 2.4 Measures of Central Tendency (Sameness) We’ve seen that we can get a sense of data by plotting dots in a graph, and by making a histogram. These tools show us what the numbers look like, approximately how big and small they are, and how similar and different they are from another. It is good to get a feeling about the numbers in this way. But, these visual sensitudes are not very precise. In addition to summarizing numbers with graphs, we can summarize numbers using numbers (NO, please not more numbers, we promise numbers can be your friend). 2.4.1 From many numbers to one Measures of central have one important summary goal: to reduce a pile of numbers to a single number that we can look at. We already know looking at thousands of numbers is hopeless. Wouldn’t it be nice if we could just look at one number instead? We think so. It turns out there are lots of ways to do this. Then, if your friend ever asks the frightening question, “hey, what are all these numbers like?”. You can say they are like this one number right here. But, just like in Indiana Jones and the Last Crusade (highly recommended movie), you must choose your measure of central tendency wisely. 2.4.2 Mode The mode is the most frequently occuring number in your measurement. That is it. How do you find it? You have count the number of times each number appears in your measure, then whichever one occurs the most, is the mode. Example: 1 1 1 2 3 4 5 6 The mode of the above set is 1, which occurs three times. Every other number only occurs once. Ok fine. What happens here: Example: 1 1 1 2 2 2 3 4 5 6 Hmmm, now 1 and 2 both occur three times each. What do we do? We say there are two modes, and they are 1 and 2. Why is the mode a measure of central tendency? Well, when we ask, “what are my numbers like”, we can say, “most of the number are, like a 1 (or whatever the mode is)”. Is the mode a good measure of central tendency? Well, that depends on your numbers. For example, consider these numbers 1 1 2 3 4 5 6 7 8 9 Here, the mode is 1 again, because there are two 1s, and all of the other numbers occur once. But, are most of the numbers like, a 1. No, they are mostly not 1s. “Argh, so should I or should I not use the mode? I thought this class was supposed to tell me what to do?”. There is no telling you what to do. Everytime you use a tool in statistics you have to think about what you are doing and justify why what you are doing makes sense. Sorry. 2.4.3 Median The median is the exact middle of the data. After all, we are asking about central tendency, so why not go to the center of the data and see where we are. What do you mean middle of the data? Let’s look at these numbers: 1 5 4 3 6 7 9 Umm, ok. So, three is in the middle? Isn’t that kind of arbitrary. Yes. Before we can compute the median, we need to order the numbers from smallest to largest. 1 3 4 5 6 7 9 Now, 5 is in the middle. And, by middle we mean in the middle. There are three numbers to the left of 5, and three numbers to the right. So, five is definetely in the middle. Ok fine, but what happens when there aren’t an even number of numbers? Then the middle will be missing right? let’s see 1 2 3 4 5 6 There is no number between 3 and 4, the middle is empty. In this case, we compute the median by figuring out the number in between 3 and 4. So, the median would be 3.5. Is the median a good measure of central tendency? Sure, it is often very useful. One property of the median is that it stays in the middle even when some of the other numbers get really weird. For example, consider these numbers: 1 2 3 4 4 4 5 6 6 6 7 7 1000 Most of these numbers are smallish, but the 1000 is a big old weird number, very different from the rest. The median is still 5, because it is in the middle of these ordered numbers. We can also see that five is pretty similar to most of the numbers (except for 1000). So, the median does a pretty good job of representing most of the numbers in the set, and it does so even if one or two of the numbers are very different from the others. Finally, outlier is a term will we use to describe numbers that appear in data that are very different from the rest. 1000 is an outlier, because it lies way out there on the number compared to the other numbers. What to do with outliers is another topic we cover later in the book. 2.4.4 Mean Have you noticed this is a textbook about statistics that hasn’t used a formula yet? That is about to change, but for those of you with formula anxiety, don’t worry, we will do our best to explain them. The mean is also called the average. And, we’re guessing you might already now what the average of a bunch of numbers is? It’s the sum of the numbers, divided by the number of number right? How do we express that idea in a formula? Just like this: \\(Mean = \\bar{X} = \\frac{\\sum_{i=1}^{n} x_{i}}{N}\\) “That looks like Greek to me”. Yup. The \\(\\sum\\) symbol is calleged sigma, and it stands for the operation of summing. The little “i” on the bottom, and the little “n” on the top refers to all of the numbers in the set, from the first number “i” to the last number “n”. The letters are just arbitrary labels, called variables that we use for descriptive purposes. The \\(x_{i}\\) refers to individual numbers in the set. We sum up all of the numbers, then divide the sum by \\(N\\), which is the total number of numbers. Sometime you will see \\(\\bar{X}\\) to refer to the mean of all of the numbers inside \\(X_{i}\\), which refers to all of our numbers. In plain english, the formula looks like: \\(mean = \\frac{\\text{Sum of my numbers}}{\\text{Count of my numbers}}\\) “Well, why didn’t you just say that?”. We just did. Let’s compute the mean for these five numbers: 3 7 9 2 6 Add em up: 3+7+9+2+6 = 27 Count em up: \\(i_{1}\\) = 3, \\(i_{2}\\) = 7, \\(i_{3}\\) = 9, \\(i_{4}\\) = 2, \\(i_{5}\\) = 6; N=5, because \\(i\\) went from 1 to 5 Divide em: mean = 27 / 5 = 5.4 Or, to put the numbers in the formula, it looks like this: \\(Mean = \\bar{X} = \\frac{\\sum_{i=1}^{n} x_{i}}{N} = \\frac{3+7+9+2+6}{5} = \\frac{27}{5} = 5.4\\) Ok fine, that is how to compute the mean. But, like we imagined, you probably already knew that, and if you didn’t that’s ok, now you do. What’s next? Is the mean a good measure of central tendency? You should know now the answer to this question is: it depends. 2.4.5 What does the mean mean? It is not enough to know the formula for the mean, or to be able to use the formula to compute a mean for a set of numbers. We believe in your ability to add and divide numbers. What you really need to know is what the mean really “means”. This requires that you know what the mean does, and not just how to do it. Puzzled? Let’s explain. Can you answer this question: What happens when you divide a sum of numbers by the number of numbers? What are the consequences of doing this? What is the formula doing? What kind of properties does the result give us? FYI, the answer is not that we compute the mean. Ok, so what happens when you divide any number by another number? Of course, the key word here is divide. We literally carve the number up top in the numerator into pieces. How many times do we split the top number? That depends on the bottom number in the denominator. Watch: \\(\\frac{12}{3} = 4\\) So, we know the answer is 4. But, what is really going on here is that we are slicing and dicing up 12 aren’t we. The answer 4 tells us that we can slice and dice 12 up into three perfect pieces. So, now we are thinking of 12 as three different pieces \\(= 4 + 4 + 4\\). I know this will be obvious, but what kind of properties do our pieces have? You mean the fours? Yup. Well, obviously they are all fours. Yes. The pieces are all the same size. They are all equal. So, division equalizes the numerator by the denominator… “Umm, I think I learned this in elementary school, what does this have to do with the mean?”. The number on top of the formula for the mean is just another numerator being divided by a denominator isn’t it. In this case, the numerator is a sum of all the values in your data. What if it was the sum of all of the happiness ratings? We saw earlier that there were 500 people gave different ratings. The sum of all of them would just be a single number adding up all the different ratings. If we split the sum up into equal parts representing one part for each person’s happiness what would we get? We would get 500 identical and equal numbers for each person. It would be like taking all of the happiness in the world, then dividing it up equally, then to be fair, giving back the same equal amount of happiness to everyone in the world. This would make some people more happy than they were before, and some people less happy right. Of course, that’s because it would be equalizing the distribution of happiness for everybody. This process of equalization by dividing something into equal parts is what the mean does. See, it’s more than just a formula. It’s an idea. This is just the beginning of thinking about these kinds of ideas. We will come back to this idea about the mean, and other ideas, in later chapters. Pro tip: The mean is the one and only number that can take the place of every number in the data, such that when you add up all the equal parts, you get back the original sum of the data. 2.5 Measures of Variation (Differentness) What did you do when you wrote essay’s in high school about a book you read? Probably compare and contrast something right? When you summarize data, you do the same thing. Measures of central tendency give us something like comparing does, it tells us stuff about what is the same. Measures of Variation give us something like contrasting does, it tells us stuff about what is different. First, we note that whenever you see a bunch of numbers that aren’t the same, you already know there are some differences. This means the numbers vary, and there is variation in the size of the numbers. 2.5.1 The Range Consider these 10 numbers, that I already ordered from smallest to largest for you: 1 5 4 3 6 5 7 8 9 24 The numbers have variation, because they are not all the same. We can use the range to describe the width of the variation. The range refers to the minimum (smallest value) and maximum (largest value) in the set. So, the range would be 1 and 24. The range is a good way to quickly summarize the boundaries of your data in just two numbers. By computing the range we know that none of the data is larger or smaller than the range. And, it can alert you to outliers. For example, if you are expecting your numbers to be between 1 and 7, but you find the range is 1 - 340,500, then you know you have some big numbers that shouldn’t be there, and then you can try to figure out why those numbers occured (and potentially remove them if something went wrong). 2.5.2 The Difference Scores It would be nice to summarize the amount of differentness in the data. Here’s why. If you thought that raw data (lots of numbers) is too big to look at, then you will be frightened to contemplate how many differences there are to look at. For example, these 10 numbers are easy to look at: 1 5 4 3 6 5 7 8 9 24 But, what about the difference between the numbers, what do those look like? We can compute the difference scores between each number, then put them in a matrix like the one below: 1 5 4 3 6 5 7 8 9 24 1 0 4 3 2 5 4 6 7 8 23 5 -4 0 -1 -2 1 0 2 3 4 19 4 -3 1 0 -1 2 1 3 4 5 20 3 -2 2 1 0 3 2 4 5 6 21 6 -5 -1 -2 -3 0 -1 1 2 3 18 5 -4 0 -1 -2 1 0 2 3 4 19 7 -6 -2 -3 -4 -1 -2 0 1 2 17 8 -7 -3 -4 -5 -2 -3 -1 0 1 16 9 -8 -4 -5 -6 -3 -4 -2 -1 0 15 24 -23 -19 -20 -21 -18 -19 -17 -16 -15 0 We are looking at all of the possible differences between each number and every other number. So, in the top left, the difference between 1 and itself is 0. One column over to the right, the difference between 5 and 1 (5-1) is 4, etc. As you can see, this is a 10x10 matrix, which means there are 100 differences to look at. Not too bad, but if we had 500 numbers, then we would have 500*500 = 250,000 differences to look at (go for it if you like looking at that sort of thing). Pause for a simple question. What would this matrix look like if all of the 10 numbers in our data were the same number? It should look like a bunch of 0s right? Good. In that case, we could easily see that the numbers have no variation. But, when the numbers are different, we can see that there is a very large matrix of difference scores. How can we summarize that? How about we apply what we learned from the previous section on measures of central tendency. We have a lot of differences, so we could ask something like, what is the average difference that we have? So, we could just take all of our differences, and compute the mean difference right? What do you think would happen if we did that? Let’s try it out on these three numbers: 1 2 3 1 2 3 1 0 1 2 2 -1 0 1 3 -2 -1 0 You might already guess what is going to happen. Let’s compute the mean: \\(\\text{mean of difference scores} = \\frac{0+1+2-1+0+1-2-1+0}{9} = \\frac{0}{9} = 0\\) Uh oh, we get zero for the mean of the difference scores. This will always happen whenever you take the mean of the difference scores. We can see that there are some differences between the numbers, so using 0 as the summary value for the variation in the numbers doesn’t make much sense. Furthermore, you might also notice that the matrices of difference scores are redundant. The diagonal is always zero, and the top numbers are the same as the bottom numbers, except their signs are reversed. These are little problems that can be solved by computing the variance and the standard deviation. For now, the standard deviation is a just a trick that we use to avoid getting a zero. But, later we will see it has properties that are important for other reasons. 2.5.3 The Variance Variability, variation, variance, vary, variable, varying, variety. Confused yet? Before we describe the variance, we want to you be ok with how this word is used. First, don’t forget the big picture. We know that variability and variation refers to the big idea of differences between numbers. We can even use the word variance in the same way. When numbers are different, they have variance. The formulas for variance and standard deviation depend on whether you think your data represents an entire population of numbers, or is sample from the population. We discuss this issue in later on. For now, we divide by N, later we discuss why you will often divide by N-1 instead. The word variance also refers to a specific summary statistic, the sum of the squared deviations from the mean. Hold on what? Plain english please. The variance is the sum of the squared difference scores, where the difference scores are computed between each score and the mean. What are these scores? The scores are the numbers in the data set. Let’s see the formula in English first: \\(variance = \\frac{\\text{Sum of squared difference scores}}{\\text{Number of Scores}}\\) 2.5.3.1 Deviations from the mean, Difference scores from the mean We got a little bit complicated before when we computed the difference scores between all of the numbers in the data. Let’s do it again, but in more manageable way. This time, we calculate the difference between each score and the mean. The idea here is We can figure out how similar our scores our by computing the mean Then we can figure out how different our scores our from the mean This could tell us, 1) something about whether our scores are really all very close to the mean (which could help us know if the mean is good representative number of the data), and 2) something about how much differences there are in the numbers. Take a look at this table: scores values mean Difference_from_Mean 1 1 4.5 -3.5 2 6 4.5 1.5 3 4 4.5 -0.5 4 2 4.5 -2.5 5 6 4.5 1.5 6 8 4.5 3.5 Sums 27 27 0 Means 4.5 4.5 0 The first column shows we have 6 scores in the dataset, and the ‘value’ columns shows each score. The sum of the values, and the mean is presented on the last two rows. These values were obtained by \\(\\frac{1+6+4+2+6+8}{6} = \\frac{27}{6} = 4.5\\). The third column ‘mean’, appears a bit silly. We are just listing the mean once for every score. If you think back to our discussion about the meaning of the mean, then you will remember that it equally distributes the total sum across each datapoint. We can see that here, if we treat each score as the mean, then every score is a 4.5. We can also see that adding up all of the means for each score gives us back 27, which is the sum of the original values. Also, we see that if we find the mean of the mean scores, we get back the mean (4.5 again). All of the action is occuring in the fourth column, ‘Difference_from_Mean’. Here, we are showing the difference scores from the mean, using \\(X_{i}-\\bar{X}\\). In other words, we subtracted the mean from each score. So, the first score, 1, is -3.5 from the mean, the second score, 6, is +1.5 from the mean, and so on. Now, we can look at our original scores, and we can look at their differences from the mean. Notice, we don’t have a matrix of raw difference scores, so it is much easier to look at out. But, we still have a problem. We can see that there are non-zero values in the difference scores. But, when we add them all up, we still get zero, which makes it seem like there are a total of zero differences in the data…Why does this happen…and what to do about it? 2.5.3.2 The mean is the balancing point in the data One brief pause here to point out another wonderful property of the mean. It is the balancing point in the data. If you take a pen or pencil and try to balance it on your figure so it lays flat what are you doing. You need to find the center of mass in the pen, so that have of it is one side, and the other half is on ther other side. That’s how balancing works. One side = the other side. We can think of data as having mass or weight to it. If we put our data on our bathroom scale, we could figure out how heavy it was by summing it up. If we wanted to split the data down the middle so that half of it’s weight was equal to the other half, then we could balance the data on top of a pin. The mean of the data tells you where to put the pin. It is the location in the data, where on the one side the numbers add to the same sum as the numbers on the other side. If we think this through, it means that the sum of the difference scores from the mean will always add up to zero. This is because the numbers on one side of the mean will always add up to -x (whatever the sum of those numbers is), and the numbers of the other side of the mean will always add up to +x (which will be the same value only positive). And: \\(-x + x = 0\\), right. Right. 2.5.3.3 The squared deviations Some devious someone devined a solution to the fact that differences scores from the mean always add to zero. Can you think of any solutions? For example, what could you do to the difference scores so that you could add them up, and they would weigh something useful, that is they would not be zero? The devious solution is to square the numbers. Squaring numbers converts all the negative numbers to positive numbers. For example, \\(2^2 = 4\\), and \\(-2^2 = 4\\). Remember how squaring works, we multiply the number twice: \\(2^2 = 2*2 = 4\\), and \\(-2^2 = -2*-2 = 4\\). We use the term squared deviations to refer to differences scores that have been squared. Deviations are things that move away from something. The difference scores move away from the mean, so we also call them deviations. Let’s look at our table again, but add the squared deviations. scores values mean Difference_from_Mean Squared_Deviations 1 1 4.5 -3.5 12.25 2 6 4.5 1.5 2.25 3 4 4.5 -0.5 0.25 4 2 4.5 -2.5 6.25 5 6 4.5 1.5 2.25 6 8 4.5 3.5 12.25 Sums 27 27 0 35.5 Means 4.5 4.5 0 5.91666666666667 Ok, now we have new column called squared_deviations. These are just the difference scores squared. So, \\(-3.5^2 = 12.25\\), etc. You can confirm for yourself with your cellphone calculator. Now that all of the squared deviations are positive, we can add them up. When we do this create something very special called the sum of squares (SS), also known as the sum of the squared deviations from the mean. We will talk at length about this SS later on in the ANOVA chapter. So, when you get there, remember that you already know what it is, just some sums of some squared deviations, nothing fancy. 2.5.3.4 Finally, the variance Guess what, we already computed the variance. It already happened, and maybe you didn’t notice. “Wait, I missed that, what happened?”. First, see if you can remember what we are trying to do here. Trying pausing before reading to see you if can tell yourself what problem we are trying solve. Without further ado, we are trying to get a summary of the differences in our data. There are just as many difference scores from the mean as there are data points, which can be alot, so it would be nice to have a single number to look at, something like a mean, that would tell us about the average differences in the data. If you look at the table, you can see already computed the mean of the squared deviations. First, we found the sum (SS), then below that we calcuated the mean = 5.916 repeating. This is the variance. The variance is the mean of the sum of the squared deviations: \\(variance = \\frac{SS}{N}\\), where SS is the sum of the squared deviations, and N is the number of observations. Ok, now what. What do I do with the variance? What does this number mean? Good question. The variance is often an unhelpful number to look at. Why? Because it is not in the same scale as the original data. This is because we sqared the difference scores before taking the mean. Squaring produces large numbers. For example, we see a 12.25 in there. That’s a big difference, bigger than any difference between any two original values. What to do? How can we bring the numbers back down to their original unsquared size? If you are thinking about taking the square root, that’s a ding ding ding, correct answer for you. We can always unsquare anything by taking the square root. So, let’s do that to 5.916. \\(\\sqrt{5.916} =\\) 2.4322829. 2.5.4 The Standard Deviation Oops, we did it again. We already computed the standard deviation, and we didn’t tell you. The standard deviation is the square root of the variance…At least, it is right now, until we complicate matters for you in the next chapter. Here is the formula for the standard deviation: \\(\\text{standard deviation} = \\sqrt{Variance} = \\sqrt{\\frac{SS}{N}}\\). We could also expand this to say: \\(\\text{standard deviation} = \\sqrt{\\frac{\\sum_{i}^{n}({x_{i}-\\bar{x})^2}}{N}}\\) Don’t let those big square root signs put you off. Now, you know what they are doing there. Just bringing our measure of the variance back down to the original size of the data. Let’s look at our table again: scores values mean Difference_from_Mean Squared_Deviations 1 1 4.5 -3.5 12.25 2 6 4.5 1.5 2.25 3 4 4.5 -0.5 0.25 4 2 4.5 -2.5 6.25 5 6 4.5 1.5 2.25 6 8 4.5 3.5 12.25 Sums 27 27 0 35.5 Means 4.5 4.5 0 5.91666666666667 We measured the standard deviation as 2.4322829. Notice this number fits right in the with differences scores from the mean. All of the scores are kind of in and around + or - 2.4322829. Whereas, if we looked at the variance, 5.916 is just too big, it doesn’t summarize the actual differences very well. What does all this mean? Well, if someone told they had some number with a mean of 4.5 (like the values in our table), and a standard deviation of 2.4322829, you would get a pretty good summary of the numbers. You would know that lots of the numbers are spread about 4.5, and are + or - 2.4322829 from 4.5. That’s a good start for describing numbers. If you had loads of numbers, you could reduce them down to the mean and the standard deviation, and still be pretty well off in terms of getting a sense of those numbers. 2.6 Using Descriptive Statistics with data Example here: 2.7 Rolling your own descriptive statistics We spent many paragraphs talking about variation in numbers, and how to use calculate the variance and standard deviation to summarize the average differences between numbers in a data set. The basic process was to 1) calculate some measure of the differences, then 2) average the differences to create a summary. We found that we couldn’t average the raw difference scores, because we would always get a zero. So, we squared the differencs from the mean, then averaged the squared differences differences. Finally, we square rooted our measure to bring the summary back down to the scale of the original numbers. Perhaps you haven’t heard, but there is more than one way to skin a cat, but we prefer to think of this in terms of petting cats, because some of us love cats. Jokes aside, perhaps you were also thinking that the problem of summing differences scores (so that they don’t equal zero), can be solved in more than one way. Can you think of a different way, besides squaring? 2.7.1 Absolute deviations How about just taking the absoluate value of the difference scores. Remember, the absolute value converts any number to a positive value. Check out the following table: scores values mean Difference_from_Mean Absolute_Deviations 1 1 4.5 -3.5 3.5 2 6 4.5 1.5 1.5 3 4 4.5 -0.5 0.5 4 2 4.5 -2.5 2.5 5 6 4.5 1.5 1.5 6 8 4.5 3.5 3.5 Sums 27 27 0 13 Means 4.5 4.5 0 2.16666666666667 This works pretty well too. By converting the difference scores from the mean to positive values, we can now add them up and get a non-zero value (if there are differences). Then, we can find the mean of the sum of the absolute deviations. If we were to map the terms sum of squares (SS), variance and standard deviation onto these new measures based off of the absolute deviation, how would the mapping go? For example, what value in the table corresponds to the SS? That would be the sum of absolute deviations in the last column. How about the variance and standard deviation, what do those correspond to? Remember that the variance is mean (\\(SS/N\\)), and the standard deviation is a square-rooted mean (\\(\\sqrt{SS/N}\\)). In the table above we only have one corresponding mean, the mean of the sum of the absolute deviations. So, we have a variance measure that does not need to be square rooted. We might say the mean absolute deviation, is doing double-duty as a variance and a standard-deviation. Neat. 2.7.2 Other sign-inverting operations In principle, we could create lots of different summary statistics for variance that solve the summing to zero problem. For example, we could raise every difference score to any even numbered power beyond 2 (which is the square). We could use, 4, 6, 8, 10, etc. There is an infinity of even numbers, so there is an infinity of possible variance statistics. We could also use odd numbers as powers, and then take their absolute value. Many things are possible. The important aspect to any of this is to have a reason for what you are doing, and to choose a method that works for the data-analysis problem you are tring to solve. Note also, we bring up this general issue because we want you to understand that statistics is a creative exercise. We invent things when we need them, and we use things that have already been invented when they work for the problem at hand. "],
["Correlation.html", "Chapter 3 Correlation 3.1 If something caused something else to change, what would that look like? 3.2 Pearson’s r 3.3 Turning the numbers into a measure of co-variance 3.4 Examples with Data 3.5 Interpreting Correlations", " Chapter 3 Correlation Correlation does not equal causation —Every Statistics and Research Methods Instructor Ever Chapter by Matthew Crump In the last chapter we had some data. It was too much too look at and it didn’t make sense. So, we talked about how to look at the data visually using plots and histograms, and we talked about how to summarize lots of numbers so we could determine their central tendencies (sameness) and variability (differentness). And, all was well with the world. Let’s not forget the big reason why learned about descriptive statistics. The big reason is that we are interested in getting answers to questions using data. If you are looking for a thread to think about the whole way through this big, that thread is: how do we ask an answer questions using data? For every section in this book, you should be connecting your inner monologe to this question, and asking yourself: How does what I am learning about help me answer questions with data? Advance warning, we know it is easy to forget this stuff when we dive into the details, and we will try to throw you a rope to help you out along the way. We started Chapter two with some fake data on human happiness, remember? We imagined that we asked a bunch of people to tell us how happy they were, then we looked at the numbers they gave us. Let’s continue with this imaginary thought experiment. What do you get when ask people to use a number to describe how happy they are? A bunch of numbers. What kind of questions can you ask about those numbers? Well, you can look at the numbers and estimate their general properties as we already did. We would expect to find what we can imagine to be true. There are different people, and different people are different amounts of happy. You’ve probably met some of those of really happy people, and really unhappy people, and you yourself probably have some amount of happiness. “Great, thanks captain obvious”. Before moving on, you should also be skeptical of what the numbers might mean. For example, if you force people to give a number between 0-100 to rate their happiness, does this number truly reflect how happy that person is? Can a person know how happy they are? Does the question format bias how they give their answer? Is happiness even a real thing? These are all good questions about the validity of the construct (happiness itself) and the measure (numbers) you are using to quantify it. For now, though, we will side-step those very important questions, and assume that, happiness is a thing, and our measure of happiness measures something about how happy people are. Ok then, after we have measured some happiness, I bet you can think of some more pressing questions. For example, what causes happiness to go up or down. If you knew the causes of happiness what could you do? How about increase your own happiness, or help people who are unhappy, or better appreciate why Eeyore is unhappy, or present valid scientific arguments that argue against incorrect claims about what causes happiness. A causal theory and understanding of happiness could be used for all of those things. How can we get there? Imagine you were an alien observer. You arrived on earth and heard about this thing called happiness that people have. You want to know what causes happiness. You also discover that the planet earth has lots of other things. Which of those things, you wonder, cause happiness? How to get started on this big question. As a person who has happiness, you might already have some hunches. For example things like: weather, friends, music, money, education, drugs, books, movies, perspective, personality, color of your shoes, eyebrow length, number of cat’s you see per day, frequency of subway delay, a lifetime supply of chocolate, etcetera etcetera (as Willy Wonka would say). There could be many different causes of happiness. 3.1 If something caused something else to change, what would that look like? Before we go around determining the causes of happiness, we should prepare ourselves with some analytical tools so that we could identify what causation looks like. If we don’t prepare ourselves for what we might find, then we won’t know how to interpret our own data. Instead, we need to anticipate what the data could look like. Specifically, we need to know what data would look like when one thing does not cause another thing, and what data would look like when one thing does cause another thing. This chapter does some of this preparation. Fair warning. We will find out some tricky things. For example, we can find patterns that look like one thing is causing another, even when that one thing DOES NOT CAUSE the other thing. Hang in there. 3.1.1 Charlie and the Chocolate factory Let’s imagine that a person’s supply of chocolate has a causal influence on their level of happiness. Let’s further imagine that, like Charlie, the more chocolate you have the more happy you will be, and the less chocolate you have, the less happy you will be. Finally, because we suspect happyness is caused by lots of other things in a person’s life, we anticipate that the relationship between chocolate supply and happyness won’t be perfect. What do these assumptions mean for how the data should look? Our first step is to collect some imaginary data from 100 people. We walk around and ask the first 100 people we meet to answer two questions: 1) how much chocolate do you have, and 2) how happy are you. For convenvience, both the scales will go from 0 - 100. For the chocolate scale, 0 means no chocolate, 100 means lifetime supply of chocolate, and any other number is somewhere in between. For the happiness scale, 0 means no happiness, 100 means all of the happiness, and in between means some amount in between. Here is some sample data from the first 10 imaginary subjects. subject chocolate happiness 1 1 1 2 2 2 3 2 2 4 3 3 5 3 4 6 5 6 7 7 5 8 5 6 9 5 8 10 6 9 Of course, we asked each subjects two questions, so there are two scores for each subject, one for their chocolate supply, and one for their level of happiness. You might already notice some relationships between amount of chocolate and level of happiness in the table. To make those relationships even more clear, let’s plot all of the data in a graph. 3.1.2 Scatterplots When you have two measurements worth of data, you can always turn them into dots and plot them in a scatter plot. A scatterplot has a horizontal x-axis, and a veritcal y-axis. You get to choose which measurement goes on which axis. Let’s put chocolate supply on the x-axis, and happiness level on the y-axis. The plot below shows 100 dots for each subject. You might be wondering, why are there only 100 dots for the data. Didn’t we collect 100 measures for chocolate, and 100 measures for happiness, shouldn’t there be 200 dots? Nope. Each dot is for one subject, there are 100 subjects, so there are 100 dots. What do the dots mean? Each dot has two coordinates, an x-coordinate for chocolate, and a y-coordinate for happiness. The first dot, all the way on the bottom left is the first subject in the table, who had close to 0 chocolate and close to zero happiness. You can look at any dot, then draw a straight line down to the x-xaxis: that will tell you have much chocolate that subject has. You can draw a straight line left to the y-axis: that will tell you how much happiness the subject has. Now that we are looking at the scatterplot, we can see many things. One, the dots are scattered around a bit aren’t they, hence scatterplot. Even when the dot’s don’t scatter, they’re still called scatterplots, perhaps because those pesky dots in real life have so much scatter all the time. More important, the dots show a relationship between chocolate supply and happiness. Happiness is lower for people with smaller supplies of choclate, and higher for people with larger supplies of chocolate. It looks like the more chocolate you have the happier you will be, and vice versa. This kind of relationship is called a positive correlation. 3.1.3 Positive, Negative, and No-Correlation Seeing as we are in the business of imagining data, let’s imagine some more. We’ve already imagined what data would look like if larger chocolate supplies increase happiness. We’ll show that again in a bit. What do you imagine the scatterplot would look like if the relationship was reversed, and larger chocolate supplies decreased happiness. Or, what do you imagine the scatterplot would look like if there was no relationship, and the amount of chocolate that you have doesn’t do anything to your happiness. We invite your imagination to look at these graphs: The first panel shows a negative correlation. Happiness goes down as chocolate supply increases. Negative correlation occurs when one thing goes up and the other thing goes down; or, when more of X is less of Y, and vice versa. The second panel shows a positive correlation. Happiness goes up as chocolate as chocolate supply increases. Postive correlation occurs when both things go up togetehr, and go down together: more of X is more of Y, and vice versa. The third panel shows no correlation. Here, there doesn’t appear to be any obvious relationship between chocolate supply and happiness. The dots are scattered all over the place, the truest of the scatterplots. Zero correlation occurs when one thing is not related in any way to another another. Changes in X do not relate to any changes in Y, and vice-versa. 3.2 Pearson’s r If Beyoncé was a statistician, she might look at these scatterplots and want to “put a number on it”. We think this is a good idea too. We’ve already learned how to creative descriptive statistics for a single measure, like chocolate, or happiness (i.e., means, variances, etc.). Is it possible to create a descriptive statistic that summarized the relationship between two measures, all in one number? Can it be done? Karl Pearson to the rescue. There’s a statistic for that, and Karl Pearson invented it. Everyone now calls it, “Pearson’s r”. We will find out later that Karl Pearson was a big-wig editor at Biometrika in the 1930s. He took a hating to another big-wig statisticain, Sir Ronald Fisher (who we learn about later), and they some stat fights…why can’t we all just get along in statistics. How does Pearsons’ r work? Let’s look again at the first 10 subjects in our fake experiment: subject chocolate happiness 1 1 1 2 2 2 3 2 2 4 3 3 5 3 4 6 5 6 7 7 5 8 5 6 9 5 8 10 6 9 Sums 39 46 Means 3.9 4.6 What could we do to these numbers to produce a single, summary value, that represents the relationship between the chocolate supply and happiness? 3.2.1 The idea of co-variance “Oh please no, don’t use the word variance again”. Yes, we’re doing it, we’re going to use the word variance again, and again, until it starts making sense. Remember what variance means about some numbers. It means the numbers have some change in them, they are not all the same, some of them are big, some are small. We can see that there is variance in chocolate supply across the 10 subjects. We can see that there is variance in happiness across the 10 subjects. We also saw in the scatterplot, that happiness increases as chocolate supply increases; which is a positive relationship, a positive correlation. What does this have to do with variance? Well, it means there is a relationship between the variance in chocolate supply, and the variance in happiness levels. The two measures vary together don’t they? When we have two measures that vary together, they are like a happy couple who share their variance. This is what co-variance refers to, the idea that the pattern of varying numbers in one measure is shared by the pattern of varying numbers in another measure. Co-variance is very, very, very ,very important. We suspect that the word co-variance is initially confusing, especially if you are not yet fully comfortable with the meaning of variance for a single measure. Nevertheless, we must proceed and use the idea of co-variance over and over again to firmly implant into your statistical mind (we already said, but redundancy works, it’s a thing). Pro tip: Three-legged race as a metaphor for co-variance. Two people tie one leg to each other, then try to walk. It works when they co-vary their legs together (positive relationship). They can also co-vary in an unhelpful way, when one person tries to move forward exactly when the other person tries to move backward. This is still co-variance (negative relationship). Funny random walking happens when there is no co-variance. This means one person does whatever they want, and so does the other person. There is a lot of variance, but the variance is shared randomly, so it’s just a bunch of legs moving around accomplishing nothing. Pro tip #2: Succesfully playing paddycake occurs when two people coordinate their actions so they have postively shared co-variance. 3.3 Turning the numbers into a measure of co-variance “Ok, so if you are saying that co-variance is just another word for correlation or relationship between two measures, I’m good with that. I suppose we would need some way to measure that.” Correct, back to our table…notice anything new? subject chocolate happiness Chocolate_X_Happiness 1 1 1 1 2 2 2 4 3 2 2 4 4 3 3 9 5 3 4 12 6 5 6 30 7 7 5 35 8 5 6 30 9 5 8 40 10 6 9 54 Sums 39 46 219 Means 3.9 4.6 21.9 We’ve added a new column called “Chocolate_X_Happiness”, which translates to Chocolate scores multiplied by Happiness scores. Each row in the new column, is the product, or multiplication of the chocolate and happiness score for that row. Yes, but why would we do this? Last chapter we took you back to Elementary school and had you think about division. Now it’s time to do the same thing with multiplication. We assume you know how that works. One number times another, means taking the first number, and adding it as many times as the second says to do, \\(2*2= 2+2=4\\), \\(2*6= 2+2+2+2+2+2 = 12\\), or \\(6+6=12\\), same thing. Yes, you know all that. But, can you bend multiplication to your will, and make it do your bidding when need to solve a problem like summarizing co-variance? Multiplication is the droid you are looking for. We know how to multiple numbers, and all we have to next is think about the consequences of multiplying sets of numbers together. For example, what happens when you multiply two small numbers together, compared to multiplying two big numbers together? The first product should be smaller than the second product right? How about things like multiplying a small number by a big number? Those products should be in between right?. Then next step is to think about how the products of two measures sum together, depending on how they line up. Let’s look at another table: scores X Y A B XY AB 1 1 1 1 10 1 10 2 2 2 2 9 4 18 3 3 3 3 8 9 24 4 4 4 4 7 16 28 5 5 5 5 6 25 30 6 6 6 6 5 36 30 7 7 7 7 4 49 28 8 8 8 8 3 64 24 9 9 9 9 2 81 18 10 10 10 10 1 100 10 Sums 55 55 55 55 385 220 Means 5.5 5.5 5.5 5.5 38.5 22 Look at the X and Y column. The scores for X and Y perfectly co-vary. When X is 1, Y is 1; when X is 2, Y is 2, etc. They are perfectly aligned. The scores for A and B also perfectly co-vary, just in the opposite manner. When A is 1, B is 10; when A is 2, B is 9, etc. B is a reversed copy of A. Now, look at the column \\(XY\\). These are the products we get when we multiply the values of X across with the values of Y. Also, look at the column \\(AB\\). These are the products we get when we multiply the values of A across with the values of B. So far so good. Now, look at the Sums for the XY and AB columns. Not the same. The sum of the XY products is 385, and the sum of the AB products is 220. For this specific set of data, the numbers 385 and 220 are very important. They represent the biggest possible sum of products (385), and the smallest possible sum of products (220). There is no way of re-ordering the numbers 1 to 10, say for X, and the numbers 1 to 10 for Y, that would ever produce larger or smaller numbers. Don’t believe me? Check this out: The above graph shows 1000 computer simuations. I forced my computer to randomly order the numbers 1 to 10 for X, and randomly order the numbers 1 to 10 for Y. Then, I multiplied X and Y, and added the products together. I did this 1000 times. The dot’s show the sum of the products for each simluation. The two black lines show the maximum possible sum (385), and the minimum possible sum (220), for this set of numbers. Notice, how all of the dots are in between the maximum and minimum possible values. Told you so. “Ok fine, you told me so…So what, who cares?”. We’ve been looking for a way to summarize the covariance between two measures right? Well, for these numbers, we have found one, haven’t we. It’s the sum of the products. We know that when the sum of the products is 385, we have found a perfect, positive correlation. We know, that when the sum of the products is 220, we have found a perfect negative correlation. What about the numbers in between. What we could conclude about the correlation if we found the sum of the products to be 350. Well, it’s going to be positive, because it’s close to 385, and that’s perfectly positive. If the sum of the products was 240, that’s going to be negative, because it’s close to the perfectly negatively correlating 220. What about no correlation? Well, that’s going to be in the middle between 220 and 385 right. We have just come up with a data-specific summary measure for the correlation between the numbers 1 to 10 in X, and the numbers 1 to 10 in Y, it’s the sum of the products. We know the maximum (385) and minimum values (220), so we can now interpret any product sum for this kind of data with respect to that scale. Pro tip: When the correlation between two measures increases in the positive direction, the sum of their products increases to its maximum possible value. This is because the bigger numbers in X will tend to line up with the bigger numbers in Y, creating the biggest possible sum of products. When the correlation between two measures increases in the negative direction, the sum of their products decreases to its minimum possible value. This is because the bigger numbers in X will tend to line up with the smaller numbers in Y, creating the smallest possible sum of products. When there is no correlation, the big numbers in X will be randomly lined up with the big and small numbers in Y, making the sum of the products, somewhere in the middle. 3.3.1 Co-variance, the measure We took some time to see what happens when you multiply sets of numbers together. We found that \\(big*big = bigger\\) and \\(small*small=\\text{still small}\\), and \\(big*small=\\text{in the middle}\\). The purpose of this was to give you some conceptual idea of how the covariance between two measures is reflected in the sum of their products. We did something very straightforward. We just multiplied X with Y, and looked at how the product sums get big and small, as X and Y co-vary in different ways. Now, we can get a little bit more formal. In statistics, co-variance is not just the straight multiplication of values in X and Y. Instead, it’s the multiplication of the deviations in X from the mean of X, and the deviation in Y from the mean of Y. Remember those difference scores from the mean we talked about last chapter? They’re coming back to haunt you know, but in a good way like Casper the friendly ghost. Let’s see what this look like in a table: subject chocolate happiness C_d H_d Cd_x_Hd 1 1 1 -2.9 -3.6 10.44 2 2 2 -1.9 -2.6 4.94 3 2 2 -1.9 -2.6 4.94 4 3 3 -0.9 -1.6 1.44 5 3 4 -0.9 -0.6 0.54 6 5 6 1.1 1.4 1.54 7 7 5 3.1 0.4 1.24 8 5 6 1.1 1.4 1.54 9 5 8 1.1 3.4 3.74 10 6 9 2.1 4.4 9.24 Sums 39 46 0 0 40 Means 4 5 0 0 4 We have computed the deviations from the mean for the chocolate scores, and the deviations from the mean for the happiness scores. Then, we multiplied them together (last column). Finally, you can see the mean of the products listed in the bottom right corner of the table, the official the covariance. The formula for the covariance is: \\(cov(X,Y) = \\frac{\\sum_{i}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})}{N}\\) Ok, so now we have a formal single number to calculate the relationship between two variables. This is great, it’s what we’ve been looking for. However, there is a problem. Remember when we learned how to compute just the plain old variance. We looked at that number, and we didn’t know what to make of it. It was squared, it wasn’t in the same scale as the original data. So, we square rooted the variance to produce the standard deviation, which gave us a more interpretable number in the range of our data. The co-variance has a similar problem. When you calculate the covariance as we just did, we don’t know immediately know its scale. Is a 3 big? is as 6 big? is a 100 big? How big or small is this thing? From our prelude discussion on the idea of co-variance, we learned the sum of products between two measures ranges between a maximum and minimum value. The same is true of the co-variance. For a given set of data, there is a maximum possible positive value for the covariance (which occurs when there is perfect positive correlation). And, there is a minimum possible negative value for the covariance (which occurs when there is a perfect negative correlation). When there is zero covariation, guess what happens. Zeroes. So, at the very least, when we look at a covariation statistic, we can see if what direction it points, positive or negative. But, we don’t know how big or small it is compared to the maxiumum or minimum possible value, so we don’t know the relative size, which means we can’t say how strong the correlation is. What to do? 3.3.2 Pearson’s r we there yet Yes, we are here now. Wouldn’t it be nice if could force our measure of covariation to be between -1 and +1. -1 would be the minimum possible value for a perfect negative correlation. +1 would be the maximum possible value for a perfect positive correlation. 0 would mean no correlation. Everything in between 0 and -1 would be increasingly large negative correlations. Everything between 0 and +1 would be increasingly large positive correlations. It would be a fantastic, sensible, easy to interpret system. If only we could force the covariation number to be between -1 and 1. Fortunately, for us, this episode is brought to you by Pearson’s r, which does precisely this wonderful thing. Let’s take a look at a formula for Pearson’s r: \\(r = \\frac{cov(X,Y)}{\\sigma_{X}\\sigma_{Y}} = \\frac{cov(X,Y)}{SD_{X}SD_{Y}}\\) We see the symbol \\(\\sigma\\) here, that’s more Greek for you. \\(\\sigma\\) is often used as a symbol for the standard deviation (SD). If we read out the formula in English, we see that r is the covariance of X and Y, divided by the product of the standard deviation of X and the standard deviation of Y. Why are we dividing the covariance by the product of the standard deviations. This operation has the effect of normalizing the covariance into the range -1 to 1. But, we will fill this part in as soon as we can…promisary note to explain the magic. FYI, it’s not magic. Brief explanation here is that dividing each measure by its standard deviation ensures that the values in each measure are in the same range as one another. For now, we will call this mathematical magic. It works, but we don’t have space to tell you why it works right now. It’s worth saying that there are loads of different formulas for computing Pearson’s r. You can find them by googling them. We will probably include more of them here, when we get around to it. However, they all give you the same answer. And, they are all not as pretty as each other. Some of them might even look scary. In other statistics textbook you will often find formulas that are easier to use for calculation purposes. For example, if you only had a pen and paper, you might use one or another formula because it helps you compute the answer faster than if you did by hand using the approach we took here. To be honest, we are not very interested in teaching you how to plug numbers into formulas. We give one lesson on that here: Put the numbers into the letters, then compute the answer. Sorry to be snarky. Nowadays you have a computer that you should use for this kind of stuff. So, we are more interested in teaching you what the calculations mean, rather than how to do them. Of course, every week we are showing you how to do the calculations in lab with computers, because that is important to. Does Pearson’s R really stay between -1 and 1 no matter what? It’s true, take a look at the following simulation. Here I randomly ordered the numbers 1 to 10 for an X measure, and did the same for a Y measure. Then, I computed Pearson’s r, and repeated this process 1000 times. As you can see all of the dots are between -1 and 1. Neat huh. 3.4 Examples with Data Examples here 3.5 Interpreting Correlations What does the presence or the absence of a correlation between two measures mean? How should correlations be interpreted? What kind of inferences can be drawn from correlations? These are all very good questions. A first piece of advice is to use caution when interpreting correlations. Here’s why. 3.5.1 Correlation does not equal causation Perhaps you have heard that correlation does not equal causation. Why not? There are lots of reasons why not. However, before listing some of the reasons let’s start with a case where we would expect a causal connection between two measurements. Consider, buying a snake plant for your home. Snake plants are supposed to be easy to take care of because you can mostly ignore them. Like most plants, snake plants need some water to stay alive. However, they also need just the right amount of water. Imagine an experiment where 1000 snake plants were grown in a house. Each snake plant is given a different amount of water per day, from zero teaspoons of water per day to 1000 teaspoons of water per day. We will assume that water is part of the causal process that allows snake plants to grow. The amount of water given to each snake plant per day can also be one of our measures. Imagine further that every week the experimenter measures snake plant growth, which will be the second measurement. Now, can you imagine for yourself what a scatter plot of weekly snake plant growth by tablespoons of water would look like? 3.5.1.1 Even when there is causation, there might not be obvious correlation The first plant given no water at all would have a very hard time and eventually die. It should have the least amount of weekly growth. How about the plants given only a few teaspoons of water per day. This could be just enough water to keep the plants alive, so they will grow a little bit but not alot. If you are imagining a scatterplot, with each dot being a snake plant, then you should imagine some dots starting in the bottom left hand corner (no water &amp; no plant growth), moving up and to the right (a bit of water, and a bit of growth). As we look at snake plants getting more and more water, we should see more and more plant growth, right? “Sure, but only up to a point”. Correct, there should be a trend for a positive correlation with increasing plant growth as amount of water per day increases. But, what happens when you give snake plants too much water? From personal experience, they die. So, at some point, the dots in the scatter plot will start moving back down again. Snake plants that get way too much water will not grow very well. The imaginary scatterplot you should be envisioning could have an upside U shape. Going from left to right, the dot’s go up, they reach a maximum, then they go down again reaching a minimum. Computing Pearson’s r for data like this can give you \\(r\\) values close to zero. There are many ways to create a summary statistic for relationships between variables that are like Pearson’s r. We discuss some of these in the chapter on Linear Regression. This example illustrates some conundrums in interpreting correlations. We already know that water is needed for plants to grow, so we are rightly expecting there to be a relationship between measure of amount of water and plant growth. If we look at the first half of the data we see a positive correlation, if we look at the last half of the data we see a negative correlation, and if we look at all of the data we see no correlation. Yikes. So, even when there is a causal connection between two measures, we won’t necessarilly clear evidence of the connection just by computing a correlation coefficient. Pro Tip: This is one reason why plotting your data is so important. If you see an upside U shape pattern, then a correlation analysis is probably not the best analysis for your data. 3.5.1.2 Confounding variable, or Third variable problem Anybody can correlate any two things that can be quantified and measured. For example, we could find a hundred people, ask them all sorts of questions like: how happy are you how old are you how tall are you how much money do you make per year how long are your eyelashes how many books have you read in your life how loud is your inner voice Let’s say we found a positive correlation between yearly salary and happiness. Note, we could have just as easily computed the same correlation between happiness and yearly salary. If we found a correlation, would you be willing to infer that yearly salary causes happiness? Perhaps it does play a small part. But, something like happiness probably has a lot of contributing causes. Money could directly cause some people to be happy. But, more likely, money buys people access to all sorts of things, and some of those things might contribute happiness. Theses “other” things are called third variables. For example, perhaps people living in nicer places in more expensive houses are more happy than people in worse places in cheaper houses. In this scenario, money isn’t causing happiness, it’s the places and houses that money buys. But, even is this were true, people can still be more or less in lots of different situations. The lesson here is that a correlation can occur between two measures because of a third variable that is not directly measured. So, just because we find a correlation, does not mean we can conlude anything about a causal connection between two measurements. 3.5.2 Correlation and Random chance Another very important aspect of correlations is the fact that they can be produced by random chance. This means that you can find a positive or negative correlation between two measures, even when they have absolutely nothing to do with one another. You might have hoped to find zero correlation when two measures are totally unrelated to each other. Althought this certainly happens, unrelated measures can accidentally produce spurious correlations, just by chance alone. Let’s demonstrate how correlations can occur by chance when there is no causal connection between two measures. Imagine two participants. One is at the North pole with a lottery machine full of balls with numbers from 1 to 10. The other is at the south pole with a different lottery machine full of balls with numbers from 1 to 10. There are an endless supply of balls in the machine, so every number could be picked for any ball. Each participant randomly chooses 10 balls, then records the number on the ball. In this situation we will assume that there is no possible way that balls chosen by the first participant could causally influence the balls chose by the second participant. They are on the other side of the world. We should assume that the balls will be chosen by chance alone. Here is what the numbers on each ball could look like for each participant: Ball North_pole South_pole 1 2 9 2 5 9 3 6 6 4 7 1 5 8 3 6 2 8 7 5 7 8 8 4 9 8 3 10 5 8 In this one case, if we computed Pearons’ \\(r\\), we would find that \\(r =\\) -0.8179561. But, we already know that this value does not tell us anything about the relationship between the balls chosen in the north and sout pole. We know that relationship should be completely random, because that is how we set up the game. The better question here is to ask what can random chance do? For example, if we ran our game over and over again thousands of times, each time choosing new balls, and each time computing the correlation, what would we find?First, we will find fluctuation. The r value will sometimes be positive, sometimes be negative, sometimes be big and sometimes be small. Second, we will see what the fluctuation looks like. This will give us a window into the kinds of correlations that chance alone can produce. Let’s see what happens. 3.5.2.1 Monte-carlo simulation of random correlations It is possible to use a computer to simulate our game as many times as we want. This process is often termed monte-carlo simulation. Below is a script written for the programming language R. We won’t go into the details of the code here. However, let’s briefly explain what is going on. Notice, the part that says for(sim in 1:1000). This creates a loop that repeats our game 1000 times. Inside the loop there are variables named North_pole and South_pole. During each simulation, we sample 10 random numbers (between 1 to 10) into each variable. These random numbers stand for the numbers that would have been on the balls from the lottery machine. Once we have 10 random numbers for each, we then compute the correlation using cor(North_pole,South_pole). Then, we save the correlation value and move on to the next simulation. At the end, we will have 1000 individual Pearson \\(r\\) values. simulated_correlations &lt;- length(0) for(sim in 1:1000){ North_pole &lt;- runif(10,1,10) South_pole &lt;- runif(10,1,10) simulated_correlations[sim] &lt;- cor(North_pole,South_pole) } sim_df &lt;- data.frame(sims=1:1000,simulated_correlations) ggplot(sim_df, aes(x = sims, y = simulated_correlations))+ geom_point()+ theme_classic()+ geom_hline(yintercept = -1)+ geom_hline(yintercept = 1)+ ggtitle(&quot;Simulation of 1000 r values&quot;) Let’s take a look at all of the 1000 Pearson \\(r\\) values. Does the figure below look familiar to you? It should, we have already conducted a similar kind of simulation before. Each dot in the scatterplot shows the Pearson \\(r\\) for each simulation from 1 to 1000. As you can see the dots are all of the place, in between the range -1 to 1. The important lesson here is that random chance produced all of these correlations. This means we can find “correlations” in the data that are completely meaningless, and do not reflect any causal relationship between one measure and another. Let’s illustrate the idea of finding “random” correlations one more time, with a little movie. This time, we will show you a scatterplot of the random values sampled for the balls chosen from the North and South pole. If there is no relationship we should see dots going everywhere. If there happens to be a positive relationship (purely by chance), we should see the dots going from the bottom left to the top right. If there happens to be a negative relationship (purely by chance), we should see the dots going from the top left down to the bottom right. On more thing to prepare you for the movie. There are three scatterplots below, showing negative, positive, and zero correlations between two variabls. You’ve already seen this graph before. But, we added something. Blue lines. “Oooh blue lines, tell me more”. The are helpful for seeing the correlation. We are drawing the lines straight through the dots (we’ll learn more about in the chapter on linear regression), such that they do the best job of summarizing the middle of dots. Negative correlations occur when a line goes down from the top left to bottom right. Positive correlations occur when a line goes up from the bottom left to the top right. Zero correlations occur when the line is flat (doesn’t go up or down). Ok, now we are ready for the movie. You are looking at the process of sampling two set of numbers randomly, one for the X variable, and one for the Y variable. Each time we sample 10 numbers for each, plot them, then draw a line through them. Remember, these numbers are all completely random, so we should expect, on average that there should be no correlation between the numbers. However, this is not what happens. You can the line going all over the place. Sometimes we find a negative correlation (line goes down), sometimes we see a positive correlation (line goes up), and sometimes it looks like zero correlation (line is more flat). You might be thinking this is kind of disturbing. If we know that there should be no correlation between two random variables, how come we are finding correlations? This is a big problem right? I mean, if someone showed me a correlation between two things, and then claimed one thing was related to another, how could know if it was true. After all, it could be chance! Chance can do that too. Fortunately, all is not lost. We can look at our simulated data in another way, using a histogram. Remember, just before the movie, we simulated 1000 different correlations using random numbers. By, putting all of those \\(r\\) values into a histogram, we can get a better sense of how chance behaves. We can see what kind of correlations chance is likely or unlikely to produce. Here is a histogram of the simulated \\(r\\) values. Notic that this histogram is not flat. Most of the simulated \\(r\\) values are close to zero. Notice, also that the bars get smaller as you move away from zero in the positive or negative direction. The general take home here is that chance can produce a wide range of correlations. However, not all correlations happen very often. For example, the bars for -1 and 1 are very small. Chance does not produce nearly perfect correlations very often. The bars around -.5 and .5 are smaller than the bars around zero, as medium correlations do not occur as often as small correlations by chance alone. You can think of this histogram as the window of chance. It shows what chance often does, and what it often does not do. If you found a correlation under these very same circumstances (e.g., measured the correlation between two sets of 10 random numbers), then you could consult this window. What should you ask the window? How about, could my observed correlation (the one that you found in your data) have come from this window. Let’s say you found a correlation of \\(r = .1\\). Could a .1 have come from the histogram? Well, look at the histogram around where the .1 mark on the x-axis is. Is there a big bar there? If so, this means that chance produces this value fairly often. You might be comfortable with the inference, Yes, this .1 could have been produced by chance, because it is well inside the window of chance. How about \\(r = .5\\)? The bar is much smaller here, you might think, “well, I can see that chance does produce .5 some times, so chance could have produced my .5. Did it? Maybe, maybe not, not sure”. Here, your confidence in a strong inference might start getting a bit shakier. How about an \\(r = .95\\)?. You might see that the bar for .95 is very very small, perhaps too small to see. What does this tell you? It tells you that chance does not produce .95 very often, hardly if at all, pretty much never. So, if you found a .95 in your data, what would infer? Perhaps you would be comfortable inferring that chance did not produce your .95, after .95 is not inside the window of chance. In this section we have started to build some intuitions about inferential statistics. We go into more detail in the next chapters. For now, the main ideas are: We can measure relationships in data using things like correlation The correlations we measure can be produced by numerous things, so they are hard to to intrepret Correlations can be produced by chance, so have the potential to be completely meaningless. However, we can create a model of exactly what chance can do. The model tells us whether chance is more or less likely to produce correlations of different sizes We can use the chance model to help us make decisions about our own data. We can compare the correlation we found in our data to the model, then ask whether or not chance could have or was likely to have produced our results. 3.5.2.2 Increasing sample-size decreases opportunity for spurious correlation Before moving on, let’s do one more thing with correlations. In our pretend lottery game, each participant only sampled 10 balls each. We found that this could lead to a range of correlations between the number randomly drawn from either sides of the pole. Indeed, we even found some correlations that were medium to large in size. If you were a researcher who found such correlations, you might be tempted to believe there was a relationship between your measurements. However, we know in our little game, that those correlations would be spurious, just a product of random sampling. The good news is that, as a researcher, you get to make the rules of the game. You get to determine how chance can play. This is all a little bit metaphorical, so let’s make it concrete. We will see what happens in four different scenarios. First, we will repeat what we already did. Each participant will draw 10 balls, then we compute the correlation, and do this over 1000 times and look at a histrogram. Second, we will change the game so each participant draws 50 balls each, and then repeat our simulation. Third, and fourth, we will change the game so each participant draws 100 balls each, and then 1000 balls each, and repeat etc. The graph below shows four different histograms of the Pearson \\(r\\) values in each of the different scenarios. Each scenario involves a different sample-size, from, 10, 50, 100 to 1000. By inspecting the four histrograms you should notice a clear pattern. The width or range of each histogram shrinks as the sample-size increases. What is going on here? Well, we already know that we can think of these histograms as windows of chance. They tell us which \\(r\\) values occur fairly often, which do not. When our sample-size is 10, lots of different \\(r\\) values happen. That histrogram is very flat and spread out. However, as the sample-size inreases, we see that the window of chance gets pulled in. For example, by the time we get to 1000 balls each, almost all of the Pearson \\(r\\) values are very close to 0. One take home here, is that increasing sample-size narrows the window of chance. So, for example, if you ran a study involving 1000 samples of two measures, and you found a correlation of .5, then you can clearly see in the bottom right histogram that .5 does not occur very often by chance alone. In fact, there is no bar, because it didnt happen even once in the simulation. As a result, when you have a large sample size like n = 1000, you might be more confident that your observed correlation (say of .5) was not a spurious correlation. If chance is not producing your result, then something else is. Finally, notice how your confidence about whether or not chance is mucking about with your results depends on your sample size. If you only obtained 10 samples per measurement, and found \\(r = .5\\), you should not be as confident that your correlation reflects a real relationship. Instead, you can see that \\(r\\)’s of .5 happen fairly often by chance alone. Pro tip: when you run an experiment you get to decide how many samples you will collect, which means you can choose to narrow the window of chance. Then, if you find a relationship in the data you can be more confident that your finding is real, and not just something that happened by chance. 3.5.3 Some more movies Let’s ingrain these idea with some more movies. When our sample-size is small (N is small), sampling error can cause all sort “patterns” in the data. This makes it possible, and indeed common, for “correlations” to occur between two sets of numbers. When we increase the sample-size, sampling error is reduced, making it less possible for “correlations” to occur just by chance alone. When is large, chance has less of an opportunity to operate. 3.5.3.1 Watching how correlation behaves when there is no correlation Below we randomly sample numbers for two variables, plot them, and show the correlation using a line. There are four panels, each showing the number of observations in the samples, from 10, 50, 100, to 1000 in each sample. Remember, because we are randomly sampling numbers, there should be no relationship between the X and Y variables. But, as we have been discussing, because of chance, we can sometimes observe a correlation (due to chance). The important thing to watch is how the line behaves across the four panels. The line twirls around in all directions when the sample size is 10. It is also moves around quite a bit when the sample size is 50 or 100. It still moves a bit when the sample size is 1000, but much less. In all cases we expect that the line should be flat, but every time we take new samples, sometimes the line shows us pseudo patterns. Which line should you trust? Well, hopefully you can see that the line for 1000 samples is the most stable. It tends to be very flat every time, and it does not depend so much on the particular sample. The line with 10 observations per sample goes all over the place. The take home here, is that if someone told you that they found a correlation, you should want to know how many observations they hand in their sample. If they only had 10 observations, how could you trust the claim that there was a correlation? You can’t!!! Not now that you know samples that are that small can do all sorts of things by chance alone. If instead, you found out the sample was very large, then you might trust that finding a little bit more. For example, in the above movie you can see that when there are 1000 samples, we never see a strong or weak correlation; the line is always flat. This is because chance almost never produces strong correlations when the sample size is very large. Ok, so what do things look like when there actually is a correlation between variables? 3.5.3.2 Watching correlations behave when there really is a correlation Sometimes there really are correlations between two variables that are not caused by chance. Below, we get to watch a movie of four scatterplots. Each shows the correlation between two variables. Again, we change the sample-size in steps of 10, 50 100, and 1000. The data have programmed to contain a real positive correlation. So, we should expect that the line will be going up from the bottom left to the top right. However, there is still variability in the data. So this time, sampling error due to chance will fuzz the correlation. We know it is there, but sometimes chance will cause the correlation to be eliminated. Notice that in the top left panel (sample-size 10), the line is twirling around much more than the other panels. Every new set of samples produces different correlations. Sometimes, the line even goes flat or downward. However, as we increase sample-size, we can see that the line doesn’t change very much, it is always going up showing a positive correlation. The main takeaway here is that even when there is a positive correlation between two things, you might not be able to see it if your sample size is small. For example, you might get unlucky with the one sample that you measured. Your sample could show a negative correlation, even when the actual correlation is positive! Unfortunately, in the real world we usually only have the sample that we collected, so we always have to wonder if we got lucky or unlucky. Fortunately, if you want to remove luck, all you need to do is collect larger samples. Then you will be much more likely to observe the real pattern, rather the pattern that can be introduced by chance. "],
["FoundationForInference.html", "Chapter 4 Foundations for inference 4.1 Brief review of Experiments 4.2 The data came from a distribution 4.3 Playing with distributions 4.4 Is there a difference? 4.5 Chance makes some differences more likely than others 4.6 The randomization test (permutation test)", " Chapter 4 Foundations for inference Data and data sets are not objective; they are creations of human design. We give numbers their voice, draw inferences from them, and define their meaning through our interpretations. —Katie Crawford Chapter by Matthew Crump So far we have been talking about describing data and looking possible relationships between things we measure. We began by talking about the problem of having too many numbers. So, we discussed how we could summarize big piles of numbers with descriptive statistics, and by looking at the data with graphs. We also looked at the idea of relationships between things. If one thing causes another thing, then if we measure how one thing goes up and down, we should find that other thing goes up and down, or does something at least systematically following the first thing. Finally, at the end of the last chapter on correlation, we showed how correlations, which imply a relationship between two things, are very difficult to interpret. Why? because an observed correlation can be caused by a hidden third variable, or simply be a spurious findings “caused” by random chance. Fortunately, we have many more tools at our disposal that improve our ability to make inferences about causation. So, now we begin our journey into inferential statistics. The tools we use to make inferences about where our data came from. In this chapter we provide some foundational ideas. We will stay mostly at a conceptual level, and use lots of simulations like we did in the last chapter. In the remaining chapters we formalize the intuitions built here to explain how some common inferential statitistics work. 4.1 Brief review of Experiments In chapter one we talked a little bit about research methods and experiments. Experiments are a structured way of collecting data that can permit inferences about causality. If we wanted to know whether something like watching cats on youtube increases happiness we would need an experiment. We already found out that just finding a bunch of people and measuring number of hours watching cats, and level of happiness, and correlating the two will not permit inferences about causation. For one, the causal flow could be reversed. Maybe being happy causes people to watch more cat videos. We need an experiment. An experiment has two parts. A manipulation and a measurement. The manipulation is under the control of the experimenter. Manipulations are also called independent variables. For example, we could manipulate how many cat videos people will watch, 1 hour versus 2 hours of cat videos. The measurement is the data that is collected. We could measure how happy people are after watching cat videos on a scale from 1 to 100. Measurements are also called dependent variables. So, in a basic experiment like the one above, we take measurements of happiness from people in one of two experimental conditions defined by the independent variable. Let’s say we ran 50 subjects. 25 subjects would be randomly assigned to watch 1 hour of cat videos, and the other 25 subjects would be randomly assigned to watch 2 hours of cat videos. We would measure happiness for each subject at the end of the videos. Then we could look at the data. What would we want to look at? Well, if watching cat videos cause change in happiness, then we would expect the measures of happiness for people watching 1 hour of cat videos to be different from the measures of happiness for people watching 2 hours of cat videos. If watching cat videos does not change happiness, then we would expect no differences in measures of happiness between conditions. Causal forces cause change, and the experiment is set up to detect the change. Now we can state one overarching question, how do we know if the data changed between conditions? If we can be confident that there was a change between conditions, we can infer that our manipulation caused a changed in the measurement. If we cannot be confident there was a change, then we cannot infer that our manipulation caused a change in the measurement. We need to build some change detection tools so we can know a change when we find one. “Hold on, if we are just looking for a change, wouldn’t that be easy to see by looking at the numbers and seeing if they are different, what’s so hard about that?”. Good question. Now we must take a detour. The short answer is that there will always be change in the data (remember variance). 4.2 The data came from a distribution From now on when you see a bunch of numbers, you should wonder, “where did this numbers come from?”. To elaborate, this question means wondering about the things behind the numbers, causing some kinds of numbers to happen more than other kinds of numbers. To think about this question, we will veer off into the abstract world of distributions. A distribution a place where numbers can come from. The distribution sets the constraints. It determines what numbers are likely to occur, and what numbers are not likely to occur. Distributions are abstract ideas. But, they can be made concrete, and we can draw them with pictures. Let’s look at some. 4.2.1 Uniform distribution A uniform distribution is completely flat, it looks like this: Ok, so that doesn’t look like much. What is going on here? The y-axis is labelled probability, and it goes from 0 to 1. The x-xaxis is labelled Number, and it goes from one to 10. There is a horizontal line drawn straight through. This line tells you the probability of each number from 1 to 10. Notice the line is flat. This means all of the numbers have the same probability of occuring. More specifically, there are 10 numbers from 1 to 10 (1,2,3,4,5,6,7,8,9,10), and they all have an equal chance of occuring. 1/10 = .1, which is the probability indicated by the horizontal line. “So what?”. Imagine that this uniform distribution is a number generating machine. It spits out numbers, but it spits out each number with the probability indicated by the line. If this distribution was going to start spitting out numbers, it would spit out 10% 1s, 10% 2s, 10% 3s, and so on, up to 10% 10s. Wanna see what that would look like? Let’s make it spit out 100 numbers 5 8 5 6 6 3 5 9 4 10 2 5 7 9 2 7 8 8 6 8 4 5 5 5 9 5 4 4 2 6 7 5 8 5 1 7 6 5 3 3 7 2 1 4 6 1 8 6 9 4 8 2 6 1 3 6 5 8 4 5 7 4 4 9 6 7 7 2 2 7 4 8 4 3 10 6 10 2 4 1 8 5 6 7 7 3 4 5 5 10 6 9 9 2 7 8 10 3 2 3 We used the uniform distribution to generate these numbers. Officially, we call this sampling from a distribution. Sampling is what you do at a grocery store when there is free food. You can keep taking more. However, if you take all of the samples, then what you have is called the population. We’ll talk more about samples and populations as we go along. Because we used the uniformat distribution to create numbers, we already know where our numbers came from. However, we can still pretend for the moment that someone showed up at your door, showed you these numbers, and then you wondered where they came from. Can you tell just by looking at these numbers that they came from a uniform distribution? What would need to look at? Perhaps you would want to know if all of the numbers occur with roughly equal frequency, after all they should have right? That is, if each number had the same chance of occuring, we should see that each number occurs roughly the same number of times. We already know what a histogram is, so we can put our numbers into a histogram and see what the counts look like. If all of the numbers occur with equal frequency, then each number should occur 10 times, because we sampled a total of 100 numbers. The histogram looks like this: Uh oh, as you can see, not all of the number occured 10 times each. All of the bars are not the same height. This shows that randomly sampling numbers from this distribution does not guarantee that our numbers will be exactly like the distribution thehy came from. We can call this sampling error, or sampling variability. 4.2.2 Not all samples are the same, they are usually quite different Let’s take a look at sampling error more closely. We will sample 20 numbers from the uniform. Here we should expect that each number between 1 and 10 occurs two times each. Let’s take 20 sample and make a histogram. And then, let’s do that 10 times. So we will be looking at 10 histograms, each showing us what the 10 different samples of twenty numbers looks like: You might notice right away that none of the histograms are the same. Even though we are randomly taking 20 numbers from the very same uniform distribution, each sample of 20 numbers comes out different. This is sampling variability, or sampling error. Here is movie version. You are watching a new histrogam for each sample of 20 observations. The horizontal line shows the shape of the uniform distribution. It crosses the y-axis at 2, because we expect that each number (from 1 to 10) should occur about 2 times each in a sample of 20. However, as you can see, this does not happen. Instead, each sample bounces around quite a bit, due to random chance. Looking at the above histograms shows us that figuring out where our numbers came from can be difficult. In the real world, our measurements are samples. We usually only have the luxury of getting one sample of measurements, rather than repeating our own measurements 10 times or more. If you look at the histograms, you will see that some of them look like they could have come from the uniform distribution: most of the bars are near two, and they all fall kind of on a flat line. But, if you happen to look at a different sample, you might see something that is very bumpy, with some numbers happening way more than others. This could suggest to you that those numbers did not come from a uniform distribution (they’re just too bumpy). But let me remind you, all of these samples came from a uniform distribution, this is what samples from that distribution look like. This is what chance does to samples, it makes the individual data points noisy. 4.2.3 Large samples are more like the distribution they came from Let’s refresh the question. Which of these two samples do you think came from a uniform distribution? The answer is that they both did. But, neither of them look like they did. Can we improve things, and make it easier to see if a sample came from a uniform distribution? Yes, we can. All we need to do is increase the sample-size. We will often use the letter n to refer to sample-size. N is the number of observations in the sample. So let’s increase the number of observations in each sample from 20 to 100. We will again create 10 samples (each with 100 observations), and make histrograms for each of them. All of these samples will be drawn from the very same uniform distribution. This, means we should expect each number from 1 to 10 to occur about 10 times in each sample. Here are the histograms: Again, most of these histograms don’t look very flat, and all of the bars seem to be going up or down, and they are not exactly at 10 each. So, we are still dealine with sampling error. It’s a pain. It’s always there. Let’s bump it up to 1000 observations per sample. Now we should expect every number to appear about 100 times each. What happens? Each of these histograms are starting to flatten out. The bars are still not perfectly at 100, because there is still sampling error (there always will be). But, if you found a histrogram that looked flat and knew that the sample contained many observations, you might be more confident that those numbers came from a uniform distribution. Just for fun let’s make the samples really big. Say 100,000 observations per sample. Here, we should expect that each number occurs about 10,000 times each. What happens? Now we see that all of our samples start to look the same. They all have 100,000 observations, and this gives chance enough opportunity to equally distribute the numbers, roughly making sure that they all occur very close to the same amount of times. As you can see, the bars are all very close to 10,000, where they should be if the sample came from a uniform distribution. Pro tip: The pattern behind a sample will tend to stabilize as sample-size increases. Small samples will have all sorts of patterns because of sampling error (chance). Before getting back to experiments, let’s ask two more questions. First, which of these two samples do you think came from a uniform distribution? I will tell you that each of these samples had 20 observations each. If you are not confident in the answer, this is because sampling error (randomness) is fuzzing with the histograms. Here is the very same question, only this time we will take 1,000 observations for each sample. Which one do you think came from a uniform distribution, which one did not? Now that we have increased N, we can see the pattern in each sample becomes more obvious. The histogram for sample 1 has bars near 100, not perfectly flat, but it resembles a uniform distribution. The histogram for sample 2 does not look flat at all. Instead, there the number five appears most of the time, and numbers on either side of five happen less and less. Congratulations to Us! We have just made some statistical inferences without using formulas! “We did?”. Yes, by looking at our two samples we have inferred that sample 2 did not come from a uniform distribution. We have also inferred that sample 1 could have come froma uniform distribution. Fantastic. This is really all we will be doing for the rest of the course. We will be looking at some numbers, wondering where they came from, then we will arrange the numbers in such a way so that we can make an inference about where they came from. That’s it. 4.3 Playing with distributions talk about a few different distribution. Embed shiny app SHINY APP here 4.4 Is there a difference? Let’s get back to experiments. In an experiment we want to know if our independent variable (our manipulation) causes a change in our dependent variable (measurement). If this occurs, then we will expect to see some differences in our measurement as a function of manipulation. Consider the light switch example: Light Switch Experiment: You manipulate the switch up (condition 1 of independent variable), light goes on (measurement). You manipulate the switch down (condition 2 of independent variable), light goes off (another measurement). The measurement (light) changes (goes off and on) as a function of the manipulation (moving switch up or down). You can see the change in measurement between the conditions, it is as obvious as night and day. So, when you conduct a manipulation, and can see the difference (change) in your measure, you can be pretty confident that your manipulation is causing the change. note: to be cautious we can say “something” about your manipulation is causing the change, it might not be what you think it is if your manipulation is very complicated and involves lots of moving parts. 4.4.1 Chance can produce differences Do you think random chance can produce the appearance of differences, even when they really aren’t any? I hope so. We have already shown that the process of sampling numbers from a distribution is chancy process that produces different samples. Different samples are different, so yes, chance can produce differences. This can muck up our interpretation of experiments. Let’s conduct a fictitious experiment where we expect to find no differences, because we will manipulate something that shouldn’t do anything. Her’s the set-up: You are the experimenter standing in front of a gumball machine. It is very big, has thousands of gumballs. 50% of the gumballs are green, and 50% are red. You want to find out if picking gumballs with your right hand vs. your left hand will cause you to pick more green gumballs. Plus, you will be blindfolded the entire time. The independent variable is Hand: right hand vs. left hand. The dependent variable is the measurement of the color of each gumball. You run the experiment as follows. 1) put on blind fold. 2) pick 10 gumballs randomly with left hand, set them aside. 3) pick 10 gumballs randomly with right hand, set them aside. 4) count the number of green and red gumballs chosen by your left hand, and count the number of green and red gumballs chosedn by your right hand. Hopefully you will agree that your hands will not be able to tell the difference between the gumballs. If you don’t agree, we will further stipulate the gumballs are completely identical in every way except their color, so it would be impossible to tell them apart using your hands. So, what should happen in this experiment? “Umm, maybe you get 5 red gum balls and 5 green balls from your left hand, and also from your right hand?”. Sort of yes, this is what you would usually get. But, it is not all that you can get. Here is some data showing what happened from one pretend experiment: hand gumball left 1 left 0 left 0 left 0 left 0 left 1 left 1 left 1 left 1 left 1 right 1 right 0 right 1 right 1 right 1 right 1 right 0 right 1 right 0 right 0 “What am I looking at here”. This is a long-format table. Each row is one gumball. The first column tells you what hand was used. The second column tells you what kind of gumball. We will say 1s stand for green gum balls, and 0s stand for red gumballs. So, did your left hand cause you to pick more green gumballs than your right hand? It would be easier to look at the data using a bar graph. To keep things simple, we will only count green gumablls (the other gumballs must be red). So, all we need to do is sum up the 1s. The 0s won’t add anything. Oh look, the bars are not the same. One hand picked more green gum balls than the other. Does this mean that one of your hands secretly knows how to find green gumballs? No, it’s just another case of sampling error, that thing we call luck or chance. The difference here is caused by chance, not by the manipulation (which hand you use). Major problem for inference alert. We run experiments to look for differences so we can make inferences about whether our manipulations cause change in our measures. Now we know that we can find differences by chance. How can we know if a difference is real, or just caused by chance? 4.4.2 Differences due to chance can be simulated Remember when we showed that chance can produce correlations. We also showed that chance is restricted in its ability to produce correlations. For example, chance more often produces weak correlations than strong correlations. Remember the window of chance? We found out before that correlations falling outside the window of chance were very unlikely. We can do the same thing for differences. Let’s find out just what chance can do in our experiment. Once we know what chance is capable of we will be in a better position to judge whether our manipulation caused a difference, or whether it could have been chance. The first thing to do is pretend you conduct the gumball experiment 10 times in a row. This will produce 10 different sets of results. For each of them we can make a bar graph, and look at whether the left hand chose more green gumballs than red gumballs. It looks like this: These 10 experiments give us a better look at what chance can do. It should also mesh well with your expectations. If everything is left up to chance (as we have made it so), then sometimes your left hand will choose more green balls, sometimes your right hand will choose more green gumballs, and sometimes they will choose the same amount of gumballs. Right? Right. 4.5 Chance makes some differences more likely than others Ok, we have seen that chance can produce differences here. But, we still don’t have a good idea about what chance usually does and doesn’t do. For example, if we could find the window of opportunity here, we would be able find out that chance usually does not produce differences of a certain large size. If we knew what the size was, then if we ran experiment and our difference was bigger than what chance can do, we could be confident that chance did not produce our difference. Let’s use the word difference some more, because it will be helpful. In fact, let’s think about our measure of green balls in terms of a difference. For example, in each experiment we counted the green balls for the left and right hand. What we really want to know is if there is a difference between them. So, we can calculate the difference score. Let’s decide that difference score = # of green gumballs in left hand - # of green gumballs in right hand. Now, we can redraw the 10 bar graphs from above. But this time we will only see one bar for each experiment. This bar will show the differenced in number of green gumballs. Missing bars mean that there were an equal number of green gumballs chosen by the left and righ hands (difference score is 0). A positive value means that more green gumballs were chosen by the left than right hand. A negative value means that more green gumballs were chosen by the right than left hand. Note that if we decided (and we get to decide) to calculate the difference in reverse (right hand - left hand), ths signs of the differences scores would flip around. We are starting to see more of the differences that chance can produce. The difference scores are mostly between -2 to +2. We could get an even better impression by running this pretend experiment 100 times instead of only 10 times. How about we do that. OOf, we just ran so many simulated expeirments that the x-axis is unreadable, but it goes from 1 to 100. Each bar represents the difference of number of green balls chosen randomly by the left or right hand. Beginning to notice anything? Look at the y-axis, this shows the size of the difference. Yes, there are lots of bars of different sizes, this shows us that many kinds of differences do occur by chance. However, the y-axis is also restricted. It does not go from -10 to +10. Big differences greater than 5 or -5 don’t happen very often. Now that we have a method for simulating differences due to chance, let’s run 10,000 simulated experiments. But, instead of plotting the differences in a bar graph for each experiment, how about we look at the histogram of difference scores. This will give us a clearer picture about which differences happen most often, and which ones do not. This will be another window into chance. The chance window of differences. Our computer simulation allows us to force chance to operate hundreds of times, each time it produces a difference. We record the difference, then at the end of the simulation we plot the histogram of the differences. The histogram begins to show us the where the differences came from. Remember the idea that numbers come from a distribution, and the distribution says how often each number occurs. We are looking at one of these distributions. It is showing us that chance produces some differences more often than others. First, chance usually produces 0 differences, that’s the biggest bar in the middle. Chance also produces larger differences, but as the differences get larger (positive or negative), they occur less frequently. The shape of this histogram is your chance window, it tells you what chance can do, it tells you what chance usually does, and what it usually does not do. You can use this chance window to help you make inferences. If you ran yourself in the gumball experiment and found that your left hand chose 2 more green gumballs than red gumballs, would you conclude that you left hand was special, and caused you to choose more green gumballs? Hopefully not. You could look at the chance window and see that differences of size +2 do happen fairly often by chance alone. You should not be surprised if you got a luck +2 difference. However, what if your left chose 5 more green gumballs than red gumballs. Well, chance doesn’t do this very often, you might think something is up with your left hand. If you got a whopping 9 more green gumballs than red gumballs, you might really start to wonder. This is the kind of thing that could happen (it’s possible), but virtually never happens. When you get things that almost never happen by chance, you can be more confident that the difference reflects a causal force that is not chance. 4.6 The randomization test (permutation test) Welcome to the first official inferential statistic in this textbook. Up to now we have been building some intuitions for you. Now, we will get slightly more formal and show you how we can use random chance to tell use whether our experimental finding was likely due to chance or not. We do this with something called a randomization test. The ideas behind the randomization test are the very same ideas behind the rest of the inferential statistics that we will talk about in later chapters. And, surprise, we have already talked about all of the major ideas already. Now, we will just put the ideas together, and give them the name randomization test. Here’s the big idea. When you run an experiment and collect some data you find out what happened. But, because you ran the experiment only once, you don’t get to find out what could have happened. The randomization test is a way of finding out what could have happened. And, once you know that, you can compare what did happen in your experiment, with what could have happened. 4.6.1 Pretend example does chewing gum improve your grades? Let’s say you run an experiment to find out if chewing gum causes students to get better grades on statistics exams. You randomly assign 20 students to the chewing gum condition, and 20 different students to the no-chewing gum condition. Then, you give everybody statistics tests and measure their grades. If chewing gum causes better grades, then the chewing gum group should have higher grades on average than the group who did not chew gum. Let’s say the data looked like this: student gum no_gum 1 85 74 2 87 61 3 86 64 4 77 88 5 94 60 6 85 53 7 89 81 8 82 52 9 83 47 10 98 48 11 96 85 12 93 63 13 73 51 14 71 43 15 87 68 16 94 61 17 84 63 18 92 67 19 77 82 20 78 85 Sums 1711 1296 Means 85.55 64.8 So, did the students chewing gum do better than the students who didn’t chew gum? Look at the mean test performance at the bottom of the table. The mean for students chewing gum was 85.55, and the mean for students who did not chew gum was 64.8. Just looking at the means, it looks like chewing gum worked! “STOP THE PRESSES, this is silly”. We already know this is silly because we are making pretend data. But, even if this was real data, you might think, “Chewing gum won’t do anything, this difference could have been caused by chance, I mean, maybe the better students just happened to be put into the chewing group, so because of that their grades were higher, chewing gum didn’t do anything…”. We agree. But, let’s take a closer look. We already know how the data come out. What we want to know is how they could have come out, what are all the possibilities? For example, the data would have come out a bit different if we happened to have put some of the students from the gum group into the no gum group, and vice versa. Think of all the ways you could have assigned the 40 students into two groups, there are lots of ways. And, the means for each group would turn out differently depending on how the students are assigned to each group. Practically speaking, it’s not possible to run the experiment every possible way, that would take too long. But, we can nevertheless estimate how all of those experiments might have turned out using simulation. Here’s the idea. We will take the 40 measurements (exam scores) that we found for all the students. Then we will randomly take 20 of them and pretend they were in the gum group, and we’ll take the remaining 20 and pretend they were in the no gum group. Then we can compute the means again to find out what would have happened. We can keep doing this over and over again. Everytime computing what happened in that version of the experiment. 4.6.1.1 Doing the randomization Before we do that, let’s show how the randomization part works. We’ll use fewer numbers to make the process easier to look at. Here are the first 5 exam scores for students in both groups. student gum no_gum 1 85 74 2 87 61 3 86 64 4 77 88 5 94 60 Sums 429 347 Means 85.8 69.4 Things could have turned out differently if some of the subjects in the gum group were switched with the subjects in the no gum group. Here’s how we can do some random switching. We will do this using R. all_scores &lt;- c(gum[1:5],no_gum[1:5]) randomize_scores &lt;- sample(all_scores) new_gum &lt;- randomize_scores[1:5] new_no_gum &lt;- randomize_scores[6:10] print(new_gum) ## [1] 87 60 86 61 64 print(new_no_gum) ## [1] 77 88 85 94 74 We have taken the first 5 numbers from the original data, and put them all into a variable called all_scores. Then we use the sample function in R to shuffle the scores. Finally, we take the first 5 scores from the shuffled numbers and put them into a new variable called new_gum. Then, we put the last five scores into the variable new_no_gum. Then we printed them, so we can see them. If we do this a couple of times and put them in a table, we can indeed see that the means for gum and no gum would be different if the subjects were shuffled around. Check it out: student gum no_gum gum2 no_gum2 gum3 no_gum3 1 85 74 86 87 77 87 2 87 61 88 74 60 61 3 86 64 77 94 88 86 4 77 88 64 85 64 94 5 94 60 60 61 85 74 Sums 429 347 375 401 374 402 Means 85.8 69.4 75 80.2 74.8 80.4 4.6.1.2 Simulating the mean differences across the different randomizations In our pretend experiment we found that the mean for students chewing gum was 85.55, and the mean for students who did not chew gum was 64.8. The mean difference (gum - no gum) was 20.75. This is a pretty big difference. This is what did happend. But, what could have happened? If we tried out all of the experiments where different subjects were switched around, what does the distribution of the possible mean differences look like? Let’s find out. This is what the randomization test is all about. When we do our randomization test we will measure the mean difference in exam scores between the gum group and the no gum group. Every time we randomize we will save the mean difference. Then we will have loads of mean differences to look at, which we can plot in a histogram. The histogram then gives a picture of what could have happened. Then, we can compare what did happen with what could have happened. Here’s the histogram of the mean differences from the randomization test. For this simulation, we randomized the results from the original experiment 1000 times. This is what could have happened. The blue line in the figure shows us where our observed difference lies on the x-axis. We are looking at another window of chance. We are seeing a histogram of the kinds of mean differences that could have occured in our experiemnt, if we had assigned our subjects to the gum and no gum groups differently. As you can see, the mean differences range from negative to positive. The most frequent difference is 0. Also, the distribution appears to be symmetrical about zero, which shows we had roughly same the chances of getting a positive or negative difference. Also, notice that as the differences get larger (in the positive or negative direction, they become less frequent). The blue line shows us the observed difference, this is the one we found in our fake experiment. Where is it? It’s way out to the right. It is is well outside the histogram. In other words, when we look at what could have happened, we see that what did happen doesn’t occur very often. IMPORTANT: In this case, when we speak of what could have happened. We are talking about what could have happended by chance. When we compare what did happen to what chance could have done, we can get a better idea of whether our result was caused by chance. What do you think? Could the difference represented by the blue line have been caused by chance? My answer is probably not. The histogram shows us the window of chance. The blue line is not inside the window. This means we can be pretty confident that the difference we observed was not due to chance. Ok, let’s pretend we got a much smaller mean difference when we first ran the experiment. For example, the histrogram might look something like this: Look at the blue line. If you found a mean difference of 10, would you be convinced that your difference was not caused by chance? As you can see, the blue line is inside the chance window. Notably, differences of +10 don’t very often. You might infer that you difference was not likely to be due to chance (but you might be a little bit skeptical, because it could have been). How about the red line? The red line represents a difference of +5. If you found a difference of +5 here, would you be confident that your difference was not caused by chance? I wouldn’t be. The red line is totally inside the chance window, this kind of difference happens fairly often. I’d need some more evidence to consider the claim the some independent variable actually caused the difference. I’d be much more comfortable assuming that sampling error probably caused the difference. 4.6.2 Take homes so far Have you noticed that we haven’t used any formulas yet, but we have been able to accomplish inferential statistics. We will see some formulas as we progress, but these aren’t really that important. What’s important is the idea behind the formulas. Inferential statistics is an attempt to solve the problem: where did my data from?. In the randomization test example, our question was: where did the differences between the means in my data come from?. We know that the differences could be produced by chance alone. We simulated what chance can due using randomization. Then we plotted what chance can do using a histogram. Then, we used to picture to help us make an inference. Did our observed difference come from the distribution, or not? When the observed difference is clearly inside the chance distribution, then we can infer that our difference could have been produced by chance. When the observed difference is not clearly inside the chance distribution, then we can infer that our difference was probably not produced by chance. In my opinion, these pictures are very, very helpful. If one of our goals is to help ourselves summarize a bunch of complicated numbers to arrive at an inference, then the pictures do a great job. We don’t even need a summary number, we just need to look at the picture and see if the observed differerence is inside or outside of the window. This is what it is all about. Creating intuitive and meaningful ways to make inferences from our data. As we move forward, the main thing that we will do is formalize our process, and talk more about “standard” inferential statistics. For example, rather than looking at a picture (which is a good thing to do), we will create some helpful numbers. For example, what if you wanted to the probability that your difference could have been produced by chance? That could be a single number, like 95%. If there was a 95% probability that chance can produce the difference you observed, you might not be very confident that something like your experimental manipulation was causing the difference. If there was only 1% probability that chance could produce your difference, then you might be more confident that chance did not produce the difference; and, you might instead be comfortable with the possibility that your experimental manipulation actually caused the differnce. So, how can we arrive at those numbers? In order to get there we will introduce you to some more foundational tools for statistical inference. "],
["sampling-and-estimation.html", "Chapter 5 Sampling and estimation 5.1 Samples, populations and sampling 5.2 The law of large numbers 5.3 Sampling distributions and the central limit theorem 5.4 Estimating population parameters 5.5 Estimating a confidence interval[sec:ci] 5.6 Summary", " Chapter 5 Sampling and estimation I have studied many languages-French, Spanish and a little Italian, but no one told me that Statistics was a foreign language. —Charmaine J. Forde Sections 5.1 &amp; 5.2 - Original text by Danielle Navarro Section 5.3 - Matthew Crump Section 5.4 - Mix of Crump &amp; Navarro Remember, the role of descriptive statistics is to concisely summarise what we do know. In contrast, the purpose of inferential statistics is to “learn what we do not know from what we do”. What kinds of things would we like to learn about? And how do we learn them? These are the questions that lie at the heart of inferential statistics, and they are traditionally divided into two “big ideas”: estimation and hypothesis testing. The goal in this chapter is to introduce the first of these big ideas, estimation theory, but we’ll talk about sampling theory first because estimation theory doesn’t make sense until you understand sampling. So, this chapter divides into sampling theory, and how to make use of sampling theory to discuss how statisticians think about estimation. We have already done lots of sampling, so you are already familiar with some of the big ideas. 5.1 Samples, populations and sampling Sampling theory plays a huge role in specifying the assumptions upon which your statistical inferences rely. And in order to talk about “making inferences” the way statisticians think about it, we need to be a bit more explicit about what it is that we’re drawing inferences from (the sample) and what it is that we’re drawing inferences about (the population). In almost every situation of interest, what we have available to us as researchers is a sample of data. We might have run experiment with some number of participants; a polling company might have phoned some number of people to ask questions about voting intentions; etc. Regardless: the data set available to us is finite, and incomplete. We can’t possibly get every person in the world to do our experiment; a polling company doesn’t have the time or the money to ring up every voter in the country etc. In our earlier discussion of descriptive statistics, this sample was the only thing we were interested in. Our only goal was to find ways of describing, summarising and graphing that sample. This is about to change. 5.1.1 Defining a population A sample is a concrete thing. You can open up a data file, and there’s the data from your sample. A population, on the other hand, is a more abstract idea. It refers to the set of all possible people, or all possible observations, that you want to draw conclusions about, and is generally much bigger than the sample. In an ideal world, the researcher would begin the study with a clear idea of what the population of interest is, since the process of designing a study and testing hypotheses about the data that it produces does depend on the population about which you want to make statements. However, that doesn’t always happen in practice: usually the researcher has a fairly vague idea of what the population is and designs the study as best he/she can on that basis. Sometimes it’s easy to state the population of interest. For instance, in the “polling company” example, the population consisted of all voters enrolled at the a time of the study – millions of people. The sample was a set of 1000 people who all belong to that population. In most situations the situation is much less simple. In a typical a psychological experiment, determining the population of interest is a bit more complicated. Suppose I run an experiment using 100 undergraduate students as my participants. My goal, as a cognitive scientist, is to try to learn something about how the mind works. So, which of the following would count as “the population”: All of the undergraduate psychology students at the University of Adelaide? Undergraduate psychology students in general, anywhere in the world? Australians currently living? Australians of similar ages to my sample? Anyone currently alive? Any human being, past, present or future? Any biological organism with a sufficient degree of intelligence operating in a terrestrial environment? Any intelligent being? Each of these defines a real group of mind-possessing entities, all of which might be of interest to me as a cognitive scientist, and it’s not at all clear which one ought to be the true population of interest. 5.1.2 Simple random samples Irrespective of how we define the population, the critical point is that the sample is a subset of the population, and our goal is to use our knowledge of the sample to draw inferences about the properties of the population. The relationship between the two depends on the procedure by which the sample was selected. This procedure is referred to as a sampling method, and it is important to understand why it matters. To keep things simple, imagine we have a bag containing 10 chips. Each chip has a unique letter printed on it, so we can distinguish between the 10 chips. The chips come in two colors, black and white. Figure 5.1: Simple random sampling without replacement from a finite population This set of chips is the population of interest, and it is depicted graphically on the left of Figure 5.1. As you can see from looking at the picture, there are 4 black chips and 6 white chips, but of course in real life we wouldn’t know that unless we looked in the bag. Now imagine you run the following “experiment”: you shake up the bag, close your eyes, and pull out 4 chips without putting any of them back into the bag. First out comes the \\(a\\) chip (black), then the \\(c\\) chip (white), then \\(j\\) (white) and then finally \\(b\\) (black). If you wanted, you could then put all the chips back in the bag and repeat the experiment, as depicted on the right hand side of Figure5.1. Each time you get different results, but the procedure is identical in each case. The fact that the same procedure can lead to different results each time, we refer to it as a random process. However, because we shook the bag before pulling any chips out, it seems reasonable to think that every chip has the same chance of being selected. A procedure in which every member of the population has the same chance of being selected is called a simple random sample. The fact that we did not put the chips back in the bag after pulling them out means that you can’t observe the same thing twice, and in such cases the observations are said to have been sampled without replacement. To help make sure you understand the importance of the sampling procedure, consider an alternative way in which the experiment could have been run. Suppose that my 5-year old son had opened the bag, and decided to pull out four black chips without putting any of them back in the bag. This biased sampling scheme is depicted in Figure 5.2. Figure 5.2: Biased sampling without replacement from a finite population Now consider the evidentiary value of seeing 4 black chips and 0 white chips. Clearly, it depends on the sampling scheme, does it not? If you know that the sampling scheme is biased to select only black chips, then a sample that consists of only black chips doesn’t tell you very much about the population! For this reason, statisticians really like it when a data set can be considered a simple random sample, because it makes the data analysis much easier. A third procedure is worth mentioning. This time around we close our eyes, shake the bag, and pull out a chip. This time, however, we record the observation and then put the chip back in the bag. Again we close our eyes, shake the bag, and pull out a chip. We then repeat this procedure until we have 4 chips. Data sets generated in this way are still simple random samples, but because we put the chips back in the bag immediately after drawing them it is referred to as a sample with replacement. The difference between this situation and the first one is that it is possible to observe the same population member multiple times, as illustrated in Figure 5.3. Figure 5.3: Simple random sampling with replacement from a finite population Most psychology experiments tend to be sampling without replacement, because the same person is not allowed to participate in the experiment twice. However, most statistical theory is based on the assumption that the data arise from a simple random sample with replacement. In real life, this very rarely matters. If the population of interest is large (e.g., has more than 10 entities!) the difference between sampling with- and without- replacement is too small to be concerned with. The difference between simple random samples and biased samples, on the other hand, is not such an easy thing to dismiss. 5.1.3 Most samples are not simple random samples As you can see from looking at the list of possible populations that I showed above, it is almost impossible to obtain a simple random sample from most populations of interest. When I run experiments, I’d consider it a minor miracle if my participants turned out to be a random sampling of the undergraduate psychology students at Adelaide university, even though this is by far the narrowest population that I might want to generalise to. A thorough discussion of other types of sampling schemes is beyond the scope of this book, but to give you a sense of what’s out there I’ll list a few of the more important ones: Stratified sampling. Suppose your population is (or can be) divided into several different subpopulations, or strata. Perhaps you’re running a study at several different sites, for example. Instead of trying to sample randomly from the population as a whole, you instead try to collect a separate random sample from each of the strata. Stratified sampling is sometimes easier to do than simple random sampling, especially when the population is already divided into the distinct strata. It can also be more efficient that simple random sampling, especially when some of the subpopulations are rare. For instance, when studying schizophrenia it would be much better to divide the population into two strata (schizophrenic and not-schizophrenic), and then sample an equal number of people from each group. If you selected people randomly, you would get so few schizophrenic people in the sample that your study would be useless. This specific kind of of stratified sampling is referred to as oversampling because it makes a deliberate attempt to over-represent rare groups. Snowball sampling is a technique that is especially useful when sampling from a “hidden” or hard to access population, and is especially common in social sciences. For instance, suppose the researchers want to conduct an opinion poll among transgender people. The research team might only have contact details for a few trans folks, so the survey starts by asking them to participate (stage 1). At the end of the survey, the participants are asked to provide contact details for other people who might want to participate. In stage 2, those new contacts are surveyed. The process continues until the researchers have sufficient data. The big advantage to snowball sampling is that it gets you data in situations that might otherwise be impossible to get any. On the statistical side, the main disadvantage is that the sample is highly non-random, and non-random in ways that are difficult to address. On the real life side, the disadvantage is that the procedure can be unethical if not handled well, because hidden populations are often hidden for a reason. I chose transgender people as an example here to highlight this: if you weren’t careful you might end up outing people who don’t want to be outed (very, very bad form), and even if you don’t make that mistake it can still be intrusive to use people’s social networks to study them. It’s certainly very hard to get people’s informed consent before contacting them, yet in many cases the simple act of contacting them and saying “hey we want to study you” can be hurtful. Social networks are complex things, and just because you can use them to get data doesn’t always mean you should. Convenience sampling is more or less what it sounds like. The samples are chosen in a way that is convenient to the researcher, and not selected at random from the population of interest. Snowball sampling is one type of convenience sampling, but there are many others. A common example in psychology are studies that rely on undergraduate psychology students. These samples are generally non-random in two respects: firstly, reliance on undergraduate psychology students automatically means that your data are restricted to a single subpopulation. Secondly, the students usually get to pick which studies they participate in, so the sample is a self selected subset of psychology students not a randomly selected subset. In real life, most studies are convenience samples of one form or another. This is sometimes a severe limitation, but not always. 5.1.4 How much does it matter if you don’t have a simple random sample? Okay, so real world data collection tends not to involve nice simple random samples. Does that matter? A little thought should make it clear to you that it can matter if your data are not a simple random sample: just think about the difference between Figures5.1 and 5.2. However, it’s not quite as bad as it sounds. Some types of biased samples are entirely unproblematic. For instance, when using a stratified sampling technique you actually know what the bias is because you created it deliberately, often to increase the effectiveness of your study, and there are statistical techniques that you can use to adjust for the biases you’ve introduced (not covered in this book!). So in those situations it’s not a problem. More generally though, it’s important to remember that random sampling is a means to an end, not the end in itself. Let’s assume you’ve relied on a convenience sample, and as such you can assume it’s biased. A bias in your sampling method is only a problem if it causes you to draw the wrong conclusions. When viewed from that perspective, I’d argue that we don’t need the sample to be randomly generated in every respect: we only need it to be random with respect to the psychologically-relevant phenomenon of interest. Suppose I’m doing a study looking at working memory capacity. In study 1, I actually have the ability to sample randomly from all human beings currently alive, with one exception: I can only sample people born on a Monday. In study 2, I am able to sample randomly from the Australian population. I want to generalise my results to the population of all living humans. Which study is better? The answer, obviously, is study 1. Why? Because we have no reason to think that being “born on a Monday” has any interesting relationship to working memory capacity. In contrast, I can think of several reasons why “being Australian” might matter. Australia is a wealthy, industrialised country with a very well-developed education system. People growing up in that system will have had life experiences much more similar to the experiences of the people who designed the tests for working memory capacity. This shared experience might easily translate into similar beliefs about how to “take a test”, a shared assumption about how psychological experimentation works, and so on. These things might actually matter. For instance, “test taking” style might have taught the Australian participants how to direct their attention exclusively on fairly abstract test materials relative to people that haven’t grown up in a similar environment; leading to a misleading picture of what working memory capacity is. There are two points hidden in this discussion. Firstly, when designing your own studies, it’s important to think about what population you care about, and try hard to sample in a way that is appropriate to that population. In practice, you’re usually forced to put up with a “sample of convenience” (e.g., psychology lecturers sample psychology students because that’s the least expensive way to collect data, and our coffers aren’t exactly overflowing with gold), but if so you should at least spend some time thinking about what the dangers of this practice might be. Secondly, if you’re going to criticise someone else’s study because they’ve used a sample of convenience rather than laboriously sampling randomly from the entire human population, at least have the courtesy to offer a specific theory as to how this might have distorted the results. Remember, everyone in science is aware of this issue, and does what they can to alleviate it. Merely pointing out that “the study only included people from group BLAH” is entirely unhelpful, and borders on being insulting to the researchers, who are aware of the issue. They just don’t happen to be in possession of the infinite supply of time and money required to construct the perfect sample. In short, if you want to offer a responsible critique of the sampling process, then be helpful. Rehashing the blindingly obvious truisms that I’ve been rambling on about in this section isn’t helpful. 5.1.5 Population parameters and sample statistics Okay. Setting aside the thorny methodological issues associated with obtaining a random sample, let’s consider a slightly different issue. Up to this point we have been talking about populations the way a scientist might. To a psychologist, a population might be a group of people. To an ecologist, a population might be a group of bears. In most cases the populations that scientists care about are concrete things that actually exist in the real world. Statisticians, however, are a funny lot. On the one hand, they are interested in real world data and real science in the same way that scientists are. On the other hand, they also operate in the realm of pure abstraction in the way that mathematicians do. As a consequence, statistical theory tends to be a bit abstract in how a population is defined. In much the same way that psychological researchers operationalise our abstract theoretical ideas in terms of concrete measurements, statisticians operationalise the concept of a “population” in terms of mathematical objects that they know how to work with. You’ve already come across these objects they’re called probability distributions (remember, the place where data comes from). The idea is quite simple. Let’s say we’re talking about IQ scores. To a psychologist, the population of interest is a group of actual humans who have IQ scores. A statistician “simplifies” this by operationally defining the population as the probability distribution depicted in Figure 5.4a. . Figure 5.4: The population distribution of IQ scores (panel a) and two samples drawn randomly from it. In panel b we have a sample of 100 observations, and panel c we have a sample of 10,000 observations. IQ tests are designed so that the average IQ is 100, the standard deviation of IQ scores is 15, and the distribution of IQ scores is normal. These values are referred to as the population parameters because they are characteristics of the entire population. That is, we say that the population mean \\(\\mu\\) is 100, and the population standard deviation \\(\\sigma\\) is 15. Now suppose we collect some data. We select 100 people at random and administer an IQ test, giving a simple random sample from the population. The sample would consist of a collection of numbers like this: 106 101 98 80 74 ... 107 72 100 Each of these IQ scores is sampled from a normal distribution with mean 100 and standard deviation 15. So if I plot a histogram of the sample, I get something like the one shown in Figure 5.4b. As you can see, the histogram is roughly the right shape, but it’s a very crude approximation to the true population distribution shown in Figure 5.4a. The mean of the sample is fairly close to the population mean 100 but not identical. In this case, it turns out that the people in the sample have a mean IQ of 98.5, and the standard deviation of their IQ scores is 15.9. These sample statistics are properties of the data set, and although they are fairly similar to the true population values, they are not the same. In general, sample statistics are the things you can calculate from your data set, and the population parameters are the things you want to learn about. Later on in this chapter we’ll talk about how you can estimate population parameters using your sample statistics and how to work out how confident you are in your estimates but before we get to that there’s a few more ideas in sampling theory that you need to know about. 5.2 The law of large numbers We just looked at the results of one fictitious IQ experiment with a sample size of \\(N=100\\). The results were somewhat encouraging: the true population mean is 100, and the sample mean of 98.5 is a pretty reasonable approximation to it. In many scientific studies that level of precision is perfectly acceptable, but in other situations you need to be a lot more precise. If we want our sample statistics to be much closer to the population parameters, what can we do about it? The obvious answer is to collect more data. Suppose that we ran a much larger experiment, this time measuring the IQs of 10,000 people. We can simulate the results of this experiment using R, using the rnorm() function, which generates random numbers sampled from a normal distribution. For an experiment with a sample size of n = 10000, and a population with mean = 100 and sd = 15, R produces our fake IQ data using these commands: IQ &lt;- rnorm(n=10000, mean=100, sd=15) #generate IQ scores IQ &lt;- round(IQ) # make round numbers Cool, we just generated 10,000 fake IQ scores. Where did they go? Well, they went into the variable IQ on my computer. You can do the same on your computer too by copying the above code. 10,000 numbers is too many numbers to look at. We can look at the first 100 like this: print(IQ[1:100]) ## [1] 114 139 95 118 68 84 82 104 97 119 110 97 97 103 121 76 118 ## [18] 54 75 110 90 96 87 121 117 86 118 81 93 110 99 104 129 98 ## [35] 104 90 95 80 115 96 95 105 97 82 93 86 97 98 104 97 89 ## [52] 81 108 110 105 96 115 115 83 107 89 97 99 100 91 126 74 103 ## [69] 108 110 107 98 96 110 104 122 87 80 92 75 113 94 140 80 80 ## [86] 102 103 103 99 99 90 84 83 94 112 90 127 115 93 86 We can compute the mean IQ using the command mean(IQ) and the standard deviation using the command sd(IQ), and draw a histgram using hist(). The histogram of this much larger sample is shown in Figure 5.4c. Even a moment’s inspections makes clear that the larger sample is a much better approximation to the true population distribution than the smaller one. This is reflected in the sample statistics: the mean IQ for the larger sample turns out to be 99.9, and the standard deviation is 15.1. These values are now very close to the true population. I feel a bit silly saying this, but the thing I want you to take away from this is that large samples generally give you better information. I feel silly saying it because it’s so bloody obvious that it shouldn’t need to be said. In fact, it’s such an obvious point that when Jacob Bernoulli – one of the founders of probability theory – formalised this idea back in 1713, he was kind of a jerk about it. Here’s how he described the fact that we all share this intuition: For even the most stupid of men, by some instinct of nature, by himself and without any instruction (which is a remarkable thing), is convinced that the more observations have been made, the less danger there is of wandering from one’s goal (see Stigler, 1986, p65). Okay, so the passage comes across as a bit condescending (not to mention sexist), but his main point is correct: it really does feel obvious that more data will give you better answers. The question is, why is this so? Not surprisingly, this intuition that we all share turns out to be correct, and statisticians refer to it as the law of large numbers. The law of large numbers is a mathematical law that applies to many different sample statistics, but the simplest way to think about it is as a law about averages. The sample mean is the most obvious example of a statistic that relies on averaging (because that’s what the mean is… an average), so let’s look at that. When applied to the sample mean, what the law of large numbers states is that as the sample gets larger, the sample mean tends to get closer to the true population mean. Or, to say it a little bit more precisely, as the sample size “approaches” infinity (written as \\(N \\rightarrow \\infty\\)) the sample mean approaches the population mean (\\(\\bar{X} \\rightarrow \\mu\\)). I don’t intend to subject you to a proof that the law of large numbers is true, but it’s one of the most important tools for statistical theory. The law of large numbers is the thing we can use to justify our belief that collecting more and more data will eventually lead us to the truth. For any particular data set, the sample statistics that we calculate from it will be wrong, but the law of large numbers tells us that if we keep collecting more data those sample statistics will tend to get closer and closer to the true population parameters. 5.3 Sampling distributions and the central limit theorem The law of large numbers is a very powerful tool, but it’s not going to be good enough to answer all our questions. Among other things, all it gives us is a “long run guarantee”. In the long run, if we were somehow able to collect an infinite amount of data, then the law of large numbers guarantees that our sample statistics will be correct. But as John Maynard Keynes famously argued in economics, a long run guarantee is of little use in real life: [The] long run is a misleading guide to current affairs. In the long run we are all dead. Economists set themselves too easy, too useless a task, if in tempestuous seasons they can only tell us, that when the storm is long past, the ocean is flat again. Keynes (1923, 80) As in economics, so too in psychology and statistics. It is not enough to know that we will eventually arrive at the right answer when calculating the sample mean. Knowing that an infinitely large data set will tell me the exact value of the population mean is cold comfort when my actual data set has a sample size of \\(N=100\\). In real life, then, we must know something about the behaviour of the sample mean when it is calculated from a more modest data set! 5.3.1 Sampling distribution of the sample means “Oh no, what is the sample distribution of the sample means? Is that even allowed in English?”. Yes, unfortunately, this is allowed. The sampling distribution of the sample means is the next most important thing you will need to understand. IT IS SO IMPORTANT THAT IT IS NECESSARY TO USE ALL CAPS. It is only confusing at first because it’s long and uses sampling and sample in the same phrase. Don’t worry, we’ve been prepping you for this. You know what a distribution is right? It’s where numbers comes from. It makes some numbers occur more or less frequently, or the same as other numbers. You know what a sample is right? It’s the numbers we take from a distribution. So, what could the sampling distribution of the sample means refer to? First, what do you think the sample means refers to? Well, if you took a sample of numbers, you would have a bunch of numbers…then, you could compute the mean of those numbers. The sample mean is the mean of the numbers in the sample. That is all. So, what is this distribution you speak of? Well, what if you took a bunch of samples of, put one here, put one there, put some other ones other places. You have a lot of different samples of numbers. You could compute the mean for each them. Then you would have a bunch of means. What do those means look like? Well, if you put them in a histogram, you could find out. If you did that, you would be looking at (roughly) a distribution, AKA the sampling distribution of the sample means. “I’m following along sort of, why would I want to do this instead of watching netflix…”. Because, the sampling distribution of the sample means gives you another window into chance. A very useful one that you can control, just like your remote control, by pressing the right design buttons. 5.3.1.1 Seeing the pieces To make a sampling distribution of the sample means, we just need the following: A distribution to take numbers from A bunch of different samples from the distribution The means of each of the samples Get all of the sample means, and plot them in a histogram Question for yourself: What do you think the sampling distribution of the sample means will look like? Will it tend to look the shape of the distribution that the samples came from? Or not? Good question, think about it. Let’s do those four things. We already know about the uniform distribution. So, let’s use that for fun. Remember, it looks like this if we are sampling from the set of integers from 1 to 10: Ok, now let’s take a bunch of samples from that distribution. We will set our sample-size to 20. It’s easier to see how the sample mean behaves in a movie. Each histogram shows a new sample. The red line shows where the mean of the sample is. The samples are all very different from each other, but the red line doesn’t move around very much, it always stays near the middle. However, the red line does move around a little bit, and this variance is what we call the sampling distribution of the sample mean. Ok, what have we got here? We have 10 different samples. Each sample has 20 observations and these are summarized in each of the 10 histograms. Each histogram has a red line. The red line shows you where the mean of each sample is located. So, we have found the sample means for the 10 different samples from a uniform distribution. First question. Are the sample means all the same? The answer is no. They are all kind of similar to each other though, they are all around five plus or minus a few numbers. This is interesting. Although all of our samples look pretty different from one another, the means of our samples look more similar than different. Second question. What should we do with the means of our samples? Well, how about we collect them them all, and then plot a histogram of them. This would allow us to see what the distribution of the sample means looks like. The next histogram is just this. Except, rather than taking 10 samples, we will take 10,000 samples. For each of them we will compute the means. So, we will have 10,000 means. This is the histogram of the sample means: “Wait what? This doesn’t look right. I thought we were taking samples from a uniform distribution. Uniform distributions are flat. I thought you said that when you take lots and lots of sample, which is what you did, that the more you have, the more they will look the distribution they came from…THIS DOES NOT LOOK LIKE A FLAT DISTRIBTUION, WHAT IS GOING ON, AAAAAGGGHH.”. We feel your pain. Remember, we are looking at the distribution of sample means. It is indeed true that the distribution of sample means does not look the same as the distribution we took the samples from. Our distribution of sample means goes up and down. In fact, this will almost always be the case for distributions of sample means. This fact is called the central limit theorem, which we talk about later. For now, let’s talk about about what’s happening. Remember, we have been sampling numbers between the range 1 to 10. We are supposed to get each number with roughly equal frequency, because we are sampling from a uniform distribution. So, let’s say we took a sample of 10 numbers, and happened to get one of each from 1 to 10. 1 2 3 4 5 6 7 8 9 10 What is the mean of those numbers? Well, its 1+2+3+4+5+6+7+8+9+10 = 55 / 10 = 5.5. Imagine if we took a bigger sample, say of 20 numbers, and again we got exactly 2 of each number. What would the mean be? It would be (1+2+3+4+5+6+7+8+9+10)*2 = 110 / 20 = 5.5. Still 5.5. You can see here, that the mean value of our uniform distribution is 5.5. Now that we know this, we might expect that most of our samples will have a mean near this number. We already know that every sample won’y be perfect, and it won’t have exactly an equal amount of every number. So, we will expect the mean of our samples to vary a little bit. The histogram that we made shows the variation. Not surprisingly, the numbes vary around the value 5.5. 5.3.2 Sampling distributions exist for any sample statistic! One thing to keep in mind when thinking about sampling distributions is that any sample statistic you might care to calculate has a sampling distribution. For example, suppose that each time you sampled some numbers experiment you wrote down the largest number in the experiment. Doing this over and over again would give you a very different sampling distribution, namely the sampling distribution of the maximum. You could calculate the smallest number, or the mode, or the median, of the variance, or the standard deviation, or anything else from your sample. Then, you could repeat many times, and produce the sampling distribution of those statistics. Neat! Just for fun here are some different sampling distributions for different statistics. We will take a normal distribution with mean = 100, and standard deviation =20. Then, we’ll take lots of sample with n = 50 (50 observations per sample). We’l save all of the sample statistics, then plot their histograms. Let’s do it: We just computed 4 different sampling distributions, for the mean, standard deviation, maximum value, and the median. If you just look quickly at these histograms you might think they all basically look the same. Hold up now. It’s very important to look at the x-axes. They are different. For example, the sample mean goes from about 90 to 110, whereas the standard deviation goes from 15 to 25. Finally, while it is true that these histograms all look like normal distributions, notice that the distribution for the sample max is kind of skewed, not totally symmetrical. These sampling distributions are super important, and worth thinking about. What should you think about? Well, here’s a clue. These distributions are telling you what to expect from your sample. Critically, they are telling you what you should expect from a sample, when you take one from the specific distribution that we used (normal distribution with mean =100 and sd = 20). What have we learned. We’ve leard a tonne. We’ve learned that we can expect our sample to have a mean somewhere between 90 and 108ish. Notice, the sample means are never more extreme. We’ve learned that our sample with usually have some variance, and that the the standard deviation will be somewhere between 15 and 25 (never much more extreme than that). We can see that sometime we get some big numbers, say between 120 and 180, but not much bigger than tha. And, we can see that the median is pretty similar to the mean. If you ever took a sample of 50 numbers, and your descriptive statistics were inside these windows, then perhaps they came from this kind of normal distribution. If your sample statistics are very different, then your sample probably did not come this distribution. By using simulation, we can find out what samples look like when they come from distributions, and we can use this information to make inferences about whether our sample came from particular distributions. 5.3.3 The central limit theorem Ok, so no you’ve seen lots of sampling distributions, and you know what the sampling distribution of the mean is. Here, we’ll focus on how the sampling distribution of the mean changes as a function of sample size. Intuitively, you already know part of the answer: if you only have a few observations, the sample mean is likely to be quite inaccurate (you’ve already seen it bounce aronud): if you replicate a small experiment and recalculate the mean you’ll get a very different answer. In other words, the sampling distribution is quite wide. If you replicate a large experiment and recalculate the sample mean you’ll probably get the same answer you got last time, so the sampling distribution will be very narrow. Let’s give ourselves a nice movie to see everything in action. We’re going to sample numbers from a normal distribution. You will see four panels, each panel represents a different sample size (n), including sample-sizes of 10, 50, 100, and 1000. The red line shows the shape of the normal distribution. The grey bars show a histogram of each of the samples that we take. The red line shows the mean of an individual sample (the middle of the grey bars). As you can see, the red line moves around alot, especially when the sample size is small (10). The new bits are the blue bars and the blue lines. The blue bars represent the sampling distribution of the sample mean. For example, in the panel for sample-size 10, we see a bunch of blue bars. This is a histogram of 10 sample means, taken from 10 samples of size 10. In the 50 panel, we see a histogram of 50 sample means, taken from 50 samples of size 50, and so on. The blue line in each panel is the mean of the sample means (“aaa, it’s a mean of means”, yes it is). What should you notice? Notice that the width of the blue bars shrink as sample size increases. The sampling distribution of the mean is qutie wide when the sample-size is 10, it narrows as sample-size increases to 50 and 100, and it’s just one bar, right in the middle when sample-size goes to 1000. What we are seeing is that the mean of the sampling distribution approaches the mean of the population as sample-size increases. So, the sampling distribution of the mean is another distribution, and it has some variance. It varies more when sample-size is small, and varies less when sample-size is large. We can quantify this effect by calculating the standard deviation of the sampling distribution, which is referred to as the standard error. The standard error of a statistic is often denoted SE, and since we’re usually interested in the standard error of the sample mean, we often use the acronym SEM. As you can see just by looking at the movie, as the sample size \\(N\\) increases, the SEM decreases. Okay, so that’s one part of the story. However, there’s something we’ve been glossing over a little bit. We’ve seen it already, but it’s worth looking at it one more time. Here’s the thing: no matter what shape your population distribution is, as \\(N\\) increases the sampling distribution of the mean starts to look more like a normal distribution. This is the central limit theorem. To see the central limit theoreom in action, we are going to look at some histrograms of sample means different kinds of distributions. It is very important to recognize that you are looking at distributions of sample means, not distributions of individual samples! Here we go, starting with sampling from a normal distribution. The red line is the distribution, the blue bars are the histogram for the sample means. They both look normal! Let’s do it again. This time we sample from a flat uniform distribution. Again, we see that the distribution of the sample means is not flat, it looks like a normal distribution. One more time with an exponential distribution. Even though way more of the numbers should be smaller than bigger, then sapmling distribution of the mean again does not look the red line. Instead, it looks more normalish. That’s the central limit theorem. It just works like that. On the basis of these figures, it seems like we have evidence for all of the following claims about the sampling distribution of the mean: The mean of the sampling distribution is the same as the mean of the population The standard deviation of the sampling distribution (i.e., the standard error) gets smaller as the sample size increases The shape of the sampling distribution becomes normal as the sample size increases As it happens, not only are all of these statements true, there is a very famous theorem in statistics that proves all three of them, known as the central limit theorem. Among other things, the central limit theorem tells us that if the population distribution has mean \\(\\mu\\) and standard deviation \\(\\sigma\\), then the sampling distribution of the mean also has mean \\(\\mu\\), and the standard error of the mean is \\[\\mbox{SEM} = \\frac{\\sigma}{ \\sqrt{N} }\\] Because we divide the population standard devation \\(\\sigma\\) by the square root of the sample size \\(N\\), the SEM gets smaller as the sample size increases. It also tells us that the shape of the sampling distribution becomes normal. This result is useful for all sorts of things. It tells us why large experiments are more reliable than small ones, and because it gives us an explicit formula for the standard error it tells us how much more reliable a large experiment is. It tells us why the normal distribution is, well, normal. In real experiments, many of the things that we want to measure are actually averages of lots of different quantities (e.g., arguably, “general” intelligence as measured by IQ is an average of a large number of “specific” skills and abilities), and when that happens, the averaged quantity should follow a normal distribution. Because of this mathematical law, the normal distribution pops up over and over again in real data. 5.4 Estimating population parameters Let’s pause for a moment to get our bearings. We’re about to go into the topic of estimation. What is that, and why should you care? First, population parameters are things about a distribution. For example, distributions have means. The mean is a parameter of the distribution. The standard deviation of a distribution is a parameter. Anything that can describe a distribution is a potential parameter. Ok fine, who cares? This I think, is a really good question. There are some good concrete reasons to care. And there are some great abstract reasons to care. Unfortunately, most of the time in research, it’s the abstract reasons that matter most, and these can be the most difficult to get your head around. 5.4.1 Concrete popopulation parameters First some concrete reasons. There are real populations out there, and sometimes you want to know the parameters of them. For example, if you are a shoe company, you would want to know about the population parameters of feet size. As a first pass, you would want to know the mean and standard deviation of the population. If your company knew this, and other companies did not, your company would do better (assuming all shoes are made equal). Why would your company do better, and how could it use the paramaters? Here’s one good reason. As a shoe company you want to meet demand with the right amount of supply. If you make too many big or small shoes, and there aren’t enough people to buy them, then you’re making extra shoes that don’t sell. If you don’t make enough of the most popular sizes, you’ll be leaving money on the table. Right? Yes. So, what would be an optimal thing to do? Perhaps, you would make different amounts of shoes in each size, corresponding to how the frequency of those sizes in the population. You would need to know the population parameters to do this. Fortunately, it’s pretty easy to get the population parameters without measuring the entire population. Who has time to measure everybodies feet? Nobody, that’s who. Instead, you would just need to randomly pick a bunch of people, measure their feet, and then measure the parameters of the sample. If you take a big enough sample, we have learned that the sample mean gives a very good estimate of the population mean. We will learn shortly that a version of the standard deviation of the sample also gives a good estimate of the standard deviation of the population. Perhaps shoe-sizes have a slightly different shape than a normal distribution. Here too, if you collect a big enough sample, the shape of the distribution of the sample will be a good estimate of the shape of the populations. All of these are good reasons to care about estimating population parameters. But, do you run a shoe company? Probably not. 5.4.2 Abstract population parameters Even when we think we are talking about something concrete in Psychology, it often gets abstract right away. Instead of measuring the population of feet-sizes, how about the population of human happiness. We all think we know what happiness is, everyone has more or less of it, there are a bunch of people, so there must be a population of happiness right? Perhaps, but it’s not very concrete. The first problem is figuring out how to measure happiness. Let’s use a questionnaire. Consider these questions: How happy are you right now on a scale from 1 to 7? How happy are you in general on a scale from 1 to 7? How happy are you in the mornings on a scale from 1 to 7? How happy are you in the afternoons on a scale from 1 to 7? 1 = very unhappy 2 = unhappy 3 = sort of unhappy 4 = in the middle 5 = sort of happy 6 = happy 7 = very happy Forget about asking these questions to everybody in the world. Let’s just ask them to lots of people (our sample). What do you think would happen? Well, obviously people would give all sorts of answers right. We could tally up the answers and plot them in a histogram. This would show us a distribution of happiness scores from our sample. “Great, fantastic!”, you say. Yes, fine and dandy. So, on the one hand we could say lots of things about the people in our sample. We could say exactly who says they are happy and who says they aren’t, after all they just told us! But, what can we say about the larger population? Can we use the parameters of our sample (e.g., mean, standard deviation, shape etc.) to estimate something about a larger population. Can we infer how happy everybody else is, just from our sample? HOLD THE PHONE. 5.4.2.1 Complications with inference Before listing a bunch of complications, let me tell you what I think we can do with our sample. Provided it is big enough, our sample parameters will be a pretty good estimate of what another sample would look like. Because of the following discussion, this is often all we can say. But, that’s ok, as you see throughout this book, we can work with that! Problem 1: Muliple populations: If you looked at a large sample of questionnaire data you will find evidence of multiple distributions inside your sample. People answer questions differently. Some people are very cautious and not very extreme. There answers will tend to be distributed about the middle of the scale, mostly 3s, 4s, and 5s. Some people are very bimodal, they are very happy and very unhappy, depending on time of day. These people’s answers will be mostly 1s and 2s, and 6s and 7s, and those numbers look like they come from a completely different distribution. Some people are entirely happy or entirely unhappy. Again, these two “populations” of people’s numbers look liek two different distributions, one with mostly 6s and 7s, and one with mostly 1s and 2s. Other people will be more random, and their scores will look like a uniform distribution. So, is there a single population with parameters that we can estimate from our sample? Probably not. Could be a mixture of lots of populations with differnet distributions. Problem 2: What do these questions measure?: If the whole point of doing the questionnaire is to estimate the population’s happiness, we really need wonder if the sample measurements actually tell us anything about happiness in the first place. Some questions: Are people accurate in saying how happy they are? Does the measure of happiness depend on the scale, for example, would the results be different if we used 0-100, or -100, to +100, or no numbers (we know this matters). Does the measure of happiness depend on the wording in the question (we know this matters alot). Does a measure like this one tell us everything we want to know about happiness (probably not), what is it missing (who knows? probably lots). In short, nobody knows if these kinds of questions measure what we want them to measure. We just hope that they do. Instead, we have a very good idea of the kinds of things that they actually measure. It’s really quite obvious, and staring you in the face. Questionnaire measurements measure how people answer questionnaires. In other words, how people behave and answer questions when they are given a questionnaire. This might also measure something about happiness, when the question has to do about happiness. But, it turns out people are remarkably consistent in how they answer questions, even when the questions are total nonsense, or have no questions at all (just numbers to choose!) Maul (2017). The take home complications here are that we can collect samples, but in Psychology, we often don’t have a good idea of the populations that might be linked to these samples. There might be lots of populations, or the populations could be different depending on who you ask. Finally, the “population” might not be the one you want it to be. 5.4.3 Experiments and Population parameters Ok, so we don’t own a shoe company, and we can’t really identify the population of interest in Psychology, can’t we just skip this section on estimation? After all, the “population” is just too weird and abstract and useless and contentious. HOLD THE PHONE AGAIN! It turns out we can apply the things we have been learning to solve lots of important problems in research. These allow us to answer questions with the data that we collect. Parameter estimation is one of these tools. We just need to be a little bit more creative, and a little bit more abstract to use the tools. Here is what we know already. The numbers that we measure come from somewhere, we have called this place “distributions”. Distributions control how the numbers arrive. Some numbers happen more than others depending on the distribution. We assume, even if we don’t know what the distribution is, or what it means, that the numbers came from one. Second, when get some numbers, we call it a sample. This entire chapter so far has taught you one thing. When your sample is big, it resembles the distribution it came from. And, when your sample is big, it will resemble very closely what another big sample of the same thing will look like. We can use this knowledge! Very often as Psychologists what we want to know is what causes what. We want to know if X causes something to change in Y. Does eating chocolate make you happier? Does studying improve your grades? There a bazillions of these kinds of questions. And, we want answers to them. I’ve been trying to be mostly concrete so far in this textbook, that’s why we talk about silly things like chocolate and happiness, at least they are concrete. Let’s give a go at being abstract. We can do it. So, we want to know if X causes Y to change. What is X? What is Y? X is something you change, something you manipulate, the independent variable. Y is something you measure. So, we will be taking samples from Y. “Oh I get it, we’ll take samples from Y, then we can use the sample parameters to estimate the population paramaters of Y!” NO, not really, but yes sort of. We will take sample from Y, that is something we absolutely do. In fact, that is really all we ever do, which is why talking about the population of Y is kind of meaningless. We’re more interested in our samples of Y, and how they behave. So, what would happen if we removed X from the universe altogether, and then took a big sample of Y. We’ll pretend Y measures something in a Psychology experiment. So, we know right away that Y is variable. When we take a big sample, it will have a distribution (because Y is variable). So, we can do things like measure the mean of Y, and measure the standard deviation of Y, and anything else we want to know about Y. Fine. What would happen if we replicated this measurement. That is, we just take another random sample of Y, just as big as the first. What should happen is that our first sample should look alot like our second example. After all, we didn’t do anything to Y, we just took two big samples twice. Both of our samples will be a little bit different (due to sampling error), but they’ll be mostly the same. The bigger our samples, the more they will look the same, especially when we don’t do anything to cause them to be different. In other words, we can use the parameters of one sample to estimate the parameters of a second sample, because they will tend to be the same, especially when they are large. We are now ready for step two. You want to know if X changes Y. What do you do? You make X go up and take a big sample of Y then look at it. You make X go down, then take a second big sample of Y and look at it. Next, you compare the two samples of Y. If X does nothing then what should you find? We already discussed that in the previous paragraph. If X does nothing, then both of your big samples of Y should be pretty similar. However, if X does something to Y, then one of your big samples of Y will be different from the other. You will have changed something about Y. Maybe X makes the mean of Y change. Or maybe X makes the variation in Y change. Or, maybe X makes the whole shape of the distribution change. If we find any big changes that can’t be explained by sampling error, then we can conclude that something about X caused a change in Y! We could use this approach to learn about what causes what! The very important idea is still about estimation, just not population parameter estimation exactly. We know that when we take samples they naturally vary. So, when we estimate a parameter of a sample, like the mean, we know we are off by some amount. When we find that two samples are different, we need to find out if the size of the difference is consistent with what sampling error can produce, or if the difference is biggere than that. If the difference is bigger, then we can be confident that sampling error didn’t produce the difference. So, we can confidently infer that something else (like an X) did cause the difference. This bit of abstract thinking is what most of the rest of the textbook is about. Determining whether there is a difference caused by your manipulation. There’s more to the story, there always is. We can get more specific than just, is there a difference, but for introductory purposes, we will focus on the finding of differences as a foundational concept. 5.4.4 Interim summary We’ve talked about estimation without doing any estimation, so in the next section we will do some estimating of the mean and of the standard deviation. Formally, we talk about this as using a sample to estimate a paramater of the population. Feel free to think of the “population” in different ways. It could be concrete population, like the distribution of feet-sizes. Or, it could be something more abstract, like the parameter estimate of what samples usually look like when they come from a distribution. 5.4.5 Estimating the population mean Suppose we go to Brooklyn and 100 of the locals are kind enough to sit through an IQ test. The average IQ score among these people turns out to be \\(\\bar{X}=98.5\\). So what is the true mean IQ for the entire population of Brooklyn? Obviously, we don’t know the answer to that question. It could be \\(97.2\\), but if could also be \\(103.5\\). Our sampling isn’t exhaustive so we cannot give a definitive answer. Nevertheless if forced to give a “best guess” I’d have to say \\(98.5\\). That’s the essence of statistical estimation: giving a best guess. We’re using the sample mean as the best guess of the population mean. In this example, estimating the unknown poulation parameter is straightforward. I calculate the sample mean, and I use that as my estimate of the population mean. It’s pretty simple, and in the next section we’ll explain the statistical justification for this intuitive answer. However, for the moment let’s make sure you recognise that the sample statistic and the estimate of the population parameter are conceptually different things. A sample statistic is a description of your data, whereas the estimate is a guess about the population. With that in mind, statisticians often use different notation to refer to them. For instance, if true population mean is denoted \\(\\mu\\), then we would use \\(\\hat\\mu\\) to refer to our estimate of the population mean. In contrast, the sample mean is denoted \\(\\bar{X}\\) or sometimes \\(m\\). However, in simple random samples, the estimate of the population mean is identical to the sample mean: if I observe a sample mean of \\(\\bar{X} = 98.5\\), then my estimate of the population mean is also \\(\\hat\\mu = 98.5\\). To help keep the notation clear, here’s a handy table: Symbol What is it? Do we know what it is? \\(\\bar{X}\\) Sample mean Yes, calculated from the raw data \\(\\mu\\) True population mean Almost never known for sure \\(\\hat{\\mu}\\) Estimate of the population mean Yes, identical to the sample mean 5.4.6 Estimating the population standard deviation So far, estimation seems pretty simple, and you might be wondering why I forced you to read through all that stuff about sampling theory. In the case of the mean, our estimate of the population parameter (i.e. \\(\\hat\\mu\\)) turned out to identical to the corresponding sample statistic (i.e. \\(\\bar{X}\\)). However, that’s not always true. To see this, let’s have a think about how to construct an estimate of the population standard deviation, which we’ll denote \\(\\hat\\sigma\\). What shall we use as our estimate in this case? Your first thought might be that we could do the same thing we did when estimating the mean, and just use the sample statistic as our estimate. That’s almost the right thing to do, but not quite. Here’s why. Suppose I have a sample that contains a single observation. For this example, it helps to consider a sample where you have no intutions at all about what the true population values might be, so let’s use something completely fictitious. Suppose the observation in question measures the cromulence of my shoes. It turns out that my shoes have a cromulence of 20. So here’s my sample: 20 This is a perfectly legitimate sample, even if it does have a sample size of \\(N=1\\). It has a sample mean of 20, and because every observation in this sample is equal to the sample mean (obviously!) it has a sample standard deviation of 0. As a description of the sample this seems quite right: the sample contains a single observation and therefore there is no variation observed within the sample. A sample standard deviation of \\(s = 0\\) is the right answer here. But as an estimate of the population standard deviation, it feels completely insane, right? Admittedly, you and I don’t know anything at all about what “cromulence” is, but we know something about data: the only reason that we don’t see any variability in the sample is that the sample is too small to display any variation! So, if you have a sample size of \\(N=1\\), it feels like the right answer is just to say “no idea at all”. Notice that you don’t have the same intuition when it comes to the sample mean and the population mean. If forced to make a best guess about the population mean, it doesn’t feel completely insane to guess that the population mean is 20. Sure, you probably wouldn’t feel very confident in that guess, because you have only the one observation to work with, but it’s still the best guess you can make. Let’s extend this example a little. Suppose I now make a second observation. My data set now has \\(N=2\\) observations of the cromulence of shoes, and the complete sample now looks like this: 20, 22 This time around, our sample is just large enough for us to be able to observe some variability: two observations is the bare minimum number needed for any variability to be observed! For our new data set, the sample mean is \\(\\bar{X}=21\\), and the sample standard deviation is \\(s=1\\). What intuitions do we have about the population? Again, as far as the population mean goes, the best guess we can possibly make is the sample mean: if forced to guess, we’d probably guess that the population mean cromulence is 21. What about the standard deviation? This is a little more complicated. The sample standard deviation is only based on two observations, and if you’re at all like me you probably have the intuition that, with only two observations, we haven’t given the population “enough of a chance” to reveal its true variability to us. It’s not just that we suspect that the estimate is wrong: after all, with only two observations we expect it to be wrong to some degree. The worry is that the error is systematic. If the error is systematic, that means it is biased. For example, imagine if the sample mean was always smaller than the population mean. If this was true (it’s not), then we couldn’t use the sample mean as an estimator. It would be biased, we’d be using the wrong number. It turns out the sample standard deviation is a biased estimator of the population standard deviation. We can sort of anticipate this by what we’ve been discussing. When the sample size is 1, the standard deviation is 0, which is obviously to small. When the sample size is 2, the standard deiviation becomes a number bigger than 0, but because we only have two sample, we suspect it might still be too small. Turns out this intuition is correct. It would be nice to demonstrate this somehow. There are in fact mathematical proofs that confirm this intuition, but unless you have the right mathematical background they don’t help very much. Instead, what I’ll do is use R to simulate the results of some experiments. With that in mind, let’s return to our IQ studies. Suppose the true population mean IQ is 100 and the standard deviation is 15. I can use the rnorm() function to generate the the results of an experiment in which I measure \\(N=2\\) IQ scores, and calculate the sample standard deviation. If I do this over and over again, and plot a histogram of these sample standard deviations, what I have is the sampling distribution of the standard deviation. I’ve plotted this distribution in Figure 5.5. Figure 5.5: The sampling distribution of the sample standard deviation for a two IQ scores experiment. The true population standard deviation is 15 (dashed line), but as you can see from the histogram, the vast majority of experiments will produce a much smaller sample standard deviation than this. On average, this experiment would produce a sample standard deviation of only 8.5, well below the true value! In other words, the sample standard deviation is a biased estimate of the population standard deviation. Even though the true population standard deviation is 15, the average of the sample standard deviations is only 8.5. Notice that this is a very different from when we were plotting sampling distributions of the sample mean, those were always centered around the mean of the population. Now let’s extend the simulation. Instead of restricting ourselves to the situation where we have a sample size of \\(N=2\\), let’s repeat the exercise for sample sizes from 1 to 10. If we plot the average sample mean and average sample standard deviation as a function of sample size, you get the following results. Figure 5.6 shows the sample mean as a function of sample size. Notice it’s a flat line. The sample mean doesn’t underestimate or overestimate the population mean. It is an unbiased estimate! Figure 5.6: An illustration of the fact that the sample mean is an unbiased estimator of the population mean. Figure 5.7 shows the sample standard deviation as a function of sample size. Notice it is not a flat line. The sample standard deviation systematically underestimates the population standard deviation! Figure 5.7: An illustration of the fact that the the sample standard deviation is a biased estimator of the population standard deviation In other words, if we want to make a “best guess” (\\(\\hat\\sigma\\), our estimate of the population standard deviation) about the value of the population standard deviation \\(\\sigma\\), we should make sure our guess is a little bit larger than the sample standard deviation \\(s\\). The fix to this systematic bias turns out to be very simple. Here’s how it works. Before tackling the standard deviation, let’s look at the variance. If you recall from the second chapter, the sample variance is defined to be the average of the squared deviations from the sample mean. That is: \\[s^2 = \\frac{1}{N} \\sum_{i=1}^N (X_i - \\bar{X})^2\\] The sample variance \\(s^2\\) is a biased estimator of the population variance \\(\\sigma^2\\). But as it turns out, we only need to make a tiny tweak to transform this into an unbiased estimator. All we have to do is divide by \\(N-1\\) rather than by \\(N\\). If we do that, we obtain the following formula: \\[\\hat\\sigma^2 = \\frac{1}{N-1} \\sum_{i=1}^N (X_i - \\bar{X})^2\\] This is an unbiased estimator of the population variance \\(\\sigma\\). A similar story applies for the standard deviation. If we divide by \\(N-1\\) rather than \\(N\\), our estimate of the population standard deviation becomes: \\[\\hat\\sigma = \\sqrt{\\frac{1}{N-1} \\sum_{i=1}^N (X_i - \\bar{X})^2}\\]. It is worth pointing out that software programs make assumptions for you, about which variance and standard deviation you are computing. Some programs automatically divide by \\(N-1\\), some do not. You need to check to figure out what they are doing. Don’t let the software tell you what to do. Software is for you telling it what to do. One final point: in practice, a lot of people tend to refer to \\(\\hat{\\sigma}\\) (i.e., the formula where we divide by \\(N-1\\)) as the sample standard deviation. Technically, this is incorrect: the sample standard deviation should be equal to \\(s\\) (i.e., the formula where we divide by \\(N\\)). These aren’t the same thing, either conceptually or numerically. One is a property of the sample, the other is an estimated characteristic of the population. However, in almost every real life application, what we actually care about is the estimate of the population parameter, and so people always report \\(\\hat\\sigma\\) rather than \\(s\\). Note, whether you should divide by N or N-1 also depends on your philosophy about what you are doing. For example, if you don’t think that what you are doing is estimating a population parameter, then why would you divide by N-1? Also, when N is large, it doesn’t matter too much. The difference between a big N, and a big N-1, is just -1. This is the right number to report, of course, it’s that people tend to get a little bit imprecise about terminology when they write it up, because “sample standard deviation” is shorter than “estimated population standard deviation”. It’s no big deal, and in practice I do the same thing everyone else does. Nevertheless, I think it’s important to keep the two concepts separate: it’s never a good idea to confuse “known properties of your sample” with “guesses about the population from which it came”. The moment you start thinking that \\(s\\) and \\(\\hat\\sigma\\) are the same thing, you start doing exactly that. To finish this section off, here’s another couple of tables to help keep things clear: Symbol What is it? Do we know what it is? \\(s^2\\) Sample variance Yes, calculated from the raw data \\(\\sigma^2\\) Population variance Almost never known for sure \\(\\hat{\\sigma}^2\\) Estimate of the population variance Yes, but not the same as the sample variance 5.5 Estimating a confidence interval[sec:ci] Statistics means never having to say you’re certain – Unknown origin Up to this point in this chapter, we’ve outlined the basics of sampling theory which statisticians rely on to make guesses about population parameters on the basis of a sample of data. As this discussion illustrates, one of the reasons we need all this sampling theory is that every data set leaves us with some of uncertainty, so our estimates are never going to be perfectly accurate. The thing that has been missing from this discussion is an attempt to quantify the amount of uncertainty in our estimate. It’s not enough to be able guess that the mean IQ of undergraduate psychology students is 115 (yes, I just made that number up). We also want to be able to say something that expresses the degree of certainty that we have in our guess. For example, it would be nice to be able to say that there is a 95% chance that the true mean lies between 109 and 121. The name for this is a confidence interval for the mean. Armed with an understanding of sampling distributions, constructing a confidence interval for the mean is actually pretty easy. Here’s how it works. Suppose the true population mean is \\(\\mu\\) and the standard deviation is \\(\\sigma\\). I’ve just finished running my study that has \\(N\\) participants, and the mean IQ among those participants is \\(\\bar{X}\\). We know from our discussion of the central limit theorem that the sampling distribution of the mean is approximately normal. We also know from our discussion of the normal distribution that there is a 95% chance that a normally-distributed quantity will fall within two standard deviations of the true mean. To be more precise, we can use the qnorm() function to compute the 2.5th and 97.5th percentiles of the normal distribution qnorm( p = c(.025, .975) ) [1] -1.959964 1.959964 Okay, so I lied earlier on. The more correct answer is that a 95% chance that a normally-distributed quantity will fall within 1.96 standard deviations of the true mean. Next, recall that the standard deviation of the sampling distribution is referred to as the standard error, and the standard error of the mean is written as SEM. When we put all these pieces together, we learn that there is a 95% probability that the sample mean \\(\\bar{X}\\) that we have actually observed lies within 1.96 standard errors of the population mean. Oof, that is a lot of mathy talk there. We’ll clear it up, don’t worry. Mathematically, we write this as: \\[\\mu - \\left( 1.96 \\times \\mbox{SEM} \\right) \\ \\leq \\ \\bar{X}\\ \\leq \\ \\mu + \\left( 1.96 \\times \\mbox{SEM} \\right)\\] where the SEM is equal to \\(\\sigma / \\sqrt{N}\\), and we can be 95% confident that this is true. However, that’s not answering the question that we’re actually interested in. The equation above tells us what we should expect about the sample mean, given that we know what the population parameters are. What we want is to have this work the other way around: we want to know what we should believe about the population parameters, given that we have observed a particular sample. However, it’s not too difficult to do this. Using a little high school algebra, a sneaky way to rewrite our equation is like this: \\[\\bar{X} - \\left( 1.96 \\times \\mbox{SEM} \\right) \\ \\leq \\ \\mu \\ \\leq \\ \\bar{X} + \\left( 1.96 \\times \\mbox{SEM}\\right)\\] What this is telling is is that the range of values has a 95% probability of containing the population mean \\(\\mu\\). We refer to this range as a 95% confidence interval, denoted \\(\\mbox{CI}_{95}\\). In short, as long as \\(N\\) is sufficiently large – large enough for us to believe that the sampling distribution of the mean is normal – then we can write this as our formula for the 95% confidence interval: \\[\\mbox{CI}_{95} = \\bar{X} \\pm \\left( 1.96 \\times \\frac{\\sigma}{\\sqrt{N}} \\right)\\] Of course, there’s nothing special about the number 1.96: it just happens to be the multiplier you need to use if you want a 95% confidence interval. If I’d wanted a 70% confidence interval, I could have used the qnorm() function to calculate the 15th and 85th quantiles: qnorm( p = c(.15, .85) ) [1] -1.036433 1.036433 and so the formula for \\(\\mbox{CI}_{70}\\) would be the same as the formula for \\(\\mbox{CI}_{95}\\) except that we’d use 1.04 as our magic number rather than 1.96. 5.5.1 A slight mistake in the formula As usual, I lied. The formula that I’ve given above for the 95% confidence interval is approximately correct, but I glossed over an important detail in the discussion. Notice my formula requires you to use the standard error of the mean, SEM, which in turn requires you to use the true population standard deviation \\(\\sigma\\). Yet, before we stressed the fact that we don’t actually know the true population parameters. Because we don’t know the true value of \\(\\sigma\\), we have to use an estimate of the population standard deviation \\(\\hat{\\sigma}\\) instead. This is pretty straightforward to do, but this has the consequence that we need to use the quantiles of the \\(t\\)-distribution rather than the normal distribution to calculate our magic number; and the answer depends on the sample size. Plus, we haven’t really talked about the \\(t\\) distribution yet. When we use the \\(t\\) distribution instead of the normal distribution, we get bigger numbers, indicating that we have more uncertainty. And why do we have that extra uncertainty? Well, because our estimate of the population standard deviation \\(\\hat\\sigma\\) might be wrong! If it’s wrong, it implies that we’re a bit less sure about what our sampling distribution of the mean actually looks like… and this uncertainty ends up getting reflected in a wider confidence interval. 5.5.2 Looking at confidence intervals 5.6 Summary In this chapter I’ve covered two main topics. The first half of the chapter talks about sampling theory, and the second half talks about how we can use sampling theory to construct estimates of the population parameters. The section breakdown looks like this: Basic ideas about samples, sampling and populations (Section [sec:srs]) Statistical theory of sampling: the law of large numbers (Section [sec:lawlargenumbers]), sampling distributions and the central limit theorem (Section [sec:samplesandclt]). Estimating means and standard deviations (Section [sec:pointestimates]) Estimating a confidence interval (Section [sec:ci]) As always, there’s a lot of topics related to sampling and estimation that aren’t covered in this chapter, but for an introductory psychology class this is fairly comprehensive I think. For most applied researchers you won’t need much more theory than this. One big question that I haven’t touched on in this chapter is what you do when you don’t have a simple random sample. There is a lot of statistical theory you can draw on to handle this situation, but it’s well beyond the scope of this book. References "],
["inferenceForNumericalDatattest.html", "Chapter 6 Inference for numerical data: t-Tests 6.1 One-sample means with the \\(t\\) distribution 6.2 Paired data 6.3 Difference of two means", " Chapter 6 Inference for numerical data: t-Tests Chapters [FoundationForInference] and [inferenceForCategoricalData] introduced us to inference for proportions using the normal model, and in Section [oneWayChiSquare], we encountered the chi-square distribution, which is useful for working with categorical data with many levels. In this chapter, our focus will be on numerical data, where we will encounter two more distributions: the \\(t\\) distribution (looks a lot like the normal distribution) and the \\(F\\) distribution. Our general approach will be: Determine which point estimate or test statistic is useful. Identify an appropriate distribution for the point estimate or test statistic. Apply the hypothesis and confidence interval techniques from Chapter [FoundationForInference] using the distribution from step 2. 6.1 One-sample means with the \\(t\\) distribution The sampling distribution associated with a sample mean or difference of two sample means is, if certain conditions are satisfied, nearly normal. However, this becomes more complex when the sample size is small, where small here typically means a sample size smaller than 30 observations. For this reason, we’ll use a new distribution called the \\(t\\) distribution that will often work for both small and large samples of numerical data. 6.1.1 Two examples using the normal distribution Before we get started with the \\(t\\) distribution, let’s take a look at two applications where it is okay to use the normal model for the sample mean. For the case of a single mean, the standard error of the sample mean can be calculated as \\[\\begin{aligned} SE = \\frac{\\sigma}{\\sqrt{n}}\\end{aligned}\\] where \\(\\sigma\\) is the population standard deviation and \\(n\\) is the sample size. Generally we use the sample standard deviation, denoted by \\(s\\), in place of the population standard deviation when we compute the standard error: \\[\\begin{aligned} SE \\approx \\frac{s}{\\sqrt{n}}\\end{aligned}\\] If we look at this formula, there are some characteristics that we can think about intuitively. If we examine the standard error formula, we would see that a larger \\(s\\) corresponds to a larger \\(SE\\). This makes intuitive sense: if the data are more volatile, then we’ll be less certain of the location of the true mean, so the standard error should be bigger. On the other hand, if the observations all fall very close together, then \\(s\\) will be small, and the sample mean should be a more precise estimate of the true mean. In the formula, the larger the sample size \\(n\\), the smaller the standard error. This matches our intuition: we expect estimates to be more precise when we have more data, so the standard error \\(SE\\) should get smaller when \\(n\\) gets bigger. As we did with proportions, we’ll also need to check a few conditions before using the normal model. We’ll forgo describing those details until later this section, but these conditions have been verified for the two examples below. We’ve taken a random sample of 100 runners from a race called the Cherry Blossom Run in Washington, DC, which was a race with 16,924 participants.2 The sample data for the 100 runners is summarized in Table [run10SampDF], histograms of the run time and age of participants are in Figure [run10SampHistograms], and summary statistics are available in Table [ptEstimatesNetTimeAge]. Create a 95% confidence interval for the average time it takes runners in the Cherry Blossom Run to complete the race. We can use the same confidence interval formula for the mean that we used for a proportion: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96 \\times SE\\end{aligned}\\] In this case, the best estimate of the overall mean is the sample mean, \\(\\bar{x} = 95.61\\) minutes. The standard error can be calculated using sample standard deviation (\\(s = 15.78\\)), the sample size (\\(n=100\\)), and the standard error formula: \\[\\begin{aligned} SE = \\frac{s}{\\sqrt{n}} = \\frac{15.78}{\\sqrt{100}} = 1.578\\end{aligned}\\] Finally, we can calculate a 95% confidence interval: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ z^{\\star} \\times SE \\quad\\rightarrow\\quad 95.61 \\pm 1.96 \\times 1.578 \\quad\\rightarrow\\quad (92.52, 98.70)\\end{aligned}\\] We are 95% confident that the average time for all runners in the 2012 Cherry Blossom Run is between 92.52 and 98.70 minutes. Four observations for the run10Samp data set, which represents a simple random sample of 100 runners from the 2012 Cherry Blossom Run. ID time age gender state 1 88.31 59 M MD 2 100.67 32 M VA 3 109.52 33 F VA \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 100 89.49 26 M DC [run10SampDF] Histograms of time and age for the sample Cherry Blossom Run data. The average time is in the mid-90s, and the average age is in the mid-30s. The age distribution is moderately skewed to the right. [run10SampHistograms] Point estimates and parameter values for the time variable. sample mean 95.61 35.05 sample median 95.37 32.50 sample st. dev. 15.78 8.97 [ptEstimatesNetTimeAge] Use the data to calculate a 90% confidence interval for the average age of participants in the 2012 Cherry Blossom Run. The conditions for applying the normal model have already been verified.3 The nutrition label on a bag of potato chips says that a one ounce (28 gram) serving of potato chips has 130 calories and contains ten grams of fat, with three grams of saturated fat. A random sample of 35 bags yielded a sample mean of 134 calories with a standard deviation of 17 calories. Is there evidence that the nutrition label does not provide an accurate measure of calories in the bags of potato chips? The conditions necessary for applying the normal model have been checked and are satisfied. The question has been framed in terms of two possibilities: the nutrition label accurately lists the correct average calories per bag of chips or it does not, which may be framed as a hypothesis test: The average is listed correctly. \\(\\mu = 130\\) The nutrition label is incorrect. \\(\\mu \\neq 130\\) The observed average is \\(\\bar{x} = 134\\) and the standard error may be calculated as \\(SE = \\frac{17}{\\sqrt{35}} = 2.87\\). First, we draw a picture summarizing this scenario. image We can compute a test statistic as the Z score: \\[\\begin{aligned} Z = \\frac{134 - 130}{2.87} = 1.39\\end{aligned}\\] The upper-tail area is 0.0823, so the p-value is \\(2 \\times 0.0823 = 0.1646\\). Since the p-value is larger than 0.05, we do not reject the null hypothesis. That is, there is not enough evidence to show the nutrition label has incorrect information. The normal model works well when the sample size is larger than about 30. For smaller sample sizes, we run into a problem: our estimate of \\(s\\), which is used to compute the standard error, isn’t as reliable when the sample size is small. To solve this problem, we’ll use a new distribution: the \\(t\\) distribution. 6.1.2 Introducing the \\(t\\) distribution A \\(t\\) distribution, shown as a solid line in Figure [tDistCompareToNormalDist], has a bell shape that looks very similar to a normal distribution (dotted line). However, its tails are thicker, which means observations are more likely to fall beyond two standard deviations from the mean than under the normal distribution.4 When our sample is small, the value \\(s\\) used to compute the standard error isn’t very reliable. The extra thick tails of the \\(t\\) distribution are exactly the correction we need to resolve this problem. Comparison of a \\(t\\) distribution (solid line) and a normal distribution (dotted line). [tDistCompareToNormalDist] The \\(t\\) distribution, always centered at zero, has a single parameter: degrees of freedom. The describe the precise form of the bell-shaped \\(t\\) distribution. Several \\(t\\) distributions are shown in Figure [tDistConvergeToNormalDist] with various degrees of freedom. When there are more degrees of freedom, the \\(t\\) distribution looks very much like the standard normal distribution. The larger the degrees of freedom, the more closely the \\(t\\) distribution resembles the standard normal model. [tDistConvergeToNormalDist] The degrees of freedom describe the shape of the \\(t\\) distribution. The larger the degrees of freedom, the more closely the distribution approximates the normal model. When the degrees of freedom is about 30 or more, the \\(t\\) distribution is nearly indistinguishable from the normal distribution, e.g. see Figure [tDistConvergeToNormalDist]. In Section [tDistSolutionToSEProblem], we relate degrees of freedom to sample size. We will find it very useful to become familiar with the \\(t\\) distribution, because it plays a very similar role to the normal distribution during inference for numerical data. We use a , partially shown in Table [tTableSample], in place of the normal probability table for small sample numerical data. A larger table is presented in Appendix . Alternatively, we could use statistical software to get this same information. r | rrr rr one tail &amp; 0.100 &amp; 0.050 &amp; 0.025 &amp; 0.010 &amp; 0.005 two tails &amp; 0.200 &amp; 0.100 &amp; 0.050 &amp; 0.020 &amp; 0.010 1 &amp; 3.08 &amp; 6.31 &amp; 12.71 &amp; 31.82 &amp; 63.66 2 &amp; 1.89 &amp; 2.92 &amp; 4.30 &amp; 6.96 &amp; 9.92 3 &amp; 1.64 &amp; 2.35 &amp; 3.18 &amp; 4.54 &amp; 5.84 \\(\\vdots\\) &amp; \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp; 17 &amp; 1.33 &amp; 1.74 &amp; 2.11 &amp; 2.57 &amp; 2.90 &amp; &amp; &amp; &amp; &amp; 19 &amp; 1.33 &amp; 1.73 &amp; 2.09 &amp; 2.54 &amp; 2.86 20 &amp; 1.33 &amp; 1.72 &amp; 2.09 &amp; 2.53 &amp; 2.85 \\(\\vdots\\) &amp; \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp; 400 &amp; 1.28 &amp; 1.65 &amp; 1.97 &amp; 2.34 &amp; 2.59 500 &amp; 1.28 &amp; 1.65 &amp; 1.96 &amp; 2.33 &amp; 2.59 \\(\\infty\\) &amp; 1.28 &amp; 1.65 &amp; 1.96 &amp; 2.33 &amp; 2.58 [tTableSample] Each row in the \\(t\\) table represents a \\(t\\) distribution with different degrees of freedom. The columns correspond to tail probabilities. For instance, if we know we are working with the \\(t\\) distribution with \\(df=18\\), we can examine row 18, which is in Table [tTableSample]. If we want the value in this row that identifies the cutoff for an upper tail of 10%, we can look in the column where one tail is 0.100. This cutoff is 1.33. If we had wanted the cutoff for the lower 10%, we would use -1.33. Just like the normal distribution, all \\(t\\) distributions are symmetric. What proportion of the \\(t\\) distribution with 18 degrees of freedom falls below -2.10? Just like a normal probability problem, we first draw the picture in Figure [tDistDF18LeftTail2Point10] and shade the area below -2.10. To find this area, we identify the appropriate row: \\(df=18\\). Then we identify the column containing the absolute value of -2.10; it is the third column. Because we are looking for just one tail, we examine the top line of the table, which shows that a one tail area for a value in the third row corresponds to 0.025. About 2.5% of the distribution falls below -2.10. In the next example we encounter a case where the exact \\(t\\) value is not listed in the table. The \\(t\\) distribution with 18 degrees of freedom. The area below -2.10 has been shaded. [tDistDF18LeftTail2Point10] A \\(t\\) distribution with 20 degrees of freedom is shown in the left panel of Figure [tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling above 1.65. We identify the row in the \\(t\\) table using the degrees of freedom: \\(df=20\\). Then we look for 1.65; it is not listed. It falls between the first and second columns. Since these values bound 1.65, their tail areas will bound the tail area corresponding to 1.65. We identify the one tail area of the first and second columns, 0.050 and 0.10, and we conclude that between 5% and 10% of the distribution is more than 1.65 standard deviations above the mean. If we like, we can identify the precise area using statistical software: 0.0573. Left: The \\(t\\) distribution with 20 degrees of freedom, with the area above 1.65 shaded. Right: The \\(t\\) distribution with 2 degrees of freedom, with the area further than 3 units from 0 shaded. [tDistDF20RightTail1Point65] A \\(t\\) distribution with 2 degrees of freedom is shown in the right panel of Figure [tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling more than 3 units from the mean (above or below). As before, first identify the appropriate row: \\(df=2\\). Next, find the columns that capture 3; because \\(2.92 &lt; 3 &lt; 4.30\\), we use the second and third columns. Finally, we find bounds for the tail areas by looking at the two tail values: 0.05 and 0.10. We use the two tail values because we are looking for two (symmetric) tails. What proportion of the \\(t\\) distribution with 19 degrees of freedom falls above -1.79 units?5 6.1.3 Applying the \\(t\\) distribution to the single-mean situation When estimating the mean and standard error from a sample of numerical data, the \\(t\\) distribution is a little more accurate than the normal model. This is true for both small and large samples, though the benefits for larger samples are limited. Use the \\(t\\) distribution for inference of the sample mean when observations are independent and nearly normal. You may relax the nearly normal condition as the sample size increases. For example, the data distribution may be moderately skewed when the sample size is at least 30. Before applying the \\(t\\) distribution for inference about a single mean, we check two conditions. Independence of observations. We verify this condition just as we did before. We collect a simple random sample from less than 10% of the population, or if the data are from an experiment or random process, we carefully check to the best of our abilities that the observations were independent. Observations come from a nearly normal distribution. This second condition is difficult to verify with small data sets. We often (i) take a look at a plot of the data for obvious departures from the normal model, usually in the form of prominent outliers, and (ii) consider whether any previous experiences alert us that the data may not be nearly normal. However, if the sample size is somewhat large, then we can relax this condition, e.g. moderate skew is acceptable when the sample size is 30 or more, and strong skew is acceptable when the size is about 60 or more. When examining a sample mean and estimated standard error from a sample of \\(n\\) independent and nearly normal observations, we use a \\(t\\) distribution with \\(n-1\\) degrees of freedom (\\(df\\)). For example, if the sample size was 19, then we would use the \\(t\\) distribution with \\(df=19-1=18\\) degrees of freedom and proceed in the same way as we did in Chapter [inferenceForCategoricalData], except that now we use the \\(t\\) table. If the sample has \\(n\\) observations and we are examining a single mean, then we use the \\(t\\) distribution with \\(df=n-1\\) degrees of freedom. 6.1.4 One sample \\(t\\) confidence intervals Dolphins are at the top of the oceanic food chain, which causes dangerous substances such as mercury to concentrate in their organs and muscles. This is an important problem for both dolphins and other animals, like humans, who occasionally eat them. For instance, this is particularly relevant in Japan where school meals have included dolphin at times. [rissosDolphin] Here we identify a confidence interval for the average mercury content in dolphin muscle using a sample of 19 Risso’s dolphins from the Taiji area in Japan.6 The data are summarized in Table [summaryStatsOfHgInMuscleOfRissosDolphins]. The minimum and maximum observed values can be used to evaluate whether or not there are obvious outliers or skew. Summary of mercury content in the muscle of 19 Risso’s dolphins from the Taiji area. Measurements are in \\(\\mu\\)g/wet g (micrograms of mercury per wet gram of muscle). \\(n\\) \\(\\bar{x}\\) \\(s\\) minimum maximum 19 4.4 2.3 1.7 9.2 [summaryStatsOfHgInMuscleOfRissosDolphins] Are the independence and normality conditions satisfied for this data set? The observations are a simple random sample and consist of less than 10% of the population, therefore independence is reasonable. Ideally we would see a visualization of the data to check for skew and outliers. However, we can instead examine the summary statistics in Table [summaryStatsOfHgInMuscleOfRissosDolphins], which do not suggest any skew or outliers. All observations are within 2.5 standard deviations of the mean. Based on this evidence, the normality assumption seems reasonable. In the normal model, we used \\(z^{\\star}\\) and the standard error to determine the width of a confidence interval. We revise the confidence interval formula slightly when using the \\(t\\) distribution: \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{df} \\times SE\\end{aligned}\\] [ \\(t^{\\star}_{df}\\) Multiplication factor for \\(t\\) conf. interval] \\(t^{\\star}_{df}\\) Multiplication factor for \\(t\\) conf. interval The sample mean and estimated standard error are computed just as in our earlier examples that used the normal model (\\(\\bar{x} = 4.4\\) and \\(SE = s/\\sqrt{n} = 0.528\\)). The value \\(t^{\\star}_{df}\\) is a cutoff we obtain based on the confidence level and the \\(t\\) distribution with \\(df\\) degrees of freedom. Before determining this cutoff, we will first need the degrees of freedom. In our current example, we should use the \\(t\\) distribution with \\(df = n - 1 = 19 - 1 = 18\\) degrees of freedom. Then identifying \\(t_{18}^{\\star}\\) is similar to how we found \\(z^{\\star}\\): For a 95% confidence interval, we want to find the cutoff \\(t^{\\star}_{18}\\) such that 95% of the \\(t\\) distribution is between -\\(t^{\\star}_{18}\\) and \\(t^{\\star}_{18}\\). We look in the \\(t\\) table on page , find the column with area totaling 0.05 in the two tails (third column), and then the row with 18 degrees of freedom: \\(t^{\\star}_{18} = 2.10\\). Generally the value of \\(t^{\\star}_{df}\\) is slightly larger than what we would get under the normal model with \\(z^{\\star}\\). Finally, we can substitute all the values into the confidence interval equation to create the 95% confidence interval for the average mercury content in muscles from Risso’s dolphins that pass through the Taiji area: \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{18} \\times SE \\quad \\to \\quad 4.4 \\ \\pm\\ 2.10 \\times 0.528 \\quad \\to \\quad (3.29, 5.51)\\end{aligned}\\] We are 95% confident the average mercury content of muscles in Risso’s dolphins is between 3.29 and 5.51 \\(\\mu\\)g/wet gram, which is considered extremely high. Based on a sample of \\(n\\) independent and nearly normal observations, a confidence interval for the population mean is \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{df} \\times SE\\end{aligned}\\] where \\(\\bar{x}\\) is the sample mean, \\(t^{\\star}_{df}\\) corresponds to the confidence level and degrees of freedom, and \\(SE\\) is the standard error as estimated by the sample. The normality condition may be relaxed for larger sample sizes. [croakerWhiteFishPacificExerConditions] The FDA’s webpage provides some data on mercury content of fish.7 Based on a sample of 15 croaker white fish (Pacific), a sample mean and standard deviation were computed as 0.287 and 0.069 ppm (parts per million), respectively. The 15 observations ranged from 0.18 to 0.41 ppm. We will assume these observations are independent. Based on the summary statistics of the data, do you have any objections to the normality condition of the individual observations?8 Estimate the standard error of the sample mean using the data summaries in Guided Practice [croakerWhiteFishPacificExerConditions]. If we are to use the \\(t\\) distribution to create a 90% confidence interval for the actual mean of the mercury content, identify the degrees of freedom we should use and also find \\(t^{\\star}_{df}\\). [croakerWhiteFishPacificExerSEDFTStar] The standard error: \\(SE = \\frac{0.069}{\\sqrt{15}} = 0.0178\\). Degrees of freedom: \\(df = n - 1 = 14\\). Looking in the column where two tails is 0.100 (for a 90% confidence interval) and row \\(df=14\\), we identify \\(t^{\\star}_{14} = 1.76\\). Using the results of Guided Practice [croakerWhiteFishPacificExerConditions] and Example [croakerWhiteFishPacificExerSEDFTStar], compute a 90% confidence interval for the average mercury content of croaker white fish (Pacific).9 6.1.5 One sample \\(t\\) tests Is the typical US runner getting faster or slower over time? We consider this question in the context of the Cherry Blossom Run, comparing runners in 2006 and 2012. Technological advances in shoes, training, and diet might suggest runners would be faster in 2012. An opposing viewpoint might say that with the average body mass index on the rise, people tend to run slower. In fact, all of these components might be influencing run time. The average time for all runners who finished the Cherry Blossom Run in 2006 was 93.29 minutes (93 minutes and about 17 seconds). We want to determine using data from 100 participants in the 2012 Cherry Blossom Run whether runners in this race are getting faster or slower, versus the other possibility that there has been no change. What are appropriate hypotheses for this context?10 The data come from a simple random sample from less than 10% of all participants, so the observations are independent. However, should we be worried about skew in the data? A histogram of the differences was shown in the left panel of Figure . 11 With independence satisfied and skew not a concern, we can proceed with performing a hypothesis test using the \\(t\\) distribution. The sample mean and sample standard deviation are 95.61 and 15.78 minutes, respectively. Recall that the sample size is 100. What is the p-value for the test, and what is your conclusion?12 To help us remember to use the \\(t\\) distribution, we use a \\(T\\) to represent the test statistic, and we often call this a T score. The Z score and T score are computed in the exact same way and are conceptually identical: each represents how many standard errors the observed value is from the null value. 6.2 Paired data Are textbooks actually cheaper online? Here we compare the price of textbooks at the University of California, Los Angeles’ (UCLA’s) bookstore and prices at Amazon.com. Seventy-three UCLA courses were randomly sampled in Spring 2010, representing less than 10% of all UCLA courses.13 A portion of the data set is shown in Table [textbooksDF]. Six cases of the textbooks data set. dept course ucla amazon diff 1 Am Ind C170 27.67 27.95 -0.28 2 Anthro 9 40.59 31.14 9.45 3 Anthro 135T 31.68 32.00 -0.32 4 Anthro 191HB 16.00 11.52 4.48 \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 72 Wom Std M144 23.76 18.72 5.04 73 Wom Std 285 27.70 18.22 9.48 [textbooksDF] 6.2.1 Paired observations Each textbook has two corresponding prices in the data set: one for the UCLA bookstore and one for Amazon. Therefore, each textbook price from the UCLA bookstore has a natural correspondence with a textbook price from Amazon. When two sets of observations have this special correspondence, they are said to be paired. Two sets of observations are paired if each observation in one set has a special correspondence or connection with exactly one observation in the other data set. To analyze paired data, it is often useful to look at the difference in outcomes of each pair of observations. In the textbook data set, we look at the difference in prices, which is represented as the diff variable in the textbooks data. Here the differences are taken as \\[\\begin{aligned} \\text{UCLA price} - \\text{Amazon price}\\end{aligned}\\] for each book. It is important that we always subtract using a consistent order; here Amazon prices are always subtracted from UCLA prices. A histogram of these differences is shown in Figure [diffInTextbookPricesS10]. Using differences between paired observations is a common and useful way to analyze paired data. Histogram of the difference in price for each book sampled. These data are strongly skewed. [diffInTextbookPricesS10] The first difference shown in Table [textbooksDF] is computed as \\(27.67-27.95=-0.28\\). Verify the differences are calculated correctly for observations 2 and 3.14 6.2.2 Inference for paired data To analyze a paired data set, we simply analyze the differences. We can use the same \\(t\\) distribution techniques we applied in the last section. ccccc \\(n_{_{diff}}\\) &amp; &amp; \\(\\bar{x}_{_{diff}}\\) &amp; &amp; \\(s_{_{diff}}\\) 73 &amp;&amp; 12.76 &amp;&amp; 14.26 [textbooksSummaryStats] Set up and implement a hypothesis test to determine whether, on average, there is a difference between Amazon’s price for a book and the UCLA bookstore’s price. [htForDiffInUCLAAndAmazonTextbookPrices] We are considering two scenarios: there is no difference or there is some difference in average prices. \\(\\mu_{diff}=0\\). There is no difference in the average textbook price. \\(\\mu_{diff} \\neq 0\\). There is a difference in average prices. Can the \\(t\\) distribution be used for this application? The observations are based on a simple random sample from less than 10% of all books sold at the bookstore, so independence is reasonable. While the distribution is strongly skewed, the sample is reasonably large (\\(n=73\\)), so we can proceed. Because the conditions are reasonably satisfied, we can apply the \\(t\\) distribution to this setting. We compute the standard error associated with \\(\\bar{x}_{diff}\\) using the standard deviation of the differences (\\(s_{_{diff}}=14.26\\)) and the number of differences (\\(n_{_{diff}}=73\\)): \\[SE_{\\bar{x}_{diff}} = \\frac{s_{diff}}{\\sqrt{n_{diff}}} = \\frac{14.26}{\\sqrt{73}} = 1.67\\] To visualize the p-value, the sampling distribution of \\(\\bar{x}_{diff}\\) is drawn as though \\(H_0\\) is true, which is shown in Figure [textbooksS10HTTails]. The p-value is represented by the two (very) small tails. To find the tail areas, we compute the test statistic, which is the T score of \\(\\bar{x}_{diff}\\) under the null condition that the actual mean difference is 0: \\[T = \\frac{\\bar{x}_{diff} - 0}{SE_{x_{diff}}} = \\frac{12.76 - 0}{1.67} = 7.59\\] The degrees of freedom are \\(df = 73 - 1 = 72\\). If we examined Appendix , we would see that this value is larger than any in the 70 df row (we round down for \\(df\\) when using the table), meaning the two-tailed p-value is less than 0.01. If we used statistical software, we would find the p-value is less than 1-in-10 billion! Because the p-value is less than 0.05, we reject the null hypothesis. We have found convincing evidence that Amazon is, on average, cheaper than the UCLA bookstore for UCLA course textbooks. Sampling distribution for the mean difference in book prices, if the true average difference is zero. [textbooksS10HTTails] Create a 95% confidence interval for the average price difference between books at the UCLA bookstore and books on Amazon.15 In the textbook price example, we applied the \\(t\\) distribution. However, as we mentioned in the last section, the \\(t\\) distribution looks a lot like the normal distribution when the degrees of freedom are larger than about 30. In such cases, including this one, it would be reasonable to use the normal distribution in place of the \\(t\\) distribution. 6.3 Difference of two means In this section we consider a difference in two population means, \\(\\mu_1 - \\mu_2\\), under the condition that the data are not paired. Just as with a single sample, we identify conditions to ensure we can use the \\(t\\) distribution with a point estimate of the difference, \\(\\bar{x}_1 - \\bar{x}_2\\). We apply these methods in three contexts: determining whether stem cells can improve heart function, exploring the impact of pregnant womens’ smoking habits on birth weights of newborns, and exploring whether there is statistically significant evidence that one variations of an exam is harder than another variation. This section is motivated by questions like “Is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who don’t smoke?” 6.3.1 Confidence interval for a differences of means Does treatment using embryonic stem cells (ESCs) help improve heart function following a heart attack? Table [summaryStatsForSheepHeartDataWhoReceivedMiceESCs] contains summary statistics for an experiment to test ESCs in sheep that had a heart attack. Each of these sheep was randomly assigned to the ESC or control group, and the change in their hearts’ pumping capacity was measured in the study. A positive value corresponds to increased pumping capacity, which generally suggests a stronger recovery. Our goal will be to identify a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity relative to the control group. A point estimate of the difference in the heart pumping variable can be found using the difference in the sample means: \\[\\begin{aligned} \\bar{x}_{esc} - \\bar{x}_{control}\\ =\\ 3.50 - (-4.33)\\ =\\ 7.83\\end{aligned}\\] l rrrrr &amp; \\(n\\) &amp; \\(\\bar{x}\\) &amp; \\(s\\) ESCs &amp; 9 &amp; 3.50 &amp; 5.17 control &amp; 9 &amp; -4.33 &amp; 2.76 [summaryStatsForSheepHeartDataWhoReceivedMiceESCs] Histograms for both the embryonic stem cell group and the control group. Higher values are associated with greater improvement. We don’t see any evidence of skew in these data; however, it is worth noting that skew would be difficult to detect with such a small sample. [stemCellTherapyForHearts] [ConditionsForTwoSampleTDist]The \\(t\\) distribution can be used for inference when working with the standardized difference of two means if (1) each sample meets the conditions for using the \\(t\\) distribution and (2) the samples are independent. Can the point estimate, \\(\\bar{x}_{esc} - \\bar{x}_{control} = 7.83\\), be analyzed using the \\(t\\) distribution? We check the two required conditions: In this study, the sheep were independent of each other. Additionally, the distributions in Figure [stemCellTherapyForHearts] don’t show any clear deviations from normality, where we watch for prominent outliers in particular for such small samples. These findings imply each sample mean could itself be modeled using a \\(t\\) distribution. The sheep in each group were also independent of each other. Because both conditions are met, we can use the \\(t\\) distribution to model the difference of the two sample means. Before we construct a confidence interval, we must calculate the standard error of the point estimate of the difference. For this, we use the following formula, where just as before we substitute the sample standard deviations into the formula: \\[\\begin{aligned} SE_{\\bar{x}_{esc} - \\bar{x}_{control}} &amp;= \\sqrt{\\frac{\\sigma_{esc}^2}{n_{esc}} + \\frac{\\sigma_{control}^2}{n_{control}}} \\\\ &amp;\\approx \\sqrt{\\frac{s_{esc}^2}{n_{esc}} + \\frac{s_{control}^2}{n_{control}}} = \\sqrt{\\frac{5.17^2}{9} + \\frac{2.76^2}{9}} = 1.95\\end{aligned}\\] Because we will use the \\(t\\) distribution, we also must identify the appropriate degrees of freedom. This can be done using computer software. An alternative technique is to use the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\), which is the method we will typically apply in the examples and guided practice.16 The sample difference of two means, \\(\\bar{x}_1 - \\bar{x}_2\\), can be modeled using the \\(t\\) distribution and the standard error \\[\\begin{aligned} \\textstyle SE_{\\bar{x}_{1} - \\bar{x}_{2}} = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}} \\label{seOfDifferenceInMeans}\\end{aligned}\\] when each sample mean can itself be modeled using a \\(t\\) distribution and the samples are independent. To calculate the degrees of freedom, use statistical software or the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\). Calculate a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity of sheep after they’ve suffered a heart attack. We will use the sample difference and the standard error for that point estimate from our earlier calculations: \\[\\begin{aligned} &amp; \\bar{x}_{esc} - \\bar{x}_{control} = 7.83 \\\\ &amp; SE = \\sqrt{\\frac{5.17^2}{9} + \\frac{2.76^2}{9}} = 1.95\\end{aligned}\\] Using \\(df = 8\\), we can identify the appropriate \\(t^{\\star}_{df} = t^{\\star}_{8}\\) for a 95% confidence interval as 2.31. Finally, we can enter the values into the confidence interval formula: \\[\\begin{aligned} \\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad\\rightarrow\\quad 7.83 \\ \\pm\\ 2.31\\times 1.95 \\quad\\rightarrow\\quad (3.38, 12.38)\\end{aligned}\\] We are 95% confident that embryonic stem cells improve the heart’s pumping function in sheep that have suffered a heart attack by 3.38% to 12.38%. 6.3.2 Hypothesis tests based on a difference in means A data set called represents a random sample of 150 cases of mothers and their newborns in North Carolina over a year. Four cases from this data set are represented in Table [babySmokeDF]. We are particularly interested in two variables: weight and smoke. The weight variable represents the weights of the newborns and the smoke variable describes which mothers smoked during pregnancy. We would like to know, is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who don’t smoke? We will use the North Carolina sample to try to answer this question. The smoking group includes 50 cases and the nonsmoking group contains 100 cases, represented in Figure [babySmokePlotOfTwoGroupsToExamineSkew]. Four cases from the data set. The value “NA”, shown for the first two entries of the first variable, indicates that piece of data is missing. fAge mAge weeks weight sexBaby smoke 1 NA 13 37 5.00 female nonsmoker 2 NA 14 36 5.88 female nonsmoker 3 19 15 41 8.13 male smoker \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 150 45 50 36 9.25 female nonsmoker [babySmokeDF] The top panel represents birth weights for infants whose mothers smoked. The bottom panel represents the birth weights for infants whose mothers who did not smoke. The distributions exhibit moderate-to-strong and strong skew, respectively. [babySmokePlotOfTwoGroupsToExamineSkew] Set up appropriate hypotheses to evaluate whether there is a relationship between a mother smoking and average birth weight.[babySmokeHTForWeight] The null hypothesis represents the case of no difference between the groups. There is no difference in average birth weight for newborns from mothers who did and did not smoke. In statistical notation: \\(\\mu_{n} - \\mu_{s} = 0\\), where \\(\\mu_{n}\\) represents non-smoking mothers and \\(\\mu_s\\) represents mothers who smoked. There is some difference in average newborn weights from mothers who did and did not smoke (\\(\\mu_{n} - \\mu_{s} \\neq 0\\)). We check the two conditions necessary to apply the \\(t\\) distribution to the difference in sample means. (1) Because the data come from a simple random sample and consist of less than 10% of all such cases, the observations are independent. Additionally, while each distribution is strongly skewed, the sample sizes of 50 and 100 would make it reasonable to model each mean separately using a \\(t\\) distribution. The skew is reasonable for these sample sizes of 50 and 100. (2) The independence reasoning applied in (1) also ensures the observations in each sample are independent. Since both conditions are satisfied, the difference in sample means may be modeled using a \\(t\\) distribution. Summary statistics for the data set. mean 6.78 7.18 st. dev. 1.43 1.60 samp. size 50 100 [summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers] The summary statistics in Table [summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers] may be useful for this exercise. (a) What is the point estimate of the population difference, \\(\\mu_{n} - \\mu_{s}\\)? (b) Compute the standard error of the point estimate from part (a).17 Draw a picture to represent the p-value for the hypothesis test from Example [babySmokeHTForWeight]. [pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights] To depict the p-value, we draw the distribution of the point estimate as though \\(H_0\\) were true and shade areas representing at least as much evidence against \\(H_0\\) as what was observed. Both tails are shaded because it is a two-sided test. image Compute the p-value of the hypothesis test using the figure in Example [pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights], and evaluate the hypotheses using a significance level of \\(\\alpha=0.05\\). [babySmokeHTForWeightComputePValueAndEvalHT] We start by computing the T score: \\[\\begin{aligned} T = \\frac{\\ 0.40 - 0\\ }{0.26} = 1.54\\end{aligned}\\] Next, we compare this value to values in the \\(t\\) table in Appendix , where we use the smaller of \\(n_n - 1 = 99\\) and \\(n_s - 1 = 49\\) as the degrees of freedom: \\(df = 49\\). The T score falls between the first and second columns in the \\(df = 49\\) row of the \\(t\\) table, meaning the two-tailed p-value falls between 0.10 and 0.20 (reminder, find tail areas along the top of the table). This p-value is larger than the significance value, 0.05, so we fail to reject the null hypothesis. There is insufficient evidence to say there is a difference in average birth weight of newborns from North Carolina mothers who did smoke during pregnancy and newborns from North Carolina mothers who did not smoke during pregnancy. Does the conclusion to Example [babySmokeHTForWeightComputePValueAndEvalHT] mean that smoking and average birth weight are unrelated?18 [babySmokeHTIDingHowToDetectDifferences] If we made a Type 2 Error and there is a difference, what could we have done differently in data collection to be more likely to detect such a difference?19 6.3.3 Case study: two versions of a course exam An instructor decided to run two slight variations of the same exam. Prior to passing out the exams, she shuffled the exams together to ensure each student received a random version. Summary statistics for how students performed on these two exams are shown in Table [summaryStatsForTwoVersionsOfExams]. Anticipating complaints from students who took Version B, she would like to evaluate whether the difference observed in the groups is so large that it provides convincing evidence that Version B was more difficult (on average) than Version A. l rrrrr Version &amp; \\(n\\) &amp; \\(\\bar{x}\\) &amp; \\(s\\) &amp; min &amp; max A &amp; 30 &amp; 79.4 &amp; 14 &amp; 45 &amp; 100 B &amp; 27 &amp; 74.1 &amp; 20 &amp; 32 &amp; 100 [summaryStatsForTwoVersionsOfExams] [htSetupForEvaluatingTwoExamVersions] Construct a hypotheses to evaluate whether the observed difference in sample means, \\(\\bar{x}_A - \\bar{x}_B=5.3\\), is due to chance.20 [conditionsForTDistForEvaluatingTwoExamVersions] To evaluate the hypotheses in Guided Practice [htSetupForEvaluatingTwoExamVersions] using the \\(t\\) distribution, we must first verify assumptions. (a) Does it seem reasonable that the scores are independent within each group? (b) What about the normality / skew condition for observations in each group? (c) Do you think scores from the two groups would be independent of each other, i.e. the two samples are independent?21 After verifying the conditions for each sample and confirming the samples are independent of each other, we are ready to conduct the test using the \\(t\\) distribution. In this case, we are estimating the true difference in average test scores using the sample data, so the point estimate is \\(\\bar{x}_A - \\bar{x}_B = 5.3\\). The standard error of the estimate can be calculated as \\[\\begin{aligned} SE = \\sqrt{\\frac{s_A^2}{n_A} + \\frac{s_B^2}{n_B}} = \\sqrt{\\frac{14^2}{30} + \\frac{20^2}{27}} = 4.62\\end{aligned}\\] Finally, we construct the test statistic: \\[\\begin{aligned} T = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{(79.4-74.1) - 0}{4.62} = 1.15\\end{aligned}\\] If we have a computer handy, we can identify the degrees of freedom as 45.97. Otherwise we use the smaller of \\(n_1-1\\) and \\(n_2-1\\): \\(df=26\\). The \\(t\\) distribution with 26 degrees of freedom. The shaded right tail represents values with \\(T \\geq 1.15\\). Because it is a two-sided test, we also shade the corresponding lower tail. [pValueOfTwoTailAreaOfExamVersionsWhereDFIs26] Identify the p-value using \\(df = 26\\) and provide a conclusion in the context of the case study. We examine row \\(df=26\\) in the \\(t\\) table. Because this value is smaller than the value in the left column, the p-value is larger than 0.200 (two tails!). Because the p-value is so large, we do not reject the null hypothesis. That is, the data do not convincingly show that one exam version is more difficult than the other, and the teacher should not be convinced that she should add points to the Version B exam scores. 6.3.4 Summary for inference using the \\(t\\) distribution Hypothesis tests. When applying the \\(t\\) distribution for a hypothesis test, we proceed as follows: Write appropriate hypotheses. Verify conditions for using the \\(t\\) distribution. One-sample or differences from paired data: the observations (or differences) must be independent and nearly normal. For larger sample sizes, we can relax the nearly normal requirement, e.g. slight skew is okay or sample sizes of 15, moderate skew for sample sizes of 30, and strong skew for sample sizes of 60. For a difference of means when the data are not paired: each sample mean must separately satisfy the one-sample conditions for the \\(t\\) distribution, and the data in the groups must also be independent. Compute the point estimate of interest, the standard error, and the degrees of freedom. For \\(df\\), use \\(n-1\\) for one sample, and for two samples use either statistical software or the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\). Compute the T score and p-value. Make a conclusion based on the p-value, and write a conclusion in context and in plain language so anyone can understand the result. Confidence intervals. Similarly, the following is how we generally computed a confidence interval using a \\(t\\) distribution: Verify conditions for using the \\(t\\) distribution. (See above.) Compute the point estimate of interest, the standard error, the degrees of freedom, and \\(t^{\\star}_df\\). Calculate the confidence interval using the general formula, point estimate \\(\\pm t_{df}^{\\star} SE\\). Put the conclusions in context and in plain language so even non-statisticians can understand the results. 6.3.5 Pooled standard deviation estimate (special topic) Occasionally, two populations will have standard deviations that are so similar that they can be treated as identical. For example, historical data or a well-understood biological mechanism may justify this strong assumption. In such cases, we can make the \\(t\\) distribution approach slightly more precise by using a pooled standard deviation. The pooled standard deviation of two groups is a way to use data from both samples to better estimate the standard deviation and standard error. If \\(s_1^{}\\) and \\(s_2^{}\\) are the standard deviations of groups 1 and 2 and there are good reasons to believe that the population standard deviations are equal, then we can obtain an improved estimate of the group variances by pooling their data: \\[\\begin{aligned} s_{pooled}^2 = \\frac{s_1^2\\times (n_1-1) + s_2^2\\times (n_2-1)}{n_1 + n_2 - 2}\\end{aligned}\\] where \\(n_1\\) and \\(n_2\\) are the sample sizes, as before. To use this new statistic, we substitute \\(s_{pooled}^2\\) in place of \\(s_1^2\\) and \\(s_2^2\\) in the standard error formula, and we use an updated formula for the degrees of freedom: \\[\\begin{aligned} df = n_1 + n_2 - 2\\end{aligned}\\] The benefits of pooling the standard deviation are realized through obtaining a better estimate of the standard deviation for each group and using a larger degrees of freedom parameter for the \\(t\\) distribution. Both of these changes may permit a more accurate model of the sampling distribution of \\(\\bar{x}_1 - \\bar{x}_2\\). Pooling standard deviations should be done only after careful research A pooled standard deviation is only appropriate when background research indicates the population standard deviations are nearly equal. When the sample size is large and the condition may be adequately checked with data, the benefits of pooling the standard deviations greatly diminishes. See www.cherryblossom.org.↩ As before, we identify the point estimate, \\(\\bar{x} = 35.05\\), and the standard error, \\(SE = 8.97 / \\sqrt{100} = 0.897\\). Next, we apply the formula for a 90% confidence interval, which uses \\(z^{\\star} = 1.65\\): \\(35.05 \\pm 1.65\\times 0.897 \\to (33.57, 36.53)\\). We are 90% confident that the average age of all participants in the 2012 Cherry Blossom Run is between 33.57 and 36.53 years.↩ The standard deviation of the \\(t\\) distribution is actually a little more than 1. However, it is useful to always think of the \\(t\\) distribution as having a standard deviation of 1 in all of our applications.↩ We find the shaded area above -1.79 (we leave the picture to you). The small left tail is between 0.025 and 0.05, so the larger upper region must have an area between 0.95 and 0.975.↩ Taiji was featured in the movie The Cove, and it is a significant source of dolphin and whale meat in Japan. Thousands of dolphins pass through the Taiji area annually, and we will assume these 19 dolphins represent a simple random sample from those dolphins. Data reference: Endo T and Haraguchi K. 2009. High mercury levels in hair samples from residents of Taiji, a Japanese whaling town. Marine Pollution Bulletin 60(5):743-747.↩ http://www.fda.gov/food/foodborneillnesscontaminants/metals/ucm115644.htm↩ There are no obvious outliers; all observations are within 2 standard deviations of the mean. If there is skew, it is not evident. There are no red flags for the normal model based on this (limited) information, and we do not have reason to believe the mercury content is not nearly normal in this type of fish.↩ \\(\\bar{x} \\ \\pm\\ t^{\\star}_{14} \\times SE \\ \\to\\ 0.287 \\ \\pm\\ 1.76\\times 0.0178\\ \\to\\ (0.256, 0.318)\\). We are 90% confident that the average mercury content of croaker white fish (Pacific) is between 0.256 and 0.318 ppm.↩ \\(H_0\\): The average 10 mile run time was the same for 2006 and 2012. \\(\\mu = 93.29\\) minutes. \\(H_A\\): The average 10 mile run time for 2012 was different than that of 2006. \\(\\mu \\neq 93.29\\) minutes.↩ With a sample of 100, we should only be concerned if there is extreme skew. The histogram of the data suggest, at worst, slight skew.↩ With the conditions satisfied for the \\(t\\) distribution, we can compute the standard error (\\(SE = 15.78 / \\sqrt{100} = 1.58\\) and the T score: \\(T = \\frac{95.61 - 93.29}{1.58} = 1.47\\). (There is more on this after the guided practice, but a T score and Z score are basically the same thing.) For \\(df = 100 - 1 = 99\\), we would find \\(T = 1.47\\) to fall between the first and second column, which means the p-value is between 0.05 and 0.10 (use \\(df = 90\\) and consider two tails since the test is two-sided). Because the p-value is greater than 0.05, we do not reject the null hypothesis. That is, the data do not provide strong evidence that the average run time for the Cherry Blossom Run in 2012 is any different than the 2006 average.↩ When a class had multiple books, only the most expensive text was considered.↩ Observation 2: \\(40.59 - 31.14 = 9.45\\). Observation 3: \\(31.68 - 32.00 = -0.32\\).↩ Conditions have already verified and the standard error computed in Example [htForDiffInUCLAAndAmazonTextbookPrices]. To find the interval, identify \\(t^{\\star}_{72}\\) (use \\(df=70\\) in the table, \\(t^{\\star}_{70} = 1.99\\)) and plug it, the point estimate, and the standard error into the confidence interval formula: \\[\\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad\\to\\quad 12.76 \\ \\pm\\ 1.99\\times 1.67 \\quad\\to\\quad (9.44, 16.08)\\] We are 95% confident that Amazon is, on average, between $9.44 and $16.08 cheaper than the UCLA bookstore for UCLA course books.↩ This technique for degrees of freedom is conservative with respect to a Type 1 Error; it is more difficult to reject the null hypothesis using this \\(df\\) method. In this example, computer software would have provided us a more precise degrees of freedom of \\(df = 12.225\\).↩ (a) The difference in sample means is an appropriate point estimate: \\(\\bar{x}_{n} - \\bar{x}_{s} = 0.40\\). (b) The standard error of the estimate can be estimated using Equation ([seOfDifferenceInMeans]): \\[\\begin{aligned} SE = \\sqrt{\\frac{\\sigma_n^2}{n_n} + \\frac{\\sigma_s^2}{n_s}} \\approx \\sqrt{\\frac{s_n^2}{n_n} + \\frac{s_s^2}{n_s}} = \\sqrt{\\frac{1.60^2}{100} + \\frac{1.43^2}{50}} = 0.26\\end{aligned}\\]↩ Absolutely not. It is possible that there is some difference but we did not detect it. If there is a difference, we made a Type 2 Error. Notice: we also don’t have enough information to, if there is an actual difference difference, confidently say which direction that difference would be in.↩ We could have collected more data. If the sample sizes are larger, we tend to have a better shot at finding a difference if one exists.↩ Because the teacher did not expect one exam to be more difficult prior to examining the test results, she should use a two-sided hypothesis test. \\(H_0\\): the exams are equally difficult, on average. \\(\\mu_A - \\mu_B = 0\\). \\(H_A\\): one exam was more difficult than the other, on average. \\(\\mu_A - \\mu_B \\neq 0\\).↩ (a) It is probably reasonable to conclude the scores are independent, provided there was no cheating. (b) The summary statistics suggest the data are roughly symmetric about the mean, and it doesn’t seem unreasonable to suggest the data might be normal. Note that since these samples are each nearing 30, moderate skew in the data would be acceptable. (c) It seems reasonable to suppose that the samples are independent since the exams were handed out randomly.↩ "],
["inferenceForNumericalDataANOVA.html", "Chapter 7 Inference for numerical data: ANOVA 7.1 Comparing many means with ANOVA 7.2 Bootstrapping to study the standard deviation", " Chapter 7 Inference for numerical data: ANOVA 7.1 Comparing many means with ANOVA Sometimes we want to compare means across many groups. We might initially think to do pairwise comparisons; for example, if there were three groups, we might be tempted to compare the first mean with the second, then with the third, and then finally compare the second and third means for a total of three comparisons. However, this strategy can be treacherous. If we have many groups and do many comparisons, it is likely that we will eventually find a difference just by chance, even if there is no difference in the populations. In this section, we will learn a new method called analysis of variance (ANOVA) and a new test statistic called \\(F\\). ANOVA uses a single hypothesis test to check whether the means across many groups are equal: The mean outcome is the same across all groups. In statistical notation, \\(\\mu_1 = \\mu_2 = \\cdots = \\mu_k\\) where \\(\\mu_i\\) represents the mean of the outcome for observations in category \\(i\\). At least one mean is different. Generally we must check three conditions on the data before performing ANOVA: the observations are independent within and across groups, the data within each group are nearly normal, and the variability across the groups is about equal. When these three conditions are met, we may perform an ANOVA to determine whether the data provide strong evidence against the null hypothesis that all the \\(\\mu_i\\) are equal. College departments commonly run multiple lectures of the same introductory course each semester because of high demand. Consider a statistics department that runs three lectures of an introductory statistics course. We might like to determine whether there are statistically significant differences in first exam scores in these three classes (\\(A\\), \\(B\\), and \\(C\\)). Describe appropriate hypotheses to determine whether there are any differences between the three classes. [firstExampleForThreeStatisticsClassesAndANOVA] The hypotheses may be written in the following form: The average score is identical in all lectures. Any observed difference is due to chance. Notationally, we write \\(\\mu_A=\\mu_B=\\mu_C\\). The average score varies by class. We would reject the null hypothesis in favor of the alternative hypothesis if there were larger differences among the class averages than what we might expect from chance alone. Strong evidence favoring the alternative hypothesis in ANOVA is described by unusually large differences among the group means. We will soon learn that assessing the variability of the group means relative to the variability among individual observations within each group is key to ANOVA’s success. Examine Figure [toyANOVA]. Compare groups I, II, and III. Can you visually determine if the differences in the group centers is due to chance or not? Now compare groups IV, V, and VI. Do these differences appear to be due to chance? Side-by-side dot plot for the outcomes for six groups. [toyANOVA] Any real difference in the means of groups I, II, and III is difficult to discern, because the data within each group are very volatile relative to any differences in the average outcome. On the other hand, it appears there are differences in the centers of groups IV, V, and VI. For instance, group V appears to have a higher mean than that of the other two groups. Investigating groups IV, V, and VI, we see the differences in the groups’ centers are noticeable because those differences are large relative to the variability in the individual observations within each group. 7.1.1 Is batting performance related to player position in MLB? We would like to discern whether there are real differences between the batting performance of baseball players according to their position: outfielder (), infielder (), designated hitter (), and catcher (). We will use a data set called bat10, which includes batting records of 327 Major League Baseball (MLB) players from the 2010 season. Six of the 327 cases represented in bat10 are shown in Table [mlbBat10DataMatrix], and descriptions for each variable are provided in Table [mlbBat10Variables]. The measure we will use for the player batting performance (the outcome variable) is on-base percentage (OBP). The on-base percentage roughly represents the fraction of the time a player successfully gets on base or hits a home run. Six cases from the bat10 data matrix. name team position AB H HR RBI AVG OBP 1 I Suzuki SEA OF 680 214 6 43 0.315 0.359 2 D Jeter NYY IF 663 179 10 67 0.270 0.340 3 M Young TEX IF 656 186 21 91 0.284 0.330 \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 325 B Molina SF C 202 52 3 17 0.257 0.312 326 J Thole NYM C 202 56 3 17 0.277 0.357 327 C Heisey CIN OF 201 51 8 21 0.254 0.324 [mlbBat10DataMatrix] Variables and their descriptions for the bat10 data set. variable description name Player name team The abbreviated name of the player’s team position The player’s primary field position (, , , ) AB Number of opportunities at bat H Number of hits HR Number of home runs RBI Number of runs batted in AVG Batting average, which is equal to \\(\\resp{H}/\\resp{AB}\\) OBP On-base percentage, which is roughly equal to the fraction of times a player gets on base or hits a home run [mlbBat10Variables] [nullHypForOBPAgainstPosition] The null hypothesis under consideration is the following: \\(\\mu_{\\resp{OF}} = \\mu_{\\resp{IF}} = \\mu_{\\resp{DH}} = \\mu_{\\resp{C}}\\). Write the null and corresponding alternative hypotheses in plain language.22 The player positions have been divided into four groups: outfield (), infield (), designated hitter (), and catcher (). What would be an appropriate point estimate of the on-base percentage by outfielders, \\(\\mu_{\\resp{OF}}\\)? A good estimate of the on-base percentage by outfielders would be the sample average of AVG for just those players whose position is outfield: \\(\\bar{x}_{OF} = 0.334\\). Table [mlbHRPerABSummaryTable] provides summary statistics for each group. A side-by-side box plot for the on-base percentage is shown in Figure [mlbANOVABoxPlot]. Notice that the variability appears to be approximately constant across groups; nearly constant variance across groups is an important assumption that must be satisfied before we consider the ANOVA approach. Summary statistics of on-base percentage, split by player position. Sample size (\\(n_i\\)) 120 154 14 39 Sample mean (\\(\\bar{x}_i\\)) 0.334 0.332 0.348 0.323 Sample SD (\\(s_i\\)) 0.029 0.037 0.036 0.045 [mlbHRPerABSummaryTable] Side-by-side box plot of the on-base percentage for 327 players across four groups. There is one prominent outlier visible in the infield group, but with 154 observations in the infield group, this outlier is not a concern. [mlbANOVABoxPlot] The largest difference between the sample means is between the designated hitter and the catcher positions. Consider again the original hypotheses: \\(\\mu_{\\resp{OF}} = \\mu_{\\resp{IF}} = \\mu_{\\resp{DH}} = \\mu_{\\resp{C}}\\) The average on-base percentage (\\(\\mu_i\\)) varies across some (or all) groups. Why might it be inappropriate to run the test by simply estimating whether the difference of \\(\\mu_{\\textbf{DH}}\\) and \\(\\mu_{\\resp{C}}\\) is statistically significant at a 0.05 significance level? [multipleComparisonExampleThatIncludesDiscussionOfClassrooms] The primary issue here is that we are inspecting the data before picking the groups that will be compared. It is inappropriate to examine all data by eye (informal testing) and only afterwards decide which parts to formally test. This is called data snooping or data fishing. Naturally we would pick the groups with the large differences for the formal test, leading to an inflation in the Type 1 Error rate. To understand this better, let’s consider a slightly different problem. Suppose we are to measure the aptitude for students in 20 classes in a large elementary school at the beginning of the year. In this school, all students are randomly assigned to classrooms, so any differences we observe between the classes at the start of the year are completely due to chance. However, with so many groups, we will probably observe a few groups that look rather different from each other. If we select only these classes that look so different, we will probably make the wrong conclusion that the assignment wasn’t random. While we might only formally test differences for a few pairs of classes, we informally evaluated the other classes by eye before choosing the most extreme cases for a comparison. For additional information on the ideas expressed in Example [multipleComparisonExampleThatIncludesDiscussionOfClassrooms], we recommend reading about the prosecutor’s fallacy.23 In the next section we will learn how to use the \\(F\\) statistic and ANOVA to test whether observed differences in means could have happened just by chance even if there was no difference in the respective population means. 7.1.2 Analysis of variance (ANOVA) and the F test The method of analysis of variance in this context focuses on answering one question: is the variability in the sample means so large that it seems unlikely to be from chance alone? This question is different from earlier testing procedures since we will simultaneously consider many groups, and evaluate whether their sample means differ more than we would expect from natural variation. We call this variability the mean square between groups (\\(MSG\\)), and it has an associated degrees of freedom, \\(df_{G}=k-1\\) when there are \\(k\\) groups. The \\(MSG\\) can be thought of as a scaled variance formula for means. If the null hypothesis is true, any variation in the sample means is due to chance and shouldn’t be too large. Details of \\(MSG\\) calculations are provided in the footnote,24 however, we typically use software for these computations. The mean square between the groups is, on its own, quite useless in a hypothesis test. We need a benchmark value for how much variability should be expected among the sample means if the null hypothesis is true. To this end, we compute a pooled variance estimate, often abbreviated as the mean square error (\\(MSE\\)), which has an associated degrees of freedom value \\(df_E=n-k\\). It is helpful to think of \\(MSE\\) as a measure of the variability within the groups. Details of the computations of the \\(MSE\\) are provided in the footnote25 for interested readers. When the null hypothesis is true, any differences among the sample means are only due to chance, and the \\(MSG\\) and \\(MSE\\) should be about equal. As a test statistic for ANOVA, we examine the fraction of \\(MSG\\) and \\(MSE\\): \\[\\begin{aligned} \\label{formulaForTheFStatistic} F = \\frac{MSG}{MSE}\\end{aligned}\\] The \\(MSG\\) represents a measure of the between-group variability, and \\(MSE\\) measures the variability within each of the groups. For the baseball data, \\(MSG = 0.00252\\) and \\(MSE=0.00127\\). Identify the degrees of freedom associated with MSG and MSE and verify the \\(F\\) statistic is approximately 1.994.26 We can use the \\(F\\) statistic to evaluate the hypotheses in what is called an F test. A p-value can be computed from the \\(F\\) statistic using an \\(F\\) distribution, which has two associated parameters: \\(df_{1}\\) and \\(df_{2}\\). For the \\(F\\) statistic in ANOVA, \\(df_{1} = df_{G}\\) and \\(df_{2}= df_{E}\\). An \\(F\\) distribution with 3 and 323 degrees of freedom, corresponding to the \\(F\\) statistic for the baseball hypothesis test, is shown in Figure [fDist3And323]. An \\(F\\) distribution with \\(df_1=3\\) and \\(df_2=323\\). [fDist3And323] The larger the observed variability in the sample means (\\(MSG\\)) relative to the within-group observations (\\(MSE\\)), the larger \\(F\\) will be and the stronger the evidence against the null hypothesis. Because larger values of \\(F\\) represent stronger evidence against the null hypothesis, we use the upper tail of the distribution to compute a p-value. Analysis of variance (ANOVA) is used to test whether the mean outcome differs across 2 or more groups. ANOVA uses a test statistic \\(F\\), which represents a standardized ratio of variability in the sample means relative to the variability within the groups. If \\(H_0\\) is true and the model assumptions are satisfied, the statistic \\(F\\) follows an \\(F\\) distribution with parameters \\(df_{1}=k-1\\) and \\(df_{2}=n-k\\). The upper tail of the \\(F\\) distribution is used to represent the p-value. [describePValueAreaForFDistributionInMLBOBPExample] The test statistic for the baseball example is \\(F=1.994\\). Shade the area corresponding to the p-value in Figure [fDist3And323].27 The p-value corresponding to the shaded area in the solution of Guided Practice [describePValueAreaForFDistributionInMLBOBPExample] is equal to about 0.115. Does this provide strong evidence against the null hypothesis? The p-value is larger than 0.05, indicating the evidence is not strong enough to reject the null hypothesis at a significance level of 0.05. That is, the data do not provide strong evidence that the average on-base percentage varies by player’s primary field position. 7.1.3 Reading an ANOVA table from software The calculations required to perform an ANOVA by hand are tedious and prone to human error. For these reasons, it is common to use statistical software to calculate the \\(F\\) statistic and p-value. An ANOVA can be summarized in a table very similar to that of a regression summary, which we will see in . Table [anovaSummaryTableForOBPAgainstPosition] shows an ANOVA summary to test whether the mean of on-base percentage varies by player positions in the MLB. Many of these values should look familiar; in particular, the \\(F\\) test statistic and p-value can be retrieved from the last columns. lrrrrr &amp; Df &amp; Sum Sq &amp; Mean Sq &amp; F value &amp; Pr(\\(&gt;\\)F) position &amp; 3 &amp; 0.0076 &amp; 0.0025 &amp; 1.9943 &amp; 0.1147 Residuals &amp; 323 &amp; 0.4080 &amp; 0.0013 &amp; &amp; [anovaSummaryTableForOBPAgainstPosition] 7.1.4 Graphical diagnostics for an ANOVA analysis There are three conditions we must check for an ANOVA analysis: all observations must be independent, the data in each group must be nearly normal, and the variance within each group must be approximately equal. Independence. If the data are a simple random sample from less than 10% of the population, this condition is satisfied. For processes and experiments, carefully consider whether the data may be independent (e.g. no pairing). For example, in the MLB data, the data were not sampled. However, there are not obvious reasons why independence would not hold for most or all observations. Approximately normal. As with one- and two-sample testing for means, the normality assumption is especially important when the sample size is quite small. The normal probability plots for each group of the MLB data are shown in Figure [mlbANOVADiagNormalityGroups]; there is some deviation from normality for infielders, but this isn’t a substantial concern since there are about 150 observations in that group and the outliers are not extreme. Sometimes in ANOVA there are so many groups or so few observations per group that checking normality for each group isn’t reasonable. See the footnote28 for guidance on how to handle such instances. Normal probability plot of OBP for each field position. [mlbANOVADiagNormalityGroups] Constant variance. The last assumption is that the variance in the groups is about equal from one group to the next. This assumption can be checked by examining a side-by-side box plot of the outcomes across the groups, as in Figure . In this case, the variability is similar in the four groups but not identical. We see in Table that the standard deviation varies a bit from one group to the next. Whether these differences are from natural variation is unclear, so we should report this uncertainty with the final results. Diagnostics for an ANOVA analysis Independence is always important to an ANOVA analysis. The normality condition is very important when the sample sizes for each group are relatively small. The constant variance condition is especially important when the sample sizes differ between groups. 7.1.5 Multiple comparisons and controlling Type 1 Error rate When we reject the null hypothesis in an ANOVA analysis, we might wonder, which of these groups have different means? To answer this question, we compare the means of each possible pair of groups. For instance, if there are three groups and there is strong evidence that there are some differences in the group means, there are three comparisons to make: group 1 to group 2, group 1 to group 3, and group 2 to group 3. These comparisons can be accomplished using a two-sample \\(t\\) test, but we use a modified significance level and a pooled estimate of the standard deviation across groups. Usually this pooled standard deviation can be found in the ANOVA table, e.g. along the bottom of Table [anovaSummaryTableForOBPAgainstPosition]. Example discussed three statistics lectures, all taught during the same semester. Table [summaryStatisticsForClassTestData] shows summary statistics for these three courses, and a side-by-side box plot of the data is shown in Figure [classDataSBSBoxPlot]. We would like to conduct an ANOVA for these data. Do you see any deviations from the three conditions for ANOVA? In this case (like many others) it is difficult to check independence in a rigorous way. Instead, the best we can do is use common sense to consider reasons the assumption of independence may not hold. For instance, the independence assumption may not be reasonable if there is a star teaching assistant that only half of the students may access; such a scenario would divide a class into two subgroups. No such situations were evident for these particular data, and we believe that independence is acceptable. The distributions in the side-by-side box plot appear to be roughly symmetric and show no noticeable outliers. The box plots show approximately equal variability, which can be verified in Table [summaryStatisticsForClassTestData], supporting the constant variance assumption. Summary statistics for the first midterm scores in three different lectures of the same course. Class \\(i\\) A B C \\(n_i\\) 58 55 51 \\(\\bar{x}_i\\) 75.1 72.0 78.9 \\(s_i\\) 13.9 13.8 13.1 [summaryStatisticsForClassTestData] Side-by-side box plot for the first midterm scores in three different lectures of the same course. [classDataSBSBoxPlot] [exerExaminingAnovaSummaryTableForMidtermData] An ANOVA was conducted for the midterm data, and summary results are shown in Table [anovaSummaryTableForMidtermData]. What should we conclude?29 lrrrrr &amp; Df &amp; Sum Sq &amp; Mean Sq &amp; F value &amp; Pr(\\(&gt;\\)F) lecture &amp; 2 &amp; 1290.11 &amp; 645.06 &amp; 3.48 &amp; 0.0330 Residuals &amp; 161 &amp; 29810.13 &amp; 185.16 &amp; &amp; [anovaSummaryTableForMidtermData] There is strong evidence that the different means in each of the three classes is not simply due to chance. We might wonder, which of the classes are actually different? As discussed in earlier chapters, a two-sample \\(t\\) test could be used to test for differences in each possible pair of groups. However, one pitfall was discussed in Example : when we run so many tests, the Type 1 Error rate increases. This issue is resolved by using a modified significance level. The scenario of testing many pairs of groups is called multiple comparisons. The Bonferroni correction suggests that a more stringent significance level is more appropriate for these tests: \\[\\begin{aligned} \\alpha^* = \\alpha / K\\end{aligned}\\] where \\(K\\) is the number of comparisons being considered (formally or informally). If there are \\(k\\) groups, then usually all possible pairs are compared and \\(K=\\frac{k(k-1)}{2}\\). In Guided Practice [exerExaminingAnovaSummaryTableForMidtermData], you found strong evidence of differences in the average midterm grades between the three lectures. Complete the three possible pairwise comparisons using the Bonferroni correction and report any differences. [multipleComparisonsOfThreeStatClasses] We use a modified significance level of \\(\\alpha^* = 0.05/3 = 0.0167\\). Additionally, we use the pooled estimate of the standard deviation: \\(s_{pooled}=13.61\\) on \\(df=161\\), which is provided in the ANOVA summary table. Lecture A versus Lecture B: The estimated difference and standard error are, respectively, \\[\\begin{aligned} \\bar{x}_A - \\bar{x}_{B} &amp;= 75.1 - 72 = 3.1 &amp;SE = \\sqrt{\\frac{13.61^2}{58} + \\frac{13.61^2}{55}} &amp;= 2.56\\end{aligned}\\] (See Section for additional details.) This results in a \\(T\\) score of 1.21 on \\(df = 161\\) (we use the \\(df\\) associated with \\(s_{pooled}\\)). Statistical software was used to precisely identify the two-tailed p-value since the modified significance of 0.0167 is not found in the \\(t\\) table. The p-value (0.228) is larger than \\(\\alpha^*=0.0167\\), so there is not strong evidence of a difference in the means of lectures A and B. Lecture A versus Lecture C: The estimated difference and standard error are 3.8 and 2.61, respectively. This results in a \\(T\\) score of 1.46 on \\(df = 161\\) and a two-tailed p-value of 0.1462. This p-value is larger than \\(\\alpha^*\\), so there is not strong evidence of a difference in the means of lectures A and C. Lecture B versus Lecture C: The estimated difference and standard error are 6.9 and 2.65, respectively. This results in a \\(T\\) score of 2.60 on \\(df = 161\\) and a two-tailed p-value of 0.0102. This p-value is smaller than \\(\\alpha^*\\). Here we find strong evidence of a difference in the means of lectures B and C. We might summarize the findings of the analysis from Example [multipleComparisonsOfThreeStatClasses] using the following notation: \\[\\begin{aligned} \\mu_A &amp;\\stackrel{?}{=} \\mu_B &amp;\\mu_A &amp;\\stackrel{?}{=} \\mu_C &amp;\\mu_B &amp;\\neq \\mu_C\\end{aligned}\\] The midterm mean in lecture A is not statistically distinguishable from those of lectures B or C. However, there is strong evidence that lectures B and C are different. In the first two pairwise comparisons, we did not have sufficient evidence to reject the null hypothesis. Recall that failing to reject \\(H_0\\) does not imply \\(H_0\\) is true. Sometimes an ANOVA will reject the null but no groups will have statistically significant differences It is possible to reject the null hypothesis using ANOVA and then to not subsequently identify differences in the pairwise comparisons. However, this does not invalidate the ANOVA conclusion. It only means we have not been able to successfully identify which groups differ in their means. The ANOVA procedure examines the big picture: it considers all groups simultaneously to decipher whether there is evidence that some difference exists. Even if the test indicates that there is strong evidence of differences in group means, identifying with high confidence a specific difference as statistically significant is more difficult. Consider the following analogy: we observe a Wall Street firm that makes large quantities of money based on predicting mergers. Mergers are generally difficult to predict, and if the prediction success rate is extremely high, that may be considered sufficiently strong evidence to warrant investigation by the Securities and Exchange Commission (SEC). While the SEC may be quite certain that there is insider trading taking place at the firm, the evidence against any single trader may not be very strong. It is only when the SEC considers all the data that they identify the pattern. This is effectively the strategy of ANOVA: stand back and consider all the groups simultaneously. 7.2 Bootstrapping to study the standard deviation We analyzed textbook pricing data in Section [pairedData] and found that prices on Amazon were statistically significantly cheaper on average. We might also want to better understand the variability of the price difference from one book to another, which we quantified using the standard deviation: \\(s = \\$14.26\\). The sample standard deviation is a point estimate for the population standard deviation. Just as we care about the precision of a sample mean, we may care about the precise of the sample standard deviation. 7.2.1 Bootstrap samples and distributions The theory required to quantify the uncertainty of the sample standard deviation is complex. In an ideal world, we would sample data from the population again and recompute the standard deviation with this new sample. Then we could do it again. And again. And so on until we get enough standard deviation estimates that we have a good sense of the precision of our original estimate. This is an ideal world where sampling data is free or extremely cheap. That is rarely the case, which poses a challenge to this “resample from the population” approach. However, we can sample from the sample. In the textbook pricing example, there are 73 price differences. This sample can serve as a proxy for the population: we sample from this data set to get a sense for what it would be like if we took new samples. A bootstrap sample is a sample of the original sample. In the case of the textbook data, we proceed as follows: Randomly sample one observation from the 73 price differences. Randomly sample a second observation from the 73 price differences. There is a chance that this second observation will be the same one sampled in the first step. \\(\\vdots\\) Randomly sample a 73\\(^{rd}\\) observation from the 73 price differences. This type of sampling is called sampling with replacement. Table [textbookBootstrapSample] shows a bootstrap sample for the textbook pricing example. Some of the values, such as , are duplicated since occasionally we sample the same observation multiple times. A bootstrap sample of the textbook price differences, which represents a sample of 73 values from the original 73 observations, where we are sampling with replacement. In sampling with replacement, it is possible for a value to be sampled multiple times. For example, was sampled twice in this bootstrap sample. 6.63 5.39 6.39 14.05 6.63 -0.25 12.45 -0.22 9.45 9.45 11.70 39.08 4.80 28.72 9.45 -0.25 -3.88 2.82 45.34 28.72 16.62 38.35 4.74 44.40 3.74 1.75 2.84 30.25 3.35 6.63 30.50 0.00 4.96 6.39 9.48 66.00 44.40 -0.25 -2.55 17.98 2.82 29.29 9.22 11.70 9.31 4.80 13.63 9.45 38.23 4.96 19.69 14.26 12.45 5.39 -0.28 8.23 0.42 2.82 4.78 7.01 4.64 9.12 9.31 9.12 11.70 27.15 28.72 30.71 2.84 -9.53 14.05 [textbookBootstrapSample] A bootstrap sample behaves similarly to how an actual sample would behave, and we compute the point estimate of interest. In the textbook price example, we compute the standard deviation of the bootstrap sample: $13.98. 7.2.2 Inference using the bootstrap One bootstrap sample is not enough to understand the uncertainty of the standard deviation, so we need to collect another bootstrap sample and compute the standard deviation: $16.21. And another: $14.07. And so on. Using a computer, we took 10,000 bootstrap samples and computed the standard deviation for each, and these are summarized in . This is called the bootstrap distribution of the standard deviation for the textbook price differences. To make use of this distribution, we make an important assumption: the bootstrap distribution shown in Figure [textbookBootstrapSamplingForSD] is similar to the sampling distribution of the standard deviation. This assumption is reasonable when doing an informal exploration of the uncertainty of an estimate, and under certain conditions, we can rely on it for more formal inference methods. Bootstrap distribution for the standard deviation of textbook price differences. The distribution is approximately centered at the original sample’s standard deviation, $14.26. [textbookBootstrapSamplingForSD] Describe the bootstrap distribution for the standard deviation shown in Figure [textbookBootstrapSamplingForSD]. The distribution is symmetric, bell-shaped, and centered near $14.26, which is the point estimate from the original data. The standard deviation of the bootstrap distribution is $1.60, and most observations in this distribution lie between $11 and $17. In this example, the bootstrap distribution’s standard deviation, $1.60, quantifies the uncertainty of the point estimate. This is an estimate of the standard error based on the bootstrap. We might be tempted to use it for a 95% confidence interval, but first we must perform some due diligence. As with every statistical method, we must check certain conditions before performing formal inference using the bootstrap. The bootstrap distribution for the standard deviation will be a good approximation of the sampling distribution for the standard deviation when observations in the original sample are independent, the original sample size is at least 30, and the bootstrap distribution is nearly normal. We’re already familiar with checking independence of observations, which we previously checked for this data set, and the second condition is easy to check. The last condition can be checked by examining the bootstrap distribution using a normal probability plot, as shown in Figure [textbookBootstrapSamplingQQPlotForSD]. In this example, we see a very straight line, which indicates the bootstrap distribution is nearly normal, and we can move forward with constructing a confidence interval. Normal probability plot for the bootstrap distribution. [textbookBootstrapSamplingQQPlotForSD] As with many other point estimates, we will use the familiar formula \\[\\begin{aligned} \\text{point estimate} \\pm t_{df}^{\\star} \\times SE\\end{aligned}\\] In the textbook example, using \\(df = 73 - 1 = 72\\) leads to \\(t_{72}^{\\star} = 1.99\\) for a 95% confidence level. For bootstrapping, the standard error is computed as the standard deviation of the bootstrap distribution. Compute the 95% confidence interval for the standard deviation of the textbook price difference. We use the general formula for a 95% confidence interval with the \\(t\\) distribution: \\[\\begin{aligned} \\text{point estimate} &amp;\\pm t_{df}^{\\star} \\times SE \\\\ 14.26 &amp;\\pm 1.99 \\times 1.60 \\\\ (\\$11.08, &amp;\\$17.44)\\end{aligned}\\] We are 95% confident that the standard deviation of the textbook price differences is between $11.08 and $17.44. Had we wanted to conduct a hypothesis test, we could have used the point estimate and standard error for a t test as we have in previous sections. The bootstrap may be used with any parameters using the same conditions as were provided for the standard deviation. However, in other situations, it may be more important to examine the validity of the third condition: that the bootstrap distribution is nearly normal. 7.2.3 Frequently asked questions There are more types of bootstrap techniques, right? Yes! There are many excellent bootstrap techniques. We have only chosen to present one bootstrap technique that could be explained in a single section and is also reasonably reliable. Can we use the bootstrap for the mean or difference of means? Technically, yes. However, the methods introduced earlier tend to be more reliable than this particular bootstrapping method and other simple bootstrapping techniques. See the following page for details on an investigation into the accuracy of several bootstrapping methods as well as the \\(t\\) distribution method introduced earlier in this chapter: www.openintro.org/stat/bootstrap I’ve heard a technique called the percentile bootstrap that is very robust. It is a held belief that the percentile bootstrap is a robust bootstrap method. That is false. The percentile method is one of the least reliable bootstrap methods. Instead, use the method described in this section, which is more reliable, or learn about more advanced techniques. \\(H_0\\): The average on-base percentage is equal across the four positions. \\(H_A\\): The average on-base percentage varies across some (or all) groups.↩ See, for example, www.stat.columbia.edu/\\(\\sim\\)cook/movabletype/archives/2007/05/the_prosecutors.html.↩ Let \\(\\bar{x}\\) represent the mean of outcomes across all groups. Then the mean square between groups is computed as \\[\\begin{aligned} MSG = \\frac{1}{df_{G}}SSG = \\frac{1}{k-1}\\sum_{i=1}^{k} n_{i}\\left(\\bar{x}_{i} - \\bar{x}\\right)^2\\end{aligned}\\] where \\(SSG\\) is called the sum of squares between groups and \\(n_{i}\\) is the sample size of group \\(i\\).↩ Let \\(\\bar{x}\\) represent the mean of outcomes across all groups. Then the sum of squares total (\\(SST\\)) is computed as \\(SST = \\sum_{i=1}^{n} \\left(x_{i} - \\bar{x}\\right)^2\\), where the sum is over all observations in the data set. Then we compute the sum of squared errors (\\(SSE\\)) in one of two equivalent ways: \\[\\begin{aligned} SSE = SST - SSG = (n_1-1)s_1^2 + (n_2-1)s_2^2 + \\cdots + (n_k-1)s_k^2\\end{aligned}\\] where \\(s_i^2\\) is the sample variance (square of the standard deviation) of the residuals in group \\(i\\). Then the \\(MSE\\) is the standardized form of \\(SSE\\): \\(MSE = \\frac{1}{df_{E}}SSE\\).↩ There are \\(k=4\\) groups, so \\(df_{G} = k-1 = 3\\). There are \\(n = n_1 + n_2 + n_3 + n_4 = 327\\) total observations, so \\(df_{E} = n - k = 323\\). Then the \\(F\\) statistic is computed as the ratio of \\(MSG\\) and \\(MSE\\): \\(F = \\frac{MSG}{MSE} = \\frac{0.00252}{0.00127} = 1.984 \\approx 1.994\\). (\\(F=1.994\\) was computed by using values for \\(MSG\\) and \\(MSE\\) that were not rounded.)↩ ↩ First calculate the of the baseball data, which are calculated by taking the observed values and subtracting the corresponding group means. For example, an outfielder with OBP of 0.435 would have a residual of \\(0.405 - \\bar{x}_{OF} = 0.071\\). Then to check the normality condition, create a normal probability plot using all the residuals simultaneously.↩ The p-value of the test is 0.0330, less than the default significance level of 0.05. Therefore, we reject the null hypothesis and conclude that the difference in the average midterm scores are not due to chance.↩ "],
["linRegrForTwoVar.html", "Chapter 8 Introduction to linear regression 8.1 Line fitting, residuals, and correlation 8.2 Fitting a line by least squares regression 8.3 Types of outliers in linear regression 8.4 Inference for linear regression", " Chapter 8 Introduction to linear regression Linear regression is a very powerful statistical technique. Many people have some familiarity with regression just from reading the news, where graphs with straight lines are overlaid on scatterplots. Linear models can be used for prediction or to evaluate whether there is a linear relationship between two numerical variables. Figure [perfLinearModel] shows two variables whose relationship can be modeled perfectly with a straight line. The equation for the line is \\[\\begin{aligned} y = 5 + 57.49x\\end{aligned}\\] Imagine what a perfect linear relationship would mean: you would know the exact value of \\(y\\) just by knowing the value of \\(x\\). This is unrealistic in almost any natural process. For example, if we took family income \\(x\\), this value would provide some useful information about how much financial support \\(y\\) a college may offer a prospective student. However, there would still be variability in financial support, even when comparing students whose families have similar financial backgrounds. Requests from twelve separate buyers were simultaneously placed with a trading company to purchase Target Corporation stock (ticker TGT, April 26th, 2012), and the total cost of the shares were reported. Because the cost is computed using a linear formula, the linear fit is perfect. [perfLinearModel] Linear regression assumes that the relationship between two variables, \\(x\\) and \\(y\\), can be modeled by a straight line: \\[\\begin{aligned} y = \\beta_0 + \\beta_1x \\label{genLinModelWNoErrorTerm}\\end{aligned}\\] [ \\(\\beta_0, \\beta_1\\) Linear model parameters] \\(\\beta_0, \\beta_1\\) Linear model parameters where \\(\\beta_0\\) and \\(\\beta_1\\) represent two model parameters (\\(\\beta\\) is the Greek letter beta). These parameters are estimated using data, and we write their point estimates as \\(b_0\\) and \\(b_1\\). When we use \\(x\\) to predict \\(y\\), we usually call \\(x\\) the explanatory or predictor variable, and we call \\(y\\) the response. It is rare for all of the data to fall on a straight line, as seen in the three scatterplots in Figure [imperfLinearModel]. In each case, the data fall around a straight line, even if none of the observations fall exactly on the line. The first plot shows a relatively strong downward linear trend, where the remaining variability in the data around the line is minor relative to the strength of the relationship between \\(x\\) and \\(y\\). The second plot shows an upward trend that, while evident, is not as strong as the first. The last plot shows a very weak downward trend in the data, so slight we can hardly notice it. In each of these examples, we will have some uncertainty regarding our estimates of the model parameters, \\(\\beta_0\\) and \\(\\beta_1\\). For instance, we might wonder, should we move the line up or down a little, or should we tilt it more or less? As we move forward in this chapter, we will learn different criteria for line-fitting, and we will also learn about the uncertainty associated with estimates of model parameters. Three data sets where a linear model may be useful even though the data do not all fall exactly on the line. [imperfLinearModel] We will also see examples in this chapter where fitting a straight line to the data, even if there is a clear relationship between the variables, is not helpful. One such case is shown in Figure [notGoodAtAllForALinearModel] where there is a very strong relationship between the variables even though the trend is not linear. We will discuss nonlinear trends in this chapter, but the details of fitting nonlinear models are saved for a later course. A linear model is not useful in this nonlinear case. These data are from an introductory physics experiment. [notGoodAtAllForALinearModel] 8.1 Line fitting, residuals, and correlation It is helpful to think deeply about the line fitting process. In this section, we examine criteria for identifying a linear model and introduce a new statistic, correlation. 8.1.1 Beginning with straight lines Scatterplots were introduced in Chapter [introductionToData] as a graphical technique to present two numerical variables simultaneously. Such plots permit the relationship between the variables to be examined with ease. Figure [scattHeadLTotalL] shows a scatterplot for the head length and total length of 104 brushtail possums from Australia. Each point represents a single possum from the data. A scatterplot showing head length against total length for 104 brushtail possums. A point representing a possum with head length 94.1mm and total length 89cm is highlighted. [scattHeadLTotalL] The common brushtail possum of Australia. Photo by wollombi on Flickr [possumPic] The head and total length variables are associated. Possums with an above average total length also tend to have above average head lengths. While the relationship is not perfectly linear, it could be helpful to partially explain the connection between these variables with a straight line. The figure on the left shows head length versus total length, and reveals that many of the points could be captured by a straight band. On the right, we see that a curved band is more appropriate in the scatterplot for weight and mpgCity from the cars data set. [scattHeadLTotalLTube] Straight lines should only be used when the data appear to have a linear relationship, such as the case shown in the left panel of Figure [scattHeadLTotalLTube]. The right panel of Figure [scattHeadLTotalLTube] shows a case where a curved line would be more useful in understanding the relationship between the two variables. Watch out for curved trends We only consider models based on straight lines in this chapter. If data show a nonlinear trend, like that in the right panel of Figure [scattHeadLTotalLTube], more advanced techniques should be used. 8.1.2 Fitting a line by eye We want to describe the relationship between the head length and total length variables in the possum data set using a line. In this example, we will use the total length as the predictor variable, \\(x\\), to predict a possum’s head length, \\(y\\). We could fit the linear relationship by eye, as in Figure [scattHeadLTotalLLine]. The equation for this line is \\[\\begin{aligned} \\hat{y} = 41 + 0.59x \\label{headLLinModTotalL}\\end{aligned}\\] We can use this line to discuss properties of possums. For instance, the equation predicts a possum with a total length of 80 cm will have a head length of \\[\\begin{aligned} \\hat{y} &amp;= 41 + 0.59\\times 80 \\\\ &amp;= 88.2 % mm\\end{aligned}\\] A “hat” on \\(y\\) is used to signify that this is an estimate. This estimate may be viewed as an average: the equation predicts that possums with a total length of 80 cm will have an average head length of 88.2 mm. Absent further information about an 80 cm possum, the prediction for head length that uses the average is a reasonable estimate. A reasonable linear model was fit to represent the relationship between head length and total length. [scattHeadLTotalLLine] 8.1.3 Residuals are the leftover variation in the data after accounting for the model fit: \\[\\begin{aligned} \\text{Data} = \\text{Fit} + \\text{Residual}\\end{aligned}\\] Each observation will have a residual. If an observation is above the regression line, then its residual, the vertical distance from the observation to the line, is positive. Observations below the line have negative residuals. One goal in picking the right linear model is for these residuals to be as small as possible. Three observations are noted specially in Figure [scattHeadLTotalLLine]. The observation marked by an “\\(\\times\\)” has a small, negative residual of about -1; the observation marked by “\\(+\\)” has a large residual of about +7; and the observation marked by “\\(\\triangle\\)” has a moderate residual of about -4. The size of a residual is usually discussed in terms of its absolute value. For example, the residual for “\\(\\triangle\\)” is larger than that of “\\(\\times\\)” because \\(|-4|\\) is larger than \\(|-1|\\). The residual of the \\(i^{th}\\) observation \\((x_i, y_i)\\) is the difference of the observed response (\\(y_i\\)) and the response we would predict based on the model fit (\\(\\hat{y}_i\\)): \\[\\begin{aligned} e_i = y_i - \\hat{y}_i\\end{aligned}\\] We typically identify \\(\\hat{y}_i\\) by plugging \\(x_i\\) into the model. The linear fit shown in Figure [scattHeadLTotalLLine] is given as \\(\\hat{y} = 41 + 0.59x\\). Based on this line, formally compute the residual of the observation \\((77.0, 85.3)\\). This observation is denoted by “\\(\\times\\)” on the plot. Check it against the earlier visual estimate, -1. We first compute the predicted value of point “\\(\\times\\)” based on the model: \\[\\begin{aligned} \\hat{y}_{\\times} = 41+0.59x_{\\times} = 41+0.59\\times 77.0 = 86.4\\end{aligned}\\] Next we compute the difference of the actual head length and the predicted head length: \\[\\begin{aligned} e_{\\times} = y_{\\times} - \\hat{y}_{\\times} = 85.3 - 86.4 = -1.1\\end{aligned}\\] This is very close to the visual estimate of -1. If a model underestimates an observation, will the residual be positive or negative? What about if it overestimates the observation?30 Compute the residuals for the observations \\((85.0, 98.6)\\) (“\\(+\\)” in the figure) and \\((95.5, 94.0)\\) (“\\(\\triangle\\)”) using the linear relationship \\(\\hat{y} = 41 + 0.59x\\).31 Residuals are helpful in evaluating how well a linear model fits a data set. We often display them in a residual plot such as the one shown in Figure [scattHeadLTotalLResidualPlot] for the regression line in Figure [scattHeadLTotalLLine]. The residuals are plotted at their original horizontal locations but with the vertical coordinate as the residual. For instance, the point \\((85.0,98.6)_{+}\\) had a residual of 7.45, so in the residual plot it is placed at \\((85.0, 7.45)\\). Creating a residual plot is sort of like tipping the scatterplot over so the regression line is horizontal. Residual plot for the model in Figure [scattHeadLTotalLLine]. [scattHeadLTotalLResidualPlot] One purpose of residual plots is to identify characteristics or patterns still apparent in data after fitting a model. Figure [sampleLinesAndResPlots] shows three scatterplots with linear models in the first row and residual plots in the second row. Can you identify any patterns remaining in the residuals? Sample data with their best fitting lines (top row) and their corresponding residual plots (bottom row). [sampleLinesAndResPlots] In the first data set (first column), the residuals show no obvious patterns. The residuals appear to be scattered randomly around the dashed line that represents 0. The second data set shows a pattern in the residuals. There is some curvature in the scatterplot, which is more obvious in the residual plot. We should not use a straight line to model these data. Instead, a more advanced technique should be used. The last plot shows very little upwards trend, and the residuals also show no obvious patterns. It is reasonable to try to fit a linear model to the data. However, it is unclear whether there is statistically significant evidence that the slope parameter is different from zero. The point estimate of the slope parameter, labeled \\(b_1\\), is not zero, but we might wonder if this could just be due to chance. We will address this sort of scenario in Section [inferenceForLinearRegression]. 8.1.4 Describing linear relationships with correlation , which always takes values between -1 and 1, describes the strength of the linear relationship between two variables. We denote the correlation by \\(R\\). [ \\(R\\) correlation] \\(R\\) correlation We can compute the correlation using a formula, just as we did with the sample mean and standard deviation. However, this formula is rather complex,32 so we generally perform the calculations on a computer or calculator. Figure [posNegCorPlots] shows eight plots and their corresponding correlations. Only when the relationship is perfectly linear is the correlation either -1 or 1. If the relationship is strong and positive, the correlation will be near +1. If it is strong and negative, it will be near -1. If there is no apparent linear relationship between the variables, then the correlation will be near zero. Sample scatterplots and their correlations. The first row shows variables with a positive relationship, represented by the trend up and to the right. The second row shows variables with a negative trend, where a large value in one variable is associated with a low value in the other. [posNegCorPlots] The correlation is intended to quantify the strength of a linear trend. Nonlinear trends, even when strong, sometimes produce correlations that do not reflect the strength of the relationship; see three such examples in Figure [corForNonLinearPlots]. Sample scatterplots and their correlations. In each case, there is a strong relationship between the variables. However, the correlation is not very strong, and the relationship is not linear. [corForNonLinearPlots] It appears no straight line would fit any of the datasets represented in Figure [corForNonLinearPlots]. Instead, try drawing nonlinear curves on each plot. Once you create a curve for each, describe what is important in your fit.33 8.2 Fitting a line by least squares regression Fitting linear models by eye is open to criticism since it is based on an individual preference. In this section, we use least squares regression as a more rigorous approach. This section considers family income and gift aid data from a random sample of fifty students in the 2011 freshman class of Elmhurst College in Illinois.34 Gift aid is financial aid that does not need to be paid back, as opposed to a loan. A scatterplot of the data is shown in Figure [elmhurstScatterW2Lines] along with two linear fits. The lines follow a negative trend in the data; students who have higher family incomes tended to have lower gift aid from the university. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College. Two lines are fit to the data, the solid line being the least squares line. [elmhurstScatterW2Lines] Is the correlation positive or negative in Figure [elmhurstScatterW2Lines]?35 8.2.1 An objective measure for finding the best line We begin by thinking about what we mean by “best”. Mathematically, we want a line that has small residuals. Perhaps our criterion could minimize the sum of the residual magnitudes: \\[\\begin{aligned} |e_1| + |e_2| + \\dots + |e_n| \\label{sumOfAbsoluteValueOfResiduals}\\end{aligned}\\] which we could accomplish with a computer program. The resulting dashed line shown in Figure [elmhurstScatterW2Lines] demonstrates this fit can be quite reasonable. However, a more common practice is to choose the line that minimizes the sum of the squared residuals: \\[\\begin{aligned} e_{1}^2 + e_{2}^2 + \\dots + e_{n}^2 \\label{sumOfSquaresForResiduals}\\end{aligned}\\] The line that minimizes this least squares criterion is represented as the solid line in Figure [elmhurstScatterW2Lines]. This is commonly called the least squares line. The following are three possible reasons to choose Criterion over Criterion : It is the most commonly used method. Computing the line based on Criterion is much easier by hand and in most statistical software. In many applications, a residual twice as large as another residual is more than twice as bad. For example, being off by 4 is usually more than twice as bad as being off by 2. Squaring the residuals accounts for this discrepancy. The first two reasons are largely for tradition and convenience; the last reason explains why Criterion is typically most helpful.36 8.2.2 Finding the least squares line For the Elmhurst data, we could write the equation of the least squares regression line as \\[\\begin{aligned} \\widehat{aid} = \\beta_0 + \\beta_{1}\\times family\\_\\hspace{0.3mm}income\\end{aligned}\\] Here the equation is set up to predict gift aid based on a student’s family income, which would be useful to students considering Elmhurst. These two values, \\(\\beta_0\\) and \\(\\beta_1\\), are the parameters of the regression line. As in Chapters 4-6, the parameters are estimated using observed data. In practice, this estimation is done using a computer in the same way that other estimates, like a sample mean, can be estimated using a computer or calculator. However, we can also find the parameter estimates by applying two properties of the least squares line: The slope of the least squares line can be estimated by \\[\\begin{aligned} b_1 = \\frac{s_y}{s_x} R \\label{slopeOfLSRLine}\\end{aligned}\\] where \\(R\\) is the correlation between the two variables, and \\(s_x\\) and \\(s_y\\) are the sample standard deviations of the explanatory variable and response, respectively. If \\(\\bar{x}\\) is the mean of the horizontal variable (from the data) and \\(\\bar{y}\\) is the mean of the vertical variable, then the point \\((\\bar{x}, \\bar{y})\\) is on the least squares line. [ \\(b_0, b_1\\) Sample estimates of \\(\\beta_0\\), \\(\\beta_1\\)] \\(b_0, b_1\\) Sample estimates of \\(\\beta_0\\), \\(\\beta_1\\) We use \\(b_0\\) and \\(b_1\\) to represent the point estimates of the parameters \\(\\beta_0\\) and \\(\\beta_1\\). Table [summaryStatsOfSATGPAData] shows the sample means for the family income and gift aid as $101,800 and $19,940, respectively. Plot the point \\((101.8, 19.94)\\) on Figure to verify it falls on the least squares line (the solid line).37 l rr &amp; &amp; &amp; family income, in $1000s (“\\(x\\)”) &amp; gift aid, in $1000s (“\\(y\\)”) &amp; &amp; mean &amp; \\(\\bar{x} = 101.8\\) &amp; \\(\\bar{y} = 19.94\\) sd &amp; \\(s_x = 63.2\\) &amp; \\(s_y = 5.46\\) &amp; &amp; [summaryStatsOfSATGPAData] [findingTheSlopeOfTheLSRLineForIncomeAndAid] Using the summary statistics in Table [summaryStatsOfSATGPAData], compute the slope for the regression line of gift aid against family income.38 You might recall the point-slope form of a line from math class (another common form is slope-intercept). Given the slope of a line and a point on the line, \\((x_0, y_0)\\), the equation for the line can be written as \\[\\begin{aligned} y - y_0 = slope\\times (x - x_0) \\label{pointSlopeFormForALine}\\end{aligned}\\] A common exercise to become more familiar with foundations of least squares regression is to use basic summary statistics and point-slope form to produce the least squares line. To identify the least squares line from summary statistics: Estimate the slope parameter, \\(\\beta_1\\), by calculating \\(b_1\\) using Equation . Noting that the point \\((\\bar{x}, \\bar{y})\\) is on the least squares line, use \\(x_0=\\bar{x}\\) and \\(y_0=\\bar{y}\\) along with the slope \\(b_1\\) in the point-slope equation: \\[y - \\bar{y} = b_1 (x - \\bar{x})\\] Simplify the equation. Using the point \\((101.8, 19.94)\\) from the sample means and the slope estimate \\(b_1 = -0.0431\\) from Guided Practice [findingTheSlopeOfTheLSRLineForIncomeAndAid], find the least-squares line for predicting aid based on family income. [exampleToFindLSRLineOfElmhurstData] Apply the point-slope equation using \\((101.8, 19.94)\\) and the slope \\(b_1 = -0.0431\\): \\[\\begin{aligned} y - y_0 &amp;= b_1 (x - x_0) \\\\ y - 19.94 &amp;= -0.0431(x - 101.8)\\end{aligned}\\] Expanding the right side and then adding 19.94 to each side, the equation simplifies: \\[\\widehat{aid} = 24.3 - 0.0431 \\times family\\_\\hspace{0.3mm}income\\] Here we have replaced \\(y\\) with \\(\\widehat{aid}\\) and \\(x\\) with \\(family\\_\\hspace{0.3mm}income\\) to put the equation in context. We mentioned earlier that a computer is usually used to compute the least squares line. A summary table based on computer output is shown in Table [rOutputForIncomeAidLSRLine] for the Elmhurst data. The first column of numbers provides estimates for \\({b}_0\\) and \\({b}_1\\), respectively. Compare these to the result from Example [exampleToFindLSRLineOfElmhurstData]. l rrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 24.3193 &amp; 1.2915 &amp; 18.83 &amp; 0.0000 family_ income &amp; -0.0431 &amp; 0.0108 &amp; -3.98 &amp; 0.0002 [rOutputForIncomeAidLSRLine] Examine the second, third, and fourth columns in Table [rOutputForIncomeAidLSRLine]. Can you guess what they represent? We’ll describe the meaning of the columns using the second row, which corresponds to \\(\\beta_1\\). The first column provides the point estimate for \\(\\beta_1\\), as we calculated in an earlier example: -0.0431. The second column is a standard error for this point estimate: 0.0108. The third column is a \\(t\\) test statistic for the null hypothesis that \\(\\beta_1 = 0\\): \\(T=-3.98\\). The last column is the p-value for the \\(t\\) test statistic for the null hypothesis \\(\\beta_1=0\\) and a two-sided alternative hypothesis: 0.0002. We will get into more of these details in Section [inferenceForLinearRegression]. Suppose a high school senior is considering Elmhurst College. Can she simply use the linear equation that we have estimated to calculate her financial aid from the university? She may use it as an estimate, though some qualifiers on this approach are important. First, the data all come from one freshman class, and the way aid is determined by the university may change from year to year. Second, the equation will provide an imperfect estimate. While the linear equation is good at capturing the trend in the data, no individual student’s aid will be perfectly predicted. 8.2.3 Interpreting regression line parameter estimates Interpreting parameters in a regression model is often one of the most important steps in the analysis. The slope and intercept estimates for the Elmhurst data are -0.0431 and 24.3. What do these numbers really mean? Interpreting the slope parameter is helpful in almost any application. For each additional $1,000 of family income, we would expect a student to receive a net difference of \\(\\$\\text{1,000}\\times (-0.0431) = -\\$43.10\\) in aid on average, i.e. $43.10 less. Note that a higher family income corresponds to less aid because the coefficient of family income is negative in the model. We must be cautious in this interpretation: while there is a real association, we cannot interpret a causal connection between the variables because these data are observational. That is, increasing a student’s family income may not cause the student’s aid to drop. (It would be reasonable to contact the college and ask if the relationship is causal, i.e. if Elmhurst College’s aid decisions are partially based on students’ family income.) The estimated intercept \\(b_0=24.3\\) (in $1000s) describes the average aid if a student’s family had no income. The meaning of the intercept is relevant to this application since the family income for some students at Elmhurst is $0. In other applications, the intercept may have little or no practical value if there are no observations where \\(x\\) is near zero. The slope describes the estimated difference in the \\(y\\) variable if the explanatory variable \\(x\\) for a case happened to be one unit larger. The intercept describes the average outcome of \\(y\\) if \\(x=0\\) and the linear model is valid all the way to \\(x=0\\), which in many applications is not the case. 8.2.4 Extrapolation is treacherous When those blizzards hit the East Coast this winter, it proved to my satisfaction that global warming was a fraud. That snow was freezing cold. But in an alarming trend, temperatures this spring have risen. Consider this: On February \\(6^{th}\\) it was 10 degrees. Today it hit almost 80. At this rate, by August it will be 220 degrees. So clearly folks the climate debate rages on. Stephen Colbert April 6th, 201039 Linear models can be used to approximate the relationship between two variables. However, these models have real limitations. Linear regression is simply a modeling framework. The truth is almost always much more complex than our simple line. For example, we do not know how the data outside of our limited window will behave. Use the model \\(\\widehat{aid} = 24.3 - 0.0431\\times family\\_\\hspace{0.3mm}income\\) to estimate the aid of another freshman student whose family had income of $1 million. Recall that the units of family income are in $1000s, so we want to calculate the aid for \\(family\\_\\hspace{0.3mm}income = 1000\\): \\[\\begin{aligned} 24.3 - 0.0431\\times family\\_\\hspace{0.3mm}income = 24.3 - 0.0431\\times 1000 = -18.8\\end{aligned}\\] The model predicts this student will have -$18,800 in aid (!). Elmhurst College cannot (or at least does not) require any students to pay extra on top of tuition to attend. Applying a model estimate to values outside of the realm of the original data is called extrapolation. Generally, a linear model is only an approximation of the real relationship between two variables. If we extrapolate, we are making an unreliable bet that the approximate linear relationship will be valid in places where it has not been explored. 8.2.5 Using \\(R^2\\) to describe the strength of a fit We evaluated the strength of the linear relationship between two variables earlier using the correlation, \\(R\\). However, it is more common to explain the strength of a linear fit using \\(R^2\\), called . If provided with a linear model, we might like to describe how closely the data cluster around the linear fit. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College, shown with the least squares regression line. [elmhurstScatterWLSROnly] The \\(R^2\\) of a linear model describes the amount of variation in the response that is explained by the least squares line. For example, consider the Elmhurst data, shown in Figure [elmhurstScatterWLSROnly]. The variance of the response variable, aid received, is \\(s_{aid}^2=29.8\\). However, if we apply our least squares line, then this model reduces our uncertainty in predicting aid using a student’s family income. The variability in the residuals describes how much variation remains after using the model: \\(s_{_{RES}}^2 = 22.4\\). In short, there was a reduction of \\[\\frac{s_{aid}^2 - s_{_{RES}}^2}{s_{_{aid}}^2} = \\frac{29.8 - 22.4}{29.8} = \\frac{7.5}{29.8} = 0.25\\] or about 25% in the data’s variation by using information about family income for predicting aid using a linear model. This corresponds exactly to the R-squared value: \\[\\begin{aligned} R &amp;= -0.499 &amp;R^2 &amp;= 0.25\\end{aligned}\\] If a linear model has a very strong negative relationship with a correlation of -0.97, how much of the variation in the response is explained by the explanatory variable?40 8.2.6 Categorical predictors with two levels Categorical variables are also useful in predicting outcomes. Here we consider a categorical predictor with two levels (recall that a level is the same as a category). We’ll consider Ebay auctions for a video game, Mario Kart for the Nintendo Wii, where both the total price of the auction and the condition of the game were recorded.41 Here we want to predict total price based on game condition, which takes values and . A plot of the auction data is shown in Figure [marioKartNewUsed]. Total auction prices for the video game Mario Kart, divided into used (\\(x=0\\)) and new (\\(x=1\\)) condition games. The least squares regression line is also shown. [marioKartNewUsed] To incorporate the game condition variable into a regression equation, we must convert the categories into a numerical form. We will do so using an indicator variable called , which takes value 1 when the game is new and 0 when the game is used. Using this indicator variable, the linear model may be written as \\[\\begin{aligned} \\widehat{price} = \\beta_0 + \\beta_1 \\times \\text{\\textbf{cond\\_\\hspace{0.3mm}new}}\\end{aligned}\\] The fitted model is summarized in Table [marioKartNewUsedRegrSummary], and the model with its parameter estimates is given as \\[\\begin{aligned} \\widehat{price} = 42.87 + 10.90 \\times \\text{\\textbf{cond\\_\\hspace{0.3mm}new}}\\end{aligned}\\] rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 42.87 &amp; 0.81 &amp; 52.67 &amp; 0.0000 cond_ new &amp; 10.90 &amp; 1.26 &amp; 8.66 &amp; 0.0000 [marioKartNewUsedRegrSummary] Interpret the two parameters estimated in the model for the price of Mario Kart in eBay auctions. The intercept is the estimated price when takes value 0, i.e. when the game is in used condition. That is, the average selling price of a used version of the game is $42.87. The slope indicates that, on average, new games sell for about $10.90 more than used games. The estimated intercept is the value of the response variable for the first category (i.e. the category corresponding to an indicator value of 0). The estimated slope is the average change in the response variable between the two categories. 8.3 Types of outliers in linear regression In this section, we identify criteria for determining which outliers are important and influential. Outliers in regression are observations that fall far from the “cloud” of points. These points are especially important because they can have a strong influence on the least squares line. There are six plots shown in Figure [outlierPlots] along with the least squares line and residual plots. For each scatterplot and residual plot pair, identify any obvious outliers and note how they influence the least squares line. Recall that an outlier is any point that doesn’t appear to belong with the vast majority of the other points.[outlierPlotsExample] There is one outlier far from the other points, though it only appears to slightly influence the line. There is one outlier on the right, though it is quite close to the least squares line, which suggests it wasn’t very influential. There is one point far away from the cloud, and this outlier appears to pull the least squares line up on the right; examine how the line around the primary cloud doesn’t appear to fit very well. There is a primary cloud and then a small secondary cloud of four outliers. The secondary cloud appears to be influencing the line somewhat strongly, making the least square line fit poorly almost everywhere. There might be an interesting explanation for the dual clouds, which is something that could be investigated. There is no obvious trend in the main cloud of points and the outlier on the right appears to largely control the slope of the least squares line. There is one outlier far from the cloud, however, it falls quite close to the least squares line and does not appear to be very influential. Six plots, each with a least squares line and residual plot. All data sets have at least one outlier. [outlierPlots] Examine the residual plots in Figure [outlierPlots]. You will probably find that there is some trend in the main clouds of (3) and (4). In these cases, the outliers influenced the slope of the least squares lines. In (5), data with no clear trend were assigned a line with a large trend simply due to one outlier (!). Points that fall horizontally away from the center of the cloud tend to pull harder on the line, so we call them points with high leverage. Points that fall horizontally far from the line are points of high leverage; these points can strongly influence the slope of the least squares line. If one of these high leverage points does appear to actually invoke its influence on the slope of the line – as in cases (3), (4), and (5) of Example [outlierPlotsExample] – then we call it an influential point. Usually we can say a point is influential if, had we fitted the line without it, the influential point would have been unusually far from the least squares line. It is tempting to remove outliers. Don’t do this without a very good reason. Models that ignore exceptional (and interesting) cases often perform poorly. For instance, if a financial firm ignored the largest market swings – the “outliers” – they would soon go bankrupt by making poorly thought-out investments. Don’t ignore outliers when fitting a final model If there are outliers in the data, they should not be removed or ignored without a good reason. Whatever final model is fit to the data would not be very helpful if it ignores the most exceptional cases. Outliers for a categorical predictor with two levels Be cautious about using a categorical predictor when one of the levels has very few observations. When this happens, those few observations become influential points. 8.4 Inference for linear regression In this section we discuss uncertainty in the estimates of the slope and y-intercept for a regression line. Just as we identified standard errors for point estimates in previous chapters, we first discuss standard errors for these new estimates. However, in the case of regression, we will identify standard errors using statistical software. 8.4.1 Conditions for the least squares line When performing inference on a least squares line, we generally require the following: Linearity. The data should show a linear trend. If there is a nonlinear trend (e.g. left panel of Figure [whatCanGoWrongWithLinearModel]), an advanced regression method from another book or later course should be applied. Nearly normal residuals. Generally the residuals must be nearly normal. When this condition is found to be unreasonable, it is usually because of outliers or concerns about influential points, which we will discuss in greater depth in Section [typesOfOutliersInLinearRegression]. An example of non-normal residuals is shown in the second panel of Figure [whatCanGoWrongWithLinearModel]. Constant variability. The variability of points around the least squares line remains roughly constant. An example of non-constant variability is shown in the third panel of Figure [whatCanGoWrongWithLinearModel]. Independent observations. Be cautious about applying regression to data collected sequentially in what is called a time series. Such data may have an underlying structure that should be considered in a model and analysis. An example of a time series where independence is violated is shown in the fourth panel of Figure [whatCanGoWrongWithLinearModel]. For additional information on checking regression conditions, see Section [multipleRegressionModelAssumptions]. Four examples showing when the methods in this chapter are insufficient to apply to the data. In the left panel, a straight line does not fit the data. In the second panel, there are outliers; two points on the left are relatively distant from the rest of the data, and one of these points is very far away from the line. In the third panel, the variability of the data around the line increases with larger values of \\(x\\). In the last panel, a time series data set is shown, where successive observations are highly correlated. [whatCanGoWrongWithLinearModel] Should we have concerns about applying inference to the Elmhurst data in Figure [elmhurstScatterLSRLineconditions]? The trend appears to be linear, the data fall around the line with no obvious outliers, the variance is roughly constant. These are also not time series observations. It would be reasonable to analyze the model using inference. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College. Two lines are fit to the data, the solid line being the least squares line. [elmhurstScatterLSRLineconditions] 8.4.2 Midterm elections and unemployment Elections for members of the United States House of Representatives occur every two years, coinciding every four years with the U.S. Presidential election. The set of House elections occurring during the middle of a Presidential term are called . In America’s two-party system, one political theory suggests the higher the unemployment rate, the worse the President’s party will do in the midterm elections. To assess the validity of this claim, we can compile historical data and look for a connection. We consider every midterm election from 1898 to 2010, with the exception of those elections during the Great Depression. Figure [unemploymentAndChangeInHouse] shows these data and the least-squares regression line: \\[\\begin{aligned} &amp;\\text{\\% change in House seats for President&#39;s party} \\\\ &amp;\\qquad\\qquad= -6.71 - 1.00\\times \\text{(unemployment rate)}\\end{aligned}\\] We consider the percent change in the number of seats of the President’s party (e.g. percent change in the number of seats for Democrats in 2010) against the unemployment rate. Examining the data, there are no clear deviations from linearity, the constant variance condition, or in the normality of residuals (though we don’t examine a normal probability plot here). While the data are collected sequentially, a separate analysis was used to check for any apparent correlation between successive observations; no such correlation was found. The percent change in House seats for the President’s party in each election from 1898 to 2010 plotted against the unemployment rate. The two points for the Great Depression have been removed, and a least squares regression line has been fit to the data. [unemploymentAndChangeInHouse] The data for the Great Depression (1934 and 1938) were removed because the unemployment rate was 21% and 18%, respectively. Do you agree that they should be removed for this investigation? Why or why not?42 There is a negative slope in the line shown in Figure [unemploymentAndChangeInHouse]. However, this slope (and the y-intercept) are only estimates of the parameter values. We might wonder, is this convincing evidence that the “true” linear model has a negative slope? That is, do the data provide strong evidence that the political theory is accurate? We can frame this investigation into a two-sided statistical hypothesis test. We use a two-sided test since a statistically significant result in either direction would be interesting. \\(\\beta_1 = 0\\). The true linear model has slope zero. \\(\\beta_1 \\neq 0\\). The true linear model has a slope different than zero. The higher the unemployment, the greater the loss for the President’s party in the House of Representatives, or vice-versa. We would reject \\(H_0\\) in favor of \\(H_A\\) if the data provide strong evidence that the true slope parameter is less than zero. To assess the hypotheses, we identify a standard error for the estimate, compute an appropriate test statistic, and identify the p-value. 8.4.3 Understanding regression output from software Just like other point estimates we have seen before, we can compute a standard error and test statistic for \\(b_1\\). We will generally label the test statistic using a \\(T\\), since it follows the \\(t\\) distribution. We will rely on statistical software to compute the standard error and leave the explanation of how this standard error is determined to a second or third statistics course. Table [midtermElectionUnemploymentRRegressionOutput] shows software output for the least squares regression line in Figure [unemploymentAndChangeInHouse]. The row labeled unemp represents the information for the slope, which is the coefficient of the unemployment variable. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -6.7142 &amp; 5.4567 &amp; -1.23 &amp; 0.2300 unemp &amp; -1.0010 &amp; 0.8717 &amp; -1.15 &amp; 0.2617 [midtermElectionUnemploymentRRegressionOutput] What do the first and second columns of Table [midtermElectionUnemploymentRRegressionOutput] represent? The entries in the first column represent the least squares estimates, \\(b_0\\) and \\(b_1\\), and the values in the second column correspond to the standard errors of each estimate. We previously used a \\(t\\) test statistic for hypothesis testing in the context of numerical data. Regression is very similar. In the hypotheses we consider, the null value for the slope is 0, so we can compute the test statistic using the T (or Z) score formula: \\[\\begin{aligned} T = \\frac{\\text{estimate} - \\text{null value}}{\\text{SE}} = \\frac{-1.0010 - 0}{0.8717} = -1.15\\end{aligned}\\] We can look for the two-tailed p-value – shown in Figure [oneSidedTailForMidtermUnemploymentHT] – using the probability table for the \\(t\\) distribution in Appendix [tDistributionTable] on page . The distribution shown here is the sampling distribution for \\(b_1\\), if the null hypothesis was true. The shaded tail represents the p-value for the hypothesis test evaluating whether there is convincing evidence that higher unemployment corresponds to a greater loss of House seats for the President’s party during a midterm election. [oneSidedTailForMidtermUnemploymentHT] Table [midtermElectionUnemploymentRRegressionOutput] offers the degrees of freedom for the test statistic \\(T\\): \\(df=25\\). Identify the p-value for the hypothesis test. Looking in the 25 degrees of freedom row in Appendix [tDistributionTable], we see that the absolute value of the test statistic is smaller than any value listed, which means the tail area and therefore also the p-value is larger than 0.200 (two tails!). Because the p-value is so large, we fail to reject the null hypothesis. That is, the data do not provide convincing evidence that unemployment is a good predictor of how well a president’s party will do in the midterm elections for the House of Representatives. We could have identified the \\(t\\) test statistic from the software output in Table [midtermElectionUnemploymentRRegressionOutput], shown in the second row (unemp) and third column (t value). The entry in the second row and last column in Table [midtermElectionUnemploymentRRegressionOutput] represents the p-value for the two-sided hypothesis test where the null value is zero. We usually rely on statistical software to identify point estimates and standard errors for parameters of a regression line. After verifying conditions hold for fitting a line, we can use the methods learned in Section [oneSampleMeansWithTDistribution] for the \\(t\\) distribution to create confidence intervals for regression parameters or to evaluate hypothesis tests. Don’t carelessly use the p-value from regression outputThe last column in regression output often lists p-values for one particular hypothesis: a two-sided test where the null value is zero. If a hypothesis test should be one-sided or a comparison is being made to a value other than zero, be cautious about using the software output to obtain the p-value. Examine Figure , which relates the Elmhurst College aid and student family income. How sure are you that the slope is statistically significantly different from zero? That is, do you think a formal hypothesis test would reject the claim that the true slope of the line should be zero? [overallAidIncomeInformalAssessmentOfRegressionLineSlope] While the relationship between the variables is not perfect, there is an evident decreasing trend in the data. This suggests the hypothesis test will reject the null claim that the slope is zero. Table [rOutputForIncomeAidLSRLineInInferenceSection] shows statistical software output from fitting the least squares regression line shown in Figure [elmhurstScatterWLSROnly]. Use this output to formally evaluate the following hypotheses. \\(H_0\\): The true coefficient for family income is zero. \\(H_A\\): The true coefficient for family income is not zero.43 rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 24.3193 &amp; 1.2915 &amp; 18.83 &amp; 0.0000 family_ income &amp; -0.0431 &amp; 0.0108 &amp; -3.98 &amp; 0.0002 [rOutputForIncomeAidLSRLineInInferenceSection] If conditions for fitting the regression line do not hold, then the methods presented here should not be applied. The standard error or distribution assumption of the point estimate – assumed to be normal when applying the \\(t\\) test statistic – may not be valid. If a model underestimates an observation, then the model estimate is below the actual. The residual, which is the actual observation value minus the model estimate, must then be positive. The opposite is true when the model overestimates the observation: the residual is negative.↩ (\\(+\\)) First compute the predicted value based on the model: \\[\\hat{y}_{+} = 41+0.59x_{+} = 41+0.59\\times 85.0 = 91.15\\] Then the residual is given by \\[e_{+} = y_{+} - \\hat{y}_{+} = 98.6-91.15=7.45\\]This was close to the earlier estimate of 7. (\\(\\triangle\\)) \\(\\hat{y}_{\\triangle} = 41+0.59x_{\\triangle} = 97.3\\). \\(e_{\\triangle} = y_{\\triangle} - \\hat{y}_{\\triangle} = -3.3\\), close to the estimate of -4.↩ Formally, we can compute the correlation for observations \\((x_1, y_1)\\), \\((x_2, y_2)\\), …, \\((x_n, y_n)\\) using the formula \\[\\begin{aligned} R = \\frac{1}{n-1}\\sum_{i=1}^{n} \\frac{x_i-\\bar{x}}{s_x}\\frac{y_i-\\bar{y}}{s_y}\\end{aligned}\\] where \\(\\bar{x}\\), \\(\\bar{y}\\), \\(s_x\\), and \\(s_y\\) are the sample means and standard deviations for each variable.↩ We’ll leave it to you to draw the lines. In general, the lines you draw should be close to most points and reflect overall trends in the data.↩ These data were sampled from a table of data for all freshman from the 2011 class at Elmhurst College that accompanied an article titled What Students Really Pay to Go to College published online by The Chronicle of Higher Education: chronicle.com/article/What-Students-Really-Pay-to-Go/131435↩ Larger family incomes are associated with lower amounts of aid, so the correlation will be negative. Using a computer, the correlation can be computed: -0.499.↩ There are applications where Criterion may be more useful, and there are plenty of other criteria we might consider. However, this book only applies the least squares criterion.↩ If you need help finding this location, draw a straight line up from the x-value of 100 (or thereabout). Then draw a horizontal line at 20 (or thereabout). These lines should intersect on the least squares line.↩ Apply Equation with the summary statistics from Table [summaryStatsOfSATGPAData] to compute the slope: \\[\\begin{aligned} b_1 = \\frac{s_y}{s_x} R = \\frac{5.46}{63.2}(-0.499) = -0.0431\\end{aligned}\\]↩ About \\(R^2 = (-0.97)^2 = 0.94\\) or 94% of the variation is explained by the linear model.↩ These data were collected in Fall 2009 and may be found at openintro.org.↩ We will provide two considerations. Each of these points would have very high leverage on any least-squares regression line, and years with such high unemployment may not help us understand what would happen in other years where the unemployment is only modestly high. On the other hand, these are exceptional cases, and we would be discarding important information if we exclude them from a final analysis.↩ We look in the second row corresponding to the family income variable. We see the point estimate of the slope of the line is -0.0431, the standard error of this estimate is 0.0108, and the \\(t\\) test statistic is -3.98. The p-value corresponds exactly to the two-sided test we are interested in: 0.0002. The p-value is so small that we reject the null hypothesis and conclude that family income and financial aid at Elmhurst College for freshman entering in the year 2011 are negatively correlated and the true slope parameter is indeed less than 0, just as we believed in Example [overallAidIncomeInformalAssessmentOfRegressionLineSlope].↩ "],
["multipleRegressionAndANOVA.html", "Chapter 9 Multiple and logistic regression 9.1 Introduction to multiple regression 9.2 Model selection 9.3 Checking model assumptions using graphs 9.4 Logistic regression", " Chapter 9 Multiple and logistic regression [multipleAndLogisticRegression] The principles of simple linear regression lay the foundation for more sophisticated regression methods used in a wide range of challenging settings. In Chapter [multipleAndLogisticRegression], we explore multiple regression, which introduces the possibility of more than one predictor, and logistic regression, a technique for predicting categorical outcomes with two possible categories. 9.1 Introduction to multiple regression Multiple regression extends simple two-variable regression to the case that still has one response but many predictors (denoted \\(x_1\\), \\(x_2\\), \\(x_3\\), …). The method is motivated by scenarios where many variables may be simultaneously connected to an output. We will consider Ebay auctions of a video game called Mario Kart for the Nintendo Wii. The outcome variable of interest is the total price of an auction, which is the highest bid plus the shipping cost. We will try to determine how total price is related to each characteristic in an auction while simultaneously controlling for other variables. For instance, all other characteristics held constant, are longer auctions associated with higher or lower prices? And, on average, how much more do buyers tend to pay for additional Wii wheels (plastic steering wheels that attach to the Wii controller) in auctions? Multiple regression will help us answer these and other questions. The data set includes results from 141 auctions.44 Four observations from this data set are shown in Table [marioKartDataMatrix], and descriptions for each variable are shown in Table [marioKartVariables]. Notice that the condition and stock photo variables are indicator variables. For instance, the variable takes value 1 if the game up for auction is new and 0 if it is used. Using indicator variables in place of category names allows for these variables to be directly used in regression. See Section [categoricalPredictorsWithTwoLevels] for additional details. Multiple regression also allows for categorical variables with many levels, though we do not have any such variables in this analysis, and we save these details for a second or third course. rrrrlr &amp; price &amp; cond_ new &amp; stock_ photo &amp; duration &amp; wheels 1 &amp; 51.55 &amp; 1 &amp; 1 &amp; 3 &amp; 1 2 &amp; 37.04 &amp; 0 &amp; 1 &amp; 7 &amp; 1 \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) 140 &amp; 38.76 &amp; 0 &amp; 0 &amp; 7 &amp; 0 141 &amp; 54.51 &amp; 1 &amp; 1 &amp; 1 &amp; 2 [marioKartDataMatrix] Variables and their descriptions for the data set. variable description price final auction price plus shipping costs, in US dollars a coded two-level categorical variable, which takes value when the game is new and if the game is used a coded two-level categorical variable, which takes value if the primary photo used in the auction was a stock photo and if the photo was unique to that auction duration the length of the auction, in days, taking values from 1 to 10 wheels the number of Wii wheels included with the auction (a Wii wheel is a plastic racing wheel that holds the Wii controller and is an optional but helpful accessory for playing Mario Kart) [marioKartVariables] 9.1.1 A single-variable model for the Mario Kart data Let’s fit a linear regression model with the game’s condition as a predictor of auction price. The model may be written as \\[\\begin{aligned} \\widehat{price} &amp;= 42.87 + 10.90\\times cond\\_\\hspace{0.3mm}new\\end{aligned}\\] Results of this model are shown in Table [singleVarModelsForPriceUsingCond] and a scatterplot for price versus game condition is shown in Figure [marioKartSingle]. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 42.8711 &amp; 0.8140 &amp; 52.67 &amp; 0.0000 cond_ new &amp; 10.8996 &amp; 1.2583 &amp; 8.66 &amp; 0.0000 &amp;&amp;&amp; [singleVarModelsForPriceUsingCond] Scatterplot of the total auction price against the game’s condition. The least squares line is also shown. [marioKartSingle] Examine Figure [marioKartSingle]. Does the linear model seem ?45 Interpret the coefficient for the game’s condition in the model. Is this coefficient significantly different from 0? Note that is a two-level categorical variable that takes value 1 when the game is new and value 0 when the game is used. So 10.90 means that the model predicts an extra $10.90 for those games that are new versus those that are used. (See Section [categoricalPredictorsWithTwoLevels] for a review of the interpretation for two-level categorical predictor variables.) Examining the regression output in Table [singleVarModelsForPriceUsingCond], we can see that the p-value for is very close to zero, indicating there is strong evidence that the coefficient is different from zero when using this simple one-variable model. 9.1.2 Including and assessing many variables in a model Sometimes there are underlying structures or relationships between predictor variables. For instance, new games sold on Ebay tend to come with more Wii wheels, which may have led to higher prices for those auctions. We would like to fit a model that includes all potentially important variables simultaneously. This would help us evaluate the relationship between a predictor variable and the outcome while controlling for the potential influence of other variables. This is the strategy used in multiple regression. While we remain cautious about making any causal interpretations using multiple regression, such models are a common first step in providing evidence of a causal connection. We want to construct a model that accounts for not only the game condition, as in Section [twoSingleVariableModelsForMarioKartData], but simultaneously accounts for three other variables: , duration, and wheels. \\[\\begin{aligned} \\widehat{\\textbf{price}} &amp;= \\beta_0 + \\beta_1\\times \\textbf{cond\\_\\hspace{0.3mm}new} + \\beta_2\\times \\textbf{stock\\_\\hspace{0.3mm}photo} \\notag \\\\ &amp;\\qquad\\ + \\beta_3 \\times \\textbf{duration} + \\beta_4 \\times \\textbf{wheels} \\notag \\\\ \\hat{y} &amp;= \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_4 x_4 \\label{eqForMultipleRegrOfTotalPrForAllPredictors}\\end{aligned}\\] In this equation, \\(y\\) represents the total price, \\(x_1\\) indicates whether the game is new, \\(x_2\\) indicates whether a stock photo was used, \\(x_3\\) is the duration of the auction, and \\(x_4\\) is the number of Wii wheels included with the game. Just as with the single predictor case, a multiple regression model may be missing important components or it might not precisely represent the relationship between the outcome and the available explanatory variables. While no model is perfect, we wish to explore the possibility that this one may fit the data reasonably well. We estimate the parameters \\(\\beta_0\\), \\(\\beta_1\\), …, \\(\\beta_4\\) in the same way as we did in the case of a single predictor. We select \\(b_0\\), \\(b_1\\), …, \\(b_4\\) that minimize the sum of the squared residuals: \\[\\begin{aligned} \\label{sumOfSqResInMultRegr} SSE = e_1^2 + e_2^2 + \\dots + e_{141}^2 = \\sum_{i=1}^{141} e_i^2 = \\sum_{i=1}^{141} \\left(y_i - \\hat{y}_i\\right)^2\\end{aligned}\\] Here there are 141 residuals, one for each observation. We typically use a computer to minimize the sum in Equation and compute point estimates, as shown in the sample output in Table [outputForMultipleRegrOutputForAllPredictors]. Using this output, we identify the point estimates \\(b_i\\) of each \\(\\beta_i\\), just as we did in the one-predictor case. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.2110 &amp; 1.5140 &amp; 23.92 &amp; 0.0000 cond_ new &amp; 5.1306 &amp; 1.0511 &amp; 4.88 &amp; 0.0000 stock_ photo &amp; 1.0803 &amp; 1.0568 &amp; 1.02 &amp; 0.3085 duration &amp; -0.0268 &amp; 0.1904 &amp; -0.14 &amp; 0.8882 wheels &amp; 7.2852 &amp; 0.5547 &amp; 13.13 &amp; 0.0000 &amp;&amp;&amp; [outputForMultipleRegrOutputForAllPredictors] A multiple regression model is a linear model with many predictors. In general, we write the model as \\[\\begin{aligned} \\hat{y} = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_k x_k %+ \\epsilon\\end{aligned}\\] when there are \\(k\\) predictors. We often estimate the \\(\\beta_i\\) parameters using a computer. [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients] Write out the model in Equation using the point estimates from Table [outputForMultipleRegrOutputForAllPredictors]. How many predictors are there in this model?46 What does \\(\\beta_4\\), the coefficient of variable \\(x_4\\) (Wii wheels), represent? What is the point estimate of \\(\\beta_4\\)?47 [computeMultipleRegressionResidualForMarioKart] Compute the residual of the first observation in Table using the equation identified in Guided Practice [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients].48 We estimated a coefficient for in Section [twoSingleVariableModelsForMarioKartData] of \\(b_1 = 10.90\\) with a standard error of \\(SE_{b_1} = 1.26\\) when using simple linear regression. Why might there be a difference between that estimate and the one in the multiple regression setting? [colinearityOfCondNewAndStockPhoto] If we examined the data carefully, we would see that some predictors are correlated. For instance, when we estimated the connection of the outcome price and predictor using simple linear regression, we were unable to control for other variables like the number of Wii wheels included in the auction. That model was biased by the confounding variable wheels. When we use both variables, this particular underlying and unintentional bias is reduced or eliminated (though bias from other confounding variables may still remain). Example [colinearityOfCondNewAndStockPhoto] describes a common issue in multiple regression: correlation among predictor variables. We say the two predictor variables are collinear (pronounced as co-linear) when they are correlated, and this collinearity complicates model estimation. While it is impossible to prevent collinearity from arising in observational data, experiments are usually designed to prevent predictors from being collinear. The estimated value of the intercept is 36.21, and one might be tempted to make some interpretation of this coefficient, such as, it is the model’s predicted price when each of the variables take value zero: the game is used, the primary image is not a stock photo, the auction duration is zero days, and there are no wheels included. Is there any value gained by making this interpretation?49 9.1.3 Adjusted \\(R^2\\) as a better estimate of explained variance We first used \\(R^2\\) in Section [fittingALineByLSR] to determine the amount of variability in the response that was explained by the model: \\[\\begin{aligned} R^2 = 1 - \\frac{\\text{variability in residuals}}{\\text{variability in the outcome}} = 1 - \\frac{Var(e_i)}{Var(y_i)}\\end{aligned}\\] where \\(e_i\\) represents the residuals of the model and \\(y_i\\) the outcomes. This equation remains valid in the multiple regression framework, but a small enhancement can often be even more informative. [computeUnadjustedR2ForAllPredictorsInMarioKart] The variance of the residuals for the model given in Guided Practice [computeMultipleRegressionResidualForMarioKart] is 23.34, and the variance of the total price in all the auctions is 83.06. Calculate \\(R^2\\) for this model.50 This strategy for estimating \\(R^2\\) is acceptable when there is just a single variable. However, it becomes less helpful when there are many variables. The regular \\(R^2\\) is actually a biased estimate of the amount of variability explained by the model. To get a better estimate, we use the adjusted \\(R^2\\). The is computed as \\[\\begin{aligned} R_{adj}^{2} = 1-\\frac{Var(e_i) / (n-k-1)}{Var(y_i) / (n-1)} = 1-\\frac{Var(e_i)}{Var(y_i)} \\times \\frac{n-1}{n-k-1}\\end{aligned}\\] where \\(n\\) is the number of cases used to fit the model and \\(k\\) is the number of predictor variables in the model. Because \\(k\\) is never negative, the adjusted \\(R^2\\) will be smaller – often times just a little smaller – than the unadjusted \\(R^2\\). The reasoning behind the adjusted \\(R^2\\) lies in the associated with each variance.51 There were \\(n=141\\) auctions in the data set and \\(k=4\\) predictor variables in the model. Use \\(n\\), \\(k\\), and the variances from Guided Practice [computeUnadjustedR2ForAllPredictorsInMarioKart] to calculate \\(R_{adj}^2\\) for the Mario Kart model.52 Suppose you added another predictor to the model, but the variance of the errors \\(Var(e_i)\\) didn’t go down. What would happen to the \\(R^2\\)? What would happen to the adjusted \\(R^2\\)? 53 9.2 Model selection The best model is not always the most complicated. Sometimes including variables that are not evidently important can actually reduce the accuracy of predictions. In this section we discuss model selection strategies, which will help us eliminate from the model variables that are less important. In this section, and in practice, the model that includes all available explanatory variables is often referred to as the full model. Our goal is to assess whether the full model is the best model. If it isn’t, we want to identify a smaller model that is preferable. 9.2.1 Identifying variables in the model that may not be helpful Table [outputForMultipleRegrOutputForAllPredictors2] provides a summary of the regression output for the full model for the auction data. The last column of the table lists p-values that can be used to assess hypotheses of the following form: \\(\\beta_i = 0\\) when the other explanatory variables are included in the model. \\(\\beta_i \\neq 0\\) when the other explanatory variables are included in the model. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.2110 &amp; 1.5140 &amp; 23.92 &amp; 0.0000 cond_ new &amp; 5.1306 &amp; 1.0511 &amp; 4.88 &amp; 0.0000 stock_ photo &amp; 1.0803 &amp; 1.0568 &amp; 1.02 &amp; 0.3085 duration &amp; -0.0268 &amp; 0.1904 &amp; -0.14 &amp; 0.8882 wheels &amp; 7.2852 &amp; 0.5547 &amp; 13.13 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp; [outputForMultipleRegrOutputForAllPredictors2] The coefficient of has a \\(t\\) test statistic of \\(T=4.88\\) and a p-value for its corresponding hypotheses (\\(H_0: \\beta_1 = 0\\), \\(H_A: \\beta_1 \\neq 0\\)) of about zero. How can this be interpreted? If we keep all the other variables in the model and add no others, then there is strong evidence that a game’s condition (new or used) has a real relationship with the total auction price. Is there strong evidence that using a stock photo is related to the total auction price? The \\(t\\) test statistic for is \\(T=1.02\\) and the p-value is about 0.31. After accounting for the other predictors, there is not strong evidence that using a stock photo in an auction is related to the total price of the auction. We might consider removing the variable from the model. Identify the p-values for both the duration and wheels variables in the model. Is there strong evidence supporting the connection of these variables with the total price in the model?54 There is not statistically significant evidence that either the stock photo or duration variables contribute meaningfully to the model. Next we consider common strategies for pruning such variables from a model. The adjusted \\(R^2\\) may be used as an alternative to p-values for model selection, where a higher adjusted \\(R^2\\) represents a better model fit. For instance, we could compare two models using their adjusted \\(R^2\\), and the model with the higher adjusted \\(R^2\\) would be preferred. This approach tends to include more variables in the final model when compared to the p-value approach. 9.2.2 Two model selection strategies Two common strategies for adding or removing variables in a multiple regression model are called backward-selection and forward-selection. These techniques are often referred to as stepwise model selection strategies, because they add or delete one variable at a time as they “step” through the candidate predictors. We will discuss these strategies in the context of the p-value approach. Alternatively, we could have employed an \\(R_{adj}^2\\) approach. The backward-elimination strategy starts with the model that includes all potential predictor variables. Variables are eliminated one-at-a-time from the model until only variables with statistically significant p-values remain. The strategy within each elimination step is to drop the variable with the largest p-value, refit the model, and reassess the inclusion of all variables. Results corresponding to the full model for the data are shown in Table [outputForMultipleRegrOutputForAllPredictors2]. How should we proceed under the backward-elimination strategy? [backwardEliminationExampleWMarioKartData] There are two variables with coefficients that are not statistically different from zero: and duration. We first drop the duration variable since it has a larger corresponding p-value, then we refit the model. A regression summary for the new model is shown in Table [outputForMultipleRegrOutputForAllPredictorsButDuration]. In the new model, there is not strong evidence that the coefficient for is different from zero, even though the p-value decreased slightly, and the other p-values remain very small. Next, we again eliminate the variable with the largest non-significant p-value, , and refit the model. The updated regression summary is shown in Table [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto]. In the latest model, we see that the two remaining predictors have statistically significant coefficients with p-values of about zero. Since there are no variables remaining that could be eliminated from the model, we stop. The final model includes only the and wheels variables in predicting the total auction price: \\[\\begin{aligned} \\hat{y} \\ &amp;= \\ b_0 + b_1x_1 + b_4x_4 \\\\ &amp;= \\ 36.78 + 5.58x_1 + 7.23x_4\\end{aligned}\\] where \\(x_1\\) represents and \\(x_4\\) represents wheels. An alternative to using p-values in model selection is to use the adjusted \\(R^2\\). At each elimination step, we refit the model without each of the variables up for potential elimination. For example, in the first step, we would fit four models, where each would be missing a different predictor. If one of these smaller models has a higher adjusted \\(R^2\\) than our current model, we pick the smaller model with the largest adjusted \\(R^2\\). We continue in this way until removing variables does not increase \\(R_{adj}^2\\). Had we used the adjusted \\(R^2\\) criteria, we would have kept the variable along with the and wheels variables. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.0483 &amp; 0.9745 &amp; 36.99 &amp; 0.0000 cond_ new &amp; 5.1763 &amp; 0.9961 &amp; 5.20 &amp; 0.0000 stock_ photo &amp; 1.1177 &amp; 1.0192 &amp; 1.10 &amp; 0.2747 wheels &amp; 7.2984 &amp; 0.5448 &amp; 13.40 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp;&amp;\\(df=137\\) [outputForMultipleRegrOutputForAllPredictorsButDuration] rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.7849 &amp; 0.7066 &amp; 52.06 &amp; 0.0000 cond_ new &amp; 5.5848 &amp; 0.9245 &amp; 6.04 &amp; 0.0000 wheels &amp; 7.2328 &amp; 0.5419 &amp; 13.35 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp;&amp;\\(df=138\\) [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto] Notice that the p-value for changed a little from the full model (0.309) to the model that did not include the duration variable (0.275). It is common for p-values of one variable to change, due to collinearity, after eliminating a different variable. This fluctuation emphasizes the importance of refitting a model after each variable elimination step. The p-values tend to change dramatically when the eliminated variable is highly correlated with another variable in the model. The forward-selection strategy is the reverse of the backward-elimination technique. Instead of eliminating variables one-at-a-time, we add variables one-at-a-time until we cannot find any variables that present strong evidence of their importance in the model. Construct a model for the data set using the forward-selection strategy.[forwardEliminationExampleWMarioKartData] We start with the model that includes no variables. Then we fit each of the possible models with just one variable. That is, we fit the model including just the predictor, then the model including just the variable, then a model with just duration, and a model with just wheels. Each of the four models (yes, we fit four models!) provides a p-value for the coefficient of the predictor variable. Out of these four variables, the wheels variable had the smallest p-value. Since its p-value is less than 0.05 (the p-value was smaller than 2e-16), we add the Wii wheels variable to the model. Once a variable is added in forward-selection, it will be included in all models considered as well as the final model. Since we successfully found a first variable to add, we consider adding another. We fit three new models: (1) the model including just the and wheels variables (output in Table [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto]), (2) the model including just the and wheels variables, and (3) the model including only the duration and wheels variables. Of these models, the first had the lowest p-value for its new variable (the p-value corresponding to was 1.4e-08). Because this p-value is below 0.05, we add the variable to the model. Now the final model is guaranteed to include both the condition and wheels variables. We must then repeat the process a third time, fitting two new models: (1) the model including the , , and wheels variables (output in Table [outputForMultipleRegrOutputForAllPredictorsButDuration]) and (2) the model including the duration, , and wheels variables. The p-value corresponding to in the first model (0.275) was smaller than the p-value corresponding to duration in the second model (0.682). However, since this smaller p-value was not below 0.05, there was not strong evidence that it should be included in the model. Therefore, neither variable is added and we are finished. The final model is the same as that arrived at using the backward-selection strategy. As before, we could have used the \\(R_{adj}^2\\) criteria instead of examining p-values in selecting variables for the model. Rather than look for variables with the smallest p-value, we look for the model with the largest \\(R_{adj}^2\\). What would the result of forward-selection be using the adjusted \\(R^2\\) approach? Using the forward-selection strategy, we start with the model with no predictors. Next we look at each model with a single predictor. If one of these models has a larger \\(R_{adj}^2\\) than the model with no variables, we use this new model. We repeat this procedure, adding one variable at a time, until we cannot find a model with a larger \\(R_{adj}^2\\). If we had done the forward-selection strategy using \\(R_{adj}^2\\), we would have arrived at the model including , , and wheels, which is a slightly larger model than we arrived at using the p-value approach and the same model we arrived at using the adjusted \\(R^2\\) and backwards-elimination. The backward-elimination strategy begins with the largest model and eliminates variables one-by-one until we are satisfied that all remaining variables are important to the model. The forward-selection strategy starts with no variables included in the model, then it adds in variables according to their importance until no other important variables are found. There is no guarantee that the backward-elimination and forward-selection strategies will arrive at the same final model using the p-value or adjusted \\(R^2\\) methods. If the backwards-elimination and forward-selection strategies are both tried and they arrive at different models, choose the model with the larger \\(R_{adj}^2\\) as a tie-breaker; other tie-break options exist but are beyond the scope of this book. It is generally acceptable to use just one strategy, usually backward-elimination with either the p-value or adjusted \\(R^2\\) criteria. However, before reporting the model results, we must verify the model conditions are reasonable. 9.3 Checking model assumptions using graphs Multiple regression methods using the model \\[\\begin{aligned} \\hat{y} &amp;= \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\cdots + \\beta_kx_k\\end{aligned}\\] generally depend on the following four assumptions: the residuals of the model are nearly normal, the variability of the residuals is nearly constant, the residuals are independent, and each variable is linearly related to the outcome. Simple and effective plots can be used to check each of these assumptions. We will consider the model for the auction data that uses the game condition and number of wheels as predictors. The plotting methods presented here may also be used to check the conditions for the models introduced in Chapter [linRegrForTwoVar]. Normal probability plot. A normal probability plot of the residuals is shown in Figure [mkDiagnosticNormalQuantilePlot]. While the plot exhibits some minor irregularities, there are no outliers that might be cause for concern. In a normal probability plot for residuals, we tend to be most worried about residuals that appear to be outliers, since these indicate long tails in the distribution of residuals. A normal probability plot of the residuals is helpful in identifying observations that might be outliers. [mkDiagnosticNormalQuantilePlot] Absolute values of residuals against fitted values. A plot of the absolute value of the residuals against their corresponding fitted values (\\(\\hat{y}_i\\)) is shown in Figure [mkDiagnosticEvsAbsF]. This plot is helpful to check the condition that the variance of the residuals is approximately constant. We don’t see any obvious deviations from constant variance in this example. Comparing the absolute value of the residuals against the fitted values (\\(\\hat{y}_i\\)) is helpful in identifying deviations from the constant variance assumption. [mkDiagnosticEvsAbsF] Residuals in order of their data collection. A plot of the residuals in the order their corresponding auctions were observed is shown in Figure [mkDiagnosticInOrder]. Such a plot is helpful in identifying any connection between cases that are close to one another, e.g. we could look for declining prices over time or if there was a time of the day when auctions tended to fetch a higher price. Here we see no structure that indicates a problem.55 Plotting residuals in the order that their corresponding observations were collected helps identify connections between successive observations. If it seems that consecutive observations tend to be close to each other, this indicates the independence assumption of the observations would fail. [mkDiagnosticInOrder] Residuals against each predictor variable. We consider a plot of the residuals against the variable and the residuals against the wheels variable. These plots are shown in Figure [mkDiagnosticEvsVariables]. For the two-level condition variable, we are guaranteed not to see any remaining trend, and instead we are checking that the variability doesn’t fluctuate across groups. In this example, when we consider the residuals against the wheels variable, we see some possible structure. There appears to be curvature in the residuals, indicating the relationship is probably not linear. In the two-level variable for the game’s condition, we check for differences in distribution shape or variability. For numerical predictors, we also check for trends or other structure. We see some slight bowing in the residuals against the wheels variable. [mkDiagnosticEvsVariables] It is necessary to summarize diagnostics for any model fit. If the diagnostics support the model assumptions, this would improve credibility in the findings. If the diagnostic assessment shows remaining underlying structure in the residuals, we should try to adjust the model to account for that structure. If we are unable to do so, we may still report the model but must also note its shortcomings. In the case of the auction data, we report that there may be a nonlinear relationship between the total price and the number of wheels included for an auction. This information would be important to buyers and sellers; omitting this information could be a setback to the very people who the model might assist. The truth is that no model is perfect. However, even imperfect models can be useful. Reporting a flawed model can be reasonable so long as we are clear and report the model’s shortcomings. Don’t report results when assumptions are grossly violated While there is a little leeway in model assumptions, don’t go too far. If model assumptions are very clearly violated, consider a new model, even if it means learning more statistical methods or hiring someone who can help. Confidence intervals for coefficients in multiple regression can be computed using the same formula as in the single predictor model: \\[\\begin{aligned} b_i \\ \\pm\\ t_{df}^{\\star}SE_{b_{i}}\\end{aligned}\\] where \\(t_{df}^{\\star}\\) is the appropriate \\(t\\) value corresponding to the confidence level and model degrees of freedom, \\(df=n-k-1\\). 9.4 Logistic regression In this section we introduce logistic regression as a tool for building models when there is a categorical response variable with two levels. Logistic regression is a type of generalized linear model (GLM) for response variables where regular multiple regression does not work very well. In particular, the response variable in these settings often takes a form where residuals look completely different from the normal distribution. GLMs can be thought of as a two-stage modeling approach. We first model the response variable using a probability distribution, such as the binomial or Poisson distribution. Second, we model the parameter of the distribution using a collection of predictors and a special form of multiple regression. In Section [logisticRegression] we will revisit the email data set from Chapter [introductionToData]. These emails were collected from a single email account, and we will work on developing a basic spam filter using these data. The response variable, spam, has been encoded to take value 0 when a message is not spam and 1 when it is spam. Our task will be to build an appropriate model that classifies messages as spam or not spam using email characteristics coded as predictor variables. While this model will not be the same as those used in large-scale spam filters, it shares many of the same features. 9.4.1 Email data The email data set was first presented in Chapter [introductionToData] with a relatively small number of variables. In fact, there are many more variables available that might be useful for classifying spam. Descriptions of these variables are presented in Table [emailVariables]. The spam variable will be the outcome, and the other 10 variables will be the model predictors. While we have limited the predictors used in this section to be categorical variables (where many are represented as indicator variables), numerical predictors may also be used in logistic regression. See the footnote for an additional discussion on this topic.56 Descriptions for 11 variables in the email data set. Notice that all of the variables are indicator variables, which take the value 1 if the specified characteristic is present and 0 otherwise. variable description spam Specifies whether the message was spam. An indicator variable for if more than one person was listed in the To field of the email. cc An indicator for if someone was CCed on the email. attach An indicator for if there was an attachment, such as a document or image. dollar An indicator for if the word “dollar” or dollar symbol ($) appeared in the email. winner An indicator for if the word “winner” appeared in the email message. inherit An indicator for if the word “inherit” (or a variation, like “inheritance”) appeared in the email. password An indicator for if the word “password” was present in the email. format Indicates if the email contained special formatting, such as bolding, tables, or links Indicates whether “Re:” was included at the start of the email subject. Indicates whether any exclamation point was included in the email subject. [emailVariables] 9.4.2 Modeling the probability of an event The outcome variable for a GLM is denoted by \\(Y_i\\), where the index \\(i\\) is used to represent observation \\(i\\). In the email application, \\(Y_i\\) will be used to represent whether email \\(i\\) is spam (\\(Y_i=1\\)) or not (\\(Y_i=0\\)). The predictor variables are represented as follows: \\(x_{1,i}\\) is the value of variable 1 for observation \\(i\\), \\(x_{2,i}\\) is the value of variable 2 for observation \\(i\\), and so on. Logistic regression is a generalized linear model where the outcome is a two-level categorical variable. The outcome, \\(Y_i\\), takes the value 1 (in our application, this represents a spam message) with probability \\(p_i\\) and the value 0 with probability \\(1-p_i\\). It is the probability \\(p_i\\) that we model in relation to the predictor variables. The logistic regression model relates the probability an email is spam (\\(p_i\\)) to the predictors \\(x_{1,i}\\), \\(x_{2,i}\\), …, \\(x_{k,i}\\) through a framework much like that of multiple regression: \\[\\begin{aligned} transformation(p_{i}) = \\beta_0 + \\beta_1x_{1,i} + \\beta_2 x_{2,i} + \\cdots \\beta_k x_{k,i} \\label{linkTransformationEquation}\\end{aligned}\\] We want to choose a transformation in Equation that makes practical and mathematical sense. For example, we want a transformation that makes the range of possibilities on the left hand side of Equation equal to the range of possibilities for the right hand side; if there was no transformation for this equation, the left hand side could only take values between 0 and 1, but the right hand side could take values outside of this range. A common transformation for \\(p_i\\) is the logit transformation, which may be written as \\[\\begin{aligned} logit(p_i) = \\log_{e}\\left( \\frac{p_i}{1-p_i} \\right)\\end{aligned}\\] The logit transformation is shown in Figure [logitTransformationFigureHoriz]. Below, we rewrite Equation using the logit transformation of \\(p_i\\): \\[\\begin{aligned} \\log_{e}\\left( \\frac{p_i}{1-p_i} \\right) = \\beta_0 + \\beta_1 x_{1,i} + \\beta_2 x_{2,i} + \\cdots + \\beta_k x_{k,i}\\end{aligned}\\] In our spam example, there are 10 predictor variables, so \\(k = 10\\). This model isn’t very intuitive, but it still has some resemblance to multiple regression, and we can fit this model using software. In fact, once we look at results from software, it will start to feel like we’re back in multiple regression, even if the interpretation of the coefficients is more complex. Values of \\(p_i\\) against values of \\(logit(p_i)\\). [logitTransformationFigureHoriz] Here we create a spam filter with a single predictor: . This variable indicates whether more than one email address was listed in the To field of the email. The following logistic regression model was fit using statistical software: \\[\\begin{aligned} \\log\\left( \\frac{p_i}{1-p_i} \\right) = -2.12 - 1.81\\times\\text{\\textbf{to\\_\\hspace{0.3mm}multiple}}\\end{aligned}\\] If an email is randomly selected and it has just one address in the To field, what is the probability it is spam? What if more than one address is listed in the To field? [logisticExampleWithToMultiple] If there is only one email in the To field, then takes value 0 and the right side of the model equation equals -2.12. Solving for \\(p_i\\): \\(\\frac{e^{-2.12}}{1 + e^{-2.12}} = 0.11\\). Just as we labeled a fitted value of \\(y_i\\) with a “hat” in single-variable and multiple regression, we will do the same for this probability: \\(\\hat{p}_i = 0.11\\). If there is more than one address listed in the To field, then the right side of the model equation is \\(-2.12 - 1.81\\times1 = -3.93\\), which corresponds to a probability \\(\\hat{p}_i = 0.02\\). Notice that we could examine -2.12 and -3.93 in Figure [logitTransformationFigureHoriz] to estimate the probability before formally calculating the value. To convert from values on the regression-scale (e.g. -2.12 and -3.93 in Example [logisticExampleWithToMultiple]), use the following formula, which is the result of solving for \\(p_i\\) in the regression model: \\[\\begin{aligned} p_i = \\frac{e^{\\beta_0 + \\beta_1 x_{1,i}+\\cdots+\\beta_k x_{k,i}}} {\\ 1\\ \\ +\\ \\ e^{\\beta_0 + \\beta_1 x_{1,i}+\\cdots+\\beta_k x_{k,i}}\\ }\\end{aligned}\\] As with most applied data problems, we substitute the point estimates for the parameters (the \\(\\beta_i\\)) so that we may make use of this formula. In Example [logisticExampleWithToMultiple], the probabilities were calculated as \\[\\begin{aligned} &amp;\\frac{\\ e^{-2.12}\\ }{\\ 1\\ +\\ e^{-2.12}\\ } = 0.11 &amp;&amp; \\frac{\\ e^{-2.12 - 1.81}\\ }{\\ 1\\ +\\ e^{-2.12 - 1.81}\\ } = 0.02\\end{aligned}\\] While the information about whether the email is addressed to multiple people is a helpful start in classifying email as spam or not, the probabilities of 11% and 2% are not dramatically different, and neither provides very strong evidence about which particular email messages are spam. To get more precise estimates, we’ll need to include many more variables in the model. We used statistical software to fit the logistic regression model with all ten predictors described in Table [emailVariables]. Like multiple regression, the result may be presented in a summary table, which is shown in Table [emailLogisticModelResults]. The structure of this table is almost identical to that of multiple regression; the only notable difference is that the p-values are calculated using the normal distribution rather than the \\(t\\) distribution. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; z value &amp; Pr(\\(&gt;\\)\\(|\\)z\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -0.8362 &amp; 0.0962 &amp; -8.69 &amp; 0.0000 to_ multiple &amp; -2.8836 &amp; 0.3121 &amp; -9.24 &amp; 0.0000 winner &amp; 1.7038 &amp; 0.3254 &amp; 5.24 &amp; 0.0000 format &amp; -1.5902 &amp; 0.1239 &amp; -12.84 &amp; 0.0000 re_ subj &amp; -2.9082 &amp; 0.3708 &amp; -7.84 &amp; 0.0000 exclaim_ subj &amp; 0.1355 &amp; 0.2268 &amp; 0.60 &amp; 0.5503 cc &amp; -0.4863 &amp; 0.3054 &amp; -1.59 &amp; 0.1113 attach &amp; 0.9790 &amp; 0.2170 &amp; 4.51 &amp; 0.0000 dollar &amp; -0.0582 &amp; 0.1589 &amp; -0.37 &amp; 0.7144 inherit &amp; 0.2093 &amp; 0.3197 &amp; 0.65 &amp; 0.5127 password &amp; -1.4929 &amp; 0.5295 &amp; -2.82 &amp; 0.0048 [emailLogisticModelResults] Just like multiple regression, we could trim some variables from the model using the p-value. Using backwards elimination with a p-value cutoff of 0.05 (start with the full model and trim the predictors with p-values greater than 0.05), we ultimately eliminate the , dollar, inherit, and cc predictors. The remainder of this section will rely on this smaller model, which is summarized in Table [emailLogisticReducedModel]. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; z value &amp; Pr(\\(&gt;\\)\\(|\\)z\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -0.8595 &amp; 0.0910 &amp; -9.44 &amp; 0.0000 to_ multiple &amp; -2.8372 &amp; 0.3092 &amp; -9.18 &amp; 0.0000 winner &amp; 1.7370 &amp; 0.3218 &amp; 5.40 &amp; 0.0000 format &amp; -1.5569 &amp; 0.1207 &amp; -12.90 &amp; 0.0000 re_ subj &amp; -3.0482 &amp; 0.3630 &amp; -8.40 &amp; 0.0000 attach &amp; 0.8643 &amp; 0.2042 &amp; 4.23 &amp; 0.0000 password &amp; -1.4871 &amp; 0.5290 &amp; -2.81 &amp; 0.0049 [emailLogisticReducedModel] Examine the summary of the reduced model in Table [emailLogisticReducedModel], and in particular, examine the row. Is the point estimate the same as we found before, -1.81, or is it different? Explain why this might be.57 Point estimates will generally change a little – and sometimes a lot – depending on which other variables are included in the model. This is usually due to colinearity in the predictor variables. We previously saw this in the Ebay auction example when we compared the coefficient of in a single-variable model and the corresponding coefficient in the multiple regression model that used three additional variables (see Sections [twoSingleVariableModelsForMarioKartData] and [includingAndAssessingManyVariablesInAModel]). Spam filters are built to be automated, meaning a piece of software is written to collect information about emails as they arrive, and this information is put in the form of variables. These variables are then put into an algorithm that uses a statistical model, like the one we’ve fit, to classify the email. Suppose we write software for a spam filter using the reduced model shown in Table [emailLogisticReducedModel]. If an incoming email has the word “winner” in it, will this raise or lower the model’s calculated probability that the incoming email is spam? [exampleForSpamAndWinner] The estimated coefficient of winner is positive (1.7370). A positive coefficient estimate in logistic regression, just like in multiple regression, corresponds to a positive association between the predictor and response variables when accounting for the other variables in the model. Since the response variable takes value 1 if an email is spam and 0 otherwise, the positive coefficient indicates that the presence of “winner” in an email raises the model probability that the message is spam. Suppose the same email from Example [exampleForSpamAndWinner] was in HTML format, meaning the format variable took value 1. Does this characteristic increase or decrease the probability that the email is spam according to the model?[exampleForSpamAndFormat] Since HTML corresponds to a value of 1 in the format variable and the coefficient of this variable is negative (-1.5569), this would lower the probability estimate returned from the model. 9.4.3 Practical decisions in the email application Examples [exampleForSpamAndWinner] and [exampleForSpamAndFormat] highlight a key feature of logistic and multiple regression. In the spam filter example, some email characteristics will push an email’s classification in the direction of spam while other characteristics will push it in the opposite direction. If we were to implement a spam filter using the model we have fit, then each future email we analyze would fall into one of three categories based on the email’s characteristics: The email characteristics generally indicate the email is not spam, and so the resulting probability that the email is spam is quite low, say, under 0.05. The characteristics generally indicate the email is spam, and so the resulting probability that the email is spam is quite large, say, over 0.95. The characteristics roughly balance each other out in terms of evidence for and against the message being classified as spam. Its probability falls in the remaining range, meaning the email cannot be adequately classified as spam or not spam. If we were managing an email service, we would have to think about what should be done in each of these three instances. In an email application, there are usually just two possibilities: filter the email out from the regular inbox and put it in a “spambox”, or let the email go to the regular inbox. The first and second scenarios are intuitive. If the evidence strongly suggests a message is not spam, send it to the inbox. If the evidence strongly suggests the message is spam, send it to the spambox. How should we handle emails in the third category?58 Suppose we apply the logistic model we have built as a spam filter and that 100 messages are placed in the spambox over 3 months. If we used the guidelines above for putting messages into the spambox, about how many legitimate (non-spam) messages would you expect to find among the 100 messages?59 Almost any classifier will have some error. In the spam filter guidelines above, we have decided that it is okay to allow up to 5% of the messages in the spambox to be real messages. If we wanted to make it a little harder to classify messages as spam, we could use a cutoff of 0.99. This would have two effects. Because it raises the standard for what can be classified as spam, it reduces the number of good emails that are classified as spam. However, it will also fail to correctly classify an increased fraction of spam messages. No matter the complexity and the confidence we might have in our model, these practical considerations are absolutely crucial to making a helpful spam filter. Without them, we could actually do more harm than good by using our statistical model. 9.4.4 Diagnostics for the email classifier There are two key conditions for fitting a logistic regression model: Each predictor \\(x_i\\) is linearly related to logit\\((p_i)\\) if all other predictors are held constant. Each outcome \\(Y_i\\) is independent of the other outcomes. The first condition of the logistic regression model is not easily checked without a fairly sizable amount of data. Luckily, we have 3,921 emails in our data set! Let’s first visualize these data by plotting the true classification of the emails against the model’s fitted probabilities, as shown in Figure [logisticModelPredict]. The vast majority of emails (spam or not) still have fitted probabilities below 0.5. The predicted probability that each of the 3,912 emails is spam is classified by their grouping, spam or not. Noise (small, random vertical shifts) have been added to each point so that points with nearly identical values aren’t plotted exactly on top of one another. This makes it possible to see more observations. [logisticModelPredict] This may at first seem very discouraging: we have fit a logistic model to create a spam filter, but no emails have a fitted probability of being spam above 0.75. Don’t despair; we will discuss ways to improve the model through the use of better variables in Section [improvingTheSetOfVariablesForASpamFilter]. We’d like to assess the quality of our model. For example, we might ask: if we look at emails that we modeled as having a 10% chance of being spam, do we find about 10% of them actually are spam? To help us out, we’ll borrow an advanced statistical method called natural splines that estimates the local probability over the region 0.00 to 0.75 (the largest predicted probability was 0.73, so we avoid extrapolating). All you need to know about natural splines to understand what we are doing is that they are used to fit flexible lines rather than straight lines. The curve fit using natural splines is shown in Figure [logisticModelSpline] as a solid black line. If the logistic model fits well, the curve should closely follow the dashed \\(y=x\\) line. We have added shading to represent the confidence bound for the curved line to clarify what fluctuations might plausibly be due to chance. Even with this confidence bound, there are weaknesses in the first model assumption. The solid curve and its confidence bound dips below the dashed line from about 0.1 to 0.3, and then it drifts above the dashed line from about 0.35 to 0.55. These deviations indicate the model relating the parameter to the predictors does not closely resemble the true relationship. The solid black line provides the empirical estimate of the probability for observations based on their predicted probabilities (confidence bounds are also shown for this line), which is fit using natural splines. A small amount of noise was added to the observations in the plot to allow more observations to be seen. [logisticModelSpline] We could evaluate the second logistic regression model assumption – independence of the outcomes – using the model residuals. The residuals for a logistic regression model are calculated the same way as with multiple regression: the observed outcome minus the expected outcome. For logistic regression, the expected value of the outcome is the fitted probability for the observation, and the residual may be written as \\[\\begin{aligned} e_i = Y_i - \\hat{p}_i\\end{aligned}\\] We could plot these residuals against a variety of variables or in their order of collection, as we did with the residuals in multiple regression. However, since the model will need to be revised to effectively classify spam and you have already seen similar residual plots in Section [multipleRegressionModelAssumptions], we won’t investigate the residuals here. 9.4.5 Improving the set of variables for a spam filter If we were building a spam filter for an email service that managed many accounts (e.g. Gmail or Hotmail), we would spend much more time thinking about additional variables that could be useful in classifying emails as spam or not. We also would use transformations or other techniques that would help us include strongly skewed numerical variables as predictors. Take a few minutes to think about additional variables that might be useful in identifying spam. Below is a list of variables we think might be useful: An indicator variable could be used to represent whether there was prior two-way correspondence with a message’s sender. For instance, if you sent a message to john@example.com and then John sent you an email, this variable would take value 1 for the email that John sent. If you had never sent John an email, then the variable would be set to 0. A second indicator variable could utilize an account’s past spam flagging information. The variable could take value 1 if the sender of the message has previously sent messages flagged as spam. A third indicator variable could flag emails that contain links included in previous spam messages. If such a link is found, then set the variable to 1 for the email. Otherwise, set it to 0. The variables described above take one of two approaches. Variable (1) is specially designed to capitalize on the fact that spam is rarely sent between individuals that have two-way communication. Variables (2) and (3) are specially designed to flag common spammers or spam messages. While we would have to verify using the data that each of the variables is effective, these seem like promising ideas. Table [emailTableOfSpamAnd] shows a contingency table for spam and also for the new variable described in (1) above. If we look at the 1,090 emails where there was correspondence with the sender in the preceding 30 days, not one of these message was spam. This suggests variable (1) would be very effective at accurately classifying some messages as not spam. With this single variable, we would be able to send about 28% of messages through to the inbox with confidence that almost none are spam. lrrrr &amp; &amp; &amp; &amp; &amp;&amp; Total &amp; &amp; &amp; &amp; &amp; 367 &amp; 0 &amp;&amp; 367 &amp; 2464 &amp; 1090 &amp;&amp; 3554 &amp; &amp; &amp; &amp; Total &amp; 2831 &amp; 1090 &amp;&amp; 3921 [emailTableOfSpamAnd] The variables described in (2) and (3) would provide an excellent foundation for distinguishing messages coming from known spammers or messages that take a known form of spam. To utilize these variables, we would need to build databases: one holding email addresses of known spammers, and one holding URLs found in known spam messages. Our access to such information is limited, so we cannot implement these two variables in this textbook. However, if we were hired by an email service to build a spam filter, these would be important next steps. In addition to finding more and better predictors, we would need to create a customized logistic regression model for each email account. This may sound like an intimidating task, but its complexity is not as daunting as it may at first seem. We’ll save the details for a statistics course where computer programming plays a more central role. For what is the extremely challenging task of classifying spam messages, we have made a lot of progress. We have seen that simple email variables, such as the format, inclusion of certain words, and other circumstantial characteristics, provide helpful information for spam classification. Many challenges remain, from better understanding logistic regression to carrying out the necessary computer programming, but completing such a task is very nearly within your reach. Diez DM, Barr CD, and Çetinkaya-Rundel M. 2012. openintro: OpenIntro data sets and supplemental functions. cran.r-project.org/web/packages/openintro.↩ Yes. Constant variability, nearly normal residuals, and linearity all appear reasonable.↩ \\(\\hat{y} = 36.21 + 5.13x_1 + 1.08x_2 - 0.03x_3 + 7.29x_4\\), and there are \\(k=4\\) predictor variables.↩ It is the average difference in auction price for each additional Wii wheel included when holding the other variables constant. The point estimate is \\(b_4 = 7.29\\).↩ \\(e_i = y_i - \\hat{y_i} = 51.55 - 49.62 = 1.93\\), where 49.62 was computed using the variables values from the observation and the equation identified in Guided Practice [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients].↩ Three of the variables (, , and wheels) do take value 0, but the auction duration is always one or more days. If the auction is not up for any days, then no one can bid on it! That means the total auction price would always be zero for such an auction; the interpretation of the intercept in this setting is not insightful.↩ \\(R^2 = 1 - \\frac{23.34}{83.06} = 0.719\\).↩ In multiple regression, the degrees of freedom associated with the variance of the estimate of the residuals is \\(n-k-1\\), not \\(n-1\\). For instance, if we were to make predictions for new data using our current model, we would find that the unadjusted \\(R^2\\) is an overly optimistic estimate of the reduction in variance in the response, and using the degrees of freedom in the adjusted \\(R^2\\) formula helps correct this bias.↩ \\(R_{adj}^2 = 1 - \\frac{23.34}{83.06}\\times \\frac{141-1}{141-4-1} = 0.711\\).↩ The unadjusted \\(R^2\\) would stay the same and the adjusted \\(R^2\\) would go down.↩ The p-value for the auction duration is 0.8882, which indicates that there is not statistically significant evidence that the duration is related to the total auction price when accounting for the other variables. The p-value for the Wii wheels variable is about zero, indicating that this variable is associated with the total auction price.↩ An especially rigorous check would use time series methods. For instance, we could check whether consecutive residuals are correlated. Doing so with these residuals yields no statistically significant correlations.↩ Recall from Chapter [linRegrForTwoVar] that if outliers are present in predictor variables, the corresponding observations may be especially influential on the resulting model. This is the motivation for omitting the numerical variables, such as the number of characters and line breaks in emails, that we saw in Chapter [introductionToData]. These variables exhibited extreme skew. We could resolve this issue by transforming these variables (e.g. using a log-transformation), but we will omit this further investigation for brevity.↩ The new estimate is different: -2.87. This new value represents the estimated coefficient when we are also accounting for other variables in the logistic regression model.↩ In this particular application, we should err on the side of sending more mail to the inbox rather than mistakenly putting good messages in the spambox. So, in summary: emails in the first and last categories go to the regular inbox, and those in the second scenario go to the spambox.↩ First, note that we proposed a cutoff for the predicted probability of 0.95 for spam. In a worst case scenario, all the messages in the spambox had the minimum probability equal to about 0.95. Thus, we should expect to find about 5 or fewer legitimate messages among the 100 messages placed in the spambox.↩ "],
["inferenceForCategoricalData.html", "Chapter 10 Inference for categorical data 10.1 Inference for a single proportion 10.2 Difference of two proportions 10.3 Testing for goodness of fit using chi-square (special topic) 10.4 Testing for independence in two-way tables (special topic)", " Chapter 10 Inference for categorical data Chapter [inferenceForCategoricalData] provides a more complete framework for statistical techniques suitable for categorical data. We’ll continue working with the normal model in the context of inference for proportions, and we’ll also encounter a new technique and distribution suitable for working with frequency and contingency tables in Sections [oneWayChiSquare] and [twoWayTablesAndChiSquare]. 10.1 Inference for a single proportion Before we get started, we’ll introduce a little terminology and notation. In the tappers-listeners study, one person tapped a tune on the table and the listener tried to guess the game. In this study, each game can be thought of as a trial. We could label each trial a success if the listener successfully guessed the tune, and we could label a trial a failure if the listener was unsuccessful. A single event that leads to an outcome can be called a trial. If the trial has two possible outcomes, e.g. heads or tails when flipping a coin, we typically label one of those outcome a success and the other a failure. The choice of which outcome is labeled a success and which a failure is arbitrary, and it will not impact the results of our analyses. When a proportion is recorded, it is common to use a 1 to represent a “success” and a 0 to represent a “failure” and then write down a key to communicate what each value represents. This notation is also convenient for calculations. For example, if we have 10 trials with 6 success (1’s) and 4 failures (0’s), the sample proportion can be computed using the mean of the zeros and ones: \\[\\begin{aligned} \\hat{p} = \\frac{\\ 1 + 1 + 1 + 1 + 1 + 1 + 0 + 0 + 0 + 0\\ }{10} = 0.6\\end{aligned}\\] Next we’ll take a look at when we can apply our normal distribution framework to the distribution of the sample proportion, \\(\\hat{p}\\). 10.1.1 When the sample proportion is nearly normal The sampling distribution for \\(\\hat{p}\\), taken from a sample of size \\(n\\) from a population with a true proportion \\(p\\), is nearly normal when the sample observations are independent and we expected to see at least 10 successes and 10 failures in our sample, i.e. \\(np\\geq10\\) and \\(n(1-p)\\geq10\\). This is called the success-failure condition. If these conditions are met, then the sampling distribution of \\(\\hat{p}\\) is nearly normal with mean \\(p\\) and standard error \\[\\begin{aligned} SE_{\\hat{p}} = \\sqrt{\\frac{\\ p(1-p)\\ }{n}} \\label{seOfPHat}\\end{aligned}\\] [ \\(\\hat{p}\\) sample proportion \\(p\\) population proportion] \\(\\hat{p}\\) sample proportion \\(p\\) population proportion Typically we do not know the true proportion, \\(p\\), so we substitute some value to check conditions and to estimate the standard error. For confidence intervals, usually \\(\\hat{p}\\) is used to check the success-failure condition and compute the standard error. For hypothesis tests, typically the null value \\(p_0\\) is used in place of \\(p\\). Examples are presented for each of these cases in Sections [confIntForPropSection] and [htForPropSection]. If data come from a simple random sample and consist of less than 10% of the population, then the independence assumption is reasonable. Or, for example, if the data come from an experiment where each user was randomly assigned to the treatment or control group and users do not interact, then the observations in each group are typically independent. 10.1.2 Confidence intervals for a proportion According to a New York Times / CBS News poll in June 2012, only about 44% of the American public approves of the job the Supreme Court is doing.60 This poll included responses of 976 randomly sampled adults. We want a confidence interval for the proportion of Americans who approve of the job the Supreme Court is doing. Our point estimate, based on a simple random sample of size \\(n = 976\\) from the NYTimes/CBS poll, is \\(\\hat{p} = 0.44\\). To use our confidence interval formula from Section [ConfidenceIntervals], we must first check whether the sampling distribution of \\(\\hat{p}\\) is nearly normal and calculate the standard error of the estimate. The data are based on a simple random sample and consist of far fewer than 10% of the U.S. population, so independence is confirmed. The sample size must also be sufficiently large, which is checked via the success-failure condition: there were approximately \\(976\\times \\hat{p}=429\\) “successes” and \\(976\\times (1-\\hat{p})=547\\) “failures” in the sample, both easily greater than 10. With the conditions met, we are assured that the sampling distribution of \\(\\hat{p}\\) is nearly normal. Next, a standard error for \\(\\hat{p}\\) is needed, and then we can employ the usual method to construct a confidence interval. [seOfPropOfAmericansJobApprovalOfSupremeCourt] Estimate the standard error of \\(\\hat{p}=0.44\\) using Equation . Because \\(p\\) is unknown and the standard error is for a confidence interval, use \\(\\hat{p}\\) in place of \\(p\\). 61 Construct a 95% confidence interval for \\(p\\), the proportion of Americans who approve of the job the Supreme Court is doing. Using the standard error estimate from Guided Practice [seOfPropOfAmericansJobApprovalOfSupremeCourt], the point estimate 0.44, and \\(z^{\\star} = 1.96\\) for a 95% confidence interval, the confidence interval can be computed as \\[\\begin{aligned} \\text{point estimate } \\ \\pm\\ z^{\\star}SE \\quad\\to\\quad 0.44 \\ \\pm\\ 1.96\\times 0.016 \\quad\\to\\quad (0.409, 0.471)\\end{aligned}\\] We are 95% confident that the true proportion of Americans who approve of the job of the Supreme Court (in June 2012) is between 0.409 and 0.471. At the time this poll was taken, we can say with high confidence that the job approval of the Supreme Court was below 50%. Verify the observations are independent and also verify the success-failure condition using \\(\\hat{p}\\) and \\(n\\). If the conditions are met, then the Central Limit Theorem applies, and the sampling distribution of \\(\\hat{p}\\) is well-approximated by the normal model. Construct the standard error using \\(\\hat{p}\\) in place of \\(p\\) and apply the general confidence interval formula. 10.1.3 Hypothesis testing for a proportion To apply the same normal distribution framework in the context of a hypothesis test for a proportion, the independence and success-failure conditions must also be satisfied. However, in a hypothesis test, the success-failure condition is checked using the null proportion: we verify \\(np_0\\) and \\(n(1-p_0)\\) are at least 10, where \\(p_0\\) is the null value. Deborah Toohey is running for Congress, and her campaign manager claims she has more than 50% support from the district’s electorate. Ms. Toohey’s opponent claimed that Ms. Toohey has less than 50%. Set up a hypothesis test to evaluate who is right.62 A newspaper collects a simple random sample of 500 likely voters in the district and estimates Toohey’s support to be 52%. Does this provide convincing evidence for the claim of Toohey’s manager at the 5% significance level? [TooheyInferenceExample] Because this is a simple random sample that includes fewer than 10% of the population, the observations are independent. In a one-proportion hypothesis test, the success-failure condition is checked using the null proportion, \\(p_0=0.5\\): \\(np_0 = n(1-p_0) = 500\\times 0.5 = 250 &gt; 10\\). With these conditions verified, the normal model may be applied to \\(\\hat{p}\\). Next the standard error can be computed. The null value is used again here, because this is a hypothesis test for a single proportion. \\[SE = \\sqrt{\\frac{p_0\\times (1-p_0)}{n}} = \\sqrt{\\frac{0.5\\times (1-0.5)}{500}} = 0.022\\] A picture of the normal model is shown in Figure [pValueForCampaignManagerClaimOfMoreThan50PercentSupport] with the p-value represented by both shaded tails. Based on the normal model, we can compute a test statistic as the Z score of the point estimate: \\[Z = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{0.52 - 0.50}{0.022} = 0.89\\] The right tail area is 0.1867, and the p-value is \\(2 \\times 0.1867 = 0.3734\\). Because the p-value is larger than 0.05, we do not reject the null hypothesis, and we do not find convincing evidence to support the campaign manager’s claim. Sampling distribution of the sample proportion if the null hypothesis is true for Example [TooheyInferenceExample]. The p-value for the test is shaded. [pValueForCampaignManagerClaimOfMoreThan50PercentSupport] Set up hypotheses and verify the conditions using the null value, \\(p_0\\), to ensure \\(\\hat{p}\\) is nearly normal under \\(H_0\\). If the conditions hold, construct the standard error, again using \\(p_0\\), and show the p-value in a drawing. Lastly, compute the p-value and evaluate the hypotheses. 10.1.4 Choosing a sample size when estimating a proportion Frequently statisticians find themselves in a position to not only analyze data, but to help others determine how to most effectively collect data and also how much data should be collected. We can perform sample size calculations that are helpful in planning a study. Our task will be to identify an appropriate sample size that ensures the margin of error \\(ME = z^{\\star} SE\\) will be no larger than some value \\(m\\). For example, we might be asked to find a sample size so the margin of error is no larger than \\(m = 0.04\\), in which case, we write \\[\\begin{aligned} z^{\\star} SE \\leq 0.04\\end{aligned}\\] Generally, we plug in a suitable value for \\(z^{\\star}\\) for the confidence level we plan to use, write in the formula for the standard error, and then solve for the sample size \\(n\\). In the case of a single proportion, we use \\(\\sqrt{p(1-p) / n\\ }\\) for the standard error (\\(SE\\)). If we are conducting a university survey to determine whether students support a $200 per year increase in fees to pay for a new football stadium, how big of a sample is needed to ensure the margin of error is less than 0.04 using a 95% confidence level? For a 95% confidence level, the value \\(z^{\\star}\\) corresponds to 1.96, and we can write the margin of error expression as follows: \\[\\begin{aligned} ME = z^{\\star}SE = 1.96\\times \\sqrt{\\frac{p(1-p)}{n}} \\leq 0.04\\end{aligned}\\] There are two unknowns in the equation: \\(p\\) and \\(n\\). If we have an estimate of \\(p\\), perhaps from a similar survey, we could use that value. If we have no such estimate, we must use some other value for \\(p\\). The margin of error for a proportion is largest when \\(p\\) is 0.5, so we typically use this worst case estimate if no other estimate is available: \\[\\begin{aligned} 1.96\\times \\sqrt{\\frac{0.5(1-0.5)}{n}} &amp;\\leq 0.04 \\\\ 1.96^2\\times \\frac{0.5(1-0.5)}{n} &amp;\\leq 0.04^2 \\\\ 1.96^2\\times \\frac{0.5(1-0.5)}{0.04^2} &amp;\\leq n \\\\ 600.25 &amp;\\leq n\\end{aligned}\\] We would need at least 600.25 participants, which means we need 601 participants or more, to ensure the sample proportion is within 0.04 of the true proportion with 95% confidence. Notice that in such calculations, we always round up for the sample size! As noted in the example, if we have an estimate of the proportion, we should use it in place of the worst case estimate of the proportion, 0.5. A manager is about to oversee the mass production of a new tire model in her factory, and she would like to estimate what proportion of these tires will be rejected through quality control. The quality control team has monitored the last three tire models produced by the factory, failing 1.7% of tires in the first model, 6.2% of the second model, and 1.3% of the third model. The manager would like to examine enough tires to estimate the failure rate of the new tire model to within about 2% with a 90% confidence level.63 There are three different failure rates to choose from. Perform the sample size computation for each separately, and identify three sample sizes to consider. The sample sizes vary widely. Which of the three would you suggest using? What would influence your choice? A recent estimate of Congress’ approval rating was 17%.64 If we were to conduct a new poll and wanted an estimate with a margin of error smaller than about 0.04 with 95% confidence, how big of a sample should we use?65 10.2 Difference of two proportions We would like to make conclusions about the difference in two population proportions (\\(p_1 - p_2\\)) using the normal model. In this section we consider three such examples. In the first, we compare the approval of the 2010 healthcare law under two different question phrasings. In the second application, a company weighs whether they should switch to a higher quality parts manufacturer. In the last example, we examine the cancer risk to dogs from the use of yard herbicides. In our investigations, we first identify a reasonable point estimate of \\(p_1 - p_2\\) based on the sample. You may have already guessed its form: \\(\\hat{p}_1 - \\hat{p}_2\\). Next, in each example we verify that the point estimate follows the normal model by checking certain conditions; as before, these conditions relate to independence of observations and checking for sufficiently large sample size. Finally, we compute the estimate’s standard error and apply our inferential framework. 10.2.1 Sample distribution of the difference of two proportions We must check two conditions before applying the normal model to \\(\\hat{p}_1 - \\hat{p}_2\\). First, the sampling distribution for each sample proportion must be nearly normal, and secondly, the samples must be independent. Under these two conditions, the sampling distribution of \\(\\hat{p}_1 - \\hat{p}_2\\) may be well approximated using the normal model. The difference \\(\\hat{p}_1 - \\hat{p}_2\\) tends to follow a normal model when each proportion separately follows a normal model, and the two samples are independent of each other. The standard error of the difference in sample proportions is \\[\\begin{aligned} SE_{\\hat{p}_1 - \\hat{p}_2} = \\sqrt{SE_{\\hat{p}_1}^2 + SE_{\\hat{p}_2}^2} = \\sqrt{\\frac{p_1(1-p_1)}{n_1} + \\frac{p_2(1-p_2)}{n_2}} \\label{seForDiffOfProp}\\end{aligned}\\] where \\(p_1\\) and \\(p_2\\) represent the population proportions, and \\(n_1\\) and \\(n_2\\) represent the sample sizes. 10.2.2 Intervals and tests for \\(p_1 -p_2\\) In the setting of confidence intervals, the sample proportions are used to verify the success-failure condition and also compute standard error, just as was the case with a single proportion. The way a question is phrased can influence a person’s response. For example, Pew Research Center conducted a survey with the following question:66 As you may know, by 2014 nearly all Americans will be required to have health insurance. [People who do not buy insurance will pay a penalty] while [People who cannot afford it will receive financial help from the government]. Do you approve or disapprove of this policy? For each randomly sampled respondent, the statements in brackets were randomized: either they were kept in the order given above, or the two statements were reversed. Table [pewPollResultsForRandomizedStatementOrdering] shows the results of this experiment. Create and interpret a 90% confidence interval of the difference in approval. p50mmc p13mmp14mmp16.5mmc &amp; &amp; Sample size (\\(n_i\\)) &amp; Approve law (%) &amp; Disapprove law (%) &amp; Other “people who cannot afford it will receive financial help from the government” is given second &amp; &amp; 771 &amp; 47 &amp; 49 &amp; 3 “people who do not buy it will pay a penalty” is given second &amp; &amp; 732 &amp; 34 &amp; 63 &amp; 3 [pewPollResultsForRandomizedStatementOrdering] First the conditions must be verified. Because each group is a simple random sample from less than 10% of the population, the observations are independent, both within the samples and between the samples. The success-failure condition also holds for each sample. Because all conditions are met, the normal model can be used for the point estimate of the difference in support, where \\(p_1\\) corresponds to the original ordering and \\(p_2\\) to the reversed ordering: \\[\\hat{p}_{1} - \\hat{p}_{2} = 0.47 - 0.34 = 0.13\\] The standard error may be computed from Equation using the sample proportions: \\[SE \\approx \\sqrt{\\frac{0.47(1-0.47)}{771} + \\frac{0.34(1-0.34)}{732}} = 0.025\\] For a 90% confidence interval, we use \\(z^{\\star} = 1.65\\): \\[\\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad \\to \\quad 0.13 \\ \\pm\\ 1.65 \\times 0.025 \\quad \\to \\quad (0.09, 0.17)\\] We are 90% confident that the approval rating for the 2010 healthcare law changes between 9% and 17% due to the ordering of the two statements in the survey question. The Pew Research Center reported that this modestly large difference suggests that the opinions of much of the public are still fluid on the health insurance mandate. [carWheelGearManufacturer] A remote control car company is considering a new manufacturer for wheel gears. The new manufacturer would be more expensive but their higher quality gears are more reliable, resulting in happier customers and fewer warranty claims. However, management must be convinced that the more expensive gears are worth the conversion before they approve the switch. If there is strong evidence of a more than 3% improvement in the percent of gears that pass inspection, management says they will switch suppliers, otherwise they will maintain the current supplier. Set up appropriate hypotheses for the test.67 The quality control engineer from Guided Practice [carWheelGearManufacturer] collects a sample of gears, examining 1000 gears from each company and finds that 899 gears pass inspection from the current supplier and 958 pass inspection from the prospective supplier. Using these data, evaluate the hypothesis setup of Guided Practice [carWheelGearManufacturer] using a significance level of 5%. First, we check the conditions. The sample is not necessarily random, so to proceed we must assume the gears are all independent; for this sample we will suppose this assumption is reasonable, but the engineer would be more knowledgeable as to whether this assumption is appropriate. The success-failure condition also holds for each sample. Thus, the difference in sample proportions, \\(0.958-0.899=0.059\\), can be said to come from a nearly normal distribution. The standard error can be found using Equation : \\[SE = \\sqrt{\\frac{0.958(1-0.958)}{1000} + \\frac{0.899(1-0.899)}{1000}} = 0.0114\\] In this hypothesis test, the sample proportions were used. We will discuss this choice more in Section [pooledHTForProportionsSection]. Next, we compute the test statistic and use it to find the p-value, which is depicted in Figure [gearsTwoSampleHTPValueQC]. \\[Z = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{0.059 - 0.03}{0.0114} = 2.54\\] Using the normal model for this test statistic, we identify the right tail area as 0.006. Since this is a one-sided test, this single tail area is also the p-value, and we reject the null hypothesis because 0.006 is less than 0.05. That is, we have statistically significant evidence that the higher quality gears actually do pass inspection more than 3% as often as the currently used gears. Based on these results, management will approve the switch to the new supplier. Distribution of the test statistic if the null hypothesis was true. The p-value is represented by the shaded area. [gearsTwoSampleHTPValueQC] 10.2.3 Hypothesis testing when \\(H_0: p_1=p_2\\) Here we use a new example to examine a special estimate of standard error when \\(H_0: p_1 = p_2\\). We investigate whether there is an increased risk of cancer in dogs that are exposed to the herbicide 2,4-dichlorophenoxyacetic acid (2,4-D). A study in 1994 examined 491 dogs that had developed cancer and 945 dogs as a control group.68 Of these two groups, researchers identified which dogs had been exposed to 2,4-D in their owner’s yard. The results are shown in Table [24DAndCancerInDogs]. Summary results for cancer in dogs and the use of 2,4-D by the dog’s owner. cancer no cancer 2,4-D 191 304 no 2,4-D 300 641 [24DAndCancerInDogs] Is this study an experiment or an observational study?69 [htFor24DAndCancerInDogs] Set up hypotheses to test whether 2,4-D and the occurrence of cancer in dogs are related. Use a one-sided test and compare across the cancer and no cancer groups.70 Are the conditions met to use the normal model and make inference on the results?[condFor24DAndCancerInDogsNormalInference] (1) It is unclear whether this is a random sample. However, if we believe the dogs in both the cancer and no cancer groups are representative of each respective population and that the dogs in the study do not interact in any way, then we may find it reasonable to assume independence between observations. (2) The success-failure condition holds for each sample. Under the assumption of independence, we can use the normal model and make statements regarding the canine population based on the data. In your hypotheses for Guided Practice [htFor24DAndCancerInDogs], the null is that the proportion of dogs with exposure to 2,4-D is the same in each group. The point estimate of the difference in sample proportions is \\(\\hat{p}_c - \\hat{p}_n = 0.067\\). To identify the p-value for this test, we first check conditions (Example [condFor24DAndCancerInDogsNormalInference]) and compute the standard error of the difference: \\[SE = \\sqrt{\\frac{p_c(1-p_c)}{n_c} + \\frac{p_n(1-p_n)}{n_n}}\\] In a hypothesis test, the distribution of the test statistic is always examined as though the null hypothesis is true, i.e. in this case, \\(p_c = p_n\\). The standard error formula should reflect this equality in the null hypothesis. We will use \\(p\\) to represent the common rate of dogs that are exposed to 2,4-D in the two groups: \\[SE = \\sqrt{\\frac{p(1-p)}{n_c} + \\frac{p(1-p)}{n_n}}\\] We don’t know the exposure rate, \\(p\\), but we can obtain a good estimate of it by pooling the results of both samples: \\[\\hat{p} = \\frac{\\text{\\# of ``successes&#39;&#39;}}{\\text{\\# of cases}} = \\frac{191 + 304}{191+300+304+641} = 0.345\\] This is called the pooled estimate of the sample proportion, and we use it to compute the standard error when the null hypothesis is that \\(p_1 = p_2\\) (e.g. \\(p_c = p_n\\) or \\(p_c - p_n = 0\\)). We also typically use it to verify the success-failure condition. When the null hypothesis is \\(p_1 = p_2\\), it is useful to find the pooled estimate of the shared proportion: \\[\\begin{aligned} \\hat{p} = \\frac{\\text{number of ``successes&#39;&#39;}}{\\text{number of cases}} = \\frac{\\hat{p}_1n_1 + \\hat{p}_2n_2}{n_1 + n_2}\\end{aligned}\\] Here \\(\\hat{p}_1n_1\\) represents the number of successes in sample 1 since \\[\\begin{aligned} \\hat{p}_1 = \\frac{\\text{number of successes in sample 1}}{n_1}\\end{aligned}\\] Similarly, \\(\\hat{p}_2n_2\\) represents the number of successes in sample 2. When the null hypothesis suggests the proportions are equal, we use the pooled proportion estimate (\\(\\hat{p}\\)) to verify the success-failure condition and also to estimate the standard error: \\[\\begin{aligned} SE = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n_1} + \\frac{\\hat{p}(1-\\hat{p})}{n_2}} \\label{seOfDiffInPropUsingPooledEstimate}\\end{aligned}\\] [verifySEOfPooledEstimateOf24DWithCancerNoCancerDogs] Using Equation , \\(\\hat{p}=0.345\\), \\(n_1 = 491\\), and \\(n_2=945\\), verify the estimate for the standard error is \\(SE = 0.026\\). Next, complete the hypothesis test using a significance level of 0.05. Be certain to draw a picture, compute the p-value, and state your conclusion in both statistical language and plain language.71 10.3 Testing for goodness of fit using chi-square (special topic) In this section, we develop a method for assessing a null model when the data are binned. This technique is commonly used in two circumstances: Given a sample of cases that can be classified into several groups, determine if the sample is representative of the general population. Evaluate whether data resemble a particular distribution, such as a normal distribution or a geometric distribution. (Background on the geometric distribution is not necessary.) Each of these scenarios can be addressed using the same statistical test: a chi-square test. In the first case, we consider data from a random sample of 275 jurors in a small county. Jurors identified their racial group, as shown in Table [juryRepresentationAndCityRepresentationForRace], and we would like to determine if these jurors are racially representative of the population. If the jury is representative of the population, then the proportions in the sample should roughly reflect the population of eligible jurors, i.e. registered voters. ll ccc c ll Race &amp; &amp; White &amp; Black &amp; Hispanic &amp; Other &amp; &amp; Total Representation in juries &amp; &amp; 205 &amp; 26 &amp; 25 &amp; 19 &amp; &amp; 275 Registered voters &amp; &amp; 0.72 &amp; 0.07 &amp; 0.12 &amp; 0.09 &amp; &amp; 1.00 [juryRepresentationAndCityRepresentationForRace] While the proportions in the juries do not precisely represent the population proportions, it is unclear whether these data provide convincing evidence that the sample is not representative. If the jurors really were randomly sampled from the registered voters, we might expect small differences due to chance. However, unusually large differences may provide convincing evidence that the juries were not representative. A second application, assessing the fit of a distribution, is presented at the end of this section. Daily stock returns from the S&amp;P500 for the years 1990-2011 are used to assess whether stock activity each day is independent of the stock’s behavior on previous days. In these problems, we would like to examine all bins simultaneously, not simply compare one or two bins at a time, which will require us to develop a new test statistic. 10.3.1 Creating a test statistic for one-way tables Of the people in the city, 275 served on a jury. If the individuals are randomly selected to serve on a jury, about how many of the 275 people would we expect to be white? How many would we expect to be black? About 72% of the population is white, so we would expect about 72% of the jurors to be white: \\(0.72\\times 275 = 198\\). Similarly, we would expect about 7% of the jurors to be black, which would correspond to about \\(0.07\\times 275 = 19.25\\) black jurors. Twelve percent of the population is Hispanic and 9% represent other races. How many of the 275 jurors would we expect to be Hispanic or from another race? Answers can be found in Table [expectedJuryRepresentationIfNoBias]. ll ccc c ll Race &amp; &amp; White &amp; Black &amp; Hispanic &amp; Other &amp; &amp; Total Observed data &amp; &amp; 205 &amp; 26 &amp; 25 &amp; 19 &amp; &amp; 275 Expected counts &amp; &amp; 198 &amp; 19.25 &amp; 33 &amp; 24.75 &amp; &amp; 275 [expectedJuryRepresentationIfNoBias] The sample proportion represented from each race among the 275 jurors was not a precise match for any ethnic group. While some sampling variation is expected, we would expect the sample proportions to be fairly similar to the population proportions if there is no bias on juries. We need to test whether the differences are strong enough to provide convincing evidence that the jurors are not a random sample. These ideas can be organized into hypotheses: The jurors are a random sample, i.e. there is no racial bias in who serves on a jury, and the observed counts reflect natural sampling fluctuation. The jurors are not randomly sampled, i.e. there is racial bias in juror selection. To evaluate these hypotheses, we quantify how different the observed counts are from the expected counts. Strong evidence for the alternative hypothesis would come in the form of unusually large deviations in the groups from what would be expected based on sampling variation alone. 10.3.2 The chi-square test statistic In previous hypothesis tests, we constructed a test statistic of the following form: \\[\\frac{\\text{point estimate} - \\text{null value}}{\\text{SE of point estimate}}\\] This construction was based on (1) identifying the difference between a point estimate and an expected value if the null hypothesis was true, and (2) standardizing that difference using the standard error of the point estimate. These two ideas will help in the construction of an appropriate test statistic for count data. Our strategy will be to first compute the difference between the observed counts and the counts we would expect if the null hypothesis was true, then we will standardize the difference: \\[\\begin{aligned} Z_{1} = \\frac{\\text{observed white count} - \\text{null white count}} {\\text{SE of observed white count}}\\end{aligned}\\] The standard error for the point estimate of the count in binned data is the square root of the count under the null.72 Therefore: \\[\\begin{aligned} Z_1 = \\frac{205 - 198}{\\sqrt{198}} = 0.50\\end{aligned}\\] The fraction is very similar to previous test statistics: first compute a difference, then standardize it. These computations should also be completed for the black, Hispanic, and other groups: \\[\\begin{aligned} &amp;Black &amp;&amp; Hispanic &amp;&amp;Other \\\\ &amp; Z_2 = \\frac{26-19.25}{\\sqrt{19.25}}=1.54\\ \\ \\ \\ &amp;&amp; Z_3 = \\frac{25-33}{\\sqrt{33}}=-1.39\\ \\ \\ \\ &amp;&amp; Z_4 = \\frac{19-24.75}{\\sqrt{24.75}}=-1.16 \\\\\\end{aligned}\\] We would like to use a single test statistic to determine if these four standardized differences are irregularly far from zero. That is, \\(Z_1\\), \\(Z_2\\), \\(Z_3\\), and \\(Z_4\\) must be combined somehow to help determine if they – as a group – tend to be unusually far from zero. A first thought might be to take the absolute value of these four standardized differences and add them up: \\[\\begin{aligned} |Z_1| + |Z_2| + |Z_3| + |Z_4| = 4.58\\end{aligned}\\] Indeed, this does give one number summarizing how far the actual counts are from what was expected. However, it is more common to add the squared values: \\[\\begin{aligned} Z_1^2 + Z_2^2 + Z_3^2 + Z_4^2 = 5.89\\end{aligned}\\] Squaring each standardized difference before adding them together does two things: Any standardized difference that is squared will now be positive. Differences that already look unusual – e.g. a standardized difference of 2.5 – will become much larger after being squared. The test statistic \\(X^2\\)[ \\(X^2\\) chi-square test statistic] \\(X^2\\) chi-square test statistic , which is the sum of the \\(Z^2\\) values, is generally used for these reasons. We can also write an equation for \\(X^2\\) using the observed counts and null counts: The final number \\(X^2\\) summarizes how strongly the observed counts tend to deviate from the null counts. In Section [pValueForAChiSquareTest], we will see that if the null hypothesis is true, then \\(X^2\\) follows a new distribution called a chi-square distribution. Using this distribution, we will be able to obtain a p-value to evaluate the hypotheses. 10.3.3 The chi-square distribution and finding areas The chi-square distribution is sometimes used to characterize data sets and statistics that are always positive and typically right skewed. Recall the normal distribution had two parameters – mean and standard deviation – that could be used to describe its exact characteristics. The chi-square distribution has just one parameter called , which influences the shape, center, and spread of the distribution. [exerChiSquareDistributionDescriptionWithMoreDOF] Figure [chiSquareDistributionWithInceasingDF] shows three chi-square distributions. (a) How does the center of the distribution change when the degrees of freedom is larger? (b) What about the variability (spread)? (c) How does the shape change?73 Three chi-square distributions with varying degrees of freedom. [chiSquareDistributionWithInceasingDF] Figure [chiSquareDistributionWithInceasingDF] and Guided Practice [exerChiSquareDistributionDescriptionWithMoreDOF] demonstrate three general properties of chi-square distributions as the degrees of freedom increases: the distribution becomes more symmetric, the center moves to the right, and the variability inflates. Our principal interest in the chi-square distribution is the calculation of p-values, which (as we have seen before) is related to finding the relevant area in the tail of a distribution. To do so, a new table is needed: the chi-square table, partially shown in Table [chiSquareProbabilityTableShort]. A more complete table is presented in Appendix . Using this table, we identify a range for the area, and we examine a particular row for distributions with different degrees of freedom. One important quality of this table: the chi-square table only provides upper tail values. A section of the chi-square table. A complete table is listed in Appendix . Upper tail 0.3 0.2 0.1 0.05 0.02 0.01 0.005 0.001 df 2 2.41 5.99 7.82 9.21 10.60 13.82 3 &amp; 3.66 &amp; 4.64 &amp; &amp; 7.81 &amp; 9.84 &amp; 11.34 &amp; 12.84 &amp; 16.27 4 &amp; 4.88 &amp; 5.99 &amp; 7.78 &amp; 9.49 &amp; 11.67 &amp; 13.28 &amp; 14.86 &amp; 18.47 5 &amp; 6.06 &amp; 7.29 &amp; 9.24 &amp; 11.07 &amp; 13.39 &amp; 15.09 &amp; 16.75 &amp; 20.52 6 &amp; 7.23 &amp; 8.56 &amp; 10.64 &amp; 12.59 &amp; 15.03 &amp; 16.81 &amp; 18.55 &amp; 22.46 7 &amp; 8.38 &amp; 9.80 &amp; 12.02 &amp; 14.07 &amp; 16.62 &amp; 18.48 &amp; 20.28 &amp; 24.32 ******** [chiSquareProbabilityTableShort] Figure [chiSquareAreaAbove6Point25WithDF3] shows a chi-square distribution with 3 degrees of freedom and an upper shaded tail starting at 6.25. Use Table [chiSquareProbabilityTableShort] to estimate the shaded area.[chisquaredistexample01] This distribution has three degrees of freedom, so only the row with 3 degrees of freedom (df) is relevant. This row has been italicized in the table. Next, we see that the value – 6.25 – falls in the column with upper tail area 0.1. That is, the shaded upper tail of Figure [chiSquareAreaAbove6Point25WithDF3] has area 0.1. [arrayOfFigureAreasForChiSquareDistribution] We rarely observe the exact value in the table. For instance, Figure [chiSquareAreaAbove4Point3WithDF2] shows the upper tail of a chi-square distribution with 2 degrees of freedom. The bound for this upper tail is at 4.3, which does not fall in Table [chiSquareProbabilityTableShort]. Find the approximate tail area.[chisquaredistexample02] The cutoff 4.3 falls between the second and third columns in the 2 degrees of freedom row. Because these columns correspond to tail areas of 0.2 and 0.1, we can be certain that the area shaded in Figure [chiSquareAreaAbove4Point3WithDF2] is between 0.1 and 0.2. Figure [chiSquareAreaAbove5Point1WithDF5] shows an upper tail for a chi-square distribution with 5 degrees of freedom and a cutoff of 5.1. Find the tail area.[chisquaredistexample03] Looking in the row with 5 df, 5.1 falls below the smallest cutoff for this row (6.06). That means we can only say that the area is greater than 0.3. [ChiSquareDistGuidedPractice01] Figure [chiSquareAreaAbove11Point7WithDF7] shows a cutoff of 11.7 on a chi-square distribution with 7 degrees of freedom. Find the area of the upper tail.74 [ChiSquareDistGuidedPractice02] Figure [chiSquareAreaAbove10WithDF4] shows a cutoff of 10 on a chi-square distribution with 4 degrees of freedom. Find the area of the upper tail.75 [ChiSquareDistGuidedPractice03] Figure [chiSquareAreaAbove9Point21WithDF3] shows a cutoff of 9.21 with a chi-square distribution with 3 df. Find the area of the upper tail.76 10.3.4 Finding a p-value for a chi-square distribution In Section [chiSquareTestStatistic], we identified a new test statistic (\\(X^2\\)) within the context of assessing whether there was evidence of racial bias in how jurors were sampled. The null hypothesis represented the claim that jurors were randomly sampled and there was no racial bias. The alternative hypothesis was that there was racial bias in how the jurors were sampled. We determined that a large \\(X^2\\) value would suggest strong evidence favoring the alternative hypothesis: that there was racial bias. However, we could not quantify what the chance was of observing such a large test statistic (\\(X^2=5.89\\)) if the null hypothesis actually was true. This is where the chi-square distribution becomes useful. If the null hypothesis was true and there was no racial bias, then \\(X^2\\) would follow a chi-square distribution, with three degrees of freedom in this case. Under certain conditions, the statistic \\(X^2\\) follows a chi-square distribution with \\(k-1\\) degrees of freedom, where \\(k\\) is the number of bins. How many categories were there in the juror example? How many degrees of freedom should be associated with the chi-square distribution used for \\(X^2\\)? In the jurors example, there were \\(k=4\\) categories: white, black, Hispanic, and other. According to the rule above, the test statistic \\(X^2\\) should then follow a chi-square distribution with \\(k-1 = 3\\) degrees of freedom if \\(H_0\\) is true. Just like we checked sample size conditions to use the normal model in earlier sections, we must also check a sample size condition to safely apply the chi-square distribution for \\(X^2\\). Each expected count must be at least 5. In the juror example, the expected counts were 198, 19.25, 33, and 24.75, all easily above 5, so we can apply the chi-square model to the test statistic, \\(X^2=5.89\\). If the null hypothesis is true, the test statistic \\(X^2=5.89\\) would be closely associated with a chi-square distribution with three degrees of freedom. Using this distribution and test statistic, identify the p-value. The chi-square distribution and p-value are shown in Figure [jurorHTPValueShown]. Because larger chi-square values correspond to stronger evidence against the null hypothesis, we shade the upper tail to represent the p-value. Using the chi-square table in Appendix [chiSquareProbabilityTable] or the short table on page , we can determine that the area is between 0.1 and 0.2. That is, the p-value is larger than 0.1 but smaller than 0.2. Generally we do not reject the null hypothesis with such a large p-value. In other words, the data do not provide convincing evidence of racial bias in the juror selection. The p-value for the juror hypothesis test is shaded in the chi-square distribution with \\(df=3\\). [jurorHTPValueShown] Suppose we are to evaluate whether there is convincing evidence that a set of observed counts \\(O_1\\), \\(O_2\\), …, \\(O_k\\) in \\(k\\) categories are unusually different from what might be expected under a null hypothesis. Call the expected counts that are based on the null hypothesis \\(E_1\\), \\(E_2\\), …, \\(E_k\\). If each expected count is at least 5 and the null hypothesis is true, then the test statistic below follows a chi-square distribution with \\(k-1\\) degrees of freedom: \\[\\begin{aligned} X^2 = \\frac{(O_1 - E_1)^2}{E_1} + \\frac{(O_2 - E_2)^2}{E_2} + \\cdots + \\frac{(O_k - E_k)^2}{E_k}\\end{aligned}\\] The p-value for this test statistic is found by looking at the upper tail of this chi-square distribution. We consider the upper tail because larger values of \\(X^2\\) would provide greater evidence against the null hypothesis. There are three conditions that must be checked before performing a chi-square test: Independence. Each case that contributes a count to the table must be independent of all the other cases in the table. Sample size / distribution. Each particular scenario (i.e. cell count) must have at least 5 expected cases. Degrees of freedom We only apply the chi-square technique when the table is associated with a chi-square distribution with 2 or more degrees of freedom. Failing to check conditions may affect the test’s error rates. When examining a table with just two bins, pick a single bin and use the one-proportion methods introduced in Section [singleProportion]. 10.3.5 Evaluating goodness of fit for a distribution We can apply our new chi-square testing framework to the second problem in this section: evaluating whether a certain statistical model fits a data set. Daily stock returns from the S&amp;P500 for 1990-2011 can be used to assess whether stock activity each day is independent of the stock’s behavior on previous days. This sounds like a very complex question, and it is, but a chi-square test can be used to study the problem. We will label each day as or () depending on whether the market was up or down that day. For example, consider the following changes in price, their new labels of up and down, and then the number of days that must be observed before each day: lc ccc ccc ccc cc Change in price &amp; &amp; 2.52 &amp; -1.46 &amp; 0.51 &amp; -4.07 &amp; 3.36 &amp; 1.10 &amp; -5.46 &amp; -1.03 &amp; -2.99 &amp; 1.71 Outcome &amp; &amp; Up &amp; D &amp; Up &amp; D &amp; Up &amp; Up &amp; D &amp; D &amp; D &amp; Up Days to Up &amp; &amp; 1 &amp; - &amp; 2 &amp; - &amp; 2 &amp; 1 &amp; - &amp; - &amp; - &amp; 4 If the days really are independent, then the number of days until a positive trading day should follow a geometric distribution. The geometric distribution describes the probability of waiting for the \\(k^{th}\\) trial to observe the first success. Here each up day (Up) represents a success, and down (D) days represent failures. In the data above, it took only one day until the market was up, so the first wait time was 1 day. It took two more days before we observed our next trading day, and two more for the third day. We would like to determine if these counts (1, 2, 2, 1, 4, and so on) follow the geometric distribution. Table [sAndP500For1990To2011TimeToPosTrade] shows the number of waiting days for a positive trading day during 1990-2011 for the S&amp;P500. ll ccc ccc c ll Days &amp; &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7+ &amp; &amp; Total Observed &amp; &amp; 1532 &amp; 760 &amp; 338 &amp; 194 &amp; 74 &amp; 33 &amp; 17 &amp; &amp; 2948 [sAndP500For1990To2011TimeToPosTrade] We consider how many days one must wait until observing an day on the S&amp;P500 stock exchange. If the stock activity was independent from one day to the next and the probability of a positive trading day was constant, then we would expect this waiting time to follow a geometric distribution. We can organize this into a hypothesis framework: The stock market being up or down on a given day is independent from all other days. We will consider the number of days that pass until an day is observed. Under this hypothesis, the number of days until an day should follow a geometric distribution. The stock market being up or down on a given day is not independent from all other days. Since we know the number of days until an day would follow a geometric distribution under the null, we look for deviations from the geometric distribution, which would support the alternative hypothesis. There are important implications in our result for stock traders: if information from past trading days is useful in telling what will happen today, that information may provide an advantage over other traders. We consider data for the S&amp;P500 from 1990 to 2011 and summarize the waiting times in Table [sAndP500For1990To2011TimeToPosTrade2] and Figure [geomFitEvaluationForSP500For1990To2011]. The S&amp;P500 was positive on 53.2% of those days. ll ccc ccc c ll Days &amp; &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7+ &amp; &amp; Total Observed &amp; &amp; 1532 &amp; 760 &amp; 338 &amp; 194 &amp; 74 &amp; 33 &amp; 17 &amp; &amp; 2948 Geometric Model &amp; &amp; 1569 &amp; 734 &amp; 343 &amp; 161 &amp; 75 &amp; 35 &amp; 31 &amp; &amp; 2948 [sAndP500For1990To2011TimeToPosTrade2] Side-by-side bar plot of the observed and expected counts for each waiting time. [geomFitEvaluationForSP500For1990To2011] Because applying the chi-square framework requires expected counts to be at least 5, we have binned together all the cases where the waiting time was at least 7 days to ensure each expected count is well above this minimum. The actual data, shown in the Observed row in Table [sAndP500For1990To2011TimeToPosTrade2], can be compared to the expected counts from the Geometric Model row. The method for computing expected counts is discussed in Table [sAndP500For1990To2011TimeToPosTrade2]. In general, the expected counts are determined by (1) identifying the null proportion associated with each bin, then (2) multiplying each null proportion by the total count to obtain the expected counts. That is, this strategy identifies what proportion of the total count we would expect to be in each bin. Do you notice any unusually large deviations in the graph? Can you tell if these deviations are due to chance just by looking? It is not obvious whether differences in the observed counts and the expected counts from the geometric distribution are significantly different. That is, it is not clear whether these deviations might be due to chance or whether they are so strong that the data provide convincing evidence against the null hypothesis. However, we can perform a chi-square test using the counts in Table [sAndP500For1990To2011TimeToPosTrade2]. Table [sAndP500For1990To2011TimeToPosTrade2] provides a set of count data for waiting times (\\(O_1=1532\\), \\(O_2=760\\), …) and expected counts under the geometric distribution (\\(E_1=1569\\), \\(E_2=734\\), …). Compute the chi-square test statistic, \\(X^2\\).77 Because the expected counts are all at least 5, we can safely apply the chi-square distribution to \\(X^2\\). However, how many degrees of freedom should we use?78 If the observed counts follow the geometric model, then the chi-square test statistic \\(X^2=15.08\\) would closely follow a chi-square distribution with \\(df=6\\). Using this information, compute a p-value. [RejectGeomModelForSP500StockDataFor1990To2011] Figure [geomFitPValueForSP500For1990To2011] shows the chi-square distribution, cutoff, and the shaded p-value. If we look up the statistic \\(X^2=15.08\\) in Appendix [chiSquareProbabilityTable], we find that the p-value is between 0.01 and 0.02. In other words, we have sufficient evidence to reject the notion that the wait times follow a geometric distribution, i.e. trading days are not independent and past days may help predict what the stock market will do today. Chi-square distribution with 6 degrees of freedom. The p-value for the stock analysis is shaded. [geomFitPValueForSP500For1990To2011] In Example [RejectGeomModelForSP500StockDataFor1990To2011], we rejected the null hypothesis that the trading days are independent. Why is this so important? Because the data provided strong evidence that the geometric distribution is not appropriate, we reject the claim that trading days are independent. While it is not obvious how to exploit this information, it suggests there are some hidden patterns in the data that could be interesting and possibly useful to a stock trader. 10.4 Testing for independence in two-way tables (special topic) Google is constantly running experiments to test new search algorithms. For example, Google might test three algorithms using a sample of 10,000 google.com search queries. Table [googleSearchAlgorithmByAlgorithmOnly] shows an example of 10,000 queries split into three algorithm groups.79 The group sizes were specified before the start of the experiment to be 5000 for the current algorithm and 2500 for each test algorithm. ll ccc ll Search algorithm &amp; &amp; current &amp; test 1 &amp; test 2 &amp; &amp; Total Counts &amp; &amp; 5000 &amp; 2500 &amp; 2500 &amp; &amp; 10000 [googleSearchAlgorithmByAlgorithmOnly] What is the ultimate goal of the Google experiment? What are the null and alternative hypotheses, in regular words? The ultimate goal is to see whether there is a difference in the performance of the algorithms. The hypotheses can be described as the following: The algorithms each perform equally well. The algorithms do not perform equally well. In this experiment, the explanatory variable is the search algorithm. However, an outcome variable is also needed. This outcome variable should somehow reflect whether the search results align with the user’s interests. One possible way to quantify this is to determine whether (1) the user clicked one of the links provided and did not try a new search, or (2) the user performed a related search. Under scenario (1), we might think that the user was satisfied with the search results. Under scenario (2), the search results probably were not relevant, so the user tried a second search. Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals] provides the results from the experiment. These data are very similar to the count data in Section [oneWayChiSquare]. However, now the different combinations of two variables are binned in a two-way table. In examining these data, we want to evaluate whether there is strong evidence that at least one algorithm is performing better than the others. To do so, we apply a chi-square test to this two-way table. The ideas of this test are similar to those ideas in the one-way table case. However, degrees of freedom and expected counts are computed a little differently than before. ll ccc ll Search algorithm &amp; &amp; current &amp; test 1 &amp; test 2 &amp; &amp; Total No new search &amp; &amp; 3511 &amp; 1749 &amp; 1818 &amp; &amp; 7078 New search &amp; &amp; 1489 &amp; 751 &amp; 682 &amp; &amp; 2922 Total &amp; &amp; 5000 &amp; 2500 &amp; 2500 &amp; &amp; 10000 [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals] A one-way table describes counts for each outcome in a single variable. A two-way table describes counts for combinations of outcomes for two variables. When we consider a two-way table, we often would like to know, are these variables related in any way? That is, are they dependent (versus independent)? The hypothesis test for this Google experiment is really about assessing whether there is statistically significant evidence that the choice of the algorithm affects whether a user performs a second search. In other words, the goal is to check whether the search variable is independent of the algorithm variable. 10.4.1 Expected counts in two-way tables From the experiment, we estimate the proportion of users who were satisfied with their initial search (no new search) as \\(7078/10000 = 0.7078\\). If there really is no difference among the algorithms and 70.78% of people are satisfied with the search results, how many of the 5000 people in the “current algorithm” group would be expected to not perform a new search? [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch] About 70.78% of the 5000 would be satisfied with the initial search: \\[0.7078\\times 5000 = 3539\\text{ users}\\] That is, if there was no difference between the three groups, then we would expect 3539 of the current algorithm users not to perform a new search. [googleExampleComputingTheExpectedNumberOfNewAlgGroupWithNoNewSearch] Using the same rationale described in Example [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch], about how many users in each test group would not perform a new search if the algorithms were equally helpful?80 We can compute the expected number of users who would perform a new search for each group using the same strategy employed in Example [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch] and Guided Practice [googleExampleComputingTheExpectedNumberOfNewAlgGroupWithNoNewSearch]. These expected counts were used to construct Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithExpectedCounts], which is the same as Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals], except now the expected counts have been added in parentheses. l lll lll lll l Search algorithm &amp; &amp;&amp; &amp;&amp; &amp; &amp; Total No new search &amp; 3511 &amp; &amp;&amp; 1749 &amp; &amp;&amp; 1818 &amp; &amp; &amp; 7078 New search &amp; 1489 &amp; &amp;&amp; 751 &amp; &amp;&amp; 682 &amp; &amp; &amp; 2922 Total &amp; 5000 &amp;&amp;&amp; 2500 &amp;&amp;&amp; 2500 &amp;&amp;&amp; 10000 [googleSearchAlgorithmByAlgorithmAndPerformanceWithExpectedCounts] The examples and guided practice above provided some help in computing expected counts. In general, expected counts for a two-way table may be computed using the row totals, column totals, and the table total. For instance, if there was no difference between the groups, then about 70.78% of each column should be in the first row: \\[\\begin{aligned} 0.7078\\times (\\text{column 1 total}) &amp;= 3539 \\\\ 0.7078\\times (\\text{column 2 total}) &amp;= 1769.5 \\\\ 0.7078\\times (\\text{column 3 total}) &amp;= 1769.5\\end{aligned}\\] Looking back to how the fraction 0.7078 was computed – as the fraction of users who did not perform a new search (\\(7078/10000\\)) – these three expected counts could have been computed as \\[\\begin{aligned} \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 1 total)} &amp;= 3539 \\\\ \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 2 total)} &amp;= 1769.5 \\\\ \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 3 total)} &amp;= 1769.5\\end{aligned}\\] This leads us to a general formula for computing expected counts in a two-way table when we would like to test whether there is strong evidence of an association between the column variable and row variable. To identify the expected count for the \\(i^{th}\\) row and \\(j^{th}\\) column, compute $$i,j = $$ 10.4.2 The chi-square test for two-way tables The chi-square test statistic for a two-way table is found the same way it is found for a one-way table. For each table count, compute \\[\\begin{aligned} &amp;\\text{General formula}&amp; &amp;\\frac{(\\text{observed count } - \\text{ expected count})^2}{\\text{expected count}} \\\\ &amp;\\text{Row 1, Col 1}&amp; &amp;\\frac{(3511 - 3539)^2}{3539} = 0.222 \\\\ &amp;\\text{Row 1, Col 2}&amp; &amp;\\frac{(1749 - 1769.5)^2}{1769.5} = 0.237 \\\\ &amp; \\hspace{9mm}\\vdots &amp; &amp;\\hspace{13mm}\\vdots \\\\ &amp;\\text{Row 2, Col 3}&amp; &amp;\\frac{(682 - 730.5)^2}{730.5} = 3.220\\end{aligned}\\] Adding the computed value for each cell gives the chi-square test statistic \\(X^2\\): \\[X^2 = 0.222 + 0.237 + \\dots + 3.220 = 6.120\\] Just like before, this test statistic follows a chi-square distribution. However, the degrees of freedom are computed a little differently for a two-way table.81 For two way tables, the degrees of freedom is equal to \\[\\begin{aligned} df = \\text{(number of rows minus 1)}\\times \\text{(number of columns minus 1)}\\end{aligned}\\] In our example, the degrees of freedom parameter is \\[\\begin{aligned} df = (2-1)\\times (3-1) = 2\\end{aligned}\\] If the null hypothesis is true (i.e. the algorithms are equally useful), then the test statistic \\(X^2 = 6.12\\) closely follows a chi-square distribution with 2 degrees of freedom. Using this information, we can compute the p-value for the test, which is depicted in Figure [googleHTForDiffAlgPerformancePValue]. When applying the chi-square test to a two-way table, we use \\[df = (R-1)\\times (C-1)\\] where \\(R\\) is the number of rows in the table and \\(C\\) is the number of columns. When analyzing 2-by-2 contingency tables, use the two-proportion methods introduced in Section [differenceOfTwoProportions]. Computing the p-value for the Google hypothesis test. [googleHTForDiffAlgPerformancePValue] Compute the p-value and draw a conclusion about whether the search algorithms have different performances. Looking in Appendix [chiSquareProbabilityTable] on page , we examine the row corresponding to 2 degrees of freedom. The test statistic, \\(X^2=6.120\\), falls between the fourth and fifth columns, which means the p-value is between 0.02 and 0.05. Because we typically test at a significance level of \\(\\alpha=0.05\\) and the p-value is less than 0.05, the null hypothesis is rejected. That is, the data provide convincing evidence that there is some difference in performance among the algorithms. Table [pewResearchPollOnApprovalRatingsForChiSquareSectionExampleAndExercises] summarizes the results of a Pew Research poll.82 We would like to determine if there are actually differences in the approval ratings of Barack Obama, Democrats in Congress, and Republicans in Congress. What are appropriate hypotheses for such a test?[hypothesisTestSetupForPewResearchPollOnApprovalRatingsForChiSquareSection] There is no difference in approval ratings between the three groups. There is some difference in approval ratings between the three groups, e.g. perhaps Obama’s approval differs from Democrats in Congress. ll ccc ll &amp; &amp; &amp; &amp; &amp; &amp; Obama &amp; Democrats &amp; Republicans &amp; &amp; Total Approve &amp; &amp; 842 &amp; 736 &amp; 541 &amp; &amp; 2119 Disapprove &amp; &amp; 616 &amp; 646 &amp; 842 &amp; &amp; 2104 Total &amp; &amp; 1458 &amp; 1382 &amp; 1383 &amp; &amp; 4223 [pewResearchPollOnApprovalRatingsForChiSquareSectionExampleAndExercises] A chi-square test for a two-way table may be used to test the hypotheses in Example [hypothesisTestSetupForPewResearchPollOnApprovalRatingsForChiSquareSection]. As a first step, compute the expected values for each of the six table cells.83 Compute the chi-square test statistic.84 Because there are 2 rows and 3 columns, the degrees of freedom for the test is \\(df=(2-1)\\times (3-1) = 2\\). Use \\(X^2=106.4\\), \\(df=2\\), and the chi-square table on page to evaluate whether to reject the null hypothesis.85 "]
]
