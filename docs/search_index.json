[
["index.html", "Answering questions with data? Preface 0.1 Important notes", " Answering questions with data? Matthew J. C. Crump Anjali Krishnan Stephen Volz Alla Chavarga Jeffrey Suzuki 2018-04-11 Preface Draft in progress 0.1 Important notes This is a working revision of the OER statistics textbook titled: Introductory Statistics with Randomization and Simulation, by Diaz, Barr, &amp; Cetinkaya-Rundel. The original source latex files were obtained from : https://www.openintro.org/stat/textbook.php?stat_book=isrs The original textbook is licensed under a Creative Commons license. The original latex were converted to Markdown using pandoc. Some minimal typesetting was completed on the first chapter. The plan is to use this textbook as a starting point for developing another OER textbook for tailored for undergraduate psychology students. The Github changelog from this point forward reflects all of our changes to the original textbook. The github repository for this project is https://github.com/CrumpLab/statistics Contributing to the textbook Use Hypothes.is, an amazing tool for annotating the web. Go to Hypothes.is, and “get-started” Install the the add-on for chrome, or other browser That’s it, turn on Hypothes.is when you are reading this textbook, and you will see all public annotations made by anyone else. The source code for this textbook is available in my github repo statsforpsych Edit the .Rmd files, and push them back The edit link in the top bar of the textbook should automatically take you to the source .Rmd file "],
["introductionToData.html", "Chapter 1 Psychological Science and Data 1.1 Case study: using stents to prevent strokes 1.2 Data basics 1.3 Overview of data collection principles 1.4 Observational studies and sampling strategies 1.5 Experiments", " Chapter 1 Psychological Science and Data Scientists seek to answer questions using rigorous methods and careful observations. These observations – collected from the likes of field notes, surveys, and experiments – form the backbone of a statistical investigation and are called . Statistics is the study of how best to collect, analyze, and draw conclusions from data. It is helpful to put statistics in the context of a general process of investigation: Identify a question or problem. Collect relevant data on the topic. Analyze the data. Form a conclusion. Statistics as a subject focuses on making stages 2-4 objective, rigorous, and efficient. That is, statistics has three primary components: How best can we collect data? How should it be analyzed? And what can we infer from the analysis? The topics scientists investigate are as diverse as the questions they ask. However, many of these investigations can be addressed with a small number of data collection techniques, analytic tools, and fundamental concepts in statistical inference. This chapter provides a glimpse into these and other themes we will encounter throughout the rest of the book. We introduce the basic principles of each branch and learn some tools along the way. We will encounter applications from other fields, some of which are not typically associated with science but nonetheless can benefit from statistical study. 1.1 Case study: using stents to prevent strokes Section 1.1 introduces a classic challenge in statistics: evaluating the efficacy of a medical treatment. Terms in this section, and indeed much of this chapter, will all be revisited later in the text. The plan for now is simply to get a sense of the role statistics can play in practice. In this section we will consider an experiment that studies effectiveness of stents in treating patients at risk of stroke.1 1.Chimowitz MI, Lynn MJ, Derdeyn CP, et al. 2011. Stenting versus Aggressive Medical Therapy for Intracranial Arterial Stenosis. New England Journal of Medicine 365:993-1003. http://www.nejm.org/doi/ full/10.1056/NEJMoa1105335. NY Times article reporting on the study: http://www.nytimes.com/2011/09/08/health/research/08stent.html. Stents are small mesh tubes that are placed inside narrow or weak arteries to assist in patient recovery after cardiac events and reduce the risk of an additional heart attack or death. Many doctors have hoped that there would be similar benefits for patients at risk of stroke. We start by writing the principal question the researchers hope to answer: Does the use of stents reduce the risk of stroke? The researchers who asked this question collected data on 451 at-risk patients. Each volunteer patient was randomly assigned to one of two groups: Treatment group. Patients in the treatment group received a stent and medical management. The medical management included medications, management of risk factors, and help in lifestyle modification. Control Group. Patients in the control group received the same medical management as the treatment group but did not receive stents. Researchers randomly assigned 224 patients to the treatment group and 227 to the control group. In this study, the control group provides a reference point against which we can measure the medical impact of stents in the treatment group. Researchers studied the effect of stents at two time points: 30 days after enrollment and 365 days after enrollment. The results of 5 patients are summarized in Table 1.1. Patient outcomes are recorded as “stroke” or “no event”. Table 1.1: Results for five patients from the stent study. Patient group 0-30 days 0-365 days 1 treatment no event no event 2 treatment stroke stroke 3 treatment no event no event \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 450 control no event no event 451 control no event no event Considering data from each patient individually would be a long, cumbersome path towards answering the original research question. Instead, a statistical analysis allows us to consider all of the data at once. Table 1.2 summarizes the raw data in a more helpful way. In this table, we can quickly see what happened over the entire study. For instance, to identify the number of patients in the treatment group who had a stroke within 30 days, we look on the left-side of the table at the intersection of the treatment and stroke: 33. l cc c cc &amp; &amp; &amp; &amp; stroke &amp; no event &amp;&amp; stroke &amp; no event treatment &amp; 33 &amp; 191 &amp;&amp; 45 &amp; 179 control &amp; 13 &amp; 214 &amp;&amp; 28 &amp; 199 Total &amp; 46 &amp; 405 &amp;&amp; 73 &amp; 378 Table: (#tab:stentStudyResults) Descriptive statistics for the stent study. Guided Practice 1.1 Of the 224 patients in the treatment group, 45 had a stroke by the end of the first year. Using these two numbers, compute the proportion of patients in the treatment group who had a stroke by the end of their first year. (Answers to all in-text exercises are provided in footnotes.)2 We can compute summary statistics from the table. A summary statistics is a single number summarizing a large amount of data.3 For instance, the primary results of the study after 1 year could be described by two summary statistics: the proportion of people who had a stroke in the treatment and control groups. Proportion who had a stroke in the treatment (stent) group: \\(45/224 = 0.20 = 20\\%\\). Proportion who had a stroke in the control group: \\(28/227 = 0.12 = 12\\%\\). These two summary statistics are useful in looking for differences in the groups, and we are in for a surprise: an additional 8% of patients in the treatment group had a stroke! This is important for two reasons. First, it is contrary to what doctors expected, which was that stents would reduce the rate of strokes. Second, it leads to a statistical question: do the data show a “real” difference due to the treatment? This second question is subtle. Suppose you flip a coin 100 times. While the chance a coin lands heads in any given coin flip is 50%, we probably won’t observe exactly 50 heads. This type of fluctuation is part of almost any type of data generating process. It is possible that the 8% difference in the stent study is due to this natural variation. However, the larger the difference we observe (for a particular sample size), the less believable it is that the difference is due to chance. So what we are really asking is the following: is the difference so large that we should reject the notion that it was due to chance? While we haven’t yet covered statistical tools to fully address this question, we can comprehend the conclusions of the published analysis: there was compelling evidence of harm by stents in this study of stroke patients. Be careful: do not generalize the results of this study to all patients and all stents. This study looked at patients with very specific characteristics who volunteered to be a part of this study and who may not be representative of all stroke patients. In addition, there are many types of stents and this study only considered the self-expanding Wingspan stent (Boston Scientific). However, this study does leave us with an important lesson: we should keep our eyes open for surprises. 1.2 Data basics Effective presentation and description of data is a first step in most analyses. This section introduces one structure for organizing data as well as some terminology that will be used throughout this book. 1.2.1 Observations, variables, and data matrices Table 1.3 displays rows 1, 2, 3, and 50 of a data set concerning 50 emails received in 2012. These observations will be referred to as the data set, and they are a random sample from a larger data set that we will see in Section 2.2. Each row in the table represents a single email or case.4 The columns represent characteristics, called variables, for each of the emails. For example, the first row represents email 1, which is not spam, contains 21,705 characters, 551 line breaks, is written in HTML format, and contains only small numbers. In practice, it is especially important to ask clarifying questions to ensure important aspects of the data are understood. For instance, it is always important to be sure we know what each variable means and the units of measurement. Descriptions of all five email variables are given in Table 1.4. Table 1.3: Four rows from the email50 data matrix. 1 no 21,705 551 html small 2 no 7,011 183 html big 3 yes 631 28 text none \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 50 no 15,829 242 html small Table 1.4: Variables and their descriptions for the data set. variable description am Specifies whether the message was spam m_char The number of characters in the email ne_breaks The number of line breaks in the email (not including text wrapping) rmat Indicates if the email contained special formatting, such as bolding, tables, or links, which would indicate the message is in HTML format mber Indicates whether the email contained no number, a small number (under 1 million), or a large number The data in Table 1.3 represent a data matrix, which is a common way to organize data. Each row of a data matrix corresponds to a unique case, and each column corresponds to a variable. A data matrix for the stroke study introduced in Section 1.1 is shown in Table @ref(#tab:stentStudyResultsDF), where the cases were patients and there were three variables recorded for each patient. Data matrices are a convenient way to record and store data. If another individual or case is added to the data set, an additional row can be easily added. Similarly, another column can be added for a new variable. Guided Practice 1.2 We consider a publicly available data set that summarizes information about the 3,143 counties in the United States, and we call this the data set. This data set includes information about each county: its name, the state where it resides, its population in 2000 and 2010, per capita federal spending, poverty rate, and five additional characteristics. How might these data be organized in a data matrix? Reminder: look in the footnotes for answers to in-text exercises.5 Seven rows of the data set are shown in Table 1.5, and the variables are summarized in Table 1.6. These data were collected from the US Census website.6 Table 1.5: Seven rows from the data set. 1 Autauga AL 43671 54571 6.068 10.6 77.5 7.2 24568 53255 none 2 Baldwin AL 140415 182265 6.140 12.2 76.7 22.6 26469 50147 none 3 Barbour AL 29038 27457 8.752 25.0 68.0 11.1 15875 33219 none 4 Bibb AL 20826 22915 7.122 12.6 82.9 6.6 19918 41770 none 5 Blount AL 51024 57322 5.131 13.4 82.0 3.7 21070 45549 none \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 3142 Washakie WY 8289 8533 8.714 5.6 70.9 10.0 28557 48379 none 3143 Weston WY 6644 7208 6.695 7.9 77.9 6.5 28463 53853 none Table 1.6: Variables and their descriptions for the data set. variable description me County name ate State where the county resides (also including the District of Columbia) p2000 Population in 2000 p2010 Population in 2010 d_spend Federal spending per capita verty Percent of the population in poverty meownership Percent of the population that lives in their own home or lives with the owner (e.g. children living with parents who own the home) ltiunit Percent of living units that are in multi-unit structures (e.g. apartments) come Income per capita d_income Median household income for the county, where a household’s income equals the total income of its occupants who are 15 years or older okingban Type of county-wide smoking ban in place at the end of 2011, which takes one of three values: , , or , where a ban means smoking was not permitted in restaurants, bars, or workplaces, and means smoking was banned in at least one of those three locations 1.2.2 Types of variables Figure 1.1: Breakdown of variables into their respective types Examine the fed_spend, pop2010, state , and smoking ban variables in the data set. Each of these variables is inherently different from the other three yet many of them share certain characteristics. First consider fed_spend, which is said to be a numerical variable since it can take a wide range of numerical values, and it is sensible to add, subtract, or take averages with those values. On the other hand, we would not classify a variable reporting telephone area codes as numerical since their average, sum, and difference have no clear meaning. The pop2010 variable is also numerical, although it seems to be a little different than fed_spend. This variable of the population count can only be a whole non-negative number (0, 1, 2, …). For this reason, the population variable is said to be dicrete since it can only take numerical values with jumps. On the other hand, the federal spending variable is said to be continuous. The variable can take up to 51 values after accounting for Washington, DC: AL, …, and WY. Because the responses themselves are categories, state is called a categorical variable,7 and the possible values are called the variable’s levels. Consider the variables and (at 30 days) from the stent study in Section 1.1. Are these numerical or categorical variables?8 Finally, consider the smoking ban variable, which describes the type of county-wide smoking ban and takes a value none, partial, or comprehensive in each county. This variable seems to be a hybrid: it is a categorical variable but the levels have a natural ordering. A variable with these properties is called an ordinal variable. To simplify analyses, any ordinal variables in this book will be treated as categorical variables. Example 1.3: Data were collected about students in a statistics course. Three variables were recorded for each student: number of siblings, student height, and whether the student had previously taken a statistics course. Classify each of the variables as continuous numerical, discrete numerical, or categorical. The number of siblings and student height represent numerical variables. Because the number of siblings is a count, it is discrete. Height varies continuously, so it is a continuous numerical variable. The last variable classifies students into two categories – those who have and those who have not taken a statistics course – which makes this variable categorical. 1.2.3 Relationships between variables Many analyses are motivated by a researcher looking for a relationship between two or more variables. A social scientist may like to answer some of the following questions: Is federal spending, on average, higher or lower in counties with high rates of poverty? If homeownership is lower than the national average in one county, will the percent of multi-unit structures in that county likely be above or below the national average? Which counties have a higher average income: those that enact one or more smoking bans or those that do not? To answer these questions, data must be collected, such as the data set shown in Table 1.5. Examining summary statistics could provide insights for each of the three questions about counties. Additionally, graphs can be used to visually summarize data and are useful for answering such questions as well. Figure 1.2: A scatterplot showing fed spend against poverty. Owsley County of Kentucky, with a poverty rate of 41.5% and federal spending of $21.50 per capita, is highlighted. Scatterplots are one type of graph used to study the relationship between two numerical variables. Figure 1.2 compares the variables fed_spend and poverty. Each point on the plot represents a single county. For instance, the highlighted dot corresponds to County 1088 in the county data set: Owsley County, Kentucky, which had a poverty rate of 41.5% and federal spending of $21.50 per capita. The dense cloud in the scatterplot suggests a relationship between the two variables: counties with a high poverty rate also tend to have slightly more federal spending. We might brainstorm as to why this relationship exists and investigate each idea to determine which is the most reasonable explanation. Guided Practice 1.5 Examine the variables in the data set, which are described in Table . Create two questions about the relationships between these variables that are of interest to you.9 The and variables are said to be associated because the plot shows a discernible pattern. When two variables show some connection with oneanother, they are called variables. Associated variables can also be called variables and vice-versa. Example 1.6 The relationship between the homeownership rate and the percent of units in multi-unit structures (e.g. apartments, condos) is visualized using a scatterplot in Figure 1.3. Are these variables associated? Figure 1.3: A scatterplot of the homeownership rate versus the percent of units that are in multi-unit structures for all 3,143 counties. It appears that the larger the fraction of units in multi-unit structures, the lower the homeownership rate. Since there is some relationship between the variables, they are associated. Because there is a downward trend in Figure 1.3 counties with more units in multi-unit structures are associated with lower homeownership – these variables are said to be negatively associated. A positive association is shown in the relationship between the poverty and fed_spend variables represented in Figure 1.2, where counties with higher poverty rates tend to receive more federal spending per capita. Associated or indepedendent, not both A pair of variables are either related in some way (associated) or not (independent). No pair of variables is both associated and independent. If two variables are not associated, then they are said to be . That is, two variables are independent if there is no evident relationship between the two. 1.3 Overview of data collection principles The first step in conducting research is to identify topics or questions that are to be investigated. A clearly laid out research question is helpful in identifying what subjects or cases should be studied and what variables are important. It is also important to consider how data are collected so that they are reliable and help achieve the research goals. 1.3.1 Populations and samples Consider the following three research questions: What is the average mercury content in swordfish in the Atlantic Ocean? Over the last 5 years, what is the average time to complete a degree for Duke undergraduate students? Does a new drug reduce the number of deaths in patients with severe heart disease? Each research question refers to a target population. In the first question, the target population is all swordfish in the Atlantic ocean, and each fish represents a case. It is usually too expensive to collect data for every case in a population. Instead, a sample is taken. A sample represents a subset of the cases and is often a small fraction of the population. For instance, 60 swordfish (or some other number) in the population might be selected, and this sample data may be used to provide an estimate of the population average and answer the research question. Guided Practice 1.7 For the second and third questions above, identify the target population and what represents an individual case.10 1.3.2 Anecdotal evidence Consider the following possible responses to the three research questions: A man on the news got mercury poisoning from eating swordfish, so the average mercury concentration in swordfish must be dangerously high. I met two students who took more than 7 years to graduate from Duke, so it must take longer to graduate at Duke than at many other colleges. My friend’s dad had a heart attack and died after they gave him a new heart disease drug, so the drug must not work. Each conclusion is based on data. However, there are two problems. First, the data only represent one or two cases. Second, and more importantly, it is unclear whether these cases are actually representative of the population. Data collected in this haphazard fashion are called anecdotal evidence. Anecdotal Evidence Be careful of data collected haphazardly. Such evidence may be true and verifiable, but it may only represent extraordinary cases. Anecdotal evidence typically is composed of unusual cases that we recall based on their striking characteristics. For instance, we are more likely to remember the two people we met who took 7 years to graduate than the six others who graduated in four years. Instead of looking at the most unusual cases, we should examine a sample of many cases that represent the population. 1.3.3 Sampling from a population We might try to estimate the time to graduation for Duke undergraduates in the last 5 years by collecting a sample of students. All graduates in the last 5 years represent the population, and graduates who are selected for review are collectively called the sample. In general, we always seek to randomly select a sample from a population. The most basic type of random selection is equivalent to how raffles are conducted. For example, in selecting graduates, we could write each graduate’s name on a raffle ticket and draw 100 tickets. The selected names would represent a random sample of 100 graduates. Why pick a sample randomly? Why not just pick a sample by hand? Consider the following scenario. Example 1.8 Suppose we ask a student who happens to be majoring in nutrition to select several graduates for the study. What kind of students do you think she might collect? Do you think her sample would be representative of all graduates? Perhaps she would pick a disproportionate number of graduates from health-related fields. Or perhaps her selection would be well-representative of the population. When selecting samples by hand, we run the risk of picking a *biased* sample, even if that bias is unintentional or difficult to discern. Figure 1.4: In this graphic, five graduates are randomly selected from the population to be included in the sample. Figure 1.5: Instead of sampling from all graduates equally, a nutrition major might inadvertently pick graduates with health-related majors disproportionately often. If someone was permitted to pick and choose exactly which graduates were included in the sample, it is entirely possible that the sample could be skewed to that person’s interests, which may be entirely unintentional. This introduces bias into a sample. Sampling randomly helps resolve this problem. The most basic random sample is called a simple random sample, which is equivalent to using a raffle to select cases. This means that each case in the population has an equal chance of being included and there is no implied connection between the cases in the sample. The act of taking a simple random sample helps minimize bias, however, bias can crop up in other ways. Even when people are picked at random, e.g. for surveys, caution must be exercised if the non-response is high. For instance, if only 30% of the people randomly sampled for a survey actually respond, and it is unclear whether the respondents are representative of the entire population, the survey might suffer from non-response bias. Figure 1.6: Due to the possibility of non-response, surveys studies may only reach a certain group within the population. It is difficult, and often impossible, to completely fix this problem. Another common downfall is a convenience sample , where individuals who are easily accessible are more likely to be included in the sample. For instance, if a political survey is done by stopping people walking in the Bronx, it will not represent all of New York City. It is often difficult to discern what sub-population a convenience sample represents. Guided Practice 1.9 We can easily access ratings for products, sellers, and companiesthrough websites. These ratings are based only on those people who goout of their way to provide a rating. If 50% of online reviews for a product are negative, do you think this means that 50% of buyers are dissatisfied with the product?11 1.3.4 Explanatory and response variables Consider the following question from page for the county data set: Is federal spending, on average, higher or lower in counties with high rates of poverty? If we suspect poverty might affect spending in a county, then poverty is the variable and federal spending is the response variable in the relationship.12 If there are many variables, it may be possible to consider a number of them as explanatory variables. Tip: Explanatory and response variables To identify the explanatory variable in a pair of variables, identify which of the two is suspected of affecting the other. Figure 1.7: Making the assumption that an explanatory variable might causally influence some response variable Caution: association does not imply causation Labeling variables as explanatory and response does not guarantee the relationship between the two is actually causal, even if there is an association identified between the two variables. We use these labels only to keep track of which variable we suspect affects the other. In some cases, there is no explanatory or response variable. Consider the following question: If homeownership is lower than the national average in one county, will the percent of multi-unit structures in that county likely be above or below the national average? It is difficult to decide which of these variables should be considered the explanatory and response variable, i.e. the direction is ambiguous, so no explanatory or response labels are suggested here. 1.3.5 Introducing observational studies and experiments There are two primary types of data collection: observational studies and experiments. Researchers perform an observational study when they collect data in a way that does not directly interfere with how the data arise. For instance, researchers may collect information via surveys, review medical or company records, or follow a cohort of many similar individuals to study why certain diseases might develop. In each of these situations, researchers merely observe what happens. In general, observational studies can provide evidence of a naturally occurring association between variables, but they cannot by themselves show a causal connection. When researchers want to investigate the possibility of a causal connection, they conduct an experiment. Usually there will be both an explanatory and a response variable. For instance, we may suspect administering a drug will reduce mortality in heart attack patients over the following year. To check if there really is a causal connection between the explanatory variable and the response, researchers will collect a sample of individuals and split them into groups. The individuals in each group are assigned a treatment. When individuals are randomly assigned to a group, the experiment is called a randomized experiment. For example, each heart attack patient in the drug trial could be randomly assigned, perhaps by flipping a coin, into one of two groups: the first group receives a placebo (fake treatment) and the second group receives the drug. See the case study in Section 1.1 for another example of an experiment, though that study did not employ a placebo. Tip: Association does not equal Causation: In a data analysis, association does not imply causation, and causation can only be inferred from a randomized experiment. 1.4 Observational studies and sampling strategies 1.4.1 Observational studies Generally, data in observational studies are collected only by monitoring what occurs, while experiments require the primary explanatory variable in a study be assigned for each subject by the researchers. Making causal conclusions based on experiments is often reasonable. However, making the same causal conclusions based on observational data can be treacherous and is not recommended. Thus, observational studies are generally only sufficient to show associations. Guided Practice 1.10 Suppose an observational study tracked sunscreen use and skin cancer, and it was found that the more sunscreen someone used, the more likely the person was to have skin cancer. Does this mean sunscreen causes skin cancer?13 Some previous research tells us that using sunscreen actually reduces skin cancer risk, so maybe there is another variable that can explain this hypothetical association between sunscreen usage and skin cancer. One important piece of information that is absent is sun exposure. If someone is out in the sun all day, she is more likely to use sunscreen and more likely to get skin cancer. Exposure to the sun is unaccounted for in the simple investigation. Figure 1.8: Sun exposure could be a confounding variable that accounts for an association between sunscreen use and skin cancer. Sun exposure is what is called a confounding variable ,14 which is a variable that is correlated with both the explanatory and response variables. While one method to justify making causal conclusions from observational studies is to exhaust the search for confounding variables, there is no guarantee that all confounding variables can be examined or measured. In the same way, the data set is an observational study with confounding variables, and its data cannot easily be used to make causal conclusions. Guided Practice 1.11 Figure 1.3 shows a negative association between the homeownership rate and the percentage of multi-unit structures in a county. However, it is unreasonable to conclude that there is a causal relationship between the two variables. Suggest one or more other variables that might explain the relationship in Figure 1.3 .15 Observational studies come in two forms: prospective and retrospective studies. A prospective study identifies individuals and collects information as events unfold. For instance, medical researchers may identify and follow a group of similar individuals over many years to assess the possible influences of behavior on cancer risk. One example of such a study is The Nurses’ Health Study, started in 1976 and expanded in 1989.16 This prospective study recruits registered nurses and then collects data from them using questionnaires. Retrospective studies collect data after events have taken place, e.g. researchers may review past events in medical records. Some data sets, such as , may contain both prospectively- and retrospectively-collected variables. Local governments prospectively collect some variables as events unfolded (e.g. retails sales) while the federal government retrospectively collected others during the 2010 census (e.g. county population). 1.4.2 Three sampling methods (special topic) Almost all statistical methods are based on the notion of implied randomness. If observational data are not collected in a random framework from a population, results from these statistical methods are not reliable. Here we consider three random sampling techniques: simple, stratified, and cluster sampling. Figure 1.9 provides a graphical representation of these techniques. Figure 1.9: Examples of simple random, stratified, and cluster sampling. In the top panel, simple random sampling was used to randomly select the 18 cases. In the middle panel, stratified sampling was used: cases were grouped into strata, and then simple random sampling was employed within each stratum. In the bottom panel, cluster sampling was used, where data were binned into nine clusters, and three of the clusters were randomly selected. Simple random sampling is probably the most intuitive form of random sampling. Consider the salaries of Major League Baseball (MLB) players, where each player is a member of one of the league’s 30 teams. To take a simple random sample of 120 baseball players and their salaries from the 2010 season, we could write the names of that season’s 828 players onto slips of paper, drop the slips into a bucket, shake the bucket around until we are sure the names are all mixed up, then draw out slips until we have the sample of 120 players. In general, a sample is referred to as “simple random” if each case in the population has an equal chance of being included in the final sample and knowing that a case is included in a sample does not provide useful information about which other cases are included. Stratified sampling is a divide-and-conquer sampling strategy. The population is divided into groups called strata. The strata are chosen so that similar cases are grouped together, then a second sampling method, usually simple random sampling, is employed within each stratum. In the baseball salary example, the teams could represent the strata; some teams have a lot more money (we’re looking at you, Yankees). Then we might randomly sample 4 players from each team for a total of 120 players. Stratified sampling is especially useful when the cases in each stratum are very similar with respect to the outcome of interest. The downside is that analyzing data from a stratified sample is a more complex task than analyzing data from a simple random sample. The analysis methods introduced in this book would need to be extended to analyze data collected using stratified sampling. Example 1.12 Why would it be good for cases within each stratum to be very similar? We might get a more stable estimate for the subpopulation in a stratum if the cases are very similar. These improved estimates for each subpopulation will help us build a reliable estimate for the full population. In cluster sampling, we group observations into clusters, then randomly sample some of the clusters. Sometimes cluster sampling can be a more economical technique than the alternatives. Also, unlike stratified sampling, cluster sampling is most helpful when there is a lot of case-to-case variability within a cluster but the clusters themselves don’t look very different from one another. For example, if neighborhoods represented clusters, then this sampling method works best when the neighborhoods are very diverse. A downside of cluster sampling is that more advanced analysis techniques are typically required, though the methods in this book can be extended to handle such data. Example 1.13 Suppose we are interested in estimating the malaria rate in a densely tropical portion of rural Indonesia. We learn that there are 30 villages in that part of the Indonesian jungle, each more or less similar to the next. What sampling method should be employed? A simple random sample would likely draw individuals from all 30 villages, which could make data collection extremely expensive. Stratified sampling would be a challenge since it is unclear how we would build strata of similar individuals. However, cluster sampling seems like a very good idea. We might randomly select a small number of villages. This would probably reduce our data collection costs substantially in comparison to a simple random sample and would still give us helpful information. Another technique called multistage sampling is similar to cluster sampling, except that we take a simple random sample within each selected cluster. For instance, if we sampled neighborhoods using cluster sampling, we would next sample a subset of homes within each selected neighborhood if we were using multistage sampling. 1.5 Experiments Studies where the researchers assign treatments to cases are called. When this assignment includes randomization, e.g. using a coin flip to decide which treatment a patient receives, it is called a . Randomized experiments are fundamentally important when trying to show a causal connection between two variables. 1.5.1 Principles of experimental design Randomized experiments are generally built on four principles. Controlling. Researchers assign treatments to cases, and they do their best to any other differences in the groups. For example, when patients take a drug in pill form, some patients take the pill with only a sip of water while others may have it with an entire glass of water. To control for the effect of water consumption, a doctor may ask all patients to drink a 12 ounce glass of water with the pill. Randomization. Researchers randomize patients into treatment groups to account for variables that cannot be controlled. For example, some patients may be more susceptible to a disease than others due to their dietary habits. Randomizing patients into the treatment or control group helps even out such differences, and it also prevents accidental bias from entering the study. Replication. The more cases researchers observe, the more accurately they can estimate the effect of the explanatory variable on the response. In a single study, we by collecting a sufficiently large sample. Additionally, a group of scientists may replicate an entire study to verify an earlier finding. Blocking. Researchers sometimes know or suspect that variables, other than the treatment, influence the response. Under these circumstances, they may first group individuals based on this variable and then randomize cases within each block to the treatment groups. This strategy is often referred to as . For instance, if we are looking at the effect of a drug on heart attacks, we might first split patients into low-risk and high-risk , then randomly assign half the patients from each block to the control group and the other half to the treatment group, as shown in Figure 1.10. This strategy ensures each treatment group has an equal number of low-risk and high-risk patients. Figure 1.10: Blocking using a variable depicting patient risk. Patients are first divided into low-risk and high-risk blocks, then each block is evenly divided into the treatment groups using randomization. This strategy ensures an equal representation of patients in each treatment group from both the low-risk and high-risk categories. It is important to incorporate the first three experimental design principles into any study, and this book describes methods for analyzing data from such experiments. Blocking is a slightly more advanced technique, and statistical methods in this book may be extended to analyze data collected using blocking. 1.5.2 Reducing bias in human experiments Randomized experiments are the gold standard for data collection, but they do not ensure an unbiased perspective into the cause and effect relationships in all cases. Human studies are perfect examples where bias can unintentionally arise. Here we reconsider a study where a new drug was used to treat heart attack patients.17 In particular, researchers wanted to know if the drug reduced deaths in patients. These researchers designed a randomized experiment because they wanted to draw causal conclusions about the drug’s effect. Study volunteers18 were randomly placed into two study groups. One group, the treatment group , received the drug. The other group, called the control group, did not receive any drug treatment. Put yourself in the place of a person in the study. If you are in the treatment group, you are given a fancy new drug that you anticipate will help you. On the other hand, a person in the other group doesn’t receive the drug and sits idly, hoping her participation doesn’t increase her risk of death. These perspectives suggest there are actually two effects: the one of interest is the effectiveness of the drug, and the second is an emotional effect that is difficult to quantify. Researchers aren’t usually interested in the emotional effect, which might bias the study. To circumvent this problem, researchers do not want patients to know which group they are in. When researchers keep the patients uninformed about their treatment, the study is said to be blind. But there is one problem: if a patient doesn’t receive a treatment, she will know she is in the control group. The solution to this problem is to give fake treatments to patients in the control group. A fake treatment is called a placebo, and an effective placebo is the key to making a study truly blind. A classic example of a placebo is a sugar pill that is made to look like the actual treatment pill. Often times, a placebo results in a slight but real improvement in patients. This effect has been dubbed the placebo effect. The patients are not the only ones who should be blinded: doctors and researchers can accidentally bias a study. When a doctor knows a patient has been given the real treatment, she might inadvertently give that patient more attention or care than a patient that she knows is on the placebo. To guard against this bias, which again has been found to have a measurable effect in some instances, most modern studies employ a setup where doctors or researchers who interact with patients are, just like the patients, unaware of who is or is not receiving the treatment.19 Guided Practice 1.14 Look back to the study in Section 1.1 where researchers were testing whether stents were effective at reducing strokes in at-risk patients. Is this an experiment? Was the study blinded? Was it double-blinded?20 Chimowitz MI, Lynn MJ, Derdeyn CP, et al. 2011. Stenting versus Aggressive Medical Therapy for Intracranial Arterial Stenosis. New England Journal of Medicine 365:993-1003. . NY Times article reporting on the study: .↩ The proportion of the 224 patients who had a stroke within 365 days: \\(45/224 = 0.20\\).↩ Formally, a summary statistic is a value computed from the data. Some summary statistics are more useful than others.↩ A case is also sometimes called a unit of observation or an observational unit.↩ Each county may be viewed as a case, and there are eleven pieces of information recorded for each case. A table with 3,143 rows and 11 columns could hold these data, where each row represents a county and each column represents a particular piece of information.↩ Sometimes also called a nominal variable.↩ There are only two possible values for each variable, and in both cases they describe categories. Thus, each is a categorical variable.↩ Two sample questions: (1) Intuition suggests that if there are many line breaks in an email then there would also tend to be many characters: does this hold true? (2) Is there a connection between whether an email format is plain text (versus HTML) and whether it is a spam message?↩ ([timeToGraduationQuestionForUCLAStudents]) Notice that the first question is only relevant to students who complete their degree; the average cannot be computed using a student who never finished her degree. Thus, only Duke undergraduate students who have graduated in the last five years represent cases in the population under consideration. Each such student would represent an individual case. ([identifyPopulationOfStentStudy]) A person with severe heart disease represents a case. The population includes all people with severe heart disease.↩ Answers will vary. From our own anecdotal experiences, we believe people tend to rant more about products that fell below expectations than rave about those that perform as expected. For this reason, we suspect there is a negative bias in product ratings on sites like Amazon. However, since our experiences may not be representative, we also keep an open mind.↩ Sometimes the explanatory variable is called the independent variable and the response variable is called the dependent variable. However, this becomes confusing since a pair of variables might be independent or dependent, so we avoid this language.↩ No. See the paragraph following the exercise for an explanation.↩ Also called a lurking variable, confounding factor, or a confounder.↩ Answers will vary. Population density may be important. If a county is very dense, then a larger fraction of residents may live in multi-unit structures. Additionally, the high density may contribute to increases in property value, making homeownership infeasible for many residents.↩ Anturane Reinfarction Trial Research Group. 1980. Sulfinpyrazone in the prevention of sudden death after myocardial infarction. New England Journal of Medicine 302(5):250-256.↩ Human subjects are often called patients, volunteers, or study participants.↩ There are always some researchers in the study who do know which patients are receiving which treatment. However, they do not interact with the study’s patients and do not tell the blinded health care professionals who is receiving which treatment.↩ The researchers assigned the patients into their treatment groups, so this study was an experiment. However, the patients could distinguish what treatment they received, so this study was not blind. The study could not be double-blind since it was not blind.↩ "],
["DescribingData.html", "Chapter 2 Describing Data 2.1 Examining numerical data 2.2 Considering categorical data", " Chapter 2 Describing Data 2.1 Examining numerical data This section introduces techniques for exploring and summarizing numerical variables, and the email50 and county data sets from Section 1.2 provide rich opportunities for examples. Recall that outcomes of numerical variables are numbers on which it is reasonable to perform basic arithmetic operations. For example, the pop20 variable, which represents the populations of counties in 2010, is numerical since we can sensibly discuss the difference or ratio of the populations in two counties. On the other hand, area codes and zip codes are not numerical. 2.1.1 Scatterplots for paired data A provides a case-by-case view of data for two numerical variables. In Figure 1.2, a scatterplot was used to examine how federal spending and poverty were related in the data set. Another scatterplot is shown in Figure 2.1, comparing the number of line breaks (line_breaks) and number of characters (num_char) in emails for the email50 data set. In any scatterplot, each point represents a single case. Since there are 50 cases in email50, there are 50 points in Figure [email50LinesCharacters]. Figure 2.1: A scatterplot of versus for thedata. To put the number of characters in perspective, this paragraph has 363 characters. Looking at Figure ??, it seems that some emails are incredibly long! Upon further investigation, we would actually find that most of the long emails use the HTML format, which means most of the characters in those emails are used to format the email rather than provide text. Guided Practice 1.15 What do scatterplots reveal about the data, and how might they be useful?21 Guided Practice 1.17 Describe two variables that would have a horseshoe shaped association in a scatterplot.22 Example 1.16 Consider a new data set of 54 cars with two variables: vehicle price and weight.23 A scatterplot of vehicle price versus weight is shown in Figure 2.2. What can be said about the relationship between these variables? Figure 2.2: A scatterplot of versus for 54 cars. The relationship is evidently nonlinear, as highlighted by the dashed line. This is different from previous scatterplots we’ve seen, such as Figure 1.2 and Figure 2.1, which show relationships that are very linear. 2.1.2 Dot plots and the mean Sometimes two variables is one too many: only one variable may be of interest. In these cases, a dot plot provides the most basic of displays. A dot plot is a one-variable scatterplot; an example using the number of characters from 50 emails is shown in Figure 2.3. A stacked version of this dot plot is shown in Figure 2.4. Figure 2.3: A dot plot of for the data set. Figure 2.4: A stacked dot plot of for the data set. The mean, sometimes called the average, is a common way to measure the center of a distribution of data. To find the mean number of characters in the 50 emails (see Equation (2.1)), we add up all the character counts and divide by the number of emails. For computational convenience, the number of characters is listed in the thousands and rounded to the first decimal. \\[\\begin{equation} \\bar{x} = \\frac{21.7 + 7.0 + \\cdots + 15.8}{50} = 11.6 \\tag{2.1} \\end{equation}\\] The sample mean is often labeled \\(\\bar{x}\\), and the letter \\(x\\) is being used as a generic placeholder for the variable of interest, num_char. The sample mean is shown as a triangle in Figures ?? and 2.4. Mean The sample mean of a numerical variable is the sum of all of the observations divided by the number of observations: \\[\\begin{equation} \\bar{x} = \\frac{x_1+x_2+\\cdots+x_n}{n} \\tag{2.2} \\end{equation}\\] where \\(x_1, x_2, \\dots, x_n\\) represent the \\(n\\) observed values. Guided Practice 1.20 Examine Equations (2.1) and (2.2) above. What does \\(x_1\\) correspond to? And \\(x_2\\)? Can you infer a general meaning to what \\(x_i\\) might represent?24 Guided Practice 1.21 What was \\(n\\) in this sample of emails?25 The email50 data set is a sample from a larger population of emails that were received in January and March. We could compute a mean for this population in the same way as the sample mean. However, there is a difference in notation: the population mean has a special label: \\(\\mu\\). The symbol \\(\\mu\\) is the Greek letter mu and represents the average of all observations in the population. Sometimes a subscript, such as \\(_x\\), is used to represent which variable the population mean refers to, e.g. \\(\\mu_x\\). Example 1.22 The average number of characters across all emails can be estimated using the sample data. Based on the sample of 50 emails, what would be a reasonable estimate of \\(\\mu_x\\), the mean number of characters in all emails in the email data set? (Recall that email50 is a sample from email.) The sample mean, 11,600, may provide a reasonable estimate of \\(\\mu_x\\). While this number will not be perfect, it provides a point estimate of the population mean. In Chapter 2 and beyond, we will develop tools to characterize the accuracy of point estimates, and we will find that point estimates based on larger samples tend to be more accurate than those based on smaller samples. Example 1.23 We might like to compute the average income per person in the US. To do so, we might first think to take the mean of the per capita incomes from the 3,143 counties in the data set. What would be a better approach? The county data set is special in that each county actually represents many individual people. If we were to simply average across the variable, we would be treating counties with 5,000 and 5,000,000 residents equally in the calculations. Instead, we should compute the total income for each county, add up all the counties’ totals, and then divide by the number of people in all the counties. If we completed these steps with the data, we would find that the per capita income for the US is $27,348.43. Had we computed the simple mean of per capita income across counties, the result would have been just $22,504.70! Example 1.23 used what is called a weighted mean, which will not be a key topic in this textbook. However, we have provided an online supplement on weighted means for interested readers: http://www.openintro.org/stat/down/supp/wtdmean.pdf 2.1.3 Histograms and shape Dot plots show the exact value of each observation. This is useful for small data sets, but they can become hard to read with larger samples. Rather than showing the value of each observation, think of the value as belonging to a bin. For example, in the data set, we create a table of counts for the number of cases with character counts between 0 and 5,000, then the number of cases between 5,000 and 10,000, and so on. Observations that fall on the boundary of a bin (e.g. 5,000) are allocated to the lower bin. This tabulation is shown in Table2.1. These binned counts are plotted as bars in Figure 2.5 into what is called a , which resembles the stacked dot plot shown in Figure 2.4. Table 2.1: The counts for the binned *num_char** data. Characters (in thousands) 0-5 &lt;spa n&gt;5-10 10- 15 15-20&lt;/s pan&gt; 20-25 25-30 &lt;sp an&gt;\\(\\cdots\\) &lt;span &gt;55-60 60-65&lt;/ span&gt; Count 19 12 6 2 3 5 \\(\\cdots\\) 0 1 Figure 2.5: A histogram of num_char. This distribution is very strongly skewed to the right. Histograms provide a view of the data density. Higher bars represent where the data are relatively more dense. For instance, there are many more emails between 0 and 10,000 characters than emails between 10,000 and 20,000 characters in the data set. The bars make it easy to see how the density of the data changes relative to the number of characters. Histograms are especially convenient for describing the shape of the data distribution. Figure 2.5 shows that most emails have a relatively small number of characters, while fewer emails have a very large number of characters. When data trail off to the right in this way and have a longer right , the shape is said to be right skewed.26 Data sets with the reverse characteristic – a long, thin tail to the left – are said to be left skewed. We also say that such a distribution has a long left tail. Data sets that show roughly equal trailing off in both directions are called . Tip: Use Long tails identify skew When data trail off in one direction, the distribution has a . If a distribution has a long left tail, it is left skewed. If a distribution has a long right tail, it is right skewed. Guided Practice 1.24 Take a look at the dot plots in Figures 2.3 and (???)(fig:emailCharactersDotPlotStacked). Can you see the skew in the data? Is it easier to see the skew in this histogram or the dot plots?27 Guided Practice 1.25 Besides the mean (since it was labeled), what can you see in the dot plots that you cannot see in the histogram?28 In addition to looking at whether a distribution is skewed or symmetric, histograms can be used to identify modes. A mode is represented by a prominent peak in the distribution.29 There is only one prominent peak in the histogram of num_char. Figure 2.6: Counting only prominent peaks, the distributions are (left to right) unimodal, bimodal, and multimodal. Figure 2.6 shows histograms that have one, two, or three prominent peaks. Such distributions are called unimodal, bimodal, and multimodal, respectively. Any distribution with more than 2 prominent peaks is called multimodal. Notice that there was one prominent peak in the unimodal distribution with a second less prominent peak that was not counted since it only differs from its neighboring bins by a few observations. Guided Practice 1.26 Figure 2.5 reveals only one prominent mode in the number of characters. Is the distribution unimodal, bimodal, or multimodal?30 Guided Practice 1.27 Height measurements of young students and adult teachers at a K-3 elementary school were taken. How many modes would you anticipate in this height data set?31 Tip: Looking for modes isn’t about finding a clear and correct answer about the number of modes in a distribution, which is why prominent is not rigorously defined in this book. The important part of this examination is to better understand your data and how it might be structured. 2.1.4 Variance and standard deviation The mean is used to describe the center of a data set, but the in the data is also important. Here, we introduce two measures of variability: the variance and the standard deviation. Both of these are very useful in data analysis, even though the formulas are a bit tedious to calculate by hand. The standard deviation is the easier of the two to conceptually understand, and it roughly describes how far away the typical observation is from the mean. We call the distance of an observation from its mean its deviation. Below are the deviations for the \\(1^{st}_{}\\), \\(2^{nd}_{}\\), \\(3^{rd}\\), and \\(50^{th}_{}\\) observations in the variable. For computational convenience, the number of characters is listed in the thousands and rounded to the first decimal. \\[\\begin{aligned} x_1^{}-\\bar{x} &amp;= 21.7 - 11.6 = 10.1 \\hspace{5mm}\\text{ } \\\\ x_2^{}-\\bar{x} &amp;= 7.0 - 11.6 = -4.6 \\\\ x_3^{}-\\bar{x} &amp;= 0.6 - 11.6 = -11.0 \\\\ &amp;\\ \\vdots \\\\ x_{50}^{}-\\bar{x} &amp;= 15.8 - 11.6 = 4.2\\end{aligned}\\] If we square these deviations and then take an average, the result is about equal to the sample variance, denoted by \\(s_{}^2\\): \\[\\begin{aligned} s_{}^2 &amp;= \\frac{10.1_{}^2 + (-4.6)_{}^2 + (-11.0)_{}^2 + \\cdots + 4.2_{}^2}{50-1} \\\\ &amp;= \\frac{102.01 + 21.16 + 121.00 + \\cdots + 17.64}{49} \\\\ &amp;= 172.44\\end{aligned}\\] We divide by \\(n-1\\), rather than dividing by \\(n\\), when computing the variance; you need not worry about this mathematical nuance for the material in this textbook. Notice that squaring the deviations does two things. First, it makes large values much larger, seen by comparing \\(10.1^2\\), \\((-4.6)^2\\), \\((-11.0)^2\\), and \\(4.2^2\\). Second, it gets rid of any negative signs. The standard deviation is the square root of the variance: \\[s=\\sqrt{172.44} = 13.13\\] [ The standard deviation of the number of characters in an email is about 13.13 thousand. A subscript of \\(_x\\) may be added to the variance and standard deviation, i.e. \\(s_x^2\\) and \\(s_x^{}\\), as a reminder that these are the variance and standard deviation of the observations represented by \\(x_1^{}\\), \\(x_2^{}\\), …, \\(x_n^{}\\). The \\(_{x}\\) subscript is usually omitted when it is clear which data the variance or standard deviation is referencing. Variance and Standard Deviation The variance is roughly the average squared distance from the mean. The standard deviation is the square root of the variance and describes how close the data are to the mean. Formulas and methods used to compute the variance and standard deviation for a population are similar to those used for a sample.32 However, like the mean, the population values have special symbols: \\(\\sigma_{}^2\\) for the variance and \\(\\sigma\\) for thge standard deviation. The symbol \\(\\sigma\\) is the Greek letter sigma. Figure 2.7: In the data, 41 of the 50 emails (82%) are within 1 standard deviation of the mean, and 47 of the 50 emails (94%) are within 2 standard deviations. Usually about 70% of the data are within 1 standard deviation of the mean and 95% are within 2 standard deviations, though this rule of thumb is less accurate for skewed data, as shown in this example. Tip: Standard Deviation describes variability Focus on the conceptual meaning of the standard deviation as a descriptor of variability rather than the formulas. Usually 70% of the data will be within one standard deviation of the mean and about 95% will be within two standard deviations. However, as seen in Figures 2.7 and 2.8, these percentages are not strict rules. Figure 2.8: Three very different population distributions with the same mean and standard deviation. Guided Practice 1.28 A good description of the shape of a distribution should include modality and whether the distribution is symmetric or skewed to one side. Using Figure 2.8 as an example, explain why such a description is important.33 Example 1.29 Describe the distribution of the variable using the histogram in Figure 2.5. The description should incorporate the center, variability, and shape of the distribution, and it should also be placed in context: the number of characters in emails. Also note any especially unusual cases. The distribution of email character counts is unimodal and very strongly skewed to the high end. Many of the counts fall near the mean at 11,600, and most fall within one standard deviation (13,130) of the mean. There is one exceptionally long email with about 65,000 characters. In practice, the variance and standard deviation are sometimes used as a means to an end, where the “end” is being able to accurately estimate the uncertainty associated with a sample statistic. For example, in Chapter 2 we will use the variance and standard deviation to assess how close the sample mean is to the population mean. 2.1.5 Box plots, quartiles, and the median A box plot summarizes a data set using five statistics while also plotting unusual observations. Figure 2.9 provides a vertical dot plot alongside a box plot of the variable from the data set. Figure 2.9: A vertical dot plot next to a labeled box plot for the number of characters in 50 emails. The median (6,890), splits the data into the bottom 50% and the top 50%, marked in the dot plot by horizontal dashes and open circles, respectively. The first step in building a box plot is drawing a dark line denoting the median, which splits the data in half. Figure 2.9 shows 50% of the data falling below the median (dashes) and other 50% falling above the median (open circles). There are 50 character counts in the data set (an even number) so the data are perfectly split into two groups of 25. We take the median in this case to be the average of the two observations closest to the \\(50^{th}\\) percentile: \\((\\text{6,768} + \\text{7,012}) / 2 = \\text{6,890}\\). When there are an odd number of observations, there will be exactly one observation that splits the data into two halves, and in this case that observation is the median (no average needed). Median: the number in the middle If the data are ordered from smallest to largest, the median is the observation right in the middle. If there are an even number of observations, there will be two values in the middle, and the median is taken as their average. The second step in building a box plot is drawing a rectangle to represent the middle 50% of the data. The total length of the box, shown vertically in Figure @ref(fig:boxPlotLayoutNumVar, is called the interquartile range (, for short). It, like the standard deviation, is a measure of in data. The more variable the data, the larger the standard deviation and IQR. The two boundaries of the box are called the first quartile (the \\(25^{th}\\) , i.e. 25% of the data fall below this value) and the third quartile (the \\(75^{th}\\) percentile), and these are often labeled \\(Q_1\\) and \\(Q_3\\), respectively. Interquartile range (IQR) The IQR is the length of the box in a box plot. It is computed as \\[\\begin{aligned} IQR = Q_3 - Q_1\\end{aligned}\\] where \\(Q_1\\) and \\(Q_3\\) are the \\(25^{th}\\) and \\(75^{th}\\) percentiles. Guided Practice 1.30 What percent of the data fall between \\(Q_1\\) and the median? What percent is between the median and \\(Q_3\\)?34 Extending out from the box, the whiskers attempt to capture the data outside of the box, however, their reach is never allowed to be more than \\(1.5\\times IQR\\).35 They capture everything within this reach. In Figure [boxPlotLayoutNumVar], the upper whisker does not extend to the last three points, which are beyond \\(Q_3 + 1.5\\times IQR\\), and so it extends only to the last point below this limit. The lower whisker stops at the lowest value, 33, since there is no additional data to reach; the lower whisker’s limit is not shown in the figure because the plot does not extend down to \\(Q_1 - 1.5\\times IQR\\). In a sense, the box is like the body of the box plot and the whiskers are like its arms trying to reach the rest of the data. Any observation that lies beyond the whiskers is labeled with a dot. The purpose of labeling these points – instead of just extending the whiskers to the minimum and maximum observed values – is to help identify any observations that appear to be unusually distant from the rest of the data. Unusually distant observations are called . In this case, it would be reasonable to classify the emails with character counts of 41,623, 42,793, and 64,401 as outliers since they are numerically distant from most of the data. Outliers are extreme. An outlier is an observation that is extreme relative to the rest of the data. Tip: Why it is important to look for outliers. Examination of data for possible outliers serves many useful purposes, including: Identifying in the distribution. Identifying data collection or entry errors. For instance, we re-examined the email purported to have 64,401 characters to ensure this value was accurate. Providing insight into interesting properties of the data. Guided Practice 1.31 The observation 64,401, an outlier, was found to be an accurate observation. What would such an observation suggest about the nature of character counts in emails?36 Guided Practice 1.32 Using Figure 2.9, estimate the following values for in the data set: (a) \\(Q_1\\), (b) \\(Q_3\\), and (c) IQR.37 2.1.6 Robust statistics How are the sample statistics of the num_char data set affected by the observation, 64,401? What would have happened if this email wasn’t observed? What would happen to these summary statistics if the observation at 64,401 had been even larger, say 150,000? These scenarios are plotted alongside the original data in Figure 2.10, and sample statistics are computed under each scenario in Table ??. Figure 2.10: Dot plots of the original character count data and two modified data sets. l c cc c cc &amp; &amp; &amp; &amp; scenario &amp;&amp; median &amp; IQR &amp;&amp; \\(\\bar{x}\\) &amp; \\(s\\) original data &amp;&amp; 6,890 &amp; 12,875 &amp;&amp; 11,600 &amp; 13,130 drop 66,924 observation &amp;&amp; 6,768 &amp; 11,702 &amp;&amp; 10,521 &amp; 10,798 move 66,924 to 150,000 &amp;&amp; 6,890 &amp; 12,875 &amp;&amp; 13,310 &amp; 22,434 [robustOrNotTable] Guided Practice 1.33 Which is more affected by extreme observations, the mean or median? Table ?? may be helpful. Is the standard deviation or IQR more affected by extreme observations?38 The median and IQR are called robust estimates because extreme observations have little effect on their values. The mean and standard deviation are much more affected by changes in extreme observations. Example 1.34 The median and IQR do not change much under the three scenarios in Table ??. Why might this be the case? The median and IQR are only sensitive to numbers near \\(Q_1\\), the median, and \\(Q_3\\). Since values in these regions are relatively stable – there aren’t large jumps between observations – the median and IQR estimates are also quite stable. Guided Practice 1.34 The distribution of vehicle prices tends to be right skewed, with a few luxury and sports cars lingering out into the right tail. If you were searching for a new car and cared about price, should you be more interested in the mean or median price of vehicles sold, assuming you are in the market for a regular car?39 2.1.7 Transforming data (special topic) When data are very strongly skewed, we sometimes transform them so they are easier to model. Consider the histogram of salaries for Major League Baseball players’ salaries from 2010, which is shown in Figure 2.11. Figure 2.11: Histogram of MLB player salaries for 2010, in millions of dollars. Figure 2.12: Histogram of the log-transformed MLB player salaries for 2010. Example 1.36 The histogram of MLB player salaries is useful in that we can see the data are extremely skewed and centered (as gauged by the median) at about $1 million. What isn’t useful about this plot? Most of the data are collected into one bin in the histogram and the data are so strongly skewed that many details in the data are obscured. There are some standard transformations that are often applied when much of the data cluster near zero (relative to the larger values in the data set) and all observations are positive. A transformation is a rescaling of the data using a function. For instance, a plot of the natural logarithm40 of player salaries results in a new histogram in Figure 2.12. Transformed data are sometimes easier to work with when applying statistical models because the transformed data are much less skewed and outliers are usually less extreme. Transformations can also be applied to one or both variables in a scatterplot. A scatterplot of the and variables is shown in Figure 2.13, which was earlier shown in Figure 2.1. We can see a positive association between the variables and that many observations are clustered near zero. In Chapter 5], we might want to use a straight line to model the data. However, we’ll find that the data in their current state cannot be modeled very well. Figure 2.14 shows a scatterplot where both the and variables have been transformed using a log (base \\(e\\)) transformation. While there is a positive association in each plot, the transformed data show a steadier trend, which is easier to model than the untransformed data. Figure 2.13: Scatterplot of line breaks against num char for 50 emails. Figure 2.14: A scatterplot of the same data but where each variable has been log- transformed. Transformations other than the logarithm can be useful, too. For instance, the square root (\\(\\sqrt{\\text{original observation}}\\)) and inverse (\\(\\frac{1}{\\text{original observation}}\\)) are used by statisticians. Common goals in transforming data are to see the data structure differently, reduce skew, assist in modeling, or straighten a nonlinear relationship in a scatterplot. 2.1.8 Mapping data (special topic) The data set offers many numerical variables that we could plot using dot plots, scatterplots, or box plots, but these miss the true nature of the data. Rather, when we encounter geographic data, we should map it using an intensity map, where colors are used to show higher and lower values of a variable. Figures 2.15 and 2.16 shows intensity maps for federal spending per capita (fed_spend), poverty rate in percent (poverty), homeownership rate in percent (homeownership), and median household income (med_income). The color key indicates which colors correspond to which values. Note that the intensity maps are not generally very helpful for getting precise values in any given county, but they are very helpful for seeing geographic trends and generating interesting research questions. Figure 2.15: Map of federal spending (dollars per capita). Figure 2.16: Intensity map of poverty rate Figure 2.17: Intensity map of homeownership rate (percent) Figure 2.18: Intensity map of median household income ($1000s). Guided Practice 1.38 What interesting features are evident in the intensity map?41 Example 1.37 What interesting features are evident in the fed_spend and poverty intensity maps? The federal spending intensity map shows substantial spending in the Dakotas and along the central-to-western part of the Canadian border, which may be related to the oil boom in this region. There are several other patches of federal spending, such as a vertical strip in eastern Utah and Arizona and the area where Colorado, Nebraska, and Kansas meet. There are also seemingly random counties with very high federal spending relative to their neighbors. If we did not cap the federal spending range at $18 per capita, we would actually find that some counties have extremely high federal spending while there is almost no federal spending in the neighboring counties. These high-spending counties might contain military bases, companies with large government contracts, or other government facilities with many employees. Poverty rates are evidently higher in a few locations. Notably, the deep south shows higher poverty rates, as does the southwest border of Texas. The vertical strip of eastern Utah and Arizona, noted above for its higher federal spending, also appears to have higher rates of poverty (though generally little correspondence is seen between the two variables). High poverty rates are evident in the Mississippi flood plains a little north of New Orleans and also in a large section of Kentucky and West Virginia. 2.2 Considering categorical data Like numerical data, categorical data can also be organized and analyzed. This section introduces tables and other basic tools for categorical data that are used throughout this book. The email50 data set represents a sample from a larger email data set called . This larger data set contains information on 3,921 emails. In this section we will examine whether the presence of numbers, small or large, in an email provides any useful value in classifying email as spam or not spam. 2.2.1 Contingency tables and bar plots Table ?? summarizes two variables: spam and number. Recall that is a categorical variable that describes whether an email contains no numbers, only small numbers (values under 1 million), or at least one big number (a value of 1 million or more). A table that summarizes data for two categorical variables in this way is called a contingency table. Each value in the table represents the number of times a particular combination of variable outcomes occurred. For example, the value 149 corresponds to the number of emails in the data set that are spam and had no number listed in the email. Row and column totals are also included. The row totals provide the total counts across each row (e.g. \\(149 + 168 + 50 = 367\\)), and column totals are total counts down each column. A table for a single variable is called a frequency table. Table ?? is a frequency table for the variable. If we replaced the counts with percentages or proportions, the table would be called a relative frequency table. ll ccc rr &amp; &amp; &amp; &amp; &amp; none &amp; small &amp; big &amp; Total &amp; &amp; spam &amp; 149 &amp; 168 &amp; 50 &amp; 367 [0pt] &amp; not spam &amp; 400 &amp; 2659 &amp; 495 &amp; 3554 &amp; Total &amp; 549 &amp; 2827 &amp; 545 &amp; 3921 [emailSpamNumberTableTotals] A frequency table for the variable. none small big Total 549 2827 545 3921 [emailNumberTable] A bar plot is a common way to display a single categorical variable. The left panel of Figure 2.19 shows a bar plot for the variable. In the right panel, the counts are converted into proportions (e.g. \\(549/3921=0.140\\) for ). Figure 2.19: Two bar plots of number. The left panel shows the counts, and the right panel shows the proportions in each group. 2.2.2 Row and column proportions Table ?? shows the row proportions for Table ??. The are computed as the counts divided by their row totals. The value 149 at the intersection of and is replaced by \\(149/367=0.406\\), i.e. 149 divided by its row total, 367. So what does 0.406 represent? It corresponds to the proportion of spam emails in the sample that do not have any numbers. A contingency table with row proportions for the and variables. none small big Total spam \\(149/367 = 0.406\\) \\(168/367 = 0.458\\) \\(50/367 = 0.136\\) 1.000 not spam \\(400/3554 = 0.113\\) \\(2657/3554 = 0.748\\) \\(495/3554 = 0.139\\) 1.000 Total \\(549/3921 = 0.140\\) \\(2827/3921 = 0.721\\) \\(545/3921 = 0.139\\) 1.000 [rowPropSpamNumber] A contingency table of the column proportions is computed in a similar way, where each is computed as the count divided by the corresponding column total. Table ?? shows such a table, and here the value 0.271 indicates that 27.1% of emails with no numbers were spam. This rate of spam is much higher than emails with only small numbers (5.9%) or big numbers (9.2%). Because these spam rates vary between the three levels of number (none, small ,big ), this provides evidence that the and variables are associated. A contingency table with column proportions for the spam and number variables. none small big Total spam \\(149/549 = 0.271\\) \\(168/2827 = 0.059\\) \\(50/545 = 0.092\\) \\(367/3921 = 0.094\\) not spam \\(400/549 = 0.729\\) \\(2659/2827 = 0.941\\) \\(495/545 = 0.908\\) \\(3684/3921 = 0.906\\) Total 1.000 1.000 1.000 1.000 [colPropSpamNumber] We could also have checked for an association between spam and number in Table ?? using row proportions. When comparing these row proportions, we would look down columns to see if the fraction of emails with no numbers, small numbers, and big numbers varied from to . Guided Practice 1.39 What does 0.458 represent in Table ??? What does 0.059 represent in Table ???42 Guided Practice 1.40 What does 0.139 at the intersection of and represent in Table ??? What does 0.908 represent in the Table ???43 Example 1.41 Data scientists use statistics to filter spam from incoming email messages. By noting specific characteristics of an email, a data scientist may be able to classify some emails as spam or not spam with high accuracy. One of those characteristics is whether the email contains no numbers, small numbers, or big numbers. Another characteristic is whether or not an email has any HTML content. A contingency table for the and variables from the data set are shown in Table ??. Recall that an HTML email is an email with the capacity for special formatting, e.g. bold text. In Table ??, which would be more helpful to someone hoping to classify email as spam or regular email: row or column proportions? Such a person would be interested in how the proportion of spam changes within each email format. This corresponds to column proportions: the proportion of spam in plain text emails and the proportion of spam in HTML emails. If we generate the column proportions, we can see that a higher fraction of plain text emails are spam (\\(209/1195 = 17.5\\%\\)) than compared to HTML emails (\\(158/2726 = 5.8\\%\\)). This information on its own is insufficient to classify an email as spam or not spam, as over 80% of plain text emails are not spam. Yet, when we carefully combine this information with many other characteristics, such as and other variables, we stand a reasonable chance of being able to classify some email as spam or not spam. A contingency table for and . text HTML Total spam 209 158 367 not spam 986 2568 3554 Total 1195 2726 3921 [emailSpamHTMLTableTotals] The example points out that row and column proportions are not equivalent. Before settling on one form for a table, it is important to consider each to ensure that the most useful table is constructed. Guided Practice 1.27 Look back to Tables ?? and ??. Which would be more useful to someone hoping to identify spam emails using the variable?44 2.2.3 Segmented bar and mosaic plots Contingency tables using row or column proportions are especially useful for examining how two categorical variables are related. Segmented bar and mosaic plots provide a way to visualize the information in these tables. A segmented bar plot is a graphical display of contingency table information. For example, a segmented bar plot representing Table ?? is shown in Figure 2.20, where we have first created a bar plot using the number variable and then separated each group by the levels of spam. The column proportions of Table ?? have been translated into a standardized segmented bar plot in Figure 2.21, which is a helpful visualization of the fraction of spam emails in each level of number. Figure 2.20: Segmented bar plot for numbers found in emails, where the counts have been further broken down by spam Figure 2.21: Standardized version. Example 1.43 Examine both of the segmented bar plots. Which is more useful? Figure 2.20 contains more information, but Figure 2.21 presents the information more clearly. This second plot makes it clear that emails with no number have a relatively high rate of spam email – about 27%! On the other hand, less than 10% of email with small or big numbers are spam. Since the proportion of spam changes across the groups in Figure [emailSpamNumberSegBarSta], we can conclude the variables are dependent, which is something we were also able to discern using table proportions. Because both the and groups have relatively few observations compared to the group, the association is more difficult to see in Figure [emailSpamNumberSegBar]. In some other cases, a segmented bar plot that is not standardized will be more useful in communicating important information. Before settling on a particular segmented bar plot, create standardized and non-standardized forms and decide which is more effective at communicating features of the data. [emailSpamNumberMosaicPlot] A mosaic plot is a graphical display of contingency table information that is similar to a bar plot for one variable or a segmented bar plot when using two variables. Figure [emailNumberMosaic] shows a mosaic plot for the variable. Each column represents a level of , and the column widths correspond to the proportion of emails of each number type. For instance, there are fewer emails with no numbers than emails with only small numbers, so the no number email column is slimmer. In general, mosaic plots use box areas to represent the number of observations. Figure 2.22: Mosaic plot where emails are grouped by the variable after they’ve been divided into and . This one-variable mosaic plot is further divided into pieces in Figure [emailSpamNumberMosaic] using the variable. Each column is split proportionally according to the fraction of emails that were spam in each number category. For example, the second column, representing emails with only small numbers, was divided into emails that were spam (lower) and not spam (upper). As another example, the bottom of the third column represents spam emails that had big numbers, and the upper part of the third column represents regular emails that had big numbers. We can again use this plot to see that the and variables are associated since some columns are divided in different vertical locations than others, which was the same technique used for checking an association in the standardized version of the segmented bar plot. In a similar way, a mosaic plot representing row proportions of Table [emailSpamNumberTableTotals] could be constructed, as shown in Figure [emailSpamNumberMosaicRev]. However, because it is more insightful for this application to consider the fraction of spam in each category of the variable, we prefer Figure [emailSpamNumberMosaic]. 2.2.4 The only pie chart you will see in this book While pie charts are well known, they are not typically as useful as other charts in a data analysis. A pie chart is shown in Figure alongside a bar plot. It is generally more difficult to compare group sizes in a pie chart than in a bar plot, especially when categories have nearly identical counts or proportions. In the case of the and categories, the difference is so slight you may be unable to distinguish any difference in group sizes for either plot! Figure 2.23: A pie chart and bar plot of for the data set. 2.2.5 Comparing numerical data across groups Some of the more interesting investigations can be considered by examining numerical data across groups. The methods required here aren’t really new. All that is required is to make a numerical plot for each group. Here two convenient methods are introduced: side-by-side box plots and hollow histograms. We will take a look again at the data set and compare the median household income for counties that gained population from 2000 to 2010 versus counties that had no gain. While we might like to make a causal connection here, remember that these are observational data and so such an interpretation would be unjustified. There were 2,041 counties where the population increased from 2000 to 2010, and there were 1,099 counties with no gain (all but one were a loss). A random sample of 100 counties from the first group and 50 from the second group are shown in Table [countyIncomeSplitByPopGainTable] to give a better sense of some of the raw data. ccc ccc c ccc &amp;&amp; 41.2 &amp; 33.1 &amp; 30.4 &amp; 37.3 &amp; 79.1 &amp; 34.5 &amp; &amp; 40.3 &amp; 33.5 &amp; 34.8 22.9 &amp; 39.9 &amp; 31.4 &amp; 45.1 &amp; 50.6 &amp; 59.4 &amp;&amp; 29.5 &amp; 31.8 &amp; 41.3 47.9 &amp; 36.4 &amp; 42.2 &amp; 43.2 &amp; 31.8 &amp; 36.9 &amp;&amp; 28 &amp; 39.1 &amp; 42.8 50.1 &amp; 27.3 &amp; 37.5 &amp; 53.5 &amp; 26.1 &amp; 57.2 &amp;&amp; 38.1 &amp; 39.5 &amp; 22.3 57.4 &amp; 42.6 &amp; 40.6 &amp; 48.8 &amp; 28.1 &amp; 29.4 &amp;&amp; 43.3 &amp; 37.5 &amp; 47.1 43.8 &amp; 26 &amp; 33.8 &amp; 35.7 &amp; 38.5 &amp; 42.3 &amp;&amp; 43.7 &amp; 36.7 &amp; 36 41.3 &amp; 40.5 &amp; 68.3 &amp; 31 &amp; 46.7 &amp; 30.5 &amp;&amp; 35.8 &amp; 38.7 &amp; 39.8 68.3 &amp; 48.3 &amp; 38.7 &amp; 62 &amp; 37.6 &amp; 32.2 &amp;&amp; 46 &amp; 42.3 &amp; 48.2 42.6 &amp; 53.6 &amp; 50.7 &amp; 35.1 &amp; 30.6 &amp; 56.8 &amp;&amp; 38.6 &amp; 31.9 &amp; 31.1 66.4 &amp; 41.4 &amp; 34.3 &amp; 38.9 &amp; 37.3 &amp; 41.7 &amp;&amp; 37.6 &amp; 29.3 &amp; 30.1 51.9 &amp; 83.3 &amp; 46.3 &amp; 48.4 &amp; 40.8 &amp; 42.6 &amp;&amp; 57.5 &amp; 32.6 &amp; 31.1 44.5 &amp; 34 &amp; 48.7 &amp; 45.2 &amp; 34.7 &amp; 32.2 &amp;&amp; 46.2 &amp; 26.5 &amp; 40.1 39.4 &amp; 38.6 &amp; 40 &amp; 57.3 &amp; 45.2 &amp; 33.1 &amp;&amp; 38.4 &amp; 46.7 &amp; 25.9 43.8 &amp; 71.7 &amp; 45.1 &amp; 32.2 &amp; 63.3 &amp; 54.7 &amp;&amp; 36.4 &amp; 41.5 &amp; 45.7 71.3 &amp; 36.3 &amp; 36.4 &amp; 41 &amp; 37 &amp; 66.7 &amp;&amp; 39.7 &amp; 37 &amp; 37.7 50.2 &amp; 45.8 &amp; 45.7 &amp; 60.2 &amp; 53.1 &amp; &amp;&amp; 21.4 &amp; 29.3 &amp; 50.1 35.8 &amp; 40.4 &amp; 51.5 &amp; 66.4 &amp; 36.1 &amp; &amp;&amp; 43.6 &amp; 39.8 &amp; [countyIncomeSplitByPopGainTable] The side-by-side box plot is a traditional tool for comparing across groups. An example is shown in the left panel of Figure [countyIncomeSplitByPopGain], where there are two box plots, one for each group, placed into one plotting window and drawn on the same scale. Figure 2.24: A pie chart and bar plot of for the data set. Another useful plotting method uses to compare numerical data across groups. These are just the outlines of histograms of each group put on the same plot, as shown in the right panel of Figure [countyIncomeSplitByPopGain]. Guided Practice 1.27 Use the plots in the Figure to compare the incomes for counties across the two groups. What do you notice about the approximate center of each group? What do you notice about the variability between groups? Is the shape relatively consistent between groups? How many prominent modes are there for each group?45 Guided Practice 1.27 What components of each plot in the Figure do you find most useful?46 Answers may vary. Scatterplots are helpful in quickly spotting associations between variables, whether those associations represent simple or more complex relationships.↩ Consider the case where your vertical axis represents something “good” and your horizontal axis represents something that is only good in moderation. Health and water consumption fit this description since water becomes toxic when consumed in excessive quantities.↩ Subset of data from↩ \\(x_1\\) corresponds to the number of characters in the first email in the sample (21.7, in thousands), \\(x_2\\) to the number of characters in the second email (7.0, in thousands), and \\(x_i\\) corresponds to the number of characters in the \\(i^{th}\\) email in the data set.↩ The sample size was \\(n=50\\).↩ Other ways to describe data that are skewed to the right: , , or .↩ The skew is visible in all three plots, though the flat dot plot is the least useful. The stacked dot plot and histogram are helpful visualizations for identifying skew.↩ Character counts for individual emails.↩ Another definition of mode, which is not typically used in statistics, is the value with the most occurrences. It is common to have no observations with the same value in a data set, which makes this other definition useless for many real data sets.↩ Unimodal. Remember that uni stands for 1 (think unicycles). Similarly, bi stands for 2 (think bicycles). (We’re hoping a multicycle will be invented to complete this analogy.)↩ There might be two height groups visible in the data set: one of the students and one of the adults. That is, the data are probably bimodal.↩ The only difference is that the population variance has a division by \\(n\\) instead of \\(n-1\\).↩ Figure [severalDiffDistWithSdOf1] shows three distributions that look quite different, but all have the same mean, variance, and standard deviation. Using modality, we can distinguish between the first plot (bimodal) and the last two (unimodal). Using skewness, we can distinguish between the last plot (right skewed) and the first two. While a picture, like a histogram, tells a more complete story, we can use modality and shape (symmetry/skew) to characterize basic information about a distribution.↩ Since \\(Q_1\\) and \\(Q_3\\) capture the middle 50% of the data and the median splits the data in the middle, 25% of the data fall between \\(Q_1\\) and the median, and another 25% falls between the median and \\(Q_3\\).↩ While the choice of exactly 1.5 is arbitrary, it is the most commonly used value for box plots.↩ That occasionally there may be very long emails.↩ These visual estimates will vary a little from one person to the next: \\(Q_1\\approx\\) 3,000, \\(Q_3\\approx\\) 15,000, $=Q_3 - Q_1 $ 12,000. (The true values: \\(Q_1=\\) 2,536, \\(Q_3=\\) 15,411, $ = $ 12,875.)↩ (a) Mean is affected more. (b) Standard deviation is affected more. Complete explanations are provided in the material following Guided Practice [numCharWhichIsMoreRobust].↩ Buyers of a “regular car” should be concerned about the median price. High-end car sales can drastically inflate the mean price while the median will be more robust to the influence of those sales.↩ Statisticians often write the natural logarithm as \\(\\log\\). You might be more familiar with it being written as \\(\\ln\\).↩ Note: answers will vary. There is a very strong correspondence between high earning and metropolitan areas. You might look for large cities you are familiar with and try to spot them on the map as dark spots.↩ 0.458 represents the proportion of spam emails that had a small number. 0.058 represents the fraction of emails with small numbers that are spam.↩ 0.139 represents the fraction of non-spam email that had a big number. 0.908 represents the fraction of emails with big numbers that are non-spam emails.↩ The column proportions in Table [colPropSpamNumber] will probably be most useful, which makes it easier to see that emails with small numbers are spam about 5.9% of the time (relatively rare). We would also see that about 27.1% of emails with no numbers are spam, and 9.2% of emails with big numbers are spam.↩ Answers may vary a little. The counties with population gains tend to have higher income (median of about $45,000) versus counties without a gain (median of about $40,000). The variability is also slightly larger for the population gain group. This is evident in the IQR, which is about 50% bigger in the gain group. Both distributions show slight to moderate right skew and are unimodal. There is a secondary small bump at about $60,000 for the no gain group, visible in the hollow histogram plot, that seems out of place. (Looking into the data set, we would find that 8 of these 15 counties are in Alaska and Texas.) The box plots indicate there are many observations far above the median in each group, though we should anticipate that many observations will fall beyond the whiskers when using such a large data set.↩ Answers will vary. The side-by-side box plots are especially useful for comparing centers and spreads, while the hollow histograms are more useful for seeing distribution shape, skew, and groups of anomalies.↩ "],
["FoundationForInference.html", "Chapter 3 Foundation for inference 3.1 Randomization case study: gender discrimination 3.2 Randomization case study: opportunity cost 3.3 Hypothesis testing 3.4 Simulation case studies 3.5 Central Limit Theorem 3.6 Normal distribution 3.7 Applying the normal model 3.8 Confidence intervals", " Chapter 3 Foundation for inference Example 2.1 Suppose your professor splits the students in class into two groups: students on the left and students on the right. If \\(\\hat{p}_{_L}\\) and \\(\\hat{p}_{_R}\\) represent the proportion of students who own an Apple product on the left and right, respectively, would you be surprised if \\(\\hat{p}_{_L}\\) did not exactly equal \\(\\hat{p}_{_R}\\)? While the proportions would probably be close to each other, they are probably not exactly the same. We would probably observe a small difference due to chance. Guided Practice 2.1 If we don’t think the side of the room a person sits on in class is related to whether the person owns an Apple product, what assumption are we making about the relationship between these two variables?47 Studying randomness of this form is a key focus of statistics. In this chapter, we’ll explore this type of randomness in the context of several applications, and we’ll learn new tools and ideas that will be applied throughout the rest of the book. 3.1 Randomization case study: gender discrimination We consider a study investigating gender discrimination in the 1970s, which is set in the context of personnel decisions within a bank.48 The research question we hope to answer is, “Are females discriminated against in promotion decisions made by male managers?” 3.1.1 Variability within data The participants in this study were 48 male bank supervisors attending a management institute at the University of North Carolina in 1972. They were asked to assume the role of the personnel director of a bank and were given a personnel file to judge whether the person should be promoted to a branch manager position. The files given to the participants were identical, except that half of them indicated the candidate was male and the other half indicated the candidate was female. These files were randomly assigned to the subjects. Guided Practice 2.1 Is this an observational study or an experiment? How does the type of study impact what can be inferred from the results?49 For each supervisor we recorded the gender associated with the assigned file and the promotion decision. Using the results of the study summarized in Table @ref(tab:discriminationResults], we would like to evaluate if females are unfairly discriminated against in promotion decisions. In this study, a smaller proportion of females are promoted than males (0.583 versus 0.875), but it is unclear whether the difference provides convincing evidence that females are unfairly discriminated against. l l cc rr &amp; &amp; &amp; &amp; promoted &amp; not promoted &amp; Total &amp; &amp; male &amp; 21 &amp; 3 &amp; 24 [0pt]gender &amp; female &amp; 14 &amp; 10 &amp; 24 &amp; Total &amp; 35 &amp; 13 &amp; 48 [discriminationResults] Example 2.4 Statisticians are sometimes called upon to evaluate the strength of evidence. When looking at the rates of promotion for males and females in this study, why might we be tempted to immediately conclude that females are being discriminated against? The large difference in promotion rates (58.3% for females versus 87.5% for males) suggest there might be discrimination against women in promotion decisions. However, we cannot yet be sure if the observed difference represents discrimination or is just from random chance. Generally there is a little bit of fluctuation in sample data, and we wouldn’t expect the sample proportions to be exactly equal, even if the truth was that the promotion decisions were independent of gender. Example 2.4 is a reminder that the observed outcomes in the sample may not perfectly reflect the true relationships between variables in the underlying population. Table @ref(tab:discriminationResults] shows there were 7 fewer promotions in the female group than in the male group, a difference in promotion rates of 29.2% \\(\\left( \\frac{21}{24} - \\frac{14}{24} = 0.292 \\right)\\). This observed difference is what we call a point estimate of the true effect. The point estimate of the difference is large, but the sample size for the study is small, making it unclear if this observed difference represents discrimination or whether it is simply due to chance. We label these two competing claims, \\(H_0\\) and \\(H_A\\): \\(H_0\\): Null hypothesis. The variables gender and decision are independent. They have no relationship, and the observed difference between the proportion of males and females who were promoted, 29.2%, was due to chance. \\(H_A\\): Alternative hypothesis. The variables gender and decision are not independent. The difference in promotion rates of 29.2% was not due to chance, and equally qualified females are less likely to be promoted than males. Hypothesis Testing These hypotheses are part of what is called a hypothesis test. A hypothesis test is a statistical technique used to evaluate competing claims using data. Often times, the null hypothesis takes a stance of no difference or no effect. If the null hypothesis and the data notably disagree, then we will reject the null hypothesis in favor of the alternative hypothesis. Don’t worry if you aren’t a master of hypothesis testing at the end of this section. We’ll discuss these ideas and details many times in this chapter. What would it mean if the null hypothesis, which says the variables gender and decision are unrelated, is true? It would mean each banker would decide whether to promote the candidate without regard to the gender indicated on the file. That is, the difference in the promotion percentages would be due to the way the files were randomly divided to the bankers, and the randomization just happened to give rise to a relatively large difference of 29.2%. Consider the alternative hypothesis: bankers were influenced by which gender was listed on the personnel file. If this was true, and especially if this influence was substantial, we would expect to see some difference in the promotion rates of male and female candidates. If this gender bias was against females, we would expect a smaller fraction of promotion recommendations for female personnel files relative to the male files. We will choose between these two competing claims by assessing if the data conflict so much with \\(H_0\\) that the null hypothesis cannot be deemed reasonable. If this is the case, and the data support \\(H_A\\), then we will reject the notion of independence and conclude that these data provide strong evidence of discrimination. 3.1.2 Simulating the study Table ?? shows that 35 bank supervisors recommended promotion and 13 did not. Now, suppose the bankers’ decisions were independent of gender. Then, if we conducted the experiment again with a different random assignment of files, differences in promotion rates would be based only on random fluctuation. We can actually perform this randomization, which simulates what would have happened if the bankers’ decisions had been independent of gender but we had distributed the files differently.50 In this simulation, we thoroughly shuffle 48 personnel files, 24 labeled and 24 labeled , and deal these files into two stacks. We will deal 35 files into the first stack, which will represent the 35 supervisors who recommended promotion. The second stack will have 13 files, and it will represent the 13 supervisors who recommended against promotion. Then, as we did with the original data, we tabulate the results and determine the fraction of and who were promoted. Since the randomization of files in this simulation is independent of the promotion decisions, any difference in the two fractions is entirely due to chance. Table ?? show the results of such a simulation. l l cc rr &amp; &amp; &amp; &amp; promoted &amp; not promoted &amp; Total &amp; &amp; male &amp; 18 &amp; 6 &amp; 24 [0pt] &amp; female &amp; 17 &amp; 7 &amp; 24 &amp; Total &amp; 35 &amp; 13 &amp; 48 [discriminationRand1] Guided Practice 2.5 What is the difference in promotion rates between the two simulated groups in Table ??? How does this compare to the observed difference 29.2% from the actual study?51 3.1.3 Checking for independence We computed one possible difference under the null hypothesis in Guided Practice 2.5, which represents one difference due to chance. While in this first simulation, we physically dealt out files, it is much more efficient to perform this simulation using a computer. Repeating the simulation on a computer, we get another difference due to chance: -0.042. And another: 0.208. And so on until we repeat the simulation enough times that we have a good idea of what represents the distribution of differences from chance alone. Figure 3.1 shows a plot of the differences found from 100 simulations, where each dot represents a simulated difference between the proportions of male and female files recommended for promotion. Figure 3.1: A stacked dot plot of differences from 100 simulations produced under the null hypothesis, \\(H_0\\), where and decision are independent. Two of the 100 simulations had a difference of at least 29.2%, the difference observed in the study, and are shown as solid dots. Note that the distribution of these simulated differences is centered around 0. Because we simulated differences in a way that made no distinction between men and women, this makes sense: we should expect differences from chance alone to fall around zero with some random fluctuation for each simulation. Example 2.6 How often would you observe a difference of at least 29.2% (0.292) according to Figure 3.1? Often, sometimes, rarely, or never? It appears that a difference of at least 29.2% due to chance alone would only happen about 2% of the time according to Figure 3.1. Such a low probability indicates that observing such a large difference from chance is rare. The difference of 29.2% is a rare event if there really is no impact from listing gender in the candidates’ files, which provides us with two possible interpretations of the study results: \\(H_0\\): Null hypothesis. Gender has no effect on promotion decision, and we observed a difference that is so large that it would only happen rarely. \\(H_A\\): Alternative hypothesis. Gender has an effect on promotion decision, and what we observed was actually due to equally qualified women being discriminated against in promotion decisions, which explains the large difference of 29.2%. When we conduct formal studies, we reject a skeptical position if the data strongly conflict with that position.52 In our analysis, we determined that there was only a $$2% probability of obtaining a sample where $$29.2% more males than females get promoted by chance alone, so we conclude the data provide strong evidence of gender discrimination against women by the supervisors. In this case, we reject the null hypothesis in favor of the alternative. Statistical inference is the practice of making decisions and conclusions from data in the context of uncertainty. Errors do occur, just like rare events, and the data set at hand might lead us to the wrong conclusion. While a given data set may not always lead us to a correct conclusion, statistical inference gives us tools to control and evaluate how often these errors occur. Before getting into the nuances of hypothesis testing, let’s work through another case study. 3.2 Randomization case study: opportunity cost How rational and consistent is the behavior of the typical American college student? In this section, we’ll explore whether college student consumers always consider an obvious fact: money not spent now can be spent later. In particular, we are interested in whether reminding students about this well-known fact about money causes them to be a little thriftier. A skeptic might think that such a reminder would have no impact. We can summarize these two perspectives using the null and alternative hypothesis framework. \\(H_0\\): Null hypothesis. Reminding students that they can save money for later purchases will not have any impact on students’ spending decisions. \\(H_A\\): Alternative hypothesis. Reminding students that they can save money for later purchases will reduce the chance they will continue with a purchase. In this section, we’ll explore an experiment conducted by researchers that investigates this very question for students at a university in the southwestern United States.53 3.2.1 Exploring the data set before the analysis One-hundred and fifty students were recruited for the study, and each was given the following statement: Imagine that you have been saving some extra money on the side to make some purchases, and on your most recent visit to the video store you come across a special sale on a new video. This video is one with your favorite actor or actress, and your favorite type of movie (such as a comedy, drama, thriller, etc.). This particular video that you are considering is one you have been thinking about buying for a long time. It is available for a special sale price of $14.99. What would you do in this situation? Please circle one of the options below. Half of the 150 students were randomized into a control group and were given the following two options: (A) Buy this entertaining video. (B) Not buy this entertaining video. The remaining 75 students were placed in the treatment group, and they saw a slightly modified option (B): (A) Buy this entertaining video. (B) Not buy this entertaining video. Keep the $14.99 for other purchases. Would the extra statement reminding students of an obvious fact impact the purchasing decision? Table @ref(tab:OpportunityCostTable] summarizes the study results. l cc rr &amp; &amp; buy DVD &amp; not buy DVD &amp; Total &amp; control group &amp; 56 &amp; 19 &amp; 75 treatment group &amp; 41 &amp; 34 &amp; 75 Total &amp; 97 &amp; 53 &amp; 150 [OpportunityCostTable] It might be a little easier to review the results using row proportions, specifically considering the proportion of participants in each group who said they would buy or not buy the DVD. These summaries are given in Table @ref(tab:OpportunityCostTableRowProp]. l cc rr &amp; &amp; buy DVD &amp; not buy DVD &amp; Total &amp; control group &amp; 0.747 &amp; 0.253 &amp; 1.000 treatment group &amp; 0.547 &amp; 0.453 &amp; 1.000 Total &amp; 0.647 &amp; 0.353 &amp; 1.000 [OpportunityCostTableRowProp] We will define a success in this study as a student who chooses not to buy the DVD.54 Then, the value of interest is the change in DVD purchase rates that results by reminding students that not spending money now means they can spend the money later. We can construct a point estimate for this difference as \\[\\begin{aligned} \\hat{p}_{trmt} - \\hat{p}_{ctrl} = \\frac{34}{75} - \\frac{19}{75} = 0.453 - 0.253 = 0.200\\end{aligned}\\] The proportion of students who chose not to buy the DVD was 20% higher in the treatment group than the control group. However, is this result statistically significant? In other words, is a 20% difference between the two groups so prominent that it is unlikely to have occurred from chance alone? 3.2.2 Results from chance alone The primary goal in this data analysis is to understand what sort of differences we might see if the null hypothesis were true, i.e. the treatment had no effect on students. For this, we’ll use the same procedure we applied in Section 3.1: randomization. Let’s think about the data in the context of the hypotheses. If the null hypothesis (\\(H_0\\)) was true and the treatment had no impact on student decisions, then the observed difference between the two groups of 20% could be attributed entirely to chance. If, on the other hand, the alternative hypothesis (\\(H_A\\)) is true, then the difference indicates that reminding students about saving for later purchases actually impacts their buying decisions. Just like with the gender discrimination study, we can perform a statistical analysis. Using the same randomization technique from the last section, let’s see what happens when we simulate the experiment under the scenario where there is no effect from the treatment. While we would in reality do this simulation on a computer, it might be useful to think about how we would go about carrying out the simulation without a computer. We start with 150 index cards and label each card to indicate the distribution of our response variable: decision. That is, 53 cards will be labeled “not buy DVD” to represent the 53 students who opted not to buy, and 97 will be labeled “buy DVD” for the other 97 students. Then we shuffle these cards throughly and divide them into two stacks of size 75, representing the simulated treatment and control groups. Any observed difference between the proportions of “not buy DVD” cards (what we earlier defined as success) can be attributed entirely to chance. Example 2.7 If we are randomly assigning the cards into the simulated treatment and control groups, how many “not buy DVD” cards would we expect to end up with in each simulated group? What would be the expected difference between the proportions of “not buy DVD” cards in each group? Answer: Since the simulated groups are of equal size, we would expect \\(53 / 2 = 26.5\\), i.e. 26 or 27, “not buy DVD” cards in each simulated group, yielding a simulated point estimate of 0%. However, due to random fluctuations, we might actually observe a number a little above or below 26 and 27. The results of a randomization from chance alone is shown in Table ??. From this table, we can compute a difference that occurred from chance alone: \\[\\begin{aligned} \\hat{p}_{trmt, simulated} - \\hat{p}_{ctrl, simulated} = \\frac{24}{75} - \\frac{29}{75} = 0.32 - 0.387 = - 0.067\\end{aligned}\\] l cc rr &amp; &amp; buy DVD &amp; not buy DVD &amp; Total &amp; simulated-control group &amp; 46 &amp; 29 &amp; 75 simulated-treatment group &amp; 51 &amp; 24 &amp; 75 Total &amp; 97 &amp; 53 &amp; 150 [OpportunityCostTableSimulated] Just one simulation will not be enough to get a sense of what sorts of differences would happen from chance alone. We’ll simulate another set of simulated groups and compute the new difference: 0.013. And again: 0.067. And again: -0.173. We’ll do this 1,000 times. The results are summarized in a dot plot in Figure 3.2, where each point represents a simulation. Since there are so many points, it is more convenient to summarize the results in a histogram such as the one in Figure 3.3, where the height of each histogram bar represents the fraction of observations in that group. Figure 3.2: A stacked dot plot of 1,000 chance differences produced under the null hypothesis, \\(H_0\\). Six of the 1,000 simulations had a difference of at least 20%, which was the difference observed in the study. Figure 3.3: A histogram of 1,000 chance differences produced under the null hypothesis, \\(H_0\\). Histograms like this one are a more convenient representation of data or results when there are a large number of observations. If there was no treatment effect, then we’d only observe a difference of at least +20% about 0.6% of the time, or about 1-in-150 times. That is really rare! Instead, we will conclude the data provide strong evidence there is a treatment effect: reminding students before a purchase that they could instead spend the money later on something else lowers the chance that they will continue with the purchase. Notice that we are able to make a causal statement for this study since the study is an experiment. 3.3 Hypothesis testing In the last two sections, we utilized a hypothesis test, which is a formal technique for evaluating two competing possibilities. In each scenario, we described a null hypothesis, which represented either a skeptical perspective or a perspective of no difference. We also laid out an alternative hypothesis, which represented a new perspective such as the possibility that there has been a change or that there is a treatment effect in an experiment. Null and alternative hypotheses The null hypothesis (\\(H_0\\)) often represents either a skeptical perspective or a claim to be tested. The alternative hypothesis (\\(H_A\\)) represents an alternative claim under consideration and is often represented by a range of possible values for the value of interest. The hypothesis testing framework is a very general tool, and we often use it without a second thought. If a person makes a somewhat unbelievable claim, we are initially skeptical. However, if there is sufficient evidence that supports the claim, we set aside our skepticism. The hallmarks of hypothesis testing are also found in the US court system. 3.3.1 Hypothesis testing in the US court system Example 2.8 A US court considers two possible claims about a defendant: she is either innocent or guilty. If we set these claims up in a hypothesis framework, which would be the null hypothesis and which the alternative? The jury considers whether the evidence is so convincing (strong) that there is no reasonable doubt regarding the person’s guilt. That is, the skeptical perspective (null hypothesis) is that the person is innocent until evidence is presented that convinces the jury that the person is guilty (alternative hypothesis). Jurors examine the evidence to see whether it convincingly shows a defendant is guilty. Notice that if a jury finds a defendant not guilty, this does not necessarily mean the jury is confident in the person’s innocence. They are simply not convinced of the alternative that the person is guilty. This is also the case with hypothesis testing: even if we fail to reject the null hypothesis, we typically do not accept the null hypothesis as truth. Failing to find strong evidence for the alternative hypothesis is not equivalent to providing evidence that the null hypothesis is true. 3.3.2 p-value and statistical significance In Section 3.1 we encountered a study from the 1970’s that explored whether there was strong evidence that women were less likely to be promoted than men. The research question – are females discriminated against in promotion decisions made by male managers? – was framed in the context of hypotheses: \\(H_0\\): Gender has no effect on promotion decisions. \\(H_A\\): Women are discriminated against in promotion decisions. The null hypothesis (\\(H_0\\)) was a perspective of no difference. The data, summarized on page , provided a point estimate of a 29.2% difference in recommended promotion rates between men and women. We determined that such a difference from chance alone would be rare: it would only happen about 2 in 100 times. When results like these are inconsistent with \\(H_0\\), we reject \\(H_0\\) in favor of \\(H_A\\). Here, we concluded there was discrimination against women. The 2-in-100 chance is what we call a p-value, which is a probability quantifying the strength of the evidence against the null hypothesis and in favor of the alternative. p-value The p-value is the probability of observing data at least as favorable to the alternative hypothesis as our current data set, if the null hypothesis were true. We typically use a summary statistic of the data, such as a difference in proportions, to help compute the p-value and evaluate the hypotheses. This summary value that is used to compute the p-value is often called the test statistic. Example 2.9 In the gender discrimination study, the difference in discrimination rates was our test statistic. What was the test statistic in the opportunity cost study covered in Section 3.2? The test statistic in the opportunity cost study was the difference in the proportion of students who decided against the DVD purchase in the treatment and control groups. In each of these examples, the of the difference in proportions was used as the test statistic. When the p-value is small, i.e. less than a previously set threshold, we say the results are statistically significant. This means the data provide such strong evidence against \\(H_0\\) that we reject the null hypothesis in favor of the alternative hypothesis. The threshold, called the significance level and often represented by \\(\\alpha\\) (the Greek letter alpha), is typically set to \\(\\alpha = 0.05\\), but can vary depending on the field or the application. Using a significance level of \\(\\alpha = 0.05\\) in the discrimination study, we can say that the data provided statistically significant evidence against the null hypothesis. Statistical significance We say that the data provide statistically significant evidence against the null hypothesis if the p-value is less than some reference value, usually \\(\\alpha=0.05\\). ** Example 2.10** In the opportunity cost study in Section 3.2, we analyzed an experiment where study participants were 20% less likely to continue with a DVD purchase if they were reminded that the money, if not spent on the DVD, could be used for other purchases in the future. We determined that such a large difference would only occur about 1-in-150 times if the reminder actually had no influence on student decision-making. What is the p-value in this study? Was the result statistically significant? The p-value was 0.006 (about 1/150). Since the p-value is less than 0.05, the data provide statistically significant evidence that US college students were actually influenced by the reminder. What’s so special about 0.05? We often use a threshold of 0.05 to determine whether a result is statistically significant. But why 0.05? Maybe we should use a bigger number, or maybe a smaller number. If you’re a little puzzled, that probably means you’re reading with a critical eye – good job! We’ve made a video to help clarify why 0.05: www.openintro.org/why05 Sometimes it’s also a good idea to deviate from the standard. We’ll discuss when to choose a threshold different than 0.05 in Section 3.3.4. 3.3.3 Decision errors Hypothesis tests are not flawless. Just think of the court system: innocent people are sometimes wrongly convicted and the guilty sometimes walk free. Similarly, data can point to the wrong conclusion. However, what distinguishes statistical hypothesis tests from a court system is that our framework allows us to quantify and control how often the data lead us to the incorrect conclusion. There are two competing hypotheses: the null and the alternative. In a hypothesis test, we make a statement about which one might be true, but we might choose incorrectly. There are four possible scenarios in a hypothesis test, which are summarized in Table @ref(tab:fourHTScenarios]. l l c c c &amp; &amp; &amp; &amp; do not reject \\(H_0\\) &amp; reject \\(H_0\\) in favor of \\(H_A\\) &amp; &amp; \\(H_0\\) true &amp; okay &amp; Type 1 Error &amp; \\(H_A\\) true &amp; Type 2 Error &amp; okay [fourHTScenarios] A Type 1 Error is rejecting the null hypothesis when \\(H_0\\) is actually true. Since we rejected the null hypothesis in the gender discrimination and opportunity cost studies, it is possible that we made a Type 1 Error in one or both of those studies. A Type 2 Error is failing to reject the null hypothesis when the alternative is actually true. In a US court, the defendant is either innocent (\\(H_0\\)) or guilty (\\(H_A\\)). What does a Type 1 Error represent in this context? What does a Type 2 Error represent? Table @ref(tab:fourHTScenarios] may be useful. If the court makes a Type 1 Error, this means the defendant is innocent (\\(H_0\\) true) but wrongly convicted. A Type 2 Error means the court failed to reject \\(H_0\\) (i.e. failed to convict the person) when she was in fact guilty (\\(H_A\\) true). Consider the opportunity cost study where we concluded students were less likely to make a DVD purchase if they were reminded that money not spent now could be spent later. What would a Type 1 Error represent in this context?55 How could we reduce the Type 1 Error rate in US courts? What influence would this have on the Type 2 Error rate? To lower the Type 1 Error rate, we might raise our standard for conviction from “beyond a reasonable doubt” to “beyond a conceivable doubt” so fewer people would be wrongly convicted. However, this would also make it more difficult to convict the people who are actually guilty, so we would make more Type 2 Errors. [howToReduceType2ErrorsInUSCourts] How could we reduce the Type 2 Error rate in US courts? What influence would this have on the Type 1 Error rate?56 The example and guided practice above provide an important lesson: if we reduce how often we make one type of error, we generally make more of the other type. 3.3.4 Choosing a significance level Choosing a significance level for a test is important in many contexts, and the traditional level is 0.05. However, it is sometimes helpful to adjust the significance level based on the application. We may select a level that is smaller or larger than 0.05 depending on the consequences of any conclusions reached from the test. If making a Type 1 Error is dangerous or especially costly, we should choose a small significance level (e.g. 0.01 or 0.001). Under this scenario, we want to be very cautious about rejecting the null hypothesis, so we demand very strong evidence favoring the alternative \\(H_A\\) before we would reject \\(H_0\\). If a Type 2 Error is relatively more dangerous or much more costly than a Type 1 Error, then we should choose a higher significance level (e.g. 0.10). Here we want to be cautious about failing to reject \\(H_0\\) when the null is actually false. The significance level selected for a test should reflect the real-world consequences associated with making a Type 1 or Type 2 Error. 3.3.5 Introducing two-sided hypotheses So far we have explored whether women were discriminated against and whether a simple trick could make students a little thriftier. In these two case studies, we’ve actually ignored some possibilities: What if men are actually discriminated against? What if the money trick actually makes students spend more? These possibilities weren’t considered in our hypotheses or analyses. This may have seemed natural since the data pointed in the directions in which we framed the problems. However, there are two dangers if we ignore possibilities that disagree with our data or that conflict with our worldview: Framing an alternative hypothesis simply to match the direction that the data point will generally inflate the Type 1 Error rate. After all the work we’ve done (and will continue to do) to rigorously control the error rates in hypothesis tests, careless construction of the alternative hypotheses can disrupt that hard work. We’ll explore this topic further in Section [InflatingType1ErrorRate]. If we only use alternative hypotheses that agree with our worldview, then we’re going to be subjecting ourselves to confirmation bias, which means we are looking for data that supports our ideas. That’s not very scientific, and we can do better! The previous hypotheses we’ve seen are called one-sided hypothesis tests because they only explored one direction of possibilities. Such hypotheses are appropriate when we are exclusively interested in the single direction, but usually we want to consider all possibilities. To do so, let’s learn about two-sided hypothesis tests in the context of a new study that examines the impact of using blood thinners on patients who have undergone CPR. Cardiopulmonary resuscitation (CPR) is a procedure used on individuals suffering a heart attack when other emergency resources are unavailable. This procedure is helpful in providing some blood circulation to keep a person alive, but CPR chest compressions can also cause internal injuries. Internal bleeding and other injuries that can result from CPR complicate additional treatment efforts. For instance, blood thinners may be used to help release a clot that is causing the heart attack once a patient arrives in the hospital. However, blood thinners negatively affect internal injuries. Here we consider an experiment with patients who underwent CPR for a heart attack and were subsequently admitted to a hospital.57 Each patient was randomly assigned to either receive a blood thinner (treatment group) or not receive a blood thinner (control group). The outcome variable of interest was whether the patient survived for at least 24 hours. Form hypotheses for this study in plain and statistical language. Let \\(p_c\\) represent the true survival rate of people who do not receive a blood thinner (corresponding to the control group) and \\(p_t\\) represent the survival rate for people receiving a blood thinner (corresponding to the treatment group). [hypothesesForCPRStudyInSmallSampleSection] We want to understand whether blood thinners are helpful or harmful. We’ll consider both of these possibilities using a two-sided hypothesis test. Blood thinners do not have an overall survival effect, i.e. the survival proportions are the same in each group. \\(p_t - p_c = 0\\). Blood thinners have an impact on survival, either positive or negative, but not zero. \\(p_t - p_c \\neq 0\\). There were 50 patients in the experiment who did not receive a blood thinner and 40 patients who did. The study results are shown in Table @ref(tab:resultsForCPRStudyInSmallSampleSection]. Results for the CPR study. Patients in the treatment group were given a blood thinner, and patients in the control group were not. Survived Died Total Control 11 39 50 Treatment 14 26 40 Total 25 65 90 [resultsForCPRStudyInSmallSampleSection] What is the observed survival rate in the control group? And in the treatment group? Also, provide a point estimate of the difference in survival proportions of the two groups: \\(\\hat{p}_t - \\hat{p}_c\\). 58 According to the point estimate, for patients who have undergone CPR outside of the hospital, an additional 13% of these patients survive when they are treated with blood thinners. However, we wonder if this difference could be easily explainable by chance. As we did in our past two studies this chapter, we will simulate what type of differences we might see from chance alone under the null hypothesis. By randomly assigning “simulated treatment” and “simulated control” stickers to the patients’ files, we get a new grouping. If we repeat this simulation 10,000 times, we can build a null distribution of the differences shown in Figure @ref(fig:CPRstudyrighttail]. Null distribution of the point estimate, \\(\\hat{p}_t - \\hat{p}_c\\). The shaded right tail shows observations that are at least as large as the observed difference, 0.13. [CPRstudyrighttail] The right tail area is about 0.13. (Note: it is only a coincidence that we also have \\(\\hat{p}_t - \\hat{p}_c=0.13\\).) However, contrary to how we calculated the p-value in previous studies, the p-value of this test is not 0.13! The p-value is defined as the chance we observe a result at least as favorable to the alternative hypothesis as the result (i.e. the difference) we observe. In this case, any differences less than or equal to -0.13 would also provide equally strong evidence favoring the alternative hypothesis as a difference of 0.13. A difference of -0.13 would correspond to 13% higher survival rate in the control group than the treatment group. In Figure @ref(fig:CPRstudypvalue] we’ve also shaded these differences in the left tail of the distribution. These two shaded tails provide a visual representation of the p-value for a two-sided test. Null distribution of the point estimate, \\(\\hat{p}_t - \\hat{p}_c\\). All values that are at least as extreme as +0.13 but in either direction away from 0 are shaded. [CPRstudypvalue] For a two-sided test, take the single tail (in this case, 0.13) and double it to get the p-value: 0.26. Since this p-value is larger than 0.05, we do not reject the null hypothesis. That is, we do not find statistically significant evidence that the blood thinner has any influence on survival of patients who undergo CPR prior to arriving at the hospital. We want to be rigorous and keep an open mind when we analyze data and evidence. Use a one-sided hypothesis test only if you truly have interest in only one direction. First compute the p-value for one tail of the distribution, then double that value to get the two-sided p-value. That’s it! 3.3.6 Controlling the Type 1 Error rate It is never okay to change two-sided tests to one-sided tests after observing the data. We explore the consequences of ignoring this advice in the next example. Using \\(\\alpha=0.05\\), we show that freely switching from two-sided tests to one-sided tests will lead us to make twice as many Type 1 Errors as intended. [swappingHypAfterDataDoublesType1ErrorRate] Suppose we are interested in finding any difference from 0. We’ve created a smooth-looking null distribution representing differences due to chance in Figure @ref(fig:type1ErrorDoublingExampleFigure]. The shaded regions represent areas where we would reject \\(H_0\\) under the bad practices considered in Example [swappingHypAfterDataDoublesType1ErrorRate] when \\(\\alpha = 0.05\\). [type1ErrorDoublingExampleFigure] Suppose the sample difference was larger than 0. Then if we can flip to a one-sided test, we would use \\(H_A\\): difference \\(&gt; 0\\). Now if we obtain any observation in the upper 5% of the distribution, we would reject \\(H_0\\) since the p-value would just be a the single tail. Thus, if the null hypothesis is true, we incorrectly reject the null hypothesis about 5% of the time when the sample mean is above the null value, as shown in Figure @ref(fig:type1ErrorDoublingExampleFigure]. Suppose the sample difference was smaller than 0. Then if we change to a one-sided test, we would use \\(H_A\\): difference \\(&lt; 0\\). If the observed difference falls in the lower 5% of the figure, we would reject \\(H_0\\). That is, if the null hypothesis is true, then we would observe this situation about 5% of the time. By examining these two scenarios, we can determine that we will make a Type 1 Error \\(5\\%+5\\%=10\\%\\) of the time if we are allowed to swap to the “best” one-sided test for the data. This is twice the error rate we prescribed with our significance level: \\(\\alpha=0.05\\) (!). Hypothesis tests should be set up before seeing the data After observing data, it is tempting to turn a two-sided test into a one-sided test. Avoid this temptation. Hypotheses should be set up before observing the data. 3.3.7 How to use a hypothesis test Frame the research question in terms of hypotheses. Hypothesis tests are appropriate for research questions that can be summarized in two competing hypotheses. The null hypothesis (\\(H_0\\)) usually represents a skeptical perspective or a perspective of no difference. The alternative hypothesis (\\(H_A\\)) usually represents a new view or a difference. Collect data with an observational study or experiment. If a research question can be formed into two hypotheses, we can collect data to run a hypothesis test. If the research question focuses on associations between variables but does not concern causation, we would run an observational study. If the research question seeks a causal connection between two or more variables, then an experiment should be used. Analyze the data. Choose an analysis technique appropriate for the data and identify the p-value. So far, we’ve only seen one analysis technique: randomization. Throughout the rest of this textbook, we’ll encounter several new methods suitable for many other contexts. Form a conclusion. Using the p-value from the analysis, determine whether the data provide statistically significant evidence against the null hypothesis. Also, be sure to write the conclusion in plain language so casual readers can understand the results. 3.4 Simulation case studies Randomization is a statistical technique suitable for evaluating whether a difference in sample proportions is due to chance. In this section, we explore the situation where we focus on a single proportion, and we introduce a new simulation method. 3.4.1 Medical consultant People providing an organ for donation sometimes seek the help of a special medical consultant. These consultants assist the patient in all aspects of the surgery, with the goal of reducing the possibility of complications during the medical procedure and recovery. Patients might choose a consultant based in part on the historical complication rate of the consultant’s clients. One consultant tried to attract patients by noting the average complication rate for liver donor surgeries in the US is about 10%, but her clients have had only 3 complications in the 62 liver donor surgeries she has facilitated. She claims this is strong evidence that her work meaningfully contributes to reducing complications (and therefore she should be hired!). We will let \\(p\\) represent the true complication rate for liver donors working with this consultant. Estimate \\(p\\) using the data, and label this value \\(\\hat{p}\\). The sample proportion for the complication rate is 3 complications divided by the 62 surgeries the consultant has worked on: \\(\\hat{p} = 3/62 = 0.048\\). Is it possible to assess the consultant’s claim using the data? No. The claim is that there is a causal connection, but the data are observational. For example, maybe patients who can afford a medical consultant can afford better medical care, which can also lead to a lower complication rate. While it is not possible to assess the causal claim, it is still possible to test for an association using these data. For this question we ask, could the low complication rate of \\(\\hat{p} = 0.048\\) be due to chance? We’re going to conduct a hypothesis test for this setting. Should the test be one-sided or two-sided? The setting has been framed in the context of the consultant being helpful, but what if the consultant actually performed worse than the average? Would we care? More than ever! Since we care about a finding in either direction, we should run a two-sided test. [hypForAssessingConsultantWorkInLiverTransplants] Write out hypotheses in both plain and statistical language to test for the association between the consultant’s work and the true complication rate, \\(p\\), for this consultant’s clients.59 A parameter for a hypothesis test is the “true” value of interest. We typically estimate the parameter using a point estimate from a sample of data. For example, we estimate the probability \\(p\\) of a complication for a client of the medical consultant by examining the past complications rates of her clients: \\[\\begin{aligned} \\hat{p} = 3 / 62 = 0.048\\qquad\\text{is used to estimate}\\qquad p\\end{aligned}\\] The null value is the reference value for the parameter in \\(H_0\\), and it is sometimes represented with the parameter’s label with a subscript 0, e.g. \\(p_0\\) (just like \\(H_0\\)). In the medical consultant case study, the parameter is \\(p\\) and the null value is \\(p_0 = 0.10\\). We will use the p-value to quantify the possibility of a sample proportion (\\(\\hat{p}\\)) this far from the null value. The p-value is computed based on the null distribution, which is the distribution of the test statistic if the null hypothesis were true. Just like we did using randomization for a difference in proportions, here we can simulate 62 new patients to see what result might happen if the complication rate was 0.10. Each client can be simulated using a deck of cards. Take one red card, nine black cards, and mix them up. If the cards are well-shuffled, drawing the top card is one way of simulating the chance a patient has a complication if the true rate is 0.10: if the card is red, we say the patient had a complication, and if it is black then we say they did not have a complication. If we repeat this process 62 times and compute the proportion of simulated patients with complications, \\(\\hat{p}_{sim}\\), then this simulated proportion is exactly a draw from the null distribution. In a simulation of 62 patients, about how many would we expect to have had a complication?60 We conducted such a simulation. There were 5 simulated cases with a complication and 57 simulated cases without a complication: \\(\\hat{p}_{sim} = 5/62 = 0.081\\). One simulation isn’t enough to get a sense of the null distribution, so we repeated the simulation 10,000 times using a computer. Figure @ref(fig:MedConsNullSim] shows the null distribution from these 10,000 simulations. The simulated proportions that are less than or equal to \\(\\hat{p}=0.048\\) are shaded. There were 1222 simulated sample proportions with \\(\\hat{p}_{sim} \\leq 0.048\\), which represents a fraction 0.1222 of our simulations: \\[\\begin{aligned} \\text{left tail } = \\frac{\\text{Number of observed simulations with }\\hat{p}_{sim}\\leq\\text{ 0.048}}{10000} = \\frac{1222}{10000} = 0.1222\\end{aligned}\\] However, this is not our p-value! Remember that we are conducting a two-sided test, so we should double the one-tail area to get the p-value:61 \\[\\begin{aligned} \\text{p-value} = 2 \\times \\text{left tail} = 2 \\times 0.1222 = 0.2444\\end{aligned}\\] The null distribution for \\(\\hat{p}\\), created from 10,000 simulated studies. The left tail contains 12.22% of the simulations. We double this value to get the p-value. [MedConsNullSim] [plainLanguageExplanationOfHTConclusionForLiverDonorSurgicalConsultant] Because the p-value is 0.2444, which is larger than the significance level 0.05, we do not reject the null hypothesis. Explain what this means in the context of the problem using plain language.62 Does the conclusion in Guided Practice [plainLanguageExplanationOfHTConclusionForLiverDonorSurgicalConsultant] imply there is no real association between the surgical consultant’s work and the risk of complications? Explain. No. It might be that the consultant’s work is associated with a lower or higher risk of complications. However, the data did not provide enough information to reject the null hypothesis. 3.4.2 Tappers and listeners Here’s a game you can try with your friends or family: pick a simple, well-known song, tap that tune on your desk, and see if the other person can guess the song. In this simple game, you are the tapper, and the other person is the listener. A Stanford University graduate student named Elizabeth Newton conducted an experiment using the tapper-listener game.63 In her study, she recruited 120 tappers and 120 listeners into the study. About 50% of the tappers expected that the listener would be able to guess the song. Newton wondered, is 50% a reasonable expectation? Newton’s research question can be framed into two hypotheses: The tappers are correct, and generally 50% of the time listeners are able to guess the tune. \\(p = 0.50\\) The tappers are incorrect, and either more than or less than 50% of listeners will be able to guess the tune. \\(p \\neq 0.50\\) In Newton’s study, only 3 out of 120 listeners (\\(\\hat{p} = 0.025\\)) were able to guess the tune! From the perspective of the null hypothesis, we might wonder, how likely is it that we would get this result from chance alone? That is, what’s the chance we would happen to see such a small fraction if \\(H_0\\) were true and the true correct-guess rate is 0.50? We will again use a simulation. To simulate 120 games under the null hypothesis where \\(p = 0.50\\), we could flip a coin 120 times. Each time the coin came up heads, this could represent the listener guessing correctly, and tails would represent the listener guessing incorrectly. For example, we can simulate 5 tapper-listener pairs by flipping a coin 5 times: H H T H T Correct Correct Wrong Correct Wrong After flipping the coin 120 times, we got 56 heads for \\(\\hat{p}_{sim} = 0.467\\). As we did with the randomization technique, seeing what would happen with one simulation isn’t enough. In order to evaluate whether our originally observed proportion of 0.025 is unusual or not, we should generate more simulations. Here we’ve repeated this simulation ten times: \\[\\begin{aligned} 0.558 \\quad 0.517 \\quad 0.467 \\quad 0.458 \\quad 0.525 \\quad 0.425 \\quad 0.458 \\quad 0.492 \\quad 0.550 \\quad 0.483\\end{aligned}\\] As before, we’ll run a total of 10,000 simulations using a computer. Figure @ref(fig:TappersAndListenersNullDistribution] shows the results of these simulations. Even in these 10,000 simulations, we don’t see any results close to 0.025. Results from 10,000 simulations of the tapper-listener study where guesses are correct half of the time. [TappersAndListenersNullDistribution] What is the p-value for the hypothesis test?64 Do the data provide statistically significant evidence against the null hypothesis? State an appropriate conclusion in the context of the research question.65 3.5 Central Limit Theorem We’ve encountered four case studies so far this chapter. While they differ in the settings, in their outcomes, and also in the technique we’ve used to analyze the data, they all have something in common: the general shape of the null distribution. 3.5.1 Null distribution from the case studies Figure @ref(fig:FourCaseStudies] shows the null distributions in each of the four case studies where we ran 10,000 simulations. In the case of the opportunity cost study, which originally had just 1,000 simulations, we’ve included an additional 9,000 simulations. The null distribution for each of the four case studies presented in Sections [caseStudyOpportunityCost]-[SimulationCaseStudies]. [FourCaseStudies] Describe the shape of the distributions and note anything that you find interesting.66 As we observed in Chapter [introductionToData], it’s common for distributions to be skewed or contain outliers. However, the null distributions we’ve so far encountered have all looked somewhat similar and, for the most part, symmetric. They all resemble a bell-shaped curve. This is not a coincidence, but rather, is guaranteed by mathematical theory. If we look at a proportion (or difference in proportions) and the scenario satisfies certain conditions, then the sample proportion (or difference in proportions) will appear to follow a bell-shaped curve called the normal distribution. An example of a perfect normal distribution is shown in Figure @ref(fig:simpleNormal]. Imagine laying a normal curve over each of the four null distributions in Figure @ref(fig:FourCaseStudies]. While the mean and standard deviation may change for each plot, the general shape remains roughly intact. A normal curve. [simpleNormal] Mathematical theory guarantees that a sample proportion or a difference in sample proportions will follow something that resembles a normal distribution when certain conditions are met. These conditions fall into two categories: Observations in the sample are independent. Independence is guaranteed when we take a random sample from a population. It can also be guaranteed if we randomly divide individuals into treatment and control groups. The sample is large enough. The sample size cannot be too small. What qualifies as “small” differs from one context to the next, and we’ll provide suitable guidelines for proportions in Chapter [inferenceForCategoricalData]. So far we’ve had no need for the normal distribution. We’ve been able to answer our questions somewhat easily using simulation techniques. However, soon this will change. Simulating data can be non-trivial. For example, some scenarios that we will encounter in Chapters [linRegrForTwoVar] and [multipleAndLogisticRegression] would require complex simulations. Instead, the normal distribution and other distributions like it offer a general framework that applies to a very large number of settings. 3.5.2 Examples of future settings we will consider Below we introduce three new settings where the normal distribution will be useful but constructing suitable simulations can be difficult. The opportunity cost study determined that students are thriftier if they are reminded that saving money now means they can spend the money later. The study’s point estimate for the estimated impact was 20%, meaning 20% fewer students would move forward with a DVD purchase in the study scenario. However, as we’ve learned, point estimates aren’t perfect – they only provide an approximation of the truth. It would be useful if we could provide a range of plausible values for the impact, more formally known as a confidence interval. It is often difficult to construct a reliable confidence interval in many situations using simulations.67 However, doing so is reasonably straightforward using the normal distribution. We’ll tackle this topic in Section [ConfidenceIntervals]. Book prices were collected for 73 courses at UCLA in Spring 2010. Data were collected from both the UCLA Bookstore and Amazon. The differences in these prices are shown in Figure @ref(fig:diffInTextbookPricesS10CLTsection]. The mean difference in the price of the books was $12.76, and we might wonder, does this provide strong evidence that the prices differ between the two book sellers? Here again we can apply the normal distribution, this time in the context of numerical data. We’ll explore this example and construct such a hypothesis test in Section [pairedData]. Histogram of the difference in price for each book sampled. These data are strongly skewed. [diffInTextbookPricesS10CLTsection] Elmhurst College in Illinois released anonymized data for family income and financial support provided by the school for Elmhurst’s first-year students in 2011. Figure @ref(fig:elmhurstScatterWLSROnlyCLTsection] shows a regression line fit to a scatterplot of a sample of the data. One question we will ask is, do the data show a real trend, or is the trend we observe reasonably explained by chance? In Chapter [linRegrForTwoVar] we’ll learn how to apply least squares regression to quantify the trend and quantify whether or not that trend can be explained by chance alone. For this case study, we could again use the normal distribution to help us answer this question. Gift aid and family income for a random sample of 50 first-year students from Elmhurst College, shown with a regression line. [elmhurstScatterWLSROnlyCLTsection] These examples highlight the value of the normal distribution approach. However, before we can apply the normal distribution to statistical inference, it is necessary to become familiar with the mechanics of the normal distribution. In Section [normalDist] we discuss characteristics of the normal distribution, explore examples of data that follow a normal distribution, and learn a new plotting technique that is useful for evaluating whether a data set roughly follows the normal distribution. In Sections [ApplyingTheNormalModel] and [ConfidenceIntervals], we apply this new knowledge in the context of hypothesis tests and confidence intervals. 3.6 Normal distribution Among all the distributions we see in statistics, one is overwhelmingly the most common. The symmetric, unimodal, bell curve is ubiquitous throughout statistics. It is so common that people often know it as the normal curve, normal model, or .68 Under certain conditions, sample proportions, sample means, and differences can be modeled using the normal distribution. Additionally, some variables such as SAT scores and heights of US adult males closely follow the normal distribution. Many summary statistics and variables are nearly normal, but none are exactly normal. Thus the normal distribution, while not perfect for any single problem, is very useful for a variety of problems. We will use it in data exploration and to solve important problems in statistics. In this section, we will discuss the normal distribution in the context of data to (1) become familiar with normal distribution techniques and (2) learn how to evaluate whether data are nearly normal. In Sections [ApplyingTheNormalModel]-[ConfidenceIntervals] and beyond, we’ll move our discussion to focus on applying the normal distribution and other related distributions to model point estimates for hypothesis tests and for constructing confidence intervals. 3.6.1 Normal distribution model The normal distribution always describes a symmetric, unimodal, bell-shaped curve. However, these curves can look different depending on the details of the model. Specifically, the normal model can be adjusted using two parameters: mean and standard deviation. As you can probably guess, changing the mean shifts the bell curve to the left or right, while changing the standard deviation stretches or constricts the curve. Figure @ref(fig:twoSampleNormals] shows the normal distribution with mean \\(0\\) and standard deviation \\(1\\) in the left panel and the normal distributions with mean \\(19\\) and standard deviation \\(4\\) in the right panel. Figure @ref(fig:twoSampleNormalsStacked] shows these distributions on the same axis. Both curves represent the normal distribution, however, they differ in their center and spread. The normal distribution with mean 0 and standard deviation 1 is called the standard normal distribution. [twoSampleNormals] [The normal models shown in Figure @ref(fig:twoSampleNormals] but plotted together and on the same scale.](02/figures/twoSampleNormalsStacked/twoSampleNormalsStacked) [twoSampleNormalsStacked] If a normal distribution has mean \\(\\mu\\) and standard deviation \\(\\sigma\\), we may write the distribution as \\(N(\\mu, \\sigma)\\)[ \\(N(\\mu, \\sigma)\\) Normal dist. with mean \\(\\mu\\) &amp; st. dev. \\(\\sigma\\)] \\(N(\\mu, \\sigma)\\) Normal dist. with mean \\(\\mu\\) &amp; st. dev. \\(\\sigma\\) . The two distributions in Figure @ref(fig:twoSampleNormalsStacked] can be written as \\[\\begin{aligned} N(\\mu=0,\\sigma=1)\\quad\\text{and}\\quad N(\\mu=19,\\sigma=4)\\end{aligned}\\] Because the mean and standard deviation describe a normal distribution exactly, they are called the distribution’s . Write down the short-hand for a normal distribution with (a) mean 5 and standard deviation 3, (b) mean -100 and standard deviation 10, and (c) mean 2 and standard deviation 9. 69 3.6.2 Standardizing with Z scores Table @ref(tab:satACTstats] shows the mean and standard deviation for total scores on the SAT and ACT. The distribution of SAT and ACT scores are both nearly normal. Suppose Ann scored 1800 on her SAT and Tom scored 24 on his ACT. Who performed better?[actSAT] We use the standard deviation as a guide. Ann is 1 standard deviation above average on the SAT: \\(1500 + 300=1800\\). Tom is 0.6 standard deviations above the mean on the ACT: \\(21+0.6\\times 5=24\\). In Figure @ref(fig:satActNormals], we can see that Ann tends to do better with respect to everyone else than Tom did, so her score was better. l r r &amp; SAT &amp; ACT Mean &amp; 1500 &amp; 21 SD &amp; 300 &amp; 5 [satACTstats] Ann’s and Tom’s scores shown with the distributions of SAT and ACT scores. [satActNormals] Example [actSAT] used a standardization technique called a Z score, a method most commonly employed for nearly normal observations but that may be used with any distribution. The Z score[ \\(Z\\) Z score, the standardized observation] \\(Z\\) Z score, the standardized observation of an observation is defined as the number of standard deviations it falls above or below the mean. If the observation is one standard deviation above the mean, its Z score is 1. If it is 1.5 standard deviations below the mean, then its Z score is -1.5. If \\(x\\) is an observation from a distribution \\(N(\\mu, \\sigma)\\), we define the Z score mathematically as \\[\\begin{aligned} Z = \\frac{x-\\mu}{\\sigma}\\end{aligned}\\] Using \\(\\mu_{SAT}=1500\\), \\(\\sigma_{SAT}=300\\), and \\(x_{Ann}=1800\\), we find Ann’s Z score: \\[\\begin{aligned} Z_{Ann} = \\frac{x_{Ann} - \\mu_{SAT}}{\\sigma_{SAT}} = \\frac{1800-1500}{300} = 1\\end{aligned}\\] The Z score of an observation is the number of standard deviations it falls above or below the mean. We compute the Z score for an observation \\(x\\) that follows a distribution with mean \\(\\mu\\) and standard deviation \\(\\sigma\\) using \\[\\begin{aligned} Z = \\frac{x-\\mu}{\\sigma}\\end{aligned}\\] Use Tom’s ACT score, 24, along with the ACT mean and standard deviation to compute his Z score.70 Observations above the mean always have positive Z scores while those below the mean have negative Z scores. If an observation is equal to the mean (e.g. SAT score of 1500), then the Z score is \\(0\\). Let \\(X\\) represent a random variable from \\(N(\\mu=3, \\sigma=2)\\), and suppose we observe \\(x=5.19\\). (a) Find the Z score of \\(x\\). (b) Use the Z score to determine how many standard deviations above or below the mean \\(x\\) falls.71 [headLZScore] Head lengths of brushtail possums follow a nearly normal distribution with mean 92.6 mm and standard deviation 3.6 mm. Compute the Z scores for possums with head lengths of 95.4 mm and 85.8 mm.72 We can use Z scores to roughly identify which observations are more unusual than others. One observation \\(x_1\\) is said to be more unusual than another observation \\(x_2\\) if the absolute value of its Z score is larger than the absolute value of the other observation’s Z score: \\(|Z_1| &gt; |Z_2|\\). This technique is especially insightful when a distribution is symmetric. Which of the observations in Guided Practice [headLZScore] is more ?73 3.6.3 Normal probability table Ann from Example [actSAT] earned a score of 1800 on her SAT with a corresponding \\(Z=1\\). She would like to know what percentile she falls in among all SAT test-takers. Ann’s percentile is the percentage of people who earned a lower SAT score than Ann. We shade the area representing those individuals in Figure @ref(fig:satBelow1800]. The total area under the normal curve is always equal to 1, and the proportion of people who scored below Ann on the SAT is equal to the area shaded in Figure @ref(fig:satBelow1800]: 0.8413. In other words, Ann is in the \\(84^{th}\\) percentile of SAT takers. The normal model for SAT scores, shading the area of those individuals who scored below Ann. [satBelow1800] We can use the normal model to find percentiles. A normal probability table, which lists Z scores and corresponding percentiles, can be used to identify a percentile based on the Z score (and vice versa). Statistical software can also be used. A normal probability table is given in Appendix and abbreviated in Table @ref(tab:zTableShort]. We use this table to identify the percentile corresponding to any particular Z score. For instance, the percentile of \\(Z=0.43\\) is shown in row \\(0.4\\) and column \\(0.03\\) in Table @ref(tab:zTableShort]: 0.6664, or the \\(66.64^{th}\\) percentile. Generally, we round \\(Z\\) to two decimals, identify the proper row in the normal probability table up through the first decimal, and then determine the column representing the second decimal value. The intersection of this row and column is the percentile of the observation. The area to the left of \\(Z\\) represents the percentile of the observation. [normalTails] $Z$ 0.00 0.01 0.02 0.05 0.06 0.07 0.08 0.09 0.0 0.1 0.2 0.3 0.5 0.6 0.7 0.9 1.0 1.1 \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) ———- ———- ———- ———- ———- ———- ———- ———- ———- ———- ———- : A section of the normal probability table. The percentile for a normal random variable with \\(Z=0.43\\) has been , and the percentile closest to 0.8000 has also been . [zTableShort] We can also find the Z score associated with a percentile. For example, to identify Z for the \\(80^{th}\\) percentile, we look for the value closest to 0.8000 in the middle portion of the table: 0.7995. We determine the Z score for the \\(80^{th}\\) percentile by combining the row and column Z values: 0.84. Determine the proportion of SAT test takers who scored better than Ann on the SAT.74 3.6.4 Normal probability examples Cumulative SAT scores are approximated well by a normal model, \\(N(\\mu=1500, \\sigma=300)\\). Shannon is a randomly selected SAT taker, and nothing is known about Shannon’s SAT aptitude. What is the probability Shannon scores at least 1630 on her SATs?[satAbove1630Exam] First, always draw and label a picture of the normal distribution. (Drawings need not be exact to be useful.) We are interested in the chance she scores above 1630, so we shade this upper tail: image The picture shows the mean and the values at 2 standard deviations above and below the mean. The simplest way to find the shaded area under the curve makes use of the Z score of the cutoff value. With \\(\\mu=1500\\), \\(\\sigma=300\\), and the cutoff value \\(x=1630\\), the Z score is computed as \\[\\begin{aligned} Z = \\frac{x - \\mu}{\\sigma} = \\frac{1630 - 1500}{300} = \\frac{130}{300} = 0.43\\end{aligned}\\] We look up the percentile of \\(Z=0.43\\) in the normal probability table shown in Table @ref(tab:zTableShort] or in Appendix , which yields 0.6664. However, the percentile describes those who had a Z score lower than 0.43. To find the area above \\(Z=0.43\\), we compute one minus the area of the lower tail: image The probability Shannon scores at least 1630 on the SAT is 0.3336. For any normal probability situation, always always always draw and label the normal curve and shade the area of interest first. The picture will provide an estimate of the probability. After drawing a figure to represent the situation, identify the Z score for the observation of interest. If the probability of Shannon scoring at least 1630 is 0.3336, then what is the probability she scores less than 1630? Draw the normal curve representing this exercise, shading the lower region instead of the upper one.75 Edward earned a 1400 on his SAT. What is his percentile? [edwardSatBelow1400] First, a picture is needed. Edward’s percentile is the proportion of people who do not get as high as a 1400. These are the scores to the left of 1400. image Identifying the mean \\(\\mu=1500\\), the standard deviation \\(\\sigma=300\\), and the cutoff for the tail area \\(x=1400\\) makes it easy to compute the Z score: \\[\\begin{aligned} Z = \\frac{x - \\mu}{\\sigma} = \\frac{1400 - 1500}{300} = -0.33\\end{aligned}\\] Using the normal probability table, identify the row of \\(-0.3\\) and column of \\(0.03\\), which corresponds to the probability \\(0.3707\\). Edward is at the \\(37^{th}\\) percentile. Use the results of Example [edwardSatBelow1400] to compute the proportion of SAT takers who did better than Edward. Also draw a new picture.76 The normal probability table in most books gives the area to the left. If you would like the area to the right, first find the area to the left and then subtract this amount from one. Stuart earned an SAT score of 2100. Draw a picture for each part. (a) What is his percentile? (b) What percent of SAT takers did better than Stuart?77 Based on a sample of 100 men,78 the heights of male adults between the ages 20 and 62 in the US is nearly normal with mean 70.0&quot; and standard deviation 3.3“. Mike is 5’7&quot; and Jim is 6’4“. (a) What is Mike’s height percentile? (b) What is Jim’s height percentile? Also draw one picture for each part.79 The last several problems have focused on finding the probability or percentile for a particular observation. What if you would like to know the observation corresponding to a particular percentile? Erik’s height is at the \\(40^{th}\\) percentile. How tall is he?[normalExam40Perc] As always, first draw the picture. image In this case, the lower tail probability is known (0.40), which can be shaded on the diagram. We want to find the observation that corresponds to this value. As a first step in this direction, we determine the Z score associated with the \\(40^{th}\\) percentile. Because the percentile is below 50%, we know \\(Z\\) will be negative. Looking in the negative part of the normal probability table, we search for the probability inside the table closest to 0.4000. We find that 0.4000 falls in row \\(-0.2\\) and between columns \\(0.05\\) and \\(0.06\\). Since it falls closer to \\(0.05\\), we take this one: \\(Z=-0.25\\). Knowing \\(Z_{Erik}=-0.25\\) and the population parameters \\(\\mu=70\\) and \\(\\sigma=3.3\\) inches, the Z score formula can be set up to determine Erik’s unknown height, labeled \\(x_{Erik}\\): \\[\\begin{aligned} -0.25 = Z_{Erik} = \\frac{x_{Erik} - \\mu}{\\sigma} = \\frac{x_{Erik} - 70}{3.3}\\end{aligned}\\] Solving for \\(x_{Erik}\\) yields the height 69.18 inches. That is, Erik is about 5’9&quot; (this is notation for 5-feet, 9-inches). What is the adult male height at the \\(82^{nd}\\) percentile? Again, we draw the figure first. image Next, we want to find the Z score at the \\(82^{nd}\\) percentile, which will be a positive value. Looking in the Z table, we find \\(Z\\) falls in row \\(0.9\\) and the nearest column is \\(0.02\\), i.e. \\(Z=0.92\\). Finally, the height \\(x\\) is found using the Z score formula with the known mean \\(\\mu\\), standard deviation \\(\\sigma\\), and Z score \\(Z=0.92\\): \\[\\begin{aligned} 0.92 = Z = \\frac{x-\\mu}{\\sigma} = \\frac{x - 70}{3.3}\\end{aligned}\\] This yields 73.04 inches or about 6’1&quot; as the height at the \\(82^{nd}\\) percentile. (a) What is the \\(95^{th}\\) percentile for SAT scores? (b) What is the \\(97.5^{th}\\) percentile of the male heights? As always with normal probability problems, first draw a picture.80 [more74Less69] (a) What is the probability that a randomly selected male adult is at least 6’2&quot; (74 inches)? (b) What is the probability that a male adult is shorter than 5’9&quot; (69 inches)?81 What is the probability that a random adult male is between 5’9&quot; and 6’2“? These heights correspond to 69 inches and 74 inches. First, draw the figure. The area of interest is no longer an upper or lower tail. image The total area under the curve is 1. If we find the area of the two tails that are not shaded (from Guided Practice [more74Less69], these areas are \\(0.3821\\) and \\(0.1131\\)), then we can find the middle area: image That is, the probability of being between 5’9&quot; and 6’2&quot; is 0.5048. What percent of SAT takers get between 1500 and 2000?82 What percent of adult males are between 5’5&quot; and 5’7“?83 3.6.5 68-95-99.7 rule Here, we present a useful rule of thumb for the probability of falling within 1, 2, and 3 standard deviations of the mean in the normal distribution. This will be useful in a wide range of practical settings, especially when trying to make a quick estimate without a calculator or Z table. Probabilities for falling within 1, 2, and 3 standard deviations of the mean in a normal distribution. [6895997] Use the Z table to confirm that about 68%, 95%, and 99.7% of observations fall within 1, 2, and 3, standard deviations of the mean in the normal distribution, respectively. For instance, first find the area that falls between \\(Z=-1\\) and \\(Z=1\\), which should have an area of about 0.68. Similarly there should be an area of about 0.95 between \\(Z=-2\\) and \\(Z=2\\).84 It is possible for a normal random variable to fall 4, 5, or even more standard deviations from the mean. However, these occurrences are very rare if the data are nearly normal. The probability of being further than 4 standard deviations from the mean is about 1-in-30,000. For 5 and 6 standard deviations, it is about 1-in-3.5 million and 1-in-1 billion, respectively. SAT scores closely follow the normal model with mean \\(\\mu = 1500\\) and standard deviation \\(\\sigma = 300\\). (a) About what percent of test takers score 900 to 2100? (b) What percent score between 1500 and 2100?85 3.6.6 Evaluating the normal approximation Many processes can be well approximated by the normal distribution. We have already seen two good examples: SAT scores and the heights of US adult males. While using a normal model can be extremely convenient and helpful, it is important to remember normality is always an approximation. Testing the appropriateness of the normal assumption is a key step in many data analyses. Example [normalExam40Perc] suggests the distribution of heights of US males is well approximated by the normal model. We are interested in proceeding under the assumption that the data are normally distributed, but first we must check to see if this is reasonable. There are two visual methods for checking the assumption of normality, which can be implemented and interpreted quickly. The first is a simple histogram with the best fitting normal curve overlaid on the plot, as shown in the left panel of Figure @ref(fig:fcidMHeights]. The sample mean \\(\\bar{x}\\) and standard deviation \\(s\\) are used as the parameters of the best fitting normal curve. The closer this curve fits the histogram, the more reasonable the normal model assumption. Another more common method is examining a normal probability plot.86, shown in the right panel of Figure @ref(fig:fcidMHeights]. The closer the points are to a perfect straight line, the more confident we can be that the data follow the normal model. A sample of 100 male heights. The observations are rounded to the nearest whole inch, explaining why the points appear to jump in increments in the normal probability plot. [fcidMHeights] Three data sets of 40, 100, and 400 samples were simulated from a normal distribution, and the histograms and normal probability plots of the data sets are shown in Figure @ref(fig:normalExamples]. These will provide a benchmark for what to look for in plots of real data. [normalExamplesExample] Histograms and normal probability plots for three simulated normal data sets; \\(n=40\\) (left), \\(n=100\\) (middle), \\(n=400\\) (right). [normalExamples] The left panels show the histogram (top) and normal probability plot (bottom) for the simulated data set with 40 observations. The data set is too small to really see clear structure in the histogram. The normal probability plot also reflects this, where there are some deviations from the line. However, these deviations are not strong. The middle panels show diagnostic plots for the data set with 100 simulated observations. The histogram shows more normality and the normal probability plot shows a better fit. While there is one observation that deviates noticeably from the line, it is not particularly extreme. The data set with 400 observations has a histogram that greatly resembles the normal distribution, while the normal probability plot is nearly a perfect straight line. Again in the normal probability plot there is one observation (the largest) that deviates slightly from the line. If that observation had deviated 3 times further from the line, it would be of much greater concern in a real data set. Apparent outliers can occur in normally distributed data but they are rare. Notice the histograms look more normal as the sample size increases, and the normal probability plot becomes straighter and more stable. Are NBA player heights normally distributed? Consider all 435 NBA players from the 2008-9 season presented in Figure @ref(fig:nbaNormal]. 87 We first create a histogram and normal probability plot of the NBA player heights. The histogram in the left panel is slightly left skewed, which contrasts with the symmetric normal distribution. The points in the normal probability plot do not appear to closely follow a straight line but show what appears to be a “wave”. We can compare these characteristics to the sample of 400 normally distributed observations in Example [normalExamplesExample] and see that they represent much stronger deviations from the normal model. NBA player heights do not appear to come from a normal distribution. Histogram and normal probability plot for the NBA heights from the 2008-9 season. [nbaNormal] Can we approximate poker winnings by a normal distribution? We consider the poker winnings of an individual over 50 days. A histogram and normal probability plot of these data are shown in Figure @ref(fig:pokerNormal]. The data are very strongly right skewed in the histogram, which corresponds to the very strong deviations on the upper right component of the normal probability plot. If we compare these results to the sample of 40 normal observations in Example [normalExamplesExample], it is apparent that these data show very strong deviations from the normal model. A histogram of poker data with the best fitting normal plot and a normal probability plot. [pokerNormal] [normalQuantileExercise] Determine which data sets represented in Figure @ref(fig:normalQuantileExer] plausibly come from a nearly normal distribution. Are you confident in all of your conclusions? There are 100 (top left), 50 (top right), 500 (bottom left), and 15 points (bottom right) in the four plots.88 Four normal probability plots for Guided Practice [normalQuantileExercise]. [normalQuantileExer] [normalQuantileExerciseAdditional] Figure @ref(fig:normalQuantileExerAdditional] shows normal probability plots for two distributions that are skewed. One distribution is skewed to the low end (left skewed) and the other to the high end (right skewed). Which is which?89 Normal probability plots for Guided Practice [normalQuantileExerciseAdditional]. [normalQuantileExerAdditional] 3.7 Applying the normal model The approach for using the normal model in the context of inference is very similar to the practice of applying the model to individual observations that are nearly normal. We will replace null distributions we previously obtained using the randomization or simulation techniques and verify the results once again using the normal model. When the sample size is sufficiently large, this approximation generally provides us with the same conclusions. 3.7.1 Standard error Point estimates vary from sample to sample, and we quantify this variability with what is called the standard error (SE). The standard error is equal to the standard deviation associated with the estimate. So, for example, if we used the standard deviation to quantify the variability of a point estimate from one sample to the next, this standard deviation would be called the standard error of the point estimate. The way we determine the standard error varies from one situation to the next. However, typically it is determined using a formula based on the Central Limit Theorem. 3.7.2 Normal model application: opportunity cost In Section [caseStudyOpportunityCost] we were introduced to the opportunity cost study, which found that students became thriftier when they were reminded that not spending money now means the money can be spent on other things in the future. Let’s re-analyze the data in the context of the normal distribution and compare the results. Figure @ref(fig:OpportunityCostDiffswnormal] summarizes the null distribution as determined using the randomization method. The best fitting normal distribution for the null distribution has a mean of 0. We can calculate the standard error of this distribution by borrowing a formula that we will become familiar with in Section [differenceOfTwoProportions], but for now let’s just take the value \\(SE = 0.078\\) as a given. Recall that the point estimate of the difference was 0.20, as shown in the plot. Next, we’ll use the normal distribution approach to compute the two-tailed p-value. Null distribution of differences with an overlaid normal curve for the opportunity cost study. 10,000 simulations were run for this figure. [OpportunityCostDiffswnormal] As we learned in Section [normalDist], it is helpful to draw and shade a picture of the normal distribution so we know precisely what we want to calculate. Here we want to find the area of the two tails representing the p-value. image Next, we can calculate the Z score using the observed difference, 0.20, and the two model parameters. The standard error, \\(SE = 0.078\\), is the equivalent of the model’s standard deviation. \\[\\begin{aligned} Z = \\frac{\\text{observed difference} - 0}{SE} = \\frac{0.20 - 0}{0.078} = 2.56\\end{aligned}\\] We can either look up \\(Z = 2.56\\) in the normal probability table or use statistical software to determine the right tail area: 0.0052, which is about the same as what we got for the right tail using the randomization approach (0.0065). Doubling this value yields the total area in the two tails and the p-value for the hypothesis test: 0.01. As before, since the p-value is less than 0.05, we conclude that the treatment did indeed impact students’ spending. In the context of a hypothesis test, the Z score for a point estimate is \\[\\begin{aligned} Z = \\frac{\\text{point estimate} - \\text{null value}}{SE}\\end{aligned}\\] The standard error in this case is the equivalent of the standard deviation of the point estimate, and the null value comes from the null hypothesis. We have confirmed that the randomization approach we used earlier and the normal distribution approach provide almost identical p-values and conclusions in the opportunity cost case study. Next, let’s turn our attention to the medical consultant case study. 3.7.3 Normal model application: medical consultant In Section [SimulationCaseStudies] we learned about a medical consultant who reported that only 3 of her 62 clients who underwent a liver transplant had complications, which is less than the more common complication rate of 0.10. As in the other case studies, we identified a suitable null distribution using a simulation approach, as shown in Figure @ref(fig:MedConsNullSimwnormal]. Here we have added the best-fitting normal curve to the figure, which has a mean of 0.10. Borrowing a formula that we’ll encounter in Chapter [inferenceForCategoricalData], the standard error of this distribution was also computed: \\(SE = 0.038\\). In the previous analysis, we obtained a p-value of 0.2444, and we will try to reproduce that p-value using the normal distribution approach. However, before we begin, we want to point out a simple detail that is easy to overlook: the null distribution we earlier generated is slightly skewed, and the distribution isn’t that smooth. In fact, the normal distribution only sort-of fits this model. We’ll discuss this discrepancy more in a moment. The null distribution for \\(\\hat{p}\\), created from 10,000 simulated studies, along with the best-fitting normal model. [MedConsNullSimwnormal] We’ll again begin by creating a picture. Here a normal distribution centered at 0.10 with a standard error of 0.038. image Next, we can calculate the Z score using the observed complication rate, \\(\\hat{p} = 0.048\\) along with the mean and standard deviation of the normal model. Here again, we use the standard error for the standard deviation. \\[\\begin{aligned} Z = \\frac{\\hat{p} - p_0}{SE_{\\hat{p}}} = \\frac{0.048 - 0.10}{0.038} = -1.37\\end{aligned}\\] Identifying \\(Z = -1.37\\) in the normal probability table or using statistical software, we can determine that the left tail area is 0.0853. Doubling this value yields the total area in the two tails: about 0.17. This is the estimated p-value for the hypothesis test. However, there’s a problem: this is very different than the earlier p-value we computed: 0.2444. The discrepancy is explained by normal model’s poor representation of the null distribution in Figure @ref(fig:MedConsNullSimwnormal]. As noted earlier, the null distribution from the simulations is not very smooth, and the distribution itself is slightly skewed. That’s the bad news. The good news is that we can foresee these problems using some simple checks. We’ll learn about these checks in the following chapters. In Section [CLTsection] we noted that the two common requirements to apply the Central Limit Theorem are (1) the observations in the sample must be independent, and (2) the sample must be sufficiently large. The guidelines for this particular situation – which we will learn in Section [singleProportion] – would have alerted us that the normal model was a poor approximation. 3.7.4 Conditions for applying the normal model The success story in this section was the application of the normal model in the context of the opportunity cost data. However, the biggest lesson comes from our failed attempt to use the normal approximation in the medical consultant case study. Statistical techniques are like a carpenter’s tools. When used responsibly, they can produce amazing and precise results. However, if the tools are applied irresponsibly or under inappropriate conditions, they will produce unreliable results. For this reason, with every statistical method that we introduce in future chapters, we will carefully outline conditions when the method can reasonably be used. These conditions should be checked in each application of the technique. 3.8 Confidence intervals A point estimate provides a single plausible value for a parameter. However, a point estimate is rarely perfect; usually there is some error in the estimate. In addition to supplying a point estimate of a parameter, a next logical step would be to provide a plausible range of values for the parameter. 3.8.1 Capturing the population parameter A plausible range of values for the population parameter is called a confidence interval. Using only a point estimate is like fishing in a murky lake with a spear, and using a confidence interval is like fishing with a net. We can throw a spear where we saw a fish, but we will probably miss. On the other hand, if we toss a net in that area, we have a good chance of catching the fish. If we report a point estimate, we probably will not hit the exact population parameter. On the other hand, if we report a range of plausible values – a confidence interval – we have a good shot at capturing the parameter. If we want to be very certain we capture the population parameter, should we use a wider interval or a smaller interval?90 3.8.2 Constructing a 95% confidence interval A point estimate is our best guess for the value of the parameter, so it makes sense to build the confidence interval around that value. The standard error, which is a measure of the uncertainty associated with the point estimate, provides a guide for how large we should make the confidence interval. When the sampling distribution of a point estimate can reasonably be modeled as normal, the point estimate we observe will be within 1.96 standard errors of the true value of interest about 95% of the time. Thus, a 95% confidence interval for such a point estimate can be constructed: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96 \\times SE\\vspace{-2mm} \\label{95PercentConfidenceIntervalFormula}\\end{aligned}\\] We can be this interval captures the true value. Compute the area between -1.96 and 1.96 for a normal distribution with mean 0 and standard deviation 1. 91 The point estimate from the opportunity cost study was that 20% fewer students would buy a DVD if they were reminded that money not spent now could be spent later on something else. The point estimate from this study can reasonably be modeled with a normal distribution, and a proper standard error for this point estimate is \\(SE = 0.078\\). Construct a 95% confidence interval.92 Since the conditions for the normal approximation have already been verified, we can move forward with the construction of the 95% confidence interval: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96 \\times SE \\quad \\rightarrow \\quad 0.20\\ \\pm\\ 1.96 \\times 0.078 \\quad \\rightarrow \\quad (0.047, 0.353)\\end{aligned}\\] We are 95% confident that the DVD purchase rate resulting from the treatment is between 4.7% and 35.3% lower than in the control group. Since this confidence interval does not contain 0, it is consistent with our earlier result where we rejected the notion of “no difference” using a hypothesis test. In Section [basicExampleOfStentsAndStrokes] we encountered an experiment that examined whether implanting a stent in the brain of a patient at risk for a stroke helps reduce the risk of a stroke. The results from the first 30 days of this study, which included 451 patients, are summarized in Table @ref(tab:stentStudyResultsCIsection]. These results are surprising! The point estimate suggests that patients who received stents may have a higher risk of stroke: \\(p_{trmt} - p_{ctrl} = 0.090\\). Descriptive statistics for 30-day results for the stent study. stroke no event Total treatment 33 191 224 control 13 214 227 Total 46 405 451 [stentStudyResultsCIsection] Consider the stent study and results. The conditions necessary to ensure the point estimate \\(p_{trmt} - p_{ctrl} = 0.090\\) is nearly normal have been verified for you, and the estimate’s standard error is \\(SE = 0.028\\). Construct a 95% confidence interval for the change in 30-day stroke rates from usage of the stent. [stentStroke95CICIsection] The conditions for applying the normal model have already been verified, so we can proceed to the construction of the confidence interval: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96 \\times SE \\quad \\rightarrow \\quad 0.090\\ \\pm\\ 1.96 \\times 0.028 \\quad \\rightarrow \\quad (0.035, 0.145)\\end{aligned}\\] We are 95% confident that implanting a stent in a stroke patient’s brain increased the risk of stroke within 30 days by a rate of 0.035 to 0.145. This confidence interval can also be used in a way analogous to a hypothesis test: since the interval does not contain 0, it means the data provide statistically significant evidence that the stent used in the study increases the risk of stroke, contrary to what researchers had expected before this study was published! As with hypothesis tests, confidence intervals are imperfect. About 1-in-20 properly constructed 95% confidence intervals will fail to capture the parameter of interest. Figure @ref(fig:95PercentConfidenceInterval] shows 25 confidence intervals for a proportion that were constructed from simulations where the true proportion was \\(p = 0.3\\). However, 1 of these 25 confidence intervals happened not to include the true value. Twenty-five samples of size \\(n=300\\) were simulated when \\(p = 0.30\\). For each sample, a confidence interval was created to try to capture the true proportion \\(p\\). However, 1 of these 25 intervals did not capture \\(p = 0.30\\). [95PercentConfidenceInterval] In Figure @ref(fig:95PercentConfidenceInterval], one interval does not contain the true proportion, \\(p = 0.3\\). Does this imply that there was a problem with the simulations run?93 3.8.3 Changing the confidence level Suppose we want to consider confidence intervals where the confidence level is somewhat higher than 95%: perhaps we would like a confidence level of 99%. Think back to the analogy about trying to catch a fish: if we want to be more sure that we will catch the fish, we should use a wider net. To create a 99% confidence level, we must also widen our 95% interval. On the other hand, if we want an interval with lower confidence, such as 90%, we could make our original 95% interval slightly slimmer. The 95% confidence interval structure provides guidance in how to make intervals with new confidence levels. Below is a general 95% confidence interval for a point estimate that comes from a nearly normal distribution: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96\\times SE\\end{aligned}\\] There are three components to this interval: the point estimate, “1.96”, and the standard error. The choice of \\(1.96\\times SE\\) was based on capturing 95% of the data since the estimate is within 1.96 standard errors of the true value about 95% of the time. The choice of 1.96 corresponds to a 95% confidence level. [leadInForMakingA99PercentCIExercise] If \\(X\\) is a normally distributed random variable, how often will \\(X\\) be within 2.58 standard deviations of the mean?94 To create a 99% confidence interval, change 1.96 in the 95% confidence interval formula to be \\(2.58\\). Guided Practice [leadInForMakingA99PercentCIExercise] highlights that 99% of the time a normal random variable will be within 2.58 standard deviations of its mean. This approach – using the Z scores in the normal model to compute confidence levels – is appropriate when the point estimate is associated with a normal distribution and we can properly compute the standard error. Thus, the formula for a 99% confidence interval is \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 2.58\\times SE \\label{99PercCIForMean} \\label{99PercCIForNormalPointEstimate}\\end{aligned}\\] The area between -\\(z^{\\star}\\) and \\(z^{\\star}\\) increases as \\(|z^{\\star}|\\) becomes larger. If the confidence level is 99%, we choose \\(z^{\\star}\\) such that 99% of the normal curve is between -\\(z^{\\star}\\) and \\(z^{\\star}\\), which corresponds to 0.5% in the lower tail and 0.5% in the upper tail: \\(z^{\\star}=2.58\\). [choosingZForCI] The normal approximation is crucial to the precision of these confidence intervals. The next two chapters provides detailed discussions about when the normal model can safely be applied to a variety of situations. When the normal model is not a good fit, we will use alternative distributions that better characterize the sampling distribution. [find99CIForRun10AgeExercise] Create a 99% confidence interval for the impact of the stent on the risk of stroke using the data from Example [stentStroke95CICIsection]. The point estimate is 0.090, and the standard error is \\(SE = 0.028\\). It has been verified for you that the point estimate can reasonably be modeled by a normal distribution.95 If the point estimate follows the normal model with standard error \\(SE\\), then a confidence interval for the population parameter is \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ z^{\\star} \\times SE\\end{aligned}\\] where \\(z^{\\star}\\) corresponds to the confidence level selected. Figure @ref(fig:choosingZForCI] provides a picture of how to identify \\(z^{\\star}\\) based on a confidence level. We select \\(z^{\\star}\\) so that the area between -\\(z^{\\star}\\) and \\(z^{\\star}\\) in the normal model corresponds to the confidence level. [marginOfErrorTermBox]In a confidence interval, \\(z^{\\star}\\times SE\\) is called the margin of error. [find90CIForRun10AgeExercise] In Example [stentStroke95CICIsection] we found that implanting a stent in the brain of a patient at risk for a stroke increased the risk of a stroke. The study estimated a 9% increase in the number of patients who had a stroke, and the standard error of this estimate was about \\(SE = 2.8\\%\\). Compute a 90% confidence interval for the effect.96 3.8.4 Interpreting confidence intervals A careful eye might have observed the somewhat awkward language used to describe confidence intervals. Correct interpretation: We are XX% confident that the population parameter is between… Incorrect language might try to describe the confidence interval as capturing the population parameter with a certain probability. This is one of the most common errors: while it might be useful to think of it as a probability, the confidence level only quantifies how plausible it is that the parameter is in the interval. Another especially important consideration of confidence intervals is that they only try to capture the population parameter. Our intervals say nothing about the confidence of capturing individual observations, a proportion of the observations, or about capturing point estimates. Confidence intervals only attempt to capture population parameters. We would be assuming that these two variables are independent, meaning they are unrelated.↩ Rosen B and Jerdee T. 1974. “Influence of sex role stereotypes on personnel decisions.” Journal of Applied Psychology 59(1):9-14.↩ The study is an experiment, as subjects were randomly assigned a male file or a female file. Since this is an experiment, the results can be used to evaluate a causal relationship between gender of a candidate and the promotion decision.↩ The test procedure we employ in this section is formally called a permutation test.↩ \\(18/24 - 17/24=0.042\\) or about 4.2% in favor of the men. This difference due to chance is much smaller than the difference observed in the actual groups.↩ This reasoning does not generally extend to anecdotal observations. Each of us observes incredibly rare events every day, events we could not possibly hope to predict. However, in the non-rigorous setting of anecdotal evidence, almost anything may appear to be a rare event, so the idea of looking for rare events in day-to-day activities is treacherous. For example, we might look at the lottery: there was only a 1 in 176 million chance that the Mega Millions numbers for the largest jackpot in history (March 30, 2012) would be (2, 4, 23, 38, 46) with a Mega ball of (23), but nonetheless those numbers came up! However, no matter what numbers had turned up, they would have had the same incredibly rare odds. That is, any set of numbers we could have observed would ultimately be incredibly rare. This type of situation is typical of our daily lives: each possible event in itself seems incredibly rare, but if we consider every alternative, those outcomes are also incredibly rare. We should be cautious not to misinterpret such anecdotal evidence.↩ Frederick S, Novemsky N, Wang J, Dhar R, Nowlis S. 2009. Opportunity Cost Neglect. Journal of Consumer Research 36: 553-561.↩ Success is often defined in a study as the outcome of interest, and a “success” may or may not actually be a positive outcome. For example, researchers working on a study on HIV prevalence might define a “success” in the statistical sense as a patient who is HIV+. A more complete discussion of the term success will be given in Chapter [inferenceForCategoricalData].↩ Making a Type 1 Error in this context would mean that reminding students that money not spent now can be spent later does not affect their buying habits, despite the strong evidence (the data suggesting otherwise) found in the experiment. Notice that this does not necessarily mean something was wrong with the data or that we made a computational mistake. Sometimes data simply point us to the wrong conclusion, which is why scientific studies are often repeated to check initial findings.↩ To lower the Type 2 Error rate, we want to convict more guilty people. We could lower the standards for conviction from “beyond a reasonable doubt” to “beyond a little doubt”. Lowering the bar for guilt will also result in more wrongful convictions, raising the Type 1 Error rate.↩ B\\(\\ddot{\\text{o}}\\)ttiger et al. “Efficacy and safety of thrombolytic therapy after initially unsuccessful cardiopulmonary resuscitation: a prospective clinical trial.” The Lancet, 2001.↩ Observed control survival rate: \\(p_c = \\frac{11}{50} = 0.22\\). Treatment survival rate: \\(p_t = \\frac{14}{40} = 0.35\\). Observed difference: \\(\\hat{p}_t - \\hat{p}_c = 0.35 - 0.22 = 0.13\\).↩ \\(H_0\\): There is no association between the consultant’s contributions and the clients’ complication rate. That is, the complication rate for the consultant’s clients is equal to the US average of 10%. In statistical language, \\(p=0.10\\). \\(H_A\\): Patients who work with the consultant have a complication rate different than 10%, i.e. \\(p \\neq 0.10\\).↩ About 10% of the patients (6.2 on average) in the simulation will have a complication, though we will see a little variation from one simulation to the next.↩ This doubling approach is preferred even when the distribution isn’t symmetric, as in this case.↩ The data do not provide strong evidence that the consultant’s work is associated with a lower or higher rate of surgery complications than the general rate of 10%.↩ This case study is described in Made to Stick by Chip and Dan Heath. Little known fact: the teaching principles behind many OpenIntro resources are based on Made to Stick.↩ The p-value is the chance of seeing the data summary or something more in favor of the alternative hypothesis. Since we didn’t observe anything even close to just 3 correct, the p-value will be small, around 1-in-10,000 or smaller.↩ The p-value is less than 0.05, so we reject the null hypothesis. There is statistically significant evidence, and the data provide strong evidence that the chance a listener will guess the correct tune is less than 50%.↩ In general, the distributions are reasonably symmetric. The case study for the medical consultant is the only distribution with any evident skew.↩ The percentile bootstrap method has been put forward as an alternative. However, simulations show that this method is consistently less robust than than the normal distribution. For more information, visit openintro.org/bootstrap.↩ It is also introduced as the Gaussian distribution after Frederic Gauss, the first person to formalize its mathematical expression.↩ (a) \\(N(\\mu=5,\\sigma=3)\\). (b) \\(N(\\mu=-100, \\sigma=10)\\). (c) \\(N(\\mu=2, \\sigma=9)\\).↩ \\(Z_{Tom} = \\frac{x_{Tom} - \\mu_{ACT}}{\\sigma_{ACT}} = \\frac{24 - 21}{5} = 0.6\\)↩ (a) Its Z score is given by \\(Z = \\frac{x-\\mu}{\\sigma} = \\frac{5.19 - 3}{2} = 2.19/2 = 1.095\\). (b) The observation \\(x\\) is 1.095 standard deviations above the mean. We know it must be above the mean since \\(Z\\) is positive.↩ For \\(x_1=95.4\\) mm: \\(Z_1 = \\frac{x_1 - \\mu}{\\sigma} = \\frac{95.4 - 92.6}{3.6} = 0.78\\). For \\(x_2=85.8\\) mm: \\(Z_2 = \\frac{85.8 - 92.6}{3.6} = -1.89\\).↩ Because the absolute value of Z score for the second observation is larger than that of the first, the second observation has a more unusual head length.↩ If 84% had lower scores than Ann, the number of people who had better scores must be 16%. (Generally ties are ignored when the normal model, or any other continuous distribution, is used.)↩ We found the probability in Example [satAbove1630Exam]: 0.6664. A picture for this exercise is represented by the shaded area below “0.6664” in Example [satAbove1630Exam].↩ If Edward did better than 37% of SAT takers, then about 63% must have done better than him. ↩ Numerical answers: (a) 0.9772. (b) 0.0228.↩ This sample was taken from the USDA Food Commodity Intake Database.↩ First put the heights into inches: 67 and 76 inches. Figures are shown below. (a) \\(Z_{Mike} = \\frac{67 - 70}{3.3} = -0.91\\ \\to\\ 0.1814\\). (b) \\(Z_{Jim} = \\frac{76 - 70}{3.3} = 1.82\\ \\to\\ 0.9656\\). ↩ Remember: draw a picture first, then find the Z score. (We leave the pictures to you.) The Z score can be found by using the percentiles and the normal probability table. (a) We look for 0.95 in the probability portion (middle part) of the normal probability table, which leads us to row 1.6 and (about) column 0.05, i.e. \\(Z_{95}=1.65\\). Knowing \\(Z_{95}=1.65\\), \\(\\mu = 1500\\), and \\(\\sigma = 300\\), we setup the Z score formula: \\(1.65 = \\frac{x_{95} - 1500}{300}\\). We solve for \\(x_{95}\\): \\(x_{95} = 1995\\). (b) Similarly, we find \\(Z_{97.5} = 1.96\\), again setup the Z score formula for the heights, and calculate \\(x_{97.5} = 76.5\\).↩ Numerical answers: (a) 0.1131. (b) 0.3821.↩ This is an abbreviated solution. (Be sure to draw a figure!) First find the percent who get below 1500 and the percent that get above 2000: \\(Z_{1500} = 0.00 \\to 0.5000\\) (area below), \\(Z_{2000} = 1.67 \\to 0.0475\\) (area above). Final answer: \\(1.0000-0.5000 - 0.0475 = 0.4525\\).↩ 5’5&quot; is 65 inches. 5’7&quot; is 67 inches. Numerical solution: \\(1.000 - 0.0649 - 0.8183 = 0.1168\\), i.e. 11.68%.↩ First draw the pictures. To find the area between \\(Z=-1\\) and \\(Z=1\\), use the normal probability table to determine the areas below \\(Z=-1\\) and above \\(Z=1\\). Next verify the area between \\(Z=-1\\) and \\(Z=1\\) is about 0.68. Repeat this for \\(Z=-2\\) to \\(Z=2\\) and also for \\(Z=-3\\) to \\(Z=3\\).↩ (a) 900 and 2100 represent two standard deviations above and below the mean, which means about 95% of test takers will score between 900 and 2100. (b) Since the normal model is symmetric, then half of the test takers from part (a) (\\(\\frac{95\\%}{2} = 47.5\\%\\) of all test takers) will score 900 to 1500 while 47.5% score between 1500 and 2100.↩ Also commonly called a quantile-quantile plot.↩ These data were collected from .↩ Answers may vary a little. The top-left plot shows some deviations in the smallest values in the data set; specifically, the left tail of the data set has some outliers we should be wary of. The top-right and bottom-left plots do not show any obvious or extreme deviations from the lines for their respective sample sizes, so a normal model would be reasonable for these data sets. The bottom-right plot has a consistent curvature that suggests it is not from the normal distribution. If we examine just the vertical coordinates of these observations, we see that there is a lot of data between -20 and 0, and then about five observations scattered between 0 and 70. This describes a distribution that has a strong right skew.↩ Examine where the points fall along the vertical axis. In the first plot, most points are near the low end with fewer observations scattered along the high end; this describes a distribution that is skewed to the high end. The second plot shows the opposite features, and this distribution is skewed to the low end.↩ If we want to be more certain we will capture the fish, we might use a wider net. Likewise, we use a wider confidence interval if we want to be more certain that we capture the parameter.↩ We will leave it to you to draw a picture. The Z scores are \\(Z_{left} = -1.96\\) and \\(Z_{right} = 1.96\\). The area between these two Z scores is \\(0.9750 - 0.0250 = 0.9500\\). This is where “1.96” comes from in the 95% confidence interval formula.↩ We’ve used \\(SE = 0.078\\) from the last section. However, it would more generally be appropriate to recompute the \\(SE\\) slightly differently for this confidence interval using the technique introduced in Section [SampleDistributionOfTheDiffOfTwoProportions]. Don’t worry about this detail for now since the two resulting standard errors are, in this case, almost identical.↩ No. Just as some observations occur more than 1.96 standard deviations from the mean, some point estimates will be more than 1.96 standard errors from the parameter. A confidence interval only provides a plausible range of values for a parameter. While we might say other values are implausible based on the data, this does not mean they are impossible.↩ This is equivalent to asking how often the \\(Z\\) score will be larger than -2.58 but less than 2.58. (For a picture, see Figure @ref(fig:choosingZForCI].) To determine this probability, look up -2.58 and 2.58 in the normal probability table (0.0049 and 0.9951). Thus, there is a \\(0.9951-0.0049 \\approx 0.99\\) probability that the unobserved random variable \\(X\\) will be within 2.58 standard deviations of the mean.↩ Since the necessary conditions for applying the normal model have already been checked for us, we can go straight to the construction of the confidence interval: \\(\\text{point estimate}\\ \\pm\\ 2.58 \\times SE \\rightarrow (0.018, 0.162)\\). We are 99% confident that implanting a stent in the brain of a patient who is at risk of stroke increases the risk of stroke within 30 days by a rate of 0.018 to 0.162 (assuming the patients are representative of the population).↩ We must find \\(z^{\\star}\\) such that 90% of the distribution falls between -\\(z^{\\star}\\) and \\(z^{\\star}\\) in the standard normal model, \\(N(\\mu=0, \\sigma=1)\\). We can look up -\\(z^{\\star}\\) in the normal probability table by looking for a lower tail of 5% (the other 5% is in the upper tail), thus \\(z^{\\star}=1.65\\). The 90% confidence interval can then be computed as \\(\\text{point estimate}\\ \\pm\\ 1.65\\times SE \\to (4.4\\%, 13.6\\%)\\). (Note: the conditions for normality had earlier been confirmed for us.) That is, we are 90% confident that implanting a stent in a stroke patient’s brain increased the risk of stroke within 30 days by 4.4% to 13.6%.↩ "],
["inferenceForNumericalDatattest.html", "Chapter 4 Inference for numerical data: t-Tests 4.1 One-sample means with the \\(t\\) distribution 4.2 Paired data 4.3 Difference of two means", " Chapter 4 Inference for numerical data: t-Tests Chapters [FoundationForInference] and [inferenceForCategoricalData] introduced us to inference for proportions using the normal model, and in Section [oneWayChiSquare], we encountered the chi-square distribution, which is useful for working with categorical data with many levels. In this chapter, our focus will be on numerical data, where we will encounter two more distributions: the \\(t\\) distribution (looks a lot like the normal distribution) and the \\(F\\) distribution. Our general approach will be: Determine which point estimate or test statistic is useful. Identify an appropriate distribution for the point estimate or test statistic. Apply the hypothesis and confidence interval techniques from Chapter [FoundationForInference] using the distribution from step 2. 4.1 One-sample means with the \\(t\\) distribution The sampling distribution associated with a sample mean or difference of two sample means is, if certain conditions are satisfied, nearly normal. However, this becomes more complex when the sample size is small, where small here typically means a sample size smaller than 30 observations. For this reason, we’ll use a new distribution called the \\(t\\) distribution that will often work for both small and large samples of numerical data. 4.1.1 Two examples using the normal distribution Before we get started with the \\(t\\) distribution, let’s take a look at two applications where it is okay to use the normal model for the sample mean. For the case of a single mean, the standard error of the sample mean can be calculated as \\[\\begin{aligned} SE = \\frac{\\sigma}{\\sqrt{n}}\\end{aligned}\\] where \\(\\sigma\\) is the population standard deviation and \\(n\\) is the sample size. Generally we use the sample standard deviation, denoted by \\(s\\), in place of the population standard deviation when we compute the standard error: \\[\\begin{aligned} SE \\approx \\frac{s}{\\sqrt{n}}\\end{aligned}\\] If we look at this formula, there are some characteristics that we can think about intuitively. If we examine the standard error formula, we would see that a larger \\(s\\) corresponds to a larger \\(SE\\). This makes intuitive sense: if the data are more volatile, then we’ll be less certain of the location of the true mean, so the standard error should be bigger. On the other hand, if the observations all fall very close together, then \\(s\\) will be small, and the sample mean should be a more precise estimate of the true mean. In the formula, the larger the sample size \\(n\\), the smaller the standard error. This matches our intuition: we expect estimates to be more precise when we have more data, so the standard error \\(SE\\) should get smaller when \\(n\\) gets bigger. As we did with proportions, we’ll also need to check a few conditions before using the normal model. We’ll forgo describing those details until later this section, but these conditions have been verified for the two examples below. We’ve taken a random sample of 100 runners from a race called the Cherry Blossom Run in Washington, DC, which was a race with 16,924 participants.97 The sample data for the 100 runners is summarized in Table [run10SampDF], histograms of the run time and age of participants are in Figure [run10SampHistograms], and summary statistics are available in Table [ptEstimatesNetTimeAge]. Create a 95% confidence interval for the average time it takes runners in the Cherry Blossom Run to complete the race. We can use the same confidence interval formula for the mean that we used for a proportion: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ 1.96 \\times SE\\end{aligned}\\] In this case, the best estimate of the overall mean is the sample mean, \\(\\bar{x} = 95.61\\) minutes. The standard error can be calculated using sample standard deviation (\\(s = 15.78\\)), the sample size (\\(n=100\\)), and the standard error formula: \\[\\begin{aligned} SE = \\frac{s}{\\sqrt{n}} = \\frac{15.78}{\\sqrt{100}} = 1.578\\end{aligned}\\] Finally, we can calculate a 95% confidence interval: \\[\\begin{aligned} \\text{point estimate}\\ \\pm\\ z^{\\star} \\times SE \\quad\\rightarrow\\quad 95.61 \\pm 1.96 \\times 1.578 \\quad\\rightarrow\\quad (92.52, 98.70)\\end{aligned}\\] We are 95% confident that the average time for all runners in the 2012 Cherry Blossom Run is between 92.52 and 98.70 minutes. Four observations for the run10Samp data set, which represents a simple random sample of 100 runners from the 2012 Cherry Blossom Run. ID time age gender state 1 88.31 59 M MD 2 100.67 32 M VA 3 109.52 33 F VA \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 100 89.49 26 M DC [run10SampDF] Histograms of time and age for the sample Cherry Blossom Run data. The average time is in the mid-90s, and the average age is in the mid-30s. The age distribution is moderately skewed to the right. [run10SampHistograms] Point estimates and parameter values for the time variable. sample mean 95.61 35.05 sample median 95.37 32.50 sample st. dev. 15.78 8.97 [ptEstimatesNetTimeAge] Use the data to calculate a 90% confidence interval for the average age of participants in the 2012 Cherry Blossom Run. The conditions for applying the normal model have already been verified.98 The nutrition label on a bag of potato chips says that a one ounce (28 gram) serving of potato chips has 130 calories and contains ten grams of fat, with three grams of saturated fat. A random sample of 35 bags yielded a sample mean of 134 calories with a standard deviation of 17 calories. Is there evidence that the nutrition label does not provide an accurate measure of calories in the bags of potato chips? The conditions necessary for applying the normal model have been checked and are satisfied. The question has been framed in terms of two possibilities: the nutrition label accurately lists the correct average calories per bag of chips or it does not, which may be framed as a hypothesis test: The average is listed correctly. \\(\\mu = 130\\) The nutrition label is incorrect. \\(\\mu \\neq 130\\) The observed average is \\(\\bar{x} = 134\\) and the standard error may be calculated as \\(SE = \\frac{17}{\\sqrt{35}} = 2.87\\). First, we draw a picture summarizing this scenario. image We can compute a test statistic as the Z score: \\[\\begin{aligned} Z = \\frac{134 - 130}{2.87} = 1.39\\end{aligned}\\] The upper-tail area is 0.0823, so the p-value is \\(2 \\times 0.0823 = 0.1646\\). Since the p-value is larger than 0.05, we do not reject the null hypothesis. That is, there is not enough evidence to show the nutrition label has incorrect information. The normal model works well when the sample size is larger than about 30. For smaller sample sizes, we run into a problem: our estimate of \\(s\\), which is used to compute the standard error, isn’t as reliable when the sample size is small. To solve this problem, we’ll use a new distribution: the \\(t\\) distribution. 4.1.2 Introducing the \\(t\\) distribution A \\(t\\) distribution, shown as a solid line in Figure [tDistCompareToNormalDist], has a bell shape that looks very similar to a normal distribution (dotted line). However, its tails are thicker, which means observations are more likely to fall beyond two standard deviations from the mean than under the normal distribution.99 When our sample is small, the value \\(s\\) used to compute the standard error isn’t very reliable. The extra thick tails of the \\(t\\) distribution are exactly the correction we need to resolve this problem. Comparison of a \\(t\\) distribution (solid line) and a normal distribution (dotted line). [tDistCompareToNormalDist] The \\(t\\) distribution, always centered at zero, has a single parameter: degrees of freedom. The describe the precise form of the bell-shaped \\(t\\) distribution. Several \\(t\\) distributions are shown in Figure [tDistConvergeToNormalDist] with various degrees of freedom. When there are more degrees of freedom, the \\(t\\) distribution looks very much like the standard normal distribution. The larger the degrees of freedom, the more closely the \\(t\\) distribution resembles the standard normal model. [tDistConvergeToNormalDist] The degrees of freedom describe the shape of the \\(t\\) distribution. The larger the degrees of freedom, the more closely the distribution approximates the normal model. When the degrees of freedom is about 30 or more, the \\(t\\) distribution is nearly indistinguishable from the normal distribution, e.g. see Figure [tDistConvergeToNormalDist]. In Section [tDistSolutionToSEProblem], we relate degrees of freedom to sample size. We will find it very useful to become familiar with the \\(t\\) distribution, because it plays a very similar role to the normal distribution during inference for numerical data. We use a , partially shown in Table [tTableSample], in place of the normal probability table for small sample numerical data. A larger table is presented in Appendix . Alternatively, we could use statistical software to get this same information. r | rrr rr one tail &amp; 0.100 &amp; 0.050 &amp; 0.025 &amp; 0.010 &amp; 0.005 two tails &amp; 0.200 &amp; 0.100 &amp; 0.050 &amp; 0.020 &amp; 0.010 1 &amp; 3.08 &amp; 6.31 &amp; 12.71 &amp; 31.82 &amp; 63.66 2 &amp; 1.89 &amp; 2.92 &amp; 4.30 &amp; 6.96 &amp; 9.92 3 &amp; 1.64 &amp; 2.35 &amp; 3.18 &amp; 4.54 &amp; 5.84 \\(\\vdots\\) &amp; \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp; 17 &amp; 1.33 &amp; 1.74 &amp; 2.11 &amp; 2.57 &amp; 2.90 &amp; &amp; &amp; &amp; &amp; 19 &amp; 1.33 &amp; 1.73 &amp; 2.09 &amp; 2.54 &amp; 2.86 20 &amp; 1.33 &amp; 1.72 &amp; 2.09 &amp; 2.53 &amp; 2.85 \\(\\vdots\\) &amp; \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp; 400 &amp; 1.28 &amp; 1.65 &amp; 1.97 &amp; 2.34 &amp; 2.59 500 &amp; 1.28 &amp; 1.65 &amp; 1.96 &amp; 2.33 &amp; 2.59 \\(\\infty\\) &amp; 1.28 &amp; 1.65 &amp; 1.96 &amp; 2.33 &amp; 2.58 [tTableSample] Each row in the \\(t\\) table represents a \\(t\\) distribution with different degrees of freedom. The columns correspond to tail probabilities. For instance, if we know we are working with the \\(t\\) distribution with \\(df=18\\), we can examine row 18, which is in Table [tTableSample]. If we want the value in this row that identifies the cutoff for an upper tail of 10%, we can look in the column where one tail is 0.100. This cutoff is 1.33. If we had wanted the cutoff for the lower 10%, we would use -1.33. Just like the normal distribution, all \\(t\\) distributions are symmetric. What proportion of the \\(t\\) distribution with 18 degrees of freedom falls below -2.10? Just like a normal probability problem, we first draw the picture in Figure [tDistDF18LeftTail2Point10] and shade the area below -2.10. To find this area, we identify the appropriate row: \\(df=18\\). Then we identify the column containing the absolute value of -2.10; it is the third column. Because we are looking for just one tail, we examine the top line of the table, which shows that a one tail area for a value in the third row corresponds to 0.025. About 2.5% of the distribution falls below -2.10. In the next example we encounter a case where the exact \\(t\\) value is not listed in the table. The \\(t\\) distribution with 18 degrees of freedom. The area below -2.10 has been shaded. [tDistDF18LeftTail2Point10] A \\(t\\) distribution with 20 degrees of freedom is shown in the left panel of Figure [tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling above 1.65. We identify the row in the \\(t\\) table using the degrees of freedom: \\(df=20\\). Then we look for 1.65; it is not listed. It falls between the first and second columns. Since these values bound 1.65, their tail areas will bound the tail area corresponding to 1.65. We identify the one tail area of the first and second columns, 0.050 and 0.10, and we conclude that between 5% and 10% of the distribution is more than 1.65 standard deviations above the mean. If we like, we can identify the precise area using statistical software: 0.0573. Left: The \\(t\\) distribution with 20 degrees of freedom, with the area above 1.65 shaded. Right: The \\(t\\) distribution with 2 degrees of freedom, with the area further than 3 units from 0 shaded. [tDistDF20RightTail1Point65] A \\(t\\) distribution with 2 degrees of freedom is shown in the right panel of Figure [tDistDF20RightTail1Point65]. Estimate the proportion of the distribution falling more than 3 units from the mean (above or below). As before, first identify the appropriate row: \\(df=2\\). Next, find the columns that capture 3; because \\(2.92 &lt; 3 &lt; 4.30\\), we use the second and third columns. Finally, we find bounds for the tail areas by looking at the two tail values: 0.05 and 0.10. We use the two tail values because we are looking for two (symmetric) tails. What proportion of the \\(t\\) distribution with 19 degrees of freedom falls above -1.79 units?100 4.1.3 Applying the \\(t\\) distribution to the single-mean situation When estimating the mean and standard error from a sample of numerical data, the \\(t\\) distribution is a little more accurate than the normal model. This is true for both small and large samples, though the benefits for larger samples are limited. Use the \\(t\\) distribution for inference of the sample mean when observations are independent and nearly normal. You may relax the nearly normal condition as the sample size increases. For example, the data distribution may be moderately skewed when the sample size is at least 30. Before applying the \\(t\\) distribution for inference about a single mean, we check two conditions. Independence of observations. We verify this condition just as we did before. We collect a simple random sample from less than 10% of the population, or if the data are from an experiment or random process, we carefully check to the best of our abilities that the observations were independent. Observations come from a nearly normal distribution. This second condition is difficult to verify with small data sets. We often (i) take a look at a plot of the data for obvious departures from the normal model, usually in the form of prominent outliers, and (ii) consider whether any previous experiences alert us that the data may not be nearly normal. However, if the sample size is somewhat large, then we can relax this condition, e.g. moderate skew is acceptable when the sample size is 30 or more, and strong skew is acceptable when the size is about 60 or more. When examining a sample mean and estimated standard error from a sample of \\(n\\) independent and nearly normal observations, we use a \\(t\\) distribution with \\(n-1\\) degrees of freedom (\\(df\\)). For example, if the sample size was 19, then we would use the \\(t\\) distribution with \\(df=19-1=18\\) degrees of freedom and proceed in the same way as we did in Chapter [inferenceForCategoricalData], except that now we use the \\(t\\) table. If the sample has \\(n\\) observations and we are examining a single mean, then we use the \\(t\\) distribution with \\(df=n-1\\) degrees of freedom. 4.1.4 One sample \\(t\\) confidence intervals Dolphins are at the top of the oceanic food chain, which causes dangerous substances such as mercury to concentrate in their organs and muscles. This is an important problem for both dolphins and other animals, like humans, who occasionally eat them. For instance, this is particularly relevant in Japan where school meals have included dolphin at times. [rissosDolphin] Here we identify a confidence interval for the average mercury content in dolphin muscle using a sample of 19 Risso’s dolphins from the Taiji area in Japan.101 The data are summarized in Table [summaryStatsOfHgInMuscleOfRissosDolphins]. The minimum and maximum observed values can be used to evaluate whether or not there are obvious outliers or skew. Summary of mercury content in the muscle of 19 Risso’s dolphins from the Taiji area. Measurements are in \\(\\mu\\)g/wet g (micrograms of mercury per wet gram of muscle). \\(n\\) \\(\\bar{x}\\) \\(s\\) minimum maximum 19 4.4 2.3 1.7 9.2 [summaryStatsOfHgInMuscleOfRissosDolphins] Are the independence and normality conditions satisfied for this data set? The observations are a simple random sample and consist of less than 10% of the population, therefore independence is reasonable. Ideally we would see a visualization of the data to check for skew and outliers. However, we can instead examine the summary statistics in Table [summaryStatsOfHgInMuscleOfRissosDolphins], which do not suggest any skew or outliers. All observations are within 2.5 standard deviations of the mean. Based on this evidence, the normality assumption seems reasonable. In the normal model, we used \\(z^{\\star}\\) and the standard error to determine the width of a confidence interval. We revise the confidence interval formula slightly when using the \\(t\\) distribution: \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{df} \\times SE\\end{aligned}\\] [ \\(t^{\\star}_{df}\\) Multiplication factor for \\(t\\) conf. interval] \\(t^{\\star}_{df}\\) Multiplication factor for \\(t\\) conf. interval The sample mean and estimated standard error are computed just as in our earlier examples that used the normal model (\\(\\bar{x} = 4.4\\) and \\(SE = s/\\sqrt{n} = 0.528\\)). The value \\(t^{\\star}_{df}\\) is a cutoff we obtain based on the confidence level and the \\(t\\) distribution with \\(df\\) degrees of freedom. Before determining this cutoff, we will first need the degrees of freedom. In our current example, we should use the \\(t\\) distribution with \\(df = n - 1 = 19 - 1 = 18\\) degrees of freedom. Then identifying \\(t_{18}^{\\star}\\) is similar to how we found \\(z^{\\star}\\): For a 95% confidence interval, we want to find the cutoff \\(t^{\\star}_{18}\\) such that 95% of the \\(t\\) distribution is between -\\(t^{\\star}_{18}\\) and \\(t^{\\star}_{18}\\). We look in the \\(t\\) table on page , find the column with area totaling 0.05 in the two tails (third column), and then the row with 18 degrees of freedom: \\(t^{\\star}_{18} = 2.10\\). Generally the value of \\(t^{\\star}_{df}\\) is slightly larger than what we would get under the normal model with \\(z^{\\star}\\). Finally, we can substitute all the values into the confidence interval equation to create the 95% confidence interval for the average mercury content in muscles from Risso’s dolphins that pass through the Taiji area: \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{18} \\times SE \\quad \\to \\quad 4.4 \\ \\pm\\ 2.10 \\times 0.528 \\quad \\to \\quad (3.29, 5.51)\\end{aligned}\\] We are 95% confident the average mercury content of muscles in Risso’s dolphins is between 3.29 and 5.51 \\(\\mu\\)g/wet gram, which is considered extremely high. Based on a sample of \\(n\\) independent and nearly normal observations, a confidence interval for the population mean is \\[\\begin{aligned} \\bar{x} \\ \\pm\\ t^{\\star}_{df} \\times SE\\end{aligned}\\] where \\(\\bar{x}\\) is the sample mean, \\(t^{\\star}_{df}\\) corresponds to the confidence level and degrees of freedom, and \\(SE\\) is the standard error as estimated by the sample. The normality condition may be relaxed for larger sample sizes. [croakerWhiteFishPacificExerConditions] The FDA’s webpage provides some data on mercury content of fish.102 Based on a sample of 15 croaker white fish (Pacific), a sample mean and standard deviation were computed as 0.287 and 0.069 ppm (parts per million), respectively. The 15 observations ranged from 0.18 to 0.41 ppm. We will assume these observations are independent. Based on the summary statistics of the data, do you have any objections to the normality condition of the individual observations?103 Estimate the standard error of the sample mean using the data summaries in Guided Practice [croakerWhiteFishPacificExerConditions]. If we are to use the \\(t\\) distribution to create a 90% confidence interval for the actual mean of the mercury content, identify the degrees of freedom we should use and also find \\(t^{\\star}_{df}\\). [croakerWhiteFishPacificExerSEDFTStar] The standard error: \\(SE = \\frac{0.069}{\\sqrt{15}} = 0.0178\\). Degrees of freedom: \\(df = n - 1 = 14\\). Looking in the column where two tails is 0.100 (for a 90% confidence interval) and row \\(df=14\\), we identify \\(t^{\\star}_{14} = 1.76\\). Using the results of Guided Practice [croakerWhiteFishPacificExerConditions] and Example [croakerWhiteFishPacificExerSEDFTStar], compute a 90% confidence interval for the average mercury content of croaker white fish (Pacific).104 4.1.5 One sample \\(t\\) tests Is the typical US runner getting faster or slower over time? We consider this question in the context of the Cherry Blossom Run, comparing runners in 2006 and 2012. Technological advances in shoes, training, and diet might suggest runners would be faster in 2012. An opposing viewpoint might say that with the average body mass index on the rise, people tend to run slower. In fact, all of these components might be influencing run time. The average time for all runners who finished the Cherry Blossom Run in 2006 was 93.29 minutes (93 minutes and about 17 seconds). We want to determine using data from 100 participants in the 2012 Cherry Blossom Run whether runners in this race are getting faster or slower, versus the other possibility that there has been no change. What are appropriate hypotheses for this context?105 The data come from a simple random sample from less than 10% of all participants, so the observations are independent. However, should we be worried about skew in the data? A histogram of the differences was shown in the left panel of Figure . 106 With independence satisfied and skew not a concern, we can proceed with performing a hypothesis test using the \\(t\\) distribution. The sample mean and sample standard deviation are 95.61 and 15.78 minutes, respectively. Recall that the sample size is 100. What is the p-value for the test, and what is your conclusion?107 To help us remember to use the \\(t\\) distribution, we use a \\(T\\) to represent the test statistic, and we often call this a T score. The Z score and T score are computed in the exact same way and are conceptually identical: each represents how many standard errors the observed value is from the null value. 4.2 Paired data Are textbooks actually cheaper online? Here we compare the price of textbooks at the University of California, Los Angeles’ (UCLA’s) bookstore and prices at Amazon.com. Seventy-three UCLA courses were randomly sampled in Spring 2010, representing less than 10% of all UCLA courses.108 A portion of the data set is shown in Table [textbooksDF]. Six cases of the textbooks data set. dept course ucla amazon diff 1 Am Ind C170 27.67 27.95 -0.28 2 Anthro 9 40.59 31.14 9.45 3 Anthro 135T 31.68 32.00 -0.32 4 Anthro 191HB 16.00 11.52 4.48 \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 72 Wom Std M144 23.76 18.72 5.04 73 Wom Std 285 27.70 18.22 9.48 [textbooksDF] 4.2.1 Paired observations Each textbook has two corresponding prices in the data set: one for the UCLA bookstore and one for Amazon. Therefore, each textbook price from the UCLA bookstore has a natural correspondence with a textbook price from Amazon. When two sets of observations have this special correspondence, they are said to be paired. Two sets of observations are paired if each observation in one set has a special correspondence or connection with exactly one observation in the other data set. To analyze paired data, it is often useful to look at the difference in outcomes of each pair of observations. In the textbook data set, we look at the difference in prices, which is represented as the diff variable in the textbooks data. Here the differences are taken as \\[\\begin{aligned} \\text{UCLA price} - \\text{Amazon price}\\end{aligned}\\] for each book. It is important that we always subtract using a consistent order; here Amazon prices are always subtracted from UCLA prices. A histogram of these differences is shown in Figure [diffInTextbookPricesS10]. Using differences between paired observations is a common and useful way to analyze paired data. Histogram of the difference in price for each book sampled. These data are strongly skewed. [diffInTextbookPricesS10] The first difference shown in Table [textbooksDF] is computed as \\(27.67-27.95=-0.28\\). Verify the differences are calculated correctly for observations 2 and 3.109 4.2.2 Inference for paired data To analyze a paired data set, we simply analyze the differences. We can use the same \\(t\\) distribution techniques we applied in the last section. ccccc \\(n_{_{diff}}\\) &amp; &amp; \\(\\bar{x}_{_{diff}}\\) &amp; &amp; \\(s_{_{diff}}\\) 73 &amp;&amp; 12.76 &amp;&amp; 14.26 [textbooksSummaryStats] Set up and implement a hypothesis test to determine whether, on average, there is a difference between Amazon’s price for a book and the UCLA bookstore’s price. [htForDiffInUCLAAndAmazonTextbookPrices] We are considering two scenarios: there is no difference or there is some difference in average prices. \\(\\mu_{diff}=0\\). There is no difference in the average textbook price. \\(\\mu_{diff} \\neq 0\\). There is a difference in average prices. Can the \\(t\\) distribution be used for this application? The observations are based on a simple random sample from less than 10% of all books sold at the bookstore, so independence is reasonable. While the distribution is strongly skewed, the sample is reasonably large (\\(n=73\\)), so we can proceed. Because the conditions are reasonably satisfied, we can apply the \\(t\\) distribution to this setting. We compute the standard error associated with \\(\\bar{x}_{diff}\\) using the standard deviation of the differences (\\(s_{_{diff}}=14.26\\)) and the number of differences (\\(n_{_{diff}}=73\\)): \\[SE_{\\bar{x}_{diff}} = \\frac{s_{diff}}{\\sqrt{n_{diff}}} = \\frac{14.26}{\\sqrt{73}} = 1.67\\] To visualize the p-value, the sampling distribution of \\(\\bar{x}_{diff}\\) is drawn as though \\(H_0\\) is true, which is shown in Figure [textbooksS10HTTails]. The p-value is represented by the two (very) small tails. To find the tail areas, we compute the test statistic, which is the T score of \\(\\bar{x}_{diff}\\) under the null condition that the actual mean difference is 0: \\[T = \\frac{\\bar{x}_{diff} - 0}{SE_{x_{diff}}} = \\frac{12.76 - 0}{1.67} = 7.59\\] The degrees of freedom are \\(df = 73 - 1 = 72\\). If we examined Appendix , we would see that this value is larger than any in the 70 df row (we round down for \\(df\\) when using the table), meaning the two-tailed p-value is less than 0.01. If we used statistical software, we would find the p-value is less than 1-in-10 billion! Because the p-value is less than 0.05, we reject the null hypothesis. We have found convincing evidence that Amazon is, on average, cheaper than the UCLA bookstore for UCLA course textbooks. Sampling distribution for the mean difference in book prices, if the true average difference is zero. [textbooksS10HTTails] Create a 95% confidence interval for the average price difference between books at the UCLA bookstore and books on Amazon.110 In the textbook price example, we applied the \\(t\\) distribution. However, as we mentioned in the last section, the \\(t\\) distribution looks a lot like the normal distribution when the degrees of freedom are larger than about 30. In such cases, including this one, it would be reasonable to use the normal distribution in place of the \\(t\\) distribution. 4.3 Difference of two means In this section we consider a difference in two population means, \\(\\mu_1 - \\mu_2\\), under the condition that the data are not paired. Just as with a single sample, we identify conditions to ensure we can use the \\(t\\) distribution with a point estimate of the difference, \\(\\bar{x}_1 - \\bar{x}_2\\). We apply these methods in three contexts: determining whether stem cells can improve heart function, exploring the impact of pregnant womens’ smoking habits on birth weights of newborns, and exploring whether there is statistically significant evidence that one variations of an exam is harder than another variation. This section is motivated by questions like “Is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who don’t smoke?” 4.3.1 Confidence interval for a differences of means Does treatment using embryonic stem cells (ESCs) help improve heart function following a heart attack? Table [summaryStatsForSheepHeartDataWhoReceivedMiceESCs] contains summary statistics for an experiment to test ESCs in sheep that had a heart attack. Each of these sheep was randomly assigned to the ESC or control group, and the change in their hearts’ pumping capacity was measured in the study. A positive value corresponds to increased pumping capacity, which generally suggests a stronger recovery. Our goal will be to identify a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity relative to the control group. A point estimate of the difference in the heart pumping variable can be found using the difference in the sample means: \\[\\begin{aligned} \\bar{x}_{esc} - \\bar{x}_{control}\\ =\\ 3.50 - (-4.33)\\ =\\ 7.83\\end{aligned}\\] l rrrrr &amp; \\(n\\) &amp; \\(\\bar{x}\\) &amp; \\(s\\) ESCs &amp; 9 &amp; 3.50 &amp; 5.17 control &amp; 9 &amp; -4.33 &amp; 2.76 [summaryStatsForSheepHeartDataWhoReceivedMiceESCs] Histograms for both the embryonic stem cell group and the control group. Higher values are associated with greater improvement. We don’t see any evidence of skew in these data; however, it is worth noting that skew would be difficult to detect with such a small sample. [stemCellTherapyForHearts] [ConditionsForTwoSampleTDist]The \\(t\\) distribution can be used for inference when working with the standardized difference of two means if (1) each sample meets the conditions for using the \\(t\\) distribution and (2) the samples are independent. Can the point estimate, \\(\\bar{x}_{esc} - \\bar{x}_{control} = 7.83\\), be analyzed using the \\(t\\) distribution? We check the two required conditions: In this study, the sheep were independent of each other. Additionally, the distributions in Figure [stemCellTherapyForHearts] don’t show any clear deviations from normality, where we watch for prominent outliers in particular for such small samples. These findings imply each sample mean could itself be modeled using a \\(t\\) distribution. The sheep in each group were also independent of each other. Because both conditions are met, we can use the \\(t\\) distribution to model the difference of the two sample means. Before we construct a confidence interval, we must calculate the standard error of the point estimate of the difference. For this, we use the following formula, where just as before we substitute the sample standard deviations into the formula: \\[\\begin{aligned} SE_{\\bar{x}_{esc} - \\bar{x}_{control}} &amp;= \\sqrt{\\frac{\\sigma_{esc}^2}{n_{esc}} + \\frac{\\sigma_{control}^2}{n_{control}}} \\\\ &amp;\\approx \\sqrt{\\frac{s_{esc}^2}{n_{esc}} + \\frac{s_{control}^2}{n_{control}}} = \\sqrt{\\frac{5.17^2}{9} + \\frac{2.76^2}{9}} = 1.95\\end{aligned}\\] Because we will use the \\(t\\) distribution, we also must identify the appropriate degrees of freedom. This can be done using computer software. An alternative technique is to use the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\), which is the method we will typically apply in the examples and guided practice.111 The sample difference of two means, \\(\\bar{x}_1 - \\bar{x}_2\\), can be modeled using the \\(t\\) distribution and the standard error \\[\\begin{aligned} \\textstyle SE_{\\bar{x}_{1} - \\bar{x}_{2}} = \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}} \\label{seOfDifferenceInMeans}\\end{aligned}\\] when each sample mean can itself be modeled using a \\(t\\) distribution and the samples are independent. To calculate the degrees of freedom, use statistical software or the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\). Calculate a 95% confidence interval for the effect of ESCs on the change in heart pumping capacity of sheep after they’ve suffered a heart attack. We will use the sample difference and the standard error for that point estimate from our earlier calculations: \\[\\begin{aligned} &amp; \\bar{x}_{esc} - \\bar{x}_{control} = 7.83 \\\\ &amp; SE = \\sqrt{\\frac{5.17^2}{9} + \\frac{2.76^2}{9}} = 1.95\\end{aligned}\\] Using \\(df = 8\\), we can identify the appropriate \\(t^{\\star}_{df} = t^{\\star}_{8}\\) for a 95% confidence interval as 2.31. Finally, we can enter the values into the confidence interval formula: \\[\\begin{aligned} \\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad\\rightarrow\\quad 7.83 \\ \\pm\\ 2.31\\times 1.95 \\quad\\rightarrow\\quad (3.38, 12.38)\\end{aligned}\\] We are 95% confident that embryonic stem cells improve the heart’s pumping function in sheep that have suffered a heart attack by 3.38% to 12.38%. 4.3.2 Hypothesis tests based on a difference in means A data set called represents a random sample of 150 cases of mothers and their newborns in North Carolina over a year. Four cases from this data set are represented in Table [babySmokeDF]. We are particularly interested in two variables: weight and smoke. The weight variable represents the weights of the newborns and the smoke variable describes which mothers smoked during pregnancy. We would like to know, is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who don’t smoke? We will use the North Carolina sample to try to answer this question. The smoking group includes 50 cases and the nonsmoking group contains 100 cases, represented in Figure [babySmokePlotOfTwoGroupsToExamineSkew]. Four cases from the data set. The value “NA”, shown for the first two entries of the first variable, indicates that piece of data is missing. fAge mAge weeks weight sexBaby smoke 1 NA 13 37 5.00 female nonsmoker 2 NA 14 36 5.88 female nonsmoker 3 19 15 41 8.13 male smoker \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 150 45 50 36 9.25 female nonsmoker [babySmokeDF] The top panel represents birth weights for infants whose mothers smoked. The bottom panel represents the birth weights for infants whose mothers who did not smoke. The distributions exhibit moderate-to-strong and strong skew, respectively. [babySmokePlotOfTwoGroupsToExamineSkew] Set up appropriate hypotheses to evaluate whether there is a relationship between a mother smoking and average birth weight.[babySmokeHTForWeight] The null hypothesis represents the case of no difference between the groups. There is no difference in average birth weight for newborns from mothers who did and did not smoke. In statistical notation: \\(\\mu_{n} - \\mu_{s} = 0\\), where \\(\\mu_{n}\\) represents non-smoking mothers and \\(\\mu_s\\) represents mothers who smoked. There is some difference in average newborn weights from mothers who did and did not smoke (\\(\\mu_{n} - \\mu_{s} \\neq 0\\)). We check the two conditions necessary to apply the \\(t\\) distribution to the difference in sample means. (1) Because the data come from a simple random sample and consist of less than 10% of all such cases, the observations are independent. Additionally, while each distribution is strongly skewed, the sample sizes of 50 and 100 would make it reasonable to model each mean separately using a \\(t\\) distribution. The skew is reasonable for these sample sizes of 50 and 100. (2) The independence reasoning applied in (1) also ensures the observations in each sample are independent. Since both conditions are satisfied, the difference in sample means may be modeled using a \\(t\\) distribution. Summary statistics for the data set. mean 6.78 7.18 st. dev. 1.43 1.60 samp. size 50 100 [summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers] The summary statistics in Table [summaryStatsOfBirthWeightForNewbornsFromSmokingAndNonsmokingMothers] may be useful for this exercise. (a) What is the point estimate of the population difference, \\(\\mu_{n} - \\mu_{s}\\)? (b) Compute the standard error of the point estimate from part (a).112 Draw a picture to represent the p-value for the hypothesis test from Example [babySmokeHTForWeight]. [pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights] To depict the p-value, we draw the distribution of the point estimate as though \\(H_0\\) were true and shade areas representing at least as much evidence against \\(H_0\\) as what was observed. Both tails are shaded because it is a two-sided test. image Compute the p-value of the hypothesis test using the figure in Example [pictureOfPValueForEstimateOfDiffOfMeansOfBirthWeights], and evaluate the hypotheses using a significance level of \\(\\alpha=0.05\\). [babySmokeHTForWeightComputePValueAndEvalHT] We start by computing the T score: \\[\\begin{aligned} T = \\frac{\\ 0.40 - 0\\ }{0.26} = 1.54\\end{aligned}\\] Next, we compare this value to values in the \\(t\\) table in Appendix , where we use the smaller of \\(n_n - 1 = 99\\) and \\(n_s - 1 = 49\\) as the degrees of freedom: \\(df = 49\\). The T score falls between the first and second columns in the \\(df = 49\\) row of the \\(t\\) table, meaning the two-tailed p-value falls between 0.10 and 0.20 (reminder, find tail areas along the top of the table). This p-value is larger than the significance value, 0.05, so we fail to reject the null hypothesis. There is insufficient evidence to say there is a difference in average birth weight of newborns from North Carolina mothers who did smoke during pregnancy and newborns from North Carolina mothers who did not smoke during pregnancy. Does the conclusion to Example [babySmokeHTForWeightComputePValueAndEvalHT] mean that smoking and average birth weight are unrelated?113 [babySmokeHTIDingHowToDetectDifferences] If we made a Type 2 Error and there is a difference, what could we have done differently in data collection to be more likely to detect such a difference?114 4.3.3 Case study: two versions of a course exam An instructor decided to run two slight variations of the same exam. Prior to passing out the exams, she shuffled the exams together to ensure each student received a random version. Summary statistics for how students performed on these two exams are shown in Table [summaryStatsForTwoVersionsOfExams]. Anticipating complaints from students who took Version B, she would like to evaluate whether the difference observed in the groups is so large that it provides convincing evidence that Version B was more difficult (on average) than Version A. l rrrrr Version &amp; \\(n\\) &amp; \\(\\bar{x}\\) &amp; \\(s\\) &amp; min &amp; max A &amp; 30 &amp; 79.4 &amp; 14 &amp; 45 &amp; 100 B &amp; 27 &amp; 74.1 &amp; 20 &amp; 32 &amp; 100 [summaryStatsForTwoVersionsOfExams] [htSetupForEvaluatingTwoExamVersions] Construct a hypotheses to evaluate whether the observed difference in sample means, \\(\\bar{x}_A - \\bar{x}_B=5.3\\), is due to chance.115 [conditionsForTDistForEvaluatingTwoExamVersions] To evaluate the hypotheses in Guided Practice [htSetupForEvaluatingTwoExamVersions] using the \\(t\\) distribution, we must first verify assumptions. (a) Does it seem reasonable that the scores are independent within each group? (b) What about the normality / skew condition for observations in each group? (c) Do you think scores from the two groups would be independent of each other, i.e. the two samples are independent?116 After verifying the conditions for each sample and confirming the samples are independent of each other, we are ready to conduct the test using the \\(t\\) distribution. In this case, we are estimating the true difference in average test scores using the sample data, so the point estimate is \\(\\bar{x}_A - \\bar{x}_B = 5.3\\). The standard error of the estimate can be calculated as \\[\\begin{aligned} SE = \\sqrt{\\frac{s_A^2}{n_A} + \\frac{s_B^2}{n_B}} = \\sqrt{\\frac{14^2}{30} + \\frac{20^2}{27}} = 4.62\\end{aligned}\\] Finally, we construct the test statistic: \\[\\begin{aligned} T = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{(79.4-74.1) - 0}{4.62} = 1.15\\end{aligned}\\] If we have a computer handy, we can identify the degrees of freedom as 45.97. Otherwise we use the smaller of \\(n_1-1\\) and \\(n_2-1\\): \\(df=26\\). The \\(t\\) distribution with 26 degrees of freedom. The shaded right tail represents values with \\(T \\geq 1.15\\). Because it is a two-sided test, we also shade the corresponding lower tail. [pValueOfTwoTailAreaOfExamVersionsWhereDFIs26] Identify the p-value using \\(df = 26\\) and provide a conclusion in the context of the case study. We examine row \\(df=26\\) in the \\(t\\) table. Because this value is smaller than the value in the left column, the p-value is larger than 0.200 (two tails!). Because the p-value is so large, we do not reject the null hypothesis. That is, the data do not convincingly show that one exam version is more difficult than the other, and the teacher should not be convinced that she should add points to the Version B exam scores. 4.3.4 Summary for inference using the \\(t\\) distribution Hypothesis tests. When applying the \\(t\\) distribution for a hypothesis test, we proceed as follows: Write appropriate hypotheses. Verify conditions for using the \\(t\\) distribution. One-sample or differences from paired data: the observations (or differences) must be independent and nearly normal. For larger sample sizes, we can relax the nearly normal requirement, e.g. slight skew is okay or sample sizes of 15, moderate skew for sample sizes of 30, and strong skew for sample sizes of 60. For a difference of means when the data are not paired: each sample mean must separately satisfy the one-sample conditions for the \\(t\\) distribution, and the data in the groups must also be independent. Compute the point estimate of interest, the standard error, and the degrees of freedom. For \\(df\\), use \\(n-1\\) for one sample, and for two samples use either statistical software or the smaller of \\(n_1 - 1\\) and \\(n_2 - 1\\). Compute the T score and p-value. Make a conclusion based on the p-value, and write a conclusion in context and in plain language so anyone can understand the result. Confidence intervals. Similarly, the following is how we generally computed a confidence interval using a \\(t\\) distribution: Verify conditions for using the \\(t\\) distribution. (See above.) Compute the point estimate of interest, the standard error, the degrees of freedom, and \\(t^{\\star}_df\\). Calculate the confidence interval using the general formula, point estimate \\(\\pm t_{df}^{\\star} SE\\). Put the conclusions in context and in plain language so even non-statisticians can understand the results. 4.3.5 Pooled standard deviation estimate (special topic) Occasionally, two populations will have standard deviations that are so similar that they can be treated as identical. For example, historical data or a well-understood biological mechanism may justify this strong assumption. In such cases, we can make the \\(t\\) distribution approach slightly more precise by using a pooled standard deviation. The pooled standard deviation of two groups is a way to use data from both samples to better estimate the standard deviation and standard error. If \\(s_1^{}\\) and \\(s_2^{}\\) are the standard deviations of groups 1 and 2 and there are good reasons to believe that the population standard deviations are equal, then we can obtain an improved estimate of the group variances by pooling their data: \\[\\begin{aligned} s_{pooled}^2 = \\frac{s_1^2\\times (n_1-1) + s_2^2\\times (n_2-1)}{n_1 + n_2 - 2}\\end{aligned}\\] where \\(n_1\\) and \\(n_2\\) are the sample sizes, as before. To use this new statistic, we substitute \\(s_{pooled}^2\\) in place of \\(s_1^2\\) and \\(s_2^2\\) in the standard error formula, and we use an updated formula for the degrees of freedom: \\[\\begin{aligned} df = n_1 + n_2 - 2\\end{aligned}\\] The benefits of pooling the standard deviation are realized through obtaining a better estimate of the standard deviation for each group and using a larger degrees of freedom parameter for the \\(t\\) distribution. Both of these changes may permit a more accurate model of the sampling distribution of \\(\\bar{x}_1 - \\bar{x}_2\\). Pooling standard deviations should be done only after careful research A pooled standard deviation is only appropriate when background research indicates the population standard deviations are nearly equal. When the sample size is large and the condition may be adequately checked with data, the benefits of pooling the standard deviations greatly diminishes. See www.cherryblossom.org.↩ As before, we identify the point estimate, \\(\\bar{x} = 35.05\\), and the standard error, \\(SE = 8.97 / \\sqrt{100} = 0.897\\). Next, we apply the formula for a 90% confidence interval, which uses \\(z^{\\star} = 1.65\\): \\(35.05 \\pm 1.65\\times 0.897 \\to (33.57, 36.53)\\). We are 90% confident that the average age of all participants in the 2012 Cherry Blossom Run is between 33.57 and 36.53 years.↩ The standard deviation of the \\(t\\) distribution is actually a little more than 1. However, it is useful to always think of the \\(t\\) distribution as having a standard deviation of 1 in all of our applications.↩ We find the shaded area above -1.79 (we leave the picture to you). The small left tail is between 0.025 and 0.05, so the larger upper region must have an area between 0.95 and 0.975.↩ Taiji was featured in the movie The Cove, and it is a significant source of dolphin and whale meat in Japan. Thousands of dolphins pass through the Taiji area annually, and we will assume these 19 dolphins represent a simple random sample from those dolphins. Data reference: Endo T and Haraguchi K. 2009. High mercury levels in hair samples from residents of Taiji, a Japanese whaling town. Marine Pollution Bulletin 60(5):743-747.↩ http://www.fda.gov/food/foodborneillnesscontaminants/metals/ucm115644.htm↩ There are no obvious outliers; all observations are within 2 standard deviations of the mean. If there is skew, it is not evident. There are no red flags for the normal model based on this (limited) information, and we do not have reason to believe the mercury content is not nearly normal in this type of fish.↩ \\(\\bar{x} \\ \\pm\\ t^{\\star}_{14} \\times SE \\ \\to\\ 0.287 \\ \\pm\\ 1.76\\times 0.0178\\ \\to\\ (0.256, 0.318)\\). We are 90% confident that the average mercury content of croaker white fish (Pacific) is between 0.256 and 0.318 ppm.↩ \\(H_0\\): The average 10 mile run time was the same for 2006 and 2012. \\(\\mu = 93.29\\) minutes. \\(H_A\\): The average 10 mile run time for 2012 was different than that of 2006. \\(\\mu \\neq 93.29\\) minutes.↩ With a sample of 100, we should only be concerned if there is extreme skew. The histogram of the data suggest, at worst, slight skew.↩ With the conditions satisfied for the \\(t\\) distribution, we can compute the standard error (\\(SE = 15.78 / \\sqrt{100} = 1.58\\) and the T score: \\(T = \\frac{95.61 - 93.29}{1.58} = 1.47\\). (There is more on this after the guided practice, but a T score and Z score are basically the same thing.) For \\(df = 100 - 1 = 99\\), we would find \\(T = 1.47\\) to fall between the first and second column, which means the p-value is between 0.05 and 0.10 (use \\(df = 90\\) and consider two tails since the test is two-sided). Because the p-value is greater than 0.05, we do not reject the null hypothesis. That is, the data do not provide strong evidence that the average run time for the Cherry Blossom Run in 2012 is any different than the 2006 average.↩ When a class had multiple books, only the most expensive text was considered.↩ Observation 2: \\(40.59 - 31.14 = 9.45\\). Observation 3: \\(31.68 - 32.00 = -0.32\\).↩ Conditions have already verified and the standard error computed in Example [htForDiffInUCLAAndAmazonTextbookPrices]. To find the interval, identify \\(t^{\\star}_{72}\\) (use \\(df=70\\) in the table, \\(t^{\\star}_{70} = 1.99\\)) and plug it, the point estimate, and the standard error into the confidence interval formula: \\[\\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad\\to\\quad 12.76 \\ \\pm\\ 1.99\\times 1.67 \\quad\\to\\quad (9.44, 16.08)\\] We are 95% confident that Amazon is, on average, between $9.44 and $16.08 cheaper than the UCLA bookstore for UCLA course books.↩ This technique for degrees of freedom is conservative with respect to a Type 1 Error; it is more difficult to reject the null hypothesis using this \\(df\\) method. In this example, computer software would have provided us a more precise degrees of freedom of \\(df = 12.225\\).↩ (a) The difference in sample means is an appropriate point estimate: \\(\\bar{x}_{n} - \\bar{x}_{s} = 0.40\\). (b) The standard error of the estimate can be estimated using Equation ([seOfDifferenceInMeans]): \\[\\begin{aligned} SE = \\sqrt{\\frac{\\sigma_n^2}{n_n} + \\frac{\\sigma_s^2}{n_s}} \\approx \\sqrt{\\frac{s_n^2}{n_n} + \\frac{s_s^2}{n_s}} = \\sqrt{\\frac{1.60^2}{100} + \\frac{1.43^2}{50}} = 0.26\\end{aligned}\\]↩ Absolutely not. It is possible that there is some difference but we did not detect it. If there is a difference, we made a Type 2 Error. Notice: we also don’t have enough information to, if there is an actual difference difference, confidently say which direction that difference would be in.↩ We could have collected more data. If the sample sizes are larger, we tend to have a better shot at finding a difference if one exists.↩ Because the teacher did not expect one exam to be more difficult prior to examining the test results, she should use a two-sided hypothesis test. \\(H_0\\): the exams are equally difficult, on average. \\(\\mu_A - \\mu_B = 0\\). \\(H_A\\): one exam was more difficult than the other, on average. \\(\\mu_A - \\mu_B \\neq 0\\).↩ (a) It is probably reasonable to conclude the scores are independent, provided there was no cheating. (b) The summary statistics suggest the data are roughly symmetric about the mean, and it doesn’t seem unreasonable to suggest the data might be normal. Note that since these samples are each nearing 30, moderate skew in the data would be acceptable. (c) It seems reasonable to suppose that the samples are independent since the exams were handed out randomly.↩ "],
["inferenceForNumericalDataANOVA.html", "Chapter 5 Inference for numerical data: ANOVA 5.1 Comparing many means with ANOVA 5.2 Bootstrapping to study the standard deviation", " Chapter 5 Inference for numerical data: ANOVA 5.1 Comparing many means with ANOVA Sometimes we want to compare means across many groups. We might initially think to do pairwise comparisons; for example, if there were three groups, we might be tempted to compare the first mean with the second, then with the third, and then finally compare the second and third means for a total of three comparisons. However, this strategy can be treacherous. If we have many groups and do many comparisons, it is likely that we will eventually find a difference just by chance, even if there is no difference in the populations. In this section, we will learn a new method called analysis of variance (ANOVA) and a new test statistic called \\(F\\). ANOVA uses a single hypothesis test to check whether the means across many groups are equal: The mean outcome is the same across all groups. In statistical notation, \\(\\mu_1 = \\mu_2 = \\cdots = \\mu_k\\) where \\(\\mu_i\\) represents the mean of the outcome for observations in category \\(i\\). At least one mean is different. Generally we must check three conditions on the data before performing ANOVA: the observations are independent within and across groups, the data within each group are nearly normal, and the variability across the groups is about equal. When these three conditions are met, we may perform an ANOVA to determine whether the data provide strong evidence against the null hypothesis that all the \\(\\mu_i\\) are equal. College departments commonly run multiple lectures of the same introductory course each semester because of high demand. Consider a statistics department that runs three lectures of an introductory statistics course. We might like to determine whether there are statistically significant differences in first exam scores in these three classes (\\(A\\), \\(B\\), and \\(C\\)). Describe appropriate hypotheses to determine whether there are any differences between the three classes. [firstExampleForThreeStatisticsClassesAndANOVA] The hypotheses may be written in the following form: The average score is identical in all lectures. Any observed difference is due to chance. Notationally, we write \\(\\mu_A=\\mu_B=\\mu_C\\). The average score varies by class. We would reject the null hypothesis in favor of the alternative hypothesis if there were larger differences among the class averages than what we might expect from chance alone. Strong evidence favoring the alternative hypothesis in ANOVA is described by unusually large differences among the group means. We will soon learn that assessing the variability of the group means relative to the variability among individual observations within each group is key to ANOVA’s success. Examine Figure [toyANOVA]. Compare groups I, II, and III. Can you visually determine if the differences in the group centers is due to chance or not? Now compare groups IV, V, and VI. Do these differences appear to be due to chance? Side-by-side dot plot for the outcomes for six groups. [toyANOVA] Any real difference in the means of groups I, II, and III is difficult to discern, because the data within each group are very volatile relative to any differences in the average outcome. On the other hand, it appears there are differences in the centers of groups IV, V, and VI. For instance, group V appears to have a higher mean than that of the other two groups. Investigating groups IV, V, and VI, we see the differences in the groups’ centers are noticeable because those differences are large relative to the variability in the individual observations within each group. 5.1.1 Is batting performance related to player position in MLB? We would like to discern whether there are real differences between the batting performance of baseball players according to their position: outfielder (), infielder (), designated hitter (), and catcher (). We will use a data set called bat10, which includes batting records of 327 Major League Baseball (MLB) players from the 2010 season. Six of the 327 cases represented in bat10 are shown in Table [mlbBat10DataMatrix], and descriptions for each variable are provided in Table [mlbBat10Variables]. The measure we will use for the player batting performance (the outcome variable) is on-base percentage (OBP). The on-base percentage roughly represents the fraction of the time a player successfully gets on base or hits a home run. Six cases from the bat10 data matrix. name team position AB H HR RBI AVG OBP 1 I Suzuki SEA OF 680 214 6 43 0.315 0.359 2 D Jeter NYY IF 663 179 10 67 0.270 0.340 3 M Young TEX IF 656 186 21 91 0.284 0.330 \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) \\(\\vdots\\) 325 B Molina SF C 202 52 3 17 0.257 0.312 326 J Thole NYM C 202 56 3 17 0.277 0.357 327 C Heisey CIN OF 201 51 8 21 0.254 0.324 [mlbBat10DataMatrix] Variables and their descriptions for the bat10 data set. variable description name Player name team The abbreviated name of the player’s team position The player’s primary field position (, , , ) AB Number of opportunities at bat H Number of hits HR Number of home runs RBI Number of runs batted in AVG Batting average, which is equal to \\(\\resp{H}/\\resp{AB}\\) OBP On-base percentage, which is roughly equal to the fraction of times a player gets on base or hits a home run [mlbBat10Variables] [nullHypForOBPAgainstPosition] The null hypothesis under consideration is the following: \\(\\mu_{\\resp{OF}} = \\mu_{\\resp{IF}} = \\mu_{\\resp{DH}} = \\mu_{\\resp{C}}\\). Write the null and corresponding alternative hypotheses in plain language.117 The player positions have been divided into four groups: outfield (), infield (), designated hitter (), and catcher (). What would be an appropriate point estimate of the on-base percentage by outfielders, \\(\\mu_{\\resp{OF}}\\)? A good estimate of the on-base percentage by outfielders would be the sample average of AVG for just those players whose position is outfield: \\(\\bar{x}_{OF} = 0.334\\). Table [mlbHRPerABSummaryTable] provides summary statistics for each group. A side-by-side box plot for the on-base percentage is shown in Figure [mlbANOVABoxPlot]. Notice that the variability appears to be approximately constant across groups; nearly constant variance across groups is an important assumption that must be satisfied before we consider the ANOVA approach. Summary statistics of on-base percentage, split by player position. Sample size (\\(n_i\\)) 120 154 14 39 Sample mean (\\(\\bar{x}_i\\)) 0.334 0.332 0.348 0.323 Sample SD (\\(s_i\\)) 0.029 0.037 0.036 0.045 [mlbHRPerABSummaryTable] Side-by-side box plot of the on-base percentage for 327 players across four groups. There is one prominent outlier visible in the infield group, but with 154 observations in the infield group, this outlier is not a concern. [mlbANOVABoxPlot] The largest difference between the sample means is between the designated hitter and the catcher positions. Consider again the original hypotheses: \\(\\mu_{\\resp{OF}} = \\mu_{\\resp{IF}} = \\mu_{\\resp{DH}} = \\mu_{\\resp{C}}\\) The average on-base percentage (\\(\\mu_i\\)) varies across some (or all) groups. Why might it be inappropriate to run the test by simply estimating whether the difference of \\(\\mu_{\\textbf{DH}}\\) and \\(\\mu_{\\resp{C}}\\) is statistically significant at a 0.05 significance level? [multipleComparisonExampleThatIncludesDiscussionOfClassrooms] The primary issue here is that we are inspecting the data before picking the groups that will be compared. It is inappropriate to examine all data by eye (informal testing) and only afterwards decide which parts to formally test. This is called data snooping or data fishing. Naturally we would pick the groups with the large differences for the formal test, leading to an inflation in the Type 1 Error rate. To understand this better, let’s consider a slightly different problem. Suppose we are to measure the aptitude for students in 20 classes in a large elementary school at the beginning of the year. In this school, all students are randomly assigned to classrooms, so any differences we observe between the classes at the start of the year are completely due to chance. However, with so many groups, we will probably observe a few groups that look rather different from each other. If we select only these classes that look so different, we will probably make the wrong conclusion that the assignment wasn’t random. While we might only formally test differences for a few pairs of classes, we informally evaluated the other classes by eye before choosing the most extreme cases for a comparison. For additional information on the ideas expressed in Example [multipleComparisonExampleThatIncludesDiscussionOfClassrooms], we recommend reading about the prosecutor’s fallacy.118 In the next section we will learn how to use the \\(F\\) statistic and ANOVA to test whether observed differences in means could have happened just by chance even if there was no difference in the respective population means. 5.1.2 Analysis of variance (ANOVA) and the F test The method of analysis of variance in this context focuses on answering one question: is the variability in the sample means so large that it seems unlikely to be from chance alone? This question is different from earlier testing procedures since we will simultaneously consider many groups, and evaluate whether their sample means differ more than we would expect from natural variation. We call this variability the mean square between groups (\\(MSG\\)), and it has an associated degrees of freedom, \\(df_{G}=k-1\\) when there are \\(k\\) groups. The \\(MSG\\) can be thought of as a scaled variance formula for means. If the null hypothesis is true, any variation in the sample means is due to chance and shouldn’t be too large. Details of \\(MSG\\) calculations are provided in the footnote,119 however, we typically use software for these computations. The mean square between the groups is, on its own, quite useless in a hypothesis test. We need a benchmark value for how much variability should be expected among the sample means if the null hypothesis is true. To this end, we compute a pooled variance estimate, often abbreviated as the mean square error (\\(MSE\\)), which has an associated degrees of freedom value \\(df_E=n-k\\). It is helpful to think of \\(MSE\\) as a measure of the variability within the groups. Details of the computations of the \\(MSE\\) are provided in the footnote120 for interested readers. When the null hypothesis is true, any differences among the sample means are only due to chance, and the \\(MSG\\) and \\(MSE\\) should be about equal. As a test statistic for ANOVA, we examine the fraction of \\(MSG\\) and \\(MSE\\): \\[\\begin{aligned} \\label{formulaForTheFStatistic} F = \\frac{MSG}{MSE}\\end{aligned}\\] The \\(MSG\\) represents a measure of the between-group variability, and \\(MSE\\) measures the variability within each of the groups. For the baseball data, \\(MSG = 0.00252\\) and \\(MSE=0.00127\\). Identify the degrees of freedom associated with MSG and MSE and verify the \\(F\\) statistic is approximately 1.994.121 We can use the \\(F\\) statistic to evaluate the hypotheses in what is called an F test. A p-value can be computed from the \\(F\\) statistic using an \\(F\\) distribution, which has two associated parameters: \\(df_{1}\\) and \\(df_{2}\\). For the \\(F\\) statistic in ANOVA, \\(df_{1} = df_{G}\\) and \\(df_{2}= df_{E}\\). An \\(F\\) distribution with 3 and 323 degrees of freedom, corresponding to the \\(F\\) statistic for the baseball hypothesis test, is shown in Figure [fDist3And323]. An \\(F\\) distribution with \\(df_1=3\\) and \\(df_2=323\\). [fDist3And323] The larger the observed variability in the sample means (\\(MSG\\)) relative to the within-group observations (\\(MSE\\)), the larger \\(F\\) will be and the stronger the evidence against the null hypothesis. Because larger values of \\(F\\) represent stronger evidence against the null hypothesis, we use the upper tail of the distribution to compute a p-value. Analysis of variance (ANOVA) is used to test whether the mean outcome differs across 2 or more groups. ANOVA uses a test statistic \\(F\\), which represents a standardized ratio of variability in the sample means relative to the variability within the groups. If \\(H_0\\) is true and the model assumptions are satisfied, the statistic \\(F\\) follows an \\(F\\) distribution with parameters \\(df_{1}=k-1\\) and \\(df_{2}=n-k\\). The upper tail of the \\(F\\) distribution is used to represent the p-value. [describePValueAreaForFDistributionInMLBOBPExample] The test statistic for the baseball example is \\(F=1.994\\). Shade the area corresponding to the p-value in Figure [fDist3And323].122 The p-value corresponding to the shaded area in the solution of Guided Practice [describePValueAreaForFDistributionInMLBOBPExample] is equal to about 0.115. Does this provide strong evidence against the null hypothesis? The p-value is larger than 0.05, indicating the evidence is not strong enough to reject the null hypothesis at a significance level of 0.05. That is, the data do not provide strong evidence that the average on-base percentage varies by player’s primary field position. 5.1.3 Reading an ANOVA table from software The calculations required to perform an ANOVA by hand are tedious and prone to human error. For these reasons, it is common to use statistical software to calculate the \\(F\\) statistic and p-value. An ANOVA can be summarized in a table very similar to that of a regression summary, which we will see in . Table [anovaSummaryTableForOBPAgainstPosition] shows an ANOVA summary to test whether the mean of on-base percentage varies by player positions in the MLB. Many of these values should look familiar; in particular, the \\(F\\) test statistic and p-value can be retrieved from the last columns. lrrrrr &amp; Df &amp; Sum Sq &amp; Mean Sq &amp; F value &amp; Pr(\\(&gt;\\)F) position &amp; 3 &amp; 0.0076 &amp; 0.0025 &amp; 1.9943 &amp; 0.1147 Residuals &amp; 323 &amp; 0.4080 &amp; 0.0013 &amp; &amp; [anovaSummaryTableForOBPAgainstPosition] 5.1.4 Graphical diagnostics for an ANOVA analysis There are three conditions we must check for an ANOVA analysis: all observations must be independent, the data in each group must be nearly normal, and the variance within each group must be approximately equal. Independence. If the data are a simple random sample from less than 10% of the population, this condition is satisfied. For processes and experiments, carefully consider whether the data may be independent (e.g. no pairing). For example, in the MLB data, the data were not sampled. However, there are not obvious reasons why independence would not hold for most or all observations. Approximately normal. As with one- and two-sample testing for means, the normality assumption is especially important when the sample size is quite small. The normal probability plots for each group of the MLB data are shown in Figure [mlbANOVADiagNormalityGroups]; there is some deviation from normality for infielders, but this isn’t a substantial concern since there are about 150 observations in that group and the outliers are not extreme. Sometimes in ANOVA there are so many groups or so few observations per group that checking normality for each group isn’t reasonable. See the footnote123 for guidance on how to handle such instances. Normal probability plot of OBP for each field position. [mlbANOVADiagNormalityGroups] Constant variance. The last assumption is that the variance in the groups is about equal from one group to the next. This assumption can be checked by examining a side-by-side box plot of the outcomes across the groups, as in Figure . In this case, the variability is similar in the four groups but not identical. We see in Table that the standard deviation varies a bit from one group to the next. Whether these differences are from natural variation is unclear, so we should report this uncertainty with the final results. Diagnostics for an ANOVA analysis Independence is always important to an ANOVA analysis. The normality condition is very important when the sample sizes for each group are relatively small. The constant variance condition is especially important when the sample sizes differ between groups. 5.1.5 Multiple comparisons and controlling Type 1 Error rate When we reject the null hypothesis in an ANOVA analysis, we might wonder, which of these groups have different means? To answer this question, we compare the means of each possible pair of groups. For instance, if there are three groups and there is strong evidence that there are some differences in the group means, there are three comparisons to make: group 1 to group 2, group 1 to group 3, and group 2 to group 3. These comparisons can be accomplished using a two-sample \\(t\\) test, but we use a modified significance level and a pooled estimate of the standard deviation across groups. Usually this pooled standard deviation can be found in the ANOVA table, e.g. along the bottom of Table [anovaSummaryTableForOBPAgainstPosition]. Example discussed three statistics lectures, all taught during the same semester. Table [summaryStatisticsForClassTestData] shows summary statistics for these three courses, and a side-by-side box plot of the data is shown in Figure [classDataSBSBoxPlot]. We would like to conduct an ANOVA for these data. Do you see any deviations from the three conditions for ANOVA? In this case (like many others) it is difficult to check independence in a rigorous way. Instead, the best we can do is use common sense to consider reasons the assumption of independence may not hold. For instance, the independence assumption may not be reasonable if there is a star teaching assistant that only half of the students may access; such a scenario would divide a class into two subgroups. No such situations were evident for these particular data, and we believe that independence is acceptable. The distributions in the side-by-side box plot appear to be roughly symmetric and show no noticeable outliers. The box plots show approximately equal variability, which can be verified in Table [summaryStatisticsForClassTestData], supporting the constant variance assumption. Summary statistics for the first midterm scores in three different lectures of the same course. Class \\(i\\) A B C \\(n_i\\) 58 55 51 \\(\\bar{x}_i\\) 75.1 72.0 78.9 \\(s_i\\) 13.9 13.8 13.1 [summaryStatisticsForClassTestData] Side-by-side box plot for the first midterm scores in three different lectures of the same course. [classDataSBSBoxPlot] [exerExaminingAnovaSummaryTableForMidtermData] An ANOVA was conducted for the midterm data, and summary results are shown in Table [anovaSummaryTableForMidtermData]. What should we conclude?124 lrrrrr &amp; Df &amp; Sum Sq &amp; Mean Sq &amp; F value &amp; Pr(\\(&gt;\\)F) lecture &amp; 2 &amp; 1290.11 &amp; 645.06 &amp; 3.48 &amp; 0.0330 Residuals &amp; 161 &amp; 29810.13 &amp; 185.16 &amp; &amp; [anovaSummaryTableForMidtermData] There is strong evidence that the different means in each of the three classes is not simply due to chance. We might wonder, which of the classes are actually different? As discussed in earlier chapters, a two-sample \\(t\\) test could be used to test for differences in each possible pair of groups. However, one pitfall was discussed in Example : when we run so many tests, the Type 1 Error rate increases. This issue is resolved by using a modified significance level. The scenario of testing many pairs of groups is called multiple comparisons. The Bonferroni correction suggests that a more stringent significance level is more appropriate for these tests: \\[\\begin{aligned} \\alpha^* = \\alpha / K\\end{aligned}\\] where \\(K\\) is the number of comparisons being considered (formally or informally). If there are \\(k\\) groups, then usually all possible pairs are compared and \\(K=\\frac{k(k-1)}{2}\\). In Guided Practice [exerExaminingAnovaSummaryTableForMidtermData], you found strong evidence of differences in the average midterm grades between the three lectures. Complete the three possible pairwise comparisons using the Bonferroni correction and report any differences. [multipleComparisonsOfThreeStatClasses] We use a modified significance level of \\(\\alpha^* = 0.05/3 = 0.0167\\). Additionally, we use the pooled estimate of the standard deviation: \\(s_{pooled}=13.61\\) on \\(df=161\\), which is provided in the ANOVA summary table. Lecture A versus Lecture B: The estimated difference and standard error are, respectively, \\[\\begin{aligned} \\bar{x}_A - \\bar{x}_{B} &amp;= 75.1 - 72 = 3.1 &amp;SE = \\sqrt{\\frac{13.61^2}{58} + \\frac{13.61^2}{55}} &amp;= 2.56\\end{aligned}\\] (See Section for additional details.) This results in a \\(T\\) score of 1.21 on \\(df = 161\\) (we use the \\(df\\) associated with \\(s_{pooled}\\)). Statistical software was used to precisely identify the two-tailed p-value since the modified significance of 0.0167 is not found in the \\(t\\) table. The p-value (0.228) is larger than \\(\\alpha^*=0.0167\\), so there is not strong evidence of a difference in the means of lectures A and B. Lecture A versus Lecture C: The estimated difference and standard error are 3.8 and 2.61, respectively. This results in a \\(T\\) score of 1.46 on \\(df = 161\\) and a two-tailed p-value of 0.1462. This p-value is larger than \\(\\alpha^*\\), so there is not strong evidence of a difference in the means of lectures A and C. Lecture B versus Lecture C: The estimated difference and standard error are 6.9 and 2.65, respectively. This results in a \\(T\\) score of 2.60 on \\(df = 161\\) and a two-tailed p-value of 0.0102. This p-value is smaller than \\(\\alpha^*\\). Here we find strong evidence of a difference in the means of lectures B and C. We might summarize the findings of the analysis from Example [multipleComparisonsOfThreeStatClasses] using the following notation: \\[\\begin{aligned} \\mu_A &amp;\\stackrel{?}{=} \\mu_B &amp;\\mu_A &amp;\\stackrel{?}{=} \\mu_C &amp;\\mu_B &amp;\\neq \\mu_C\\end{aligned}\\] The midterm mean in lecture A is not statistically distinguishable from those of lectures B or C. However, there is strong evidence that lectures B and C are different. In the first two pairwise comparisons, we did not have sufficient evidence to reject the null hypothesis. Recall that failing to reject \\(H_0\\) does not imply \\(H_0\\) is true. Sometimes an ANOVA will reject the null but no groups will have statistically significant differences It is possible to reject the null hypothesis using ANOVA and then to not subsequently identify differences in the pairwise comparisons. However, this does not invalidate the ANOVA conclusion. It only means we have not been able to successfully identify which groups differ in their means. The ANOVA procedure examines the big picture: it considers all groups simultaneously to decipher whether there is evidence that some difference exists. Even if the test indicates that there is strong evidence of differences in group means, identifying with high confidence a specific difference as statistically significant is more difficult. Consider the following analogy: we observe a Wall Street firm that makes large quantities of money based on predicting mergers. Mergers are generally difficult to predict, and if the prediction success rate is extremely high, that may be considered sufficiently strong evidence to warrant investigation by the Securities and Exchange Commission (SEC). While the SEC may be quite certain that there is insider trading taking place at the firm, the evidence against any single trader may not be very strong. It is only when the SEC considers all the data that they identify the pattern. This is effectively the strategy of ANOVA: stand back and consider all the groups simultaneously. 5.2 Bootstrapping to study the standard deviation We analyzed textbook pricing data in Section [pairedData] and found that prices on Amazon were statistically significantly cheaper on average. We might also want to better understand the variability of the price difference from one book to another, which we quantified using the standard deviation: \\(s = \\$14.26\\). The sample standard deviation is a point estimate for the population standard deviation. Just as we care about the precision of a sample mean, we may care about the precise of the sample standard deviation. 5.2.1 Bootstrap samples and distributions The theory required to quantify the uncertainty of the sample standard deviation is complex. In an ideal world, we would sample data from the population again and recompute the standard deviation with this new sample. Then we could do it again. And again. And so on until we get enough standard deviation estimates that we have a good sense of the precision of our original estimate. This is an ideal world where sampling data is free or extremely cheap. That is rarely the case, which poses a challenge to this “resample from the population” approach. However, we can sample from the sample. In the textbook pricing example, there are 73 price differences. This sample can serve as a proxy for the population: we sample from this data set to get a sense for what it would be like if we took new samples. A bootstrap sample is a sample of the original sample. In the case of the textbook data, we proceed as follows: Randomly sample one observation from the 73 price differences. Randomly sample a second observation from the 73 price differences. There is a chance that this second observation will be the same one sampled in the first step. \\(\\vdots\\) Randomly sample a 73\\(^{rd}\\) observation from the 73 price differences. This type of sampling is called sampling with replacement. Table [textbookBootstrapSample] shows a bootstrap sample for the textbook pricing example. Some of the values, such as , are duplicated since occasionally we sample the same observation multiple times. A bootstrap sample of the textbook price differences, which represents a sample of 73 values from the original 73 observations, where we are sampling with replacement. In sampling with replacement, it is possible for a value to be sampled multiple times. For example, was sampled twice in this bootstrap sample. 6.63 5.39 6.39 14.05 6.63 -0.25 12.45 -0.22 9.45 9.45 11.70 39.08 4.80 28.72 9.45 -0.25 -3.88 2.82 45.34 28.72 16.62 38.35 4.74 44.40 3.74 1.75 2.84 30.25 3.35 6.63 30.50 0.00 4.96 6.39 9.48 66.00 44.40 -0.25 -2.55 17.98 2.82 29.29 9.22 11.70 9.31 4.80 13.63 9.45 38.23 4.96 19.69 14.26 12.45 5.39 -0.28 8.23 0.42 2.82 4.78 7.01 4.64 9.12 9.31 9.12 11.70 27.15 28.72 30.71 2.84 -9.53 14.05 [textbookBootstrapSample] A bootstrap sample behaves similarly to how an actual sample would behave, and we compute the point estimate of interest. In the textbook price example, we compute the standard deviation of the bootstrap sample: $13.98. 5.2.2 Inference using the bootstrap One bootstrap sample is not enough to understand the uncertainty of the standard deviation, so we need to collect another bootstrap sample and compute the standard deviation: $16.21. And another: $14.07. And so on. Using a computer, we took 10,000 bootstrap samples and computed the standard deviation for each, and these are summarized in . This is called the bootstrap distribution of the standard deviation for the textbook price differences. To make use of this distribution, we make an important assumption: the bootstrap distribution shown in Figure [textbookBootstrapSamplingForSD] is similar to the sampling distribution of the standard deviation. This assumption is reasonable when doing an informal exploration of the uncertainty of an estimate, and under certain conditions, we can rely on it for more formal inference methods. Bootstrap distribution for the standard deviation of textbook price differences. The distribution is approximately centered at the original sample’s standard deviation, $14.26. [textbookBootstrapSamplingForSD] Describe the bootstrap distribution for the standard deviation shown in Figure [textbookBootstrapSamplingForSD]. The distribution is symmetric, bell-shaped, and centered near $14.26, which is the point estimate from the original data. The standard deviation of the bootstrap distribution is $1.60, and most observations in this distribution lie between $11 and $17. In this example, the bootstrap distribution’s standard deviation, $1.60, quantifies the uncertainty of the point estimate. This is an estimate of the standard error based on the bootstrap. We might be tempted to use it for a 95% confidence interval, but first we must perform some due diligence. As with every statistical method, we must check certain conditions before performing formal inference using the bootstrap. The bootstrap distribution for the standard deviation will be a good approximation of the sampling distribution for the standard deviation when observations in the original sample are independent, the original sample size is at least 30, and the bootstrap distribution is nearly normal. We’re already familiar with checking independence of observations, which we previously checked for this data set, and the second condition is easy to check. The last condition can be checked by examining the bootstrap distribution using a normal probability plot, as shown in Figure [textbookBootstrapSamplingQQPlotForSD]. In this example, we see a very straight line, which indicates the bootstrap distribution is nearly normal, and we can move forward with constructing a confidence interval. Normal probability plot for the bootstrap distribution. [textbookBootstrapSamplingQQPlotForSD] As with many other point estimates, we will use the familiar formula \\[\\begin{aligned} \\text{point estimate} \\pm t_{df}^{\\star} \\times SE\\end{aligned}\\] In the textbook example, using \\(df = 73 - 1 = 72\\) leads to \\(t_{72}^{\\star} = 1.99\\) for a 95% confidence level. For bootstrapping, the standard error is computed as the standard deviation of the bootstrap distribution. Compute the 95% confidence interval for the standard deviation of the textbook price difference. We use the general formula for a 95% confidence interval with the \\(t\\) distribution: \\[\\begin{aligned} \\text{point estimate} &amp;\\pm t_{df}^{\\star} \\times SE \\\\ 14.26 &amp;\\pm 1.99 \\times 1.60 \\\\ (\\$11.08, &amp;\\$17.44)\\end{aligned}\\] We are 95% confident that the standard deviation of the textbook price differences is between $11.08 and $17.44. Had we wanted to conduct a hypothesis test, we could have used the point estimate and standard error for a t test as we have in previous sections. The bootstrap may be used with any parameters using the same conditions as were provided for the standard deviation. However, in other situations, it may be more important to examine the validity of the third condition: that the bootstrap distribution is nearly normal. 5.2.3 Frequently asked questions There are more types of bootstrap techniques, right? Yes! There are many excellent bootstrap techniques. We have only chosen to present one bootstrap technique that could be explained in a single section and is also reasonably reliable. Can we use the bootstrap for the mean or difference of means? Technically, yes. However, the methods introduced earlier tend to be more reliable than this particular bootstrapping method and other simple bootstrapping techniques. See the following page for details on an investigation into the accuracy of several bootstrapping methods as well as the \\(t\\) distribution method introduced earlier in this chapter: www.openintro.org/stat/bootstrap I’ve heard a technique called the percentile bootstrap that is very robust. It is a held belief that the percentile bootstrap is a robust bootstrap method. That is false. The percentile method is one of the least reliable bootstrap methods. Instead, use the method described in this section, which is more reliable, or learn about more advanced techniques. \\(H_0\\): The average on-base percentage is equal across the four positions. \\(H_A\\): The average on-base percentage varies across some (or all) groups.↩ See, for example, www.stat.columbia.edu/\\(\\sim\\)cook/movabletype/archives/2007/05/the_prosecutors.html.↩ Let \\(\\bar{x}\\) represent the mean of outcomes across all groups. Then the mean square between groups is computed as \\[\\begin{aligned} MSG = \\frac{1}{df_{G}}SSG = \\frac{1}{k-1}\\sum_{i=1}^{k} n_{i}\\left(\\bar{x}_{i} - \\bar{x}\\right)^2\\end{aligned}\\] where \\(SSG\\) is called the sum of squares between groups and \\(n_{i}\\) is the sample size of group \\(i\\).↩ Let \\(\\bar{x}\\) represent the mean of outcomes across all groups. Then the sum of squares total (\\(SST\\)) is computed as \\(SST = \\sum_{i=1}^{n} \\left(x_{i} - \\bar{x}\\right)^2\\), where the sum is over all observations in the data set. Then we compute the sum of squared errors (\\(SSE\\)) in one of two equivalent ways: \\[\\begin{aligned} SSE = SST - SSG = (n_1-1)s_1^2 + (n_2-1)s_2^2 + \\cdots + (n_k-1)s_k^2\\end{aligned}\\] where \\(s_i^2\\) is the sample variance (square of the standard deviation) of the residuals in group \\(i\\). Then the \\(MSE\\) is the standardized form of \\(SSE\\): \\(MSE = \\frac{1}{df_{E}}SSE\\).↩ There are \\(k=4\\) groups, so \\(df_{G} = k-1 = 3\\). There are \\(n = n_1 + n_2 + n_3 + n_4 = 327\\) total observations, so \\(df_{E} = n - k = 323\\). Then the \\(F\\) statistic is computed as the ratio of \\(MSG\\) and \\(MSE\\): \\(F = \\frac{MSG}{MSE} = \\frac{0.00252}{0.00127} = 1.984 \\approx 1.994\\). (\\(F=1.994\\) was computed by using values for \\(MSG\\) and \\(MSE\\) that were not rounded.)↩ ↩ First calculate the of the baseball data, which are calculated by taking the observed values and subtracting the corresponding group means. For example, an outfielder with OBP of 0.435 would have a residual of \\(0.405 - \\bar{x}_{OF} = 0.071\\). Then to check the normality condition, create a normal probability plot using all the residuals simultaneously.↩ The p-value of the test is 0.0330, less than the default significance level of 0.05. Therefore, we reject the null hypothesis and conclude that the difference in the average midterm scores are not due to chance.↩ "],
["linRegrForTwoVar.html", "Chapter 6 Introduction to linear regression 6.1 Line fitting, residuals, and correlation 6.2 Fitting a line by least squares regression 6.3 Types of outliers in linear regression 6.4 Inference for linear regression", " Chapter 6 Introduction to linear regression Linear regression is a very powerful statistical technique. Many people have some familiarity with regression just from reading the news, where graphs with straight lines are overlaid on scatterplots. Linear models can be used for prediction or to evaluate whether there is a linear relationship between two numerical variables. Figure [perfLinearModel] shows two variables whose relationship can be modeled perfectly with a straight line. The equation for the line is \\[\\begin{aligned} y = 5 + 57.49x\\end{aligned}\\] Imagine what a perfect linear relationship would mean: you would know the exact value of \\(y\\) just by knowing the value of \\(x\\). This is unrealistic in almost any natural process. For example, if we took family income \\(x\\), this value would provide some useful information about how much financial support \\(y\\) a college may offer a prospective student. However, there would still be variability in financial support, even when comparing students whose families have similar financial backgrounds. Requests from twelve separate buyers were simultaneously placed with a trading company to purchase Target Corporation stock (ticker TGT, April 26th, 2012), and the total cost of the shares were reported. Because the cost is computed using a linear formula, the linear fit is perfect. [perfLinearModel] Linear regression assumes that the relationship between two variables, \\(x\\) and \\(y\\), can be modeled by a straight line: \\[\\begin{aligned} y = \\beta_0 + \\beta_1x \\label{genLinModelWNoErrorTerm}\\end{aligned}\\] [ \\(\\beta_0, \\beta_1\\) Linear model parameters] \\(\\beta_0, \\beta_1\\) Linear model parameters where \\(\\beta_0\\) and \\(\\beta_1\\) represent two model parameters (\\(\\beta\\) is the Greek letter beta). These parameters are estimated using data, and we write their point estimates as \\(b_0\\) and \\(b_1\\). When we use \\(x\\) to predict \\(y\\), we usually call \\(x\\) the explanatory or predictor variable, and we call \\(y\\) the response. It is rare for all of the data to fall on a straight line, as seen in the three scatterplots in Figure [imperfLinearModel]. In each case, the data fall around a straight line, even if none of the observations fall exactly on the line. The first plot shows a relatively strong downward linear trend, where the remaining variability in the data around the line is minor relative to the strength of the relationship between \\(x\\) and \\(y\\). The second plot shows an upward trend that, while evident, is not as strong as the first. The last plot shows a very weak downward trend in the data, so slight we can hardly notice it. In each of these examples, we will have some uncertainty regarding our estimates of the model parameters, \\(\\beta_0\\) and \\(\\beta_1\\). For instance, we might wonder, should we move the line up or down a little, or should we tilt it more or less? As we move forward in this chapter, we will learn different criteria for line-fitting, and we will also learn about the uncertainty associated with estimates of model parameters. Three data sets where a linear model may be useful even though the data do not all fall exactly on the line. [imperfLinearModel] We will also see examples in this chapter where fitting a straight line to the data, even if there is a clear relationship between the variables, is not helpful. One such case is shown in Figure [notGoodAtAllForALinearModel] where there is a very strong relationship between the variables even though the trend is not linear. We will discuss nonlinear trends in this chapter, but the details of fitting nonlinear models are saved for a later course. A linear model is not useful in this nonlinear case. These data are from an introductory physics experiment. [notGoodAtAllForALinearModel] 6.1 Line fitting, residuals, and correlation It is helpful to think deeply about the line fitting process. In this section, we examine criteria for identifying a linear model and introduce a new statistic, correlation. 6.1.1 Beginning with straight lines Scatterplots were introduced in Chapter [introductionToData] as a graphical technique to present two numerical variables simultaneously. Such plots permit the relationship between the variables to be examined with ease. Figure [scattHeadLTotalL] shows a scatterplot for the head length and total length of 104 brushtail possums from Australia. Each point represents a single possum from the data. A scatterplot showing head length against total length for 104 brushtail possums. A point representing a possum with head length 94.1mm and total length 89cm is highlighted. [scattHeadLTotalL] The common brushtail possum of Australia. Photo by wollombi on Flickr [possumPic] The head and total length variables are associated. Possums with an above average total length also tend to have above average head lengths. While the relationship is not perfectly linear, it could be helpful to partially explain the connection between these variables with a straight line. The figure on the left shows head length versus total length, and reveals that many of the points could be captured by a straight band. On the right, we see that a curved band is more appropriate in the scatterplot for weight and mpgCity from the cars data set. [scattHeadLTotalLTube] Straight lines should only be used when the data appear to have a linear relationship, such as the case shown in the left panel of Figure [scattHeadLTotalLTube]. The right panel of Figure [scattHeadLTotalLTube] shows a case where a curved line would be more useful in understanding the relationship between the two variables. Watch out for curved trends We only consider models based on straight lines in this chapter. If data show a nonlinear trend, like that in the right panel of Figure [scattHeadLTotalLTube], more advanced techniques should be used. 6.1.2 Fitting a line by eye We want to describe the relationship between the head length and total length variables in the possum data set using a line. In this example, we will use the total length as the predictor variable, \\(x\\), to predict a possum’s head length, \\(y\\). We could fit the linear relationship by eye, as in Figure [scattHeadLTotalLLine]. The equation for this line is \\[\\begin{aligned} \\hat{y} = 41 + 0.59x \\label{headLLinModTotalL}\\end{aligned}\\] We can use this line to discuss properties of possums. For instance, the equation predicts a possum with a total length of 80 cm will have a head length of \\[\\begin{aligned} \\hat{y} &amp;= 41 + 0.59\\times 80 \\\\ &amp;= 88.2 % mm\\end{aligned}\\] A “hat” on \\(y\\) is used to signify that this is an estimate. This estimate may be viewed as an average: the equation predicts that possums with a total length of 80 cm will have an average head length of 88.2 mm. Absent further information about an 80 cm possum, the prediction for head length that uses the average is a reasonable estimate. A reasonable linear model was fit to represent the relationship between head length and total length. [scattHeadLTotalLLine] 6.1.3 Residuals are the leftover variation in the data after accounting for the model fit: \\[\\begin{aligned} \\text{Data} = \\text{Fit} + \\text{Residual}\\end{aligned}\\] Each observation will have a residual. If an observation is above the regression line, then its residual, the vertical distance from the observation to the line, is positive. Observations below the line have negative residuals. One goal in picking the right linear model is for these residuals to be as small as possible. Three observations are noted specially in Figure [scattHeadLTotalLLine]. The observation marked by an “\\(\\times\\)” has a small, negative residual of about -1; the observation marked by “\\(+\\)” has a large residual of about +7; and the observation marked by “\\(\\triangle\\)” has a moderate residual of about -4. The size of a residual is usually discussed in terms of its absolute value. For example, the residual for “\\(\\triangle\\)” is larger than that of “\\(\\times\\)” because \\(|-4|\\) is larger than \\(|-1|\\). The residual of the \\(i^{th}\\) observation \\((x_i, y_i)\\) is the difference of the observed response (\\(y_i\\)) and the response we would predict based on the model fit (\\(\\hat{y}_i\\)): \\[\\begin{aligned} e_i = y_i - \\hat{y}_i\\end{aligned}\\] We typically identify \\(\\hat{y}_i\\) by plugging \\(x_i\\) into the model. The linear fit shown in Figure [scattHeadLTotalLLine] is given as \\(\\hat{y} = 41 + 0.59x\\). Based on this line, formally compute the residual of the observation \\((77.0, 85.3)\\). This observation is denoted by “\\(\\times\\)” on the plot. Check it against the earlier visual estimate, -1. We first compute the predicted value of point “\\(\\times\\)” based on the model: \\[\\begin{aligned} \\hat{y}_{\\times} = 41+0.59x_{\\times} = 41+0.59\\times 77.0 = 86.4\\end{aligned}\\] Next we compute the difference of the actual head length and the predicted head length: \\[\\begin{aligned} e_{\\times} = y_{\\times} - \\hat{y}_{\\times} = 85.3 - 86.4 = -1.1\\end{aligned}\\] This is very close to the visual estimate of -1. If a model underestimates an observation, will the residual be positive or negative? What about if it overestimates the observation?125 Compute the residuals for the observations \\((85.0, 98.6)\\) (“\\(+\\)” in the figure) and \\((95.5, 94.0)\\) (“\\(\\triangle\\)”) using the linear relationship \\(\\hat{y} = 41 + 0.59x\\).126 Residuals are helpful in evaluating how well a linear model fits a data set. We often display them in a residual plot such as the one shown in Figure [scattHeadLTotalLResidualPlot] for the regression line in Figure [scattHeadLTotalLLine]. The residuals are plotted at their original horizontal locations but with the vertical coordinate as the residual. For instance, the point \\((85.0,98.6)_{+}\\) had a residual of 7.45, so in the residual plot it is placed at \\((85.0, 7.45)\\). Creating a residual plot is sort of like tipping the scatterplot over so the regression line is horizontal. Residual plot for the model in Figure [scattHeadLTotalLLine]. [scattHeadLTotalLResidualPlot] One purpose of residual plots is to identify characteristics or patterns still apparent in data after fitting a model. Figure [sampleLinesAndResPlots] shows three scatterplots with linear models in the first row and residual plots in the second row. Can you identify any patterns remaining in the residuals? Sample data with their best fitting lines (top row) and their corresponding residual plots (bottom row). [sampleLinesAndResPlots] In the first data set (first column), the residuals show no obvious patterns. The residuals appear to be scattered randomly around the dashed line that represents 0. The second data set shows a pattern in the residuals. There is some curvature in the scatterplot, which is more obvious in the residual plot. We should not use a straight line to model these data. Instead, a more advanced technique should be used. The last plot shows very little upwards trend, and the residuals also show no obvious patterns. It is reasonable to try to fit a linear model to the data. However, it is unclear whether there is statistically significant evidence that the slope parameter is different from zero. The point estimate of the slope parameter, labeled \\(b_1\\), is not zero, but we might wonder if this could just be due to chance. We will address this sort of scenario in Section [inferenceForLinearRegression]. 6.1.4 Describing linear relationships with correlation , which always takes values between -1 and 1, describes the strength of the linear relationship between two variables. We denote the correlation by \\(R\\). [ \\(R\\) correlation] \\(R\\) correlation We can compute the correlation using a formula, just as we did with the sample mean and standard deviation. However, this formula is rather complex,127 so we generally perform the calculations on a computer or calculator. Figure [posNegCorPlots] shows eight plots and their corresponding correlations. Only when the relationship is perfectly linear is the correlation either -1 or 1. If the relationship is strong and positive, the correlation will be near +1. If it is strong and negative, it will be near -1. If there is no apparent linear relationship between the variables, then the correlation will be near zero. Sample scatterplots and their correlations. The first row shows variables with a positive relationship, represented by the trend up and to the right. The second row shows variables with a negative trend, where a large value in one variable is associated with a low value in the other. [posNegCorPlots] The correlation is intended to quantify the strength of a linear trend. Nonlinear trends, even when strong, sometimes produce correlations that do not reflect the strength of the relationship; see three such examples in Figure [corForNonLinearPlots]. Sample scatterplots and their correlations. In each case, there is a strong relationship between the variables. However, the correlation is not very strong, and the relationship is not linear. [corForNonLinearPlots] It appears no straight line would fit any of the datasets represented in Figure [corForNonLinearPlots]. Instead, try drawing nonlinear curves on each plot. Once you create a curve for each, describe what is important in your fit.128 6.2 Fitting a line by least squares regression Fitting linear models by eye is open to criticism since it is based on an individual preference. In this section, we use least squares regression as a more rigorous approach. This section considers family income and gift aid data from a random sample of fifty students in the 2011 freshman class of Elmhurst College in Illinois.129 Gift aid is financial aid that does not need to be paid back, as opposed to a loan. A scatterplot of the data is shown in Figure [elmhurstScatterW2Lines] along with two linear fits. The lines follow a negative trend in the data; students who have higher family incomes tended to have lower gift aid from the university. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College. Two lines are fit to the data, the solid line being the least squares line. [elmhurstScatterW2Lines] Is the correlation positive or negative in Figure [elmhurstScatterW2Lines]?130 6.2.1 An objective measure for finding the best line We begin by thinking about what we mean by “best”. Mathematically, we want a line that has small residuals. Perhaps our criterion could minimize the sum of the residual magnitudes: \\[\\begin{aligned} |e_1| + |e_2| + \\dots + |e_n| \\label{sumOfAbsoluteValueOfResiduals}\\end{aligned}\\] which we could accomplish with a computer program. The resulting dashed line shown in Figure [elmhurstScatterW2Lines] demonstrates this fit can be quite reasonable. However, a more common practice is to choose the line that minimizes the sum of the squared residuals: \\[\\begin{aligned} e_{1}^2 + e_{2}^2 + \\dots + e_{n}^2 \\label{sumOfSquaresForResiduals}\\end{aligned}\\] The line that minimizes this least squares criterion is represented as the solid line in Figure [elmhurstScatterW2Lines]. This is commonly called the least squares line. The following are three possible reasons to choose Criterion over Criterion : It is the most commonly used method. Computing the line based on Criterion is much easier by hand and in most statistical software. In many applications, a residual twice as large as another residual is more than twice as bad. For example, being off by 4 is usually more than twice as bad as being off by 2. Squaring the residuals accounts for this discrepancy. The first two reasons are largely for tradition and convenience; the last reason explains why Criterion is typically most helpful.131 6.2.2 Finding the least squares line For the Elmhurst data, we could write the equation of the least squares regression line as \\[\\begin{aligned} \\widehat{aid} = \\beta_0 + \\beta_{1}\\times family\\_\\hspace{0.3mm}income\\end{aligned}\\] Here the equation is set up to predict gift aid based on a student’s family income, which would be useful to students considering Elmhurst. These two values, \\(\\beta_0\\) and \\(\\beta_1\\), are the parameters of the regression line. As in Chapters 4-6, the parameters are estimated using observed data. In practice, this estimation is done using a computer in the same way that other estimates, like a sample mean, can be estimated using a computer or calculator. However, we can also find the parameter estimates by applying two properties of the least squares line: The slope of the least squares line can be estimated by \\[\\begin{aligned} b_1 = \\frac{s_y}{s_x} R \\label{slopeOfLSRLine}\\end{aligned}\\] where \\(R\\) is the correlation between the two variables, and \\(s_x\\) and \\(s_y\\) are the sample standard deviations of the explanatory variable and response, respectively. If \\(\\bar{x}\\) is the mean of the horizontal variable (from the data) and \\(\\bar{y}\\) is the mean of the vertical variable, then the point \\((\\bar{x}, \\bar{y})\\) is on the least squares line. [ \\(b_0, b_1\\) Sample estimates of \\(\\beta_0\\), \\(\\beta_1\\)] \\(b_0, b_1\\) Sample estimates of \\(\\beta_0\\), \\(\\beta_1\\) We use \\(b_0\\) and \\(b_1\\) to represent the point estimates of the parameters \\(\\beta_0\\) and \\(\\beta_1\\). Table [summaryStatsOfSATGPAData] shows the sample means for the family income and gift aid as $101,800 and $19,940, respectively. Plot the point \\((101.8, 19.94)\\) on Figure to verify it falls on the least squares line (the solid line).132 l rr &amp; &amp; &amp; family income, in $1000s (“\\(x\\)”) &amp; gift aid, in $1000s (“\\(y\\)”) &amp; &amp; mean &amp; \\(\\bar{x} = 101.8\\) &amp; \\(\\bar{y} = 19.94\\) sd &amp; \\(s_x = 63.2\\) &amp; \\(s_y = 5.46\\) &amp; &amp; [summaryStatsOfSATGPAData] [findingTheSlopeOfTheLSRLineForIncomeAndAid] Using the summary statistics in Table [summaryStatsOfSATGPAData], compute the slope for the regression line of gift aid against family income.133 You might recall the point-slope form of a line from math class (another common form is slope-intercept). Given the slope of a line and a point on the line, \\((x_0, y_0)\\), the equation for the line can be written as \\[\\begin{aligned} y - y_0 = slope\\times (x - x_0) \\label{pointSlopeFormForALine}\\end{aligned}\\] A common exercise to become more familiar with foundations of least squares regression is to use basic summary statistics and point-slope form to produce the least squares line. To identify the least squares line from summary statistics: Estimate the slope parameter, \\(\\beta_1\\), by calculating \\(b_1\\) using Equation . Noting that the point \\((\\bar{x}, \\bar{y})\\) is on the least squares line, use \\(x_0=\\bar{x}\\) and \\(y_0=\\bar{y}\\) along with the slope \\(b_1\\) in the point-slope equation: \\[y - \\bar{y} = b_1 (x - \\bar{x})\\] Simplify the equation. Using the point \\((101.8, 19.94)\\) from the sample means and the slope estimate \\(b_1 = -0.0431\\) from Guided Practice [findingTheSlopeOfTheLSRLineForIncomeAndAid], find the least-squares line for predicting aid based on family income. [exampleToFindLSRLineOfElmhurstData] Apply the point-slope equation using \\((101.8, 19.94)\\) and the slope \\(b_1 = -0.0431\\): \\[\\begin{aligned} y - y_0 &amp;= b_1 (x - x_0) \\\\ y - 19.94 &amp;= -0.0431(x - 101.8)\\end{aligned}\\] Expanding the right side and then adding 19.94 to each side, the equation simplifies: \\[\\widehat{aid} = 24.3 - 0.0431 \\times family\\_\\hspace{0.3mm}income\\] Here we have replaced \\(y\\) with \\(\\widehat{aid}\\) and \\(x\\) with \\(family\\_\\hspace{0.3mm}income\\) to put the equation in context. We mentioned earlier that a computer is usually used to compute the least squares line. A summary table based on computer output is shown in Table [rOutputForIncomeAidLSRLine] for the Elmhurst data. The first column of numbers provides estimates for \\({b}_0\\) and \\({b}_1\\), respectively. Compare these to the result from Example [exampleToFindLSRLineOfElmhurstData]. l rrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 24.3193 &amp; 1.2915 &amp; 18.83 &amp; 0.0000 family_ income &amp; -0.0431 &amp; 0.0108 &amp; -3.98 &amp; 0.0002 [rOutputForIncomeAidLSRLine] Examine the second, third, and fourth columns in Table [rOutputForIncomeAidLSRLine]. Can you guess what they represent? We’ll describe the meaning of the columns using the second row, which corresponds to \\(\\beta_1\\). The first column provides the point estimate for \\(\\beta_1\\), as we calculated in an earlier example: -0.0431. The second column is a standard error for this point estimate: 0.0108. The third column is a \\(t\\) test statistic for the null hypothesis that \\(\\beta_1 = 0\\): \\(T=-3.98\\). The last column is the p-value for the \\(t\\) test statistic for the null hypothesis \\(\\beta_1=0\\) and a two-sided alternative hypothesis: 0.0002. We will get into more of these details in Section [inferenceForLinearRegression]. Suppose a high school senior is considering Elmhurst College. Can she simply use the linear equation that we have estimated to calculate her financial aid from the university? She may use it as an estimate, though some qualifiers on this approach are important. First, the data all come from one freshman class, and the way aid is determined by the university may change from year to year. Second, the equation will provide an imperfect estimate. While the linear equation is good at capturing the trend in the data, no individual student’s aid will be perfectly predicted. 6.2.3 Interpreting regression line parameter estimates Interpreting parameters in a regression model is often one of the most important steps in the analysis. The slope and intercept estimates for the Elmhurst data are -0.0431 and 24.3. What do these numbers really mean? Interpreting the slope parameter is helpful in almost any application. For each additional $1,000 of family income, we would expect a student to receive a net difference of \\(\\$\\text{1,000}\\times (-0.0431) = -\\$43.10\\) in aid on average, i.e. $43.10 less. Note that a higher family income corresponds to less aid because the coefficient of family income is negative in the model. We must be cautious in this interpretation: while there is a real association, we cannot interpret a causal connection between the variables because these data are observational. That is, increasing a student’s family income may not cause the student’s aid to drop. (It would be reasonable to contact the college and ask if the relationship is causal, i.e. if Elmhurst College’s aid decisions are partially based on students’ family income.) The estimated intercept \\(b_0=24.3\\) (in $1000s) describes the average aid if a student’s family had no income. The meaning of the intercept is relevant to this application since the family income for some students at Elmhurst is $0. In other applications, the intercept may have little or no practical value if there are no observations where \\(x\\) is near zero. The slope describes the estimated difference in the \\(y\\) variable if the explanatory variable \\(x\\) for a case happened to be one unit larger. The intercept describes the average outcome of \\(y\\) if \\(x=0\\) and the linear model is valid all the way to \\(x=0\\), which in many applications is not the case. 6.2.4 Extrapolation is treacherous When those blizzards hit the East Coast this winter, it proved to my satisfaction that global warming was a fraud. That snow was freezing cold. But in an alarming trend, temperatures this spring have risen. Consider this: On February \\(6^{th}\\) it was 10 degrees. Today it hit almost 80. At this rate, by August it will be 220 degrees. So clearly folks the climate debate rages on. Stephen Colbert April 6th, 2010134 Linear models can be used to approximate the relationship between two variables. However, these models have real limitations. Linear regression is simply a modeling framework. The truth is almost always much more complex than our simple line. For example, we do not know how the data outside of our limited window will behave. Use the model \\(\\widehat{aid} = 24.3 - 0.0431\\times family\\_\\hspace{0.3mm}income\\) to estimate the aid of another freshman student whose family had income of $1 million. Recall that the units of family income are in $1000s, so we want to calculate the aid for \\(family\\_\\hspace{0.3mm}income = 1000\\): \\[\\begin{aligned} 24.3 - 0.0431\\times family\\_\\hspace{0.3mm}income = 24.3 - 0.0431\\times 1000 = -18.8\\end{aligned}\\] The model predicts this student will have -$18,800 in aid (!). Elmhurst College cannot (or at least does not) require any students to pay extra on top of tuition to attend. Applying a model estimate to values outside of the realm of the original data is called extrapolation. Generally, a linear model is only an approximation of the real relationship between two variables. If we extrapolate, we are making an unreliable bet that the approximate linear relationship will be valid in places where it has not been explored. 6.2.5 Using \\(R^2\\) to describe the strength of a fit We evaluated the strength of the linear relationship between two variables earlier using the correlation, \\(R\\). However, it is more common to explain the strength of a linear fit using \\(R^2\\), called . If provided with a linear model, we might like to describe how closely the data cluster around the linear fit. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College, shown with the least squares regression line. [elmhurstScatterWLSROnly] The \\(R^2\\) of a linear model describes the amount of variation in the response that is explained by the least squares line. For example, consider the Elmhurst data, shown in Figure [elmhurstScatterWLSROnly]. The variance of the response variable, aid received, is \\(s_{aid}^2=29.8\\). However, if we apply our least squares line, then this model reduces our uncertainty in predicting aid using a student’s family income. The variability in the residuals describes how much variation remains after using the model: \\(s_{_{RES}}^2 = 22.4\\). In short, there was a reduction of \\[\\frac{s_{aid}^2 - s_{_{RES}}^2}{s_{_{aid}}^2} = \\frac{29.8 - 22.4}{29.8} = \\frac{7.5}{29.8} = 0.25\\] or about 25% in the data’s variation by using information about family income for predicting aid using a linear model. This corresponds exactly to the R-squared value: \\[\\begin{aligned} R &amp;= -0.499 &amp;R^2 &amp;= 0.25\\end{aligned}\\] If a linear model has a very strong negative relationship with a correlation of -0.97, how much of the variation in the response is explained by the explanatory variable?135 6.2.6 Categorical predictors with two levels Categorical variables are also useful in predicting outcomes. Here we consider a categorical predictor with two levels (recall that a level is the same as a category). We’ll consider Ebay auctions for a video game, Mario Kart for the Nintendo Wii, where both the total price of the auction and the condition of the game were recorded.136 Here we want to predict total price based on game condition, which takes values and . A plot of the auction data is shown in Figure [marioKartNewUsed]. Total auction prices for the video game Mario Kart, divided into used (\\(x=0\\)) and new (\\(x=1\\)) condition games. The least squares regression line is also shown. [marioKartNewUsed] To incorporate the game condition variable into a regression equation, we must convert the categories into a numerical form. We will do so using an indicator variable called , which takes value 1 when the game is new and 0 when the game is used. Using this indicator variable, the linear model may be written as \\[\\begin{aligned} \\widehat{price} = \\beta_0 + \\beta_1 \\times \\text{\\textbf{cond\\_\\hspace{0.3mm}new}}\\end{aligned}\\] The fitted model is summarized in Table [marioKartNewUsedRegrSummary], and the model with its parameter estimates is given as \\[\\begin{aligned} \\widehat{price} = 42.87 + 10.90 \\times \\text{\\textbf{cond\\_\\hspace{0.3mm}new}}\\end{aligned}\\] rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 42.87 &amp; 0.81 &amp; 52.67 &amp; 0.0000 cond_ new &amp; 10.90 &amp; 1.26 &amp; 8.66 &amp; 0.0000 [marioKartNewUsedRegrSummary] Interpret the two parameters estimated in the model for the price of Mario Kart in eBay auctions. The intercept is the estimated price when takes value 0, i.e. when the game is in used condition. That is, the average selling price of a used version of the game is $42.87. The slope indicates that, on average, new games sell for about $10.90 more than used games. The estimated intercept is the value of the response variable for the first category (i.e. the category corresponding to an indicator value of 0). The estimated slope is the average change in the response variable between the two categories. 6.3 Types of outliers in linear regression In this section, we identify criteria for determining which outliers are important and influential. Outliers in regression are observations that fall far from the “cloud” of points. These points are especially important because they can have a strong influence on the least squares line. There are six plots shown in Figure [outlierPlots] along with the least squares line and residual plots. For each scatterplot and residual plot pair, identify any obvious outliers and note how they influence the least squares line. Recall that an outlier is any point that doesn’t appear to belong with the vast majority of the other points.[outlierPlotsExample] There is one outlier far from the other points, though it only appears to slightly influence the line. There is one outlier on the right, though it is quite close to the least squares line, which suggests it wasn’t very influential. There is one point far away from the cloud, and this outlier appears to pull the least squares line up on the right; examine how the line around the primary cloud doesn’t appear to fit very well. There is a primary cloud and then a small secondary cloud of four outliers. The secondary cloud appears to be influencing the line somewhat strongly, making the least square line fit poorly almost everywhere. There might be an interesting explanation for the dual clouds, which is something that could be investigated. There is no obvious trend in the main cloud of points and the outlier on the right appears to largely control the slope of the least squares line. There is one outlier far from the cloud, however, it falls quite close to the least squares line and does not appear to be very influential. Six plots, each with a least squares line and residual plot. All data sets have at least one outlier. [outlierPlots] Examine the residual plots in Figure [outlierPlots]. You will probably find that there is some trend in the main clouds of (3) and (4). In these cases, the outliers influenced the slope of the least squares lines. In (5), data with no clear trend were assigned a line with a large trend simply due to one outlier (!). Points that fall horizontally away from the center of the cloud tend to pull harder on the line, so we call them points with high leverage. Points that fall horizontally far from the line are points of high leverage; these points can strongly influence the slope of the least squares line. If one of these high leverage points does appear to actually invoke its influence on the slope of the line – as in cases (3), (4), and (5) of Example [outlierPlotsExample] – then we call it an influential point. Usually we can say a point is influential if, had we fitted the line without it, the influential point would have been unusually far from the least squares line. It is tempting to remove outliers. Don’t do this without a very good reason. Models that ignore exceptional (and interesting) cases often perform poorly. For instance, if a financial firm ignored the largest market swings – the “outliers” – they would soon go bankrupt by making poorly thought-out investments. Don’t ignore outliers when fitting a final model If there are outliers in the data, they should not be removed or ignored without a good reason. Whatever final model is fit to the data would not be very helpful if it ignores the most exceptional cases. Outliers for a categorical predictor with two levels Be cautious about using a categorical predictor when one of the levels has very few observations. When this happens, those few observations become influential points. 6.4 Inference for linear regression In this section we discuss uncertainty in the estimates of the slope and y-intercept for a regression line. Just as we identified standard errors for point estimates in previous chapters, we first discuss standard errors for these new estimates. However, in the case of regression, we will identify standard errors using statistical software. 6.4.1 Conditions for the least squares line When performing inference on a least squares line, we generally require the following: Linearity. The data should show a linear trend. If there is a nonlinear trend (e.g. left panel of Figure [whatCanGoWrongWithLinearModel]), an advanced regression method from another book or later course should be applied. Nearly normal residuals. Generally the residuals must be nearly normal. When this condition is found to be unreasonable, it is usually because of outliers or concerns about influential points, which we will discuss in greater depth in Section [typesOfOutliersInLinearRegression]. An example of non-normal residuals is shown in the second panel of Figure [whatCanGoWrongWithLinearModel]. Constant variability. The variability of points around the least squares line remains roughly constant. An example of non-constant variability is shown in the third panel of Figure [whatCanGoWrongWithLinearModel]. Independent observations. Be cautious about applying regression to data collected sequentially in what is called a time series. Such data may have an underlying structure that should be considered in a model and analysis. An example of a time series where independence is violated is shown in the fourth panel of Figure [whatCanGoWrongWithLinearModel]. For additional information on checking regression conditions, see Section [multipleRegressionModelAssumptions]. Four examples showing when the methods in this chapter are insufficient to apply to the data. In the left panel, a straight line does not fit the data. In the second panel, there are outliers; two points on the left are relatively distant from the rest of the data, and one of these points is very far away from the line. In the third panel, the variability of the data around the line increases with larger values of \\(x\\). In the last panel, a time series data set is shown, where successive observations are highly correlated. [whatCanGoWrongWithLinearModel] Should we have concerns about applying inference to the Elmhurst data in Figure [elmhurstScatterLSRLineconditions]? The trend appears to be linear, the data fall around the line with no obvious outliers, the variance is roughly constant. These are also not time series observations. It would be reasonable to analyze the model using inference. Gift aid and family income for a random sample of 50 freshman students from Elmhurst College. Two lines are fit to the data, the solid line being the least squares line. [elmhurstScatterLSRLineconditions] 6.4.2 Midterm elections and unemployment Elections for members of the United States House of Representatives occur every two years, coinciding every four years with the U.S. Presidential election. The set of House elections occurring during the middle of a Presidential term are called . In America’s two-party system, one political theory suggests the higher the unemployment rate, the worse the President’s party will do in the midterm elections. To assess the validity of this claim, we can compile historical data and look for a connection. We consider every midterm election from 1898 to 2010, with the exception of those elections during the Great Depression. Figure [unemploymentAndChangeInHouse] shows these data and the least-squares regression line: \\[\\begin{aligned} &amp;\\text{\\% change in House seats for President&#39;s party} \\\\ &amp;\\qquad\\qquad= -6.71 - 1.00\\times \\text{(unemployment rate)}\\end{aligned}\\] We consider the percent change in the number of seats of the President’s party (e.g. percent change in the number of seats for Democrats in 2010) against the unemployment rate. Examining the data, there are no clear deviations from linearity, the constant variance condition, or in the normality of residuals (though we don’t examine a normal probability plot here). While the data are collected sequentially, a separate analysis was used to check for any apparent correlation between successive observations; no such correlation was found. The percent change in House seats for the President’s party in each election from 1898 to 2010 plotted against the unemployment rate. The two points for the Great Depression have been removed, and a least squares regression line has been fit to the data. [unemploymentAndChangeInHouse] The data for the Great Depression (1934 and 1938) were removed because the unemployment rate was 21% and 18%, respectively. Do you agree that they should be removed for this investigation? Why or why not?137 There is a negative slope in the line shown in Figure [unemploymentAndChangeInHouse]. However, this slope (and the y-intercept) are only estimates of the parameter values. We might wonder, is this convincing evidence that the “true” linear model has a negative slope? That is, do the data provide strong evidence that the political theory is accurate? We can frame this investigation into a two-sided statistical hypothesis test. We use a two-sided test since a statistically significant result in either direction would be interesting. \\(\\beta_1 = 0\\). The true linear model has slope zero. \\(\\beta_1 \\neq 0\\). The true linear model has a slope different than zero. The higher the unemployment, the greater the loss for the President’s party in the House of Representatives, or vice-versa. We would reject \\(H_0\\) in favor of \\(H_A\\) if the data provide strong evidence that the true slope parameter is less than zero. To assess the hypotheses, we identify a standard error for the estimate, compute an appropriate test statistic, and identify the p-value. 6.4.3 Understanding regression output from software Just like other point estimates we have seen before, we can compute a standard error and test statistic for \\(b_1\\). We will generally label the test statistic using a \\(T\\), since it follows the \\(t\\) distribution. We will rely on statistical software to compute the standard error and leave the explanation of how this standard error is determined to a second or third statistics course. Table [midtermElectionUnemploymentRRegressionOutput] shows software output for the least squares regression line in Figure [unemploymentAndChangeInHouse]. The row labeled unemp represents the information for the slope, which is the coefficient of the unemployment variable. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -6.7142 &amp; 5.4567 &amp; -1.23 &amp; 0.2300 unemp &amp; -1.0010 &amp; 0.8717 &amp; -1.15 &amp; 0.2617 [midtermElectionUnemploymentRRegressionOutput] What do the first and second columns of Table [midtermElectionUnemploymentRRegressionOutput] represent? The entries in the first column represent the least squares estimates, \\(b_0\\) and \\(b_1\\), and the values in the second column correspond to the standard errors of each estimate. We previously used a \\(t\\) test statistic for hypothesis testing in the context of numerical data. Regression is very similar. In the hypotheses we consider, the null value for the slope is 0, so we can compute the test statistic using the T (or Z) score formula: \\[\\begin{aligned} T = \\frac{\\text{estimate} - \\text{null value}}{\\text{SE}} = \\frac{-1.0010 - 0}{0.8717} = -1.15\\end{aligned}\\] We can look for the two-tailed p-value – shown in Figure [oneSidedTailForMidtermUnemploymentHT] – using the probability table for the \\(t\\) distribution in Appendix [tDistributionTable] on page . The distribution shown here is the sampling distribution for \\(b_1\\), if the null hypothesis was true. The shaded tail represents the p-value for the hypothesis test evaluating whether there is convincing evidence that higher unemployment corresponds to a greater loss of House seats for the President’s party during a midterm election. [oneSidedTailForMidtermUnemploymentHT] Table [midtermElectionUnemploymentRRegressionOutput] offers the degrees of freedom for the test statistic \\(T\\): \\(df=25\\). Identify the p-value for the hypothesis test. Looking in the 25 degrees of freedom row in Appendix [tDistributionTable], we see that the absolute value of the test statistic is smaller than any value listed, which means the tail area and therefore also the p-value is larger than 0.200 (two tails!). Because the p-value is so large, we fail to reject the null hypothesis. That is, the data do not provide convincing evidence that unemployment is a good predictor of how well a president’s party will do in the midterm elections for the House of Representatives. We could have identified the \\(t\\) test statistic from the software output in Table [midtermElectionUnemploymentRRegressionOutput], shown in the second row (unemp) and third column (t value). The entry in the second row and last column in Table [midtermElectionUnemploymentRRegressionOutput] represents the p-value for the two-sided hypothesis test where the null value is zero. We usually rely on statistical software to identify point estimates and standard errors for parameters of a regression line. After verifying conditions hold for fitting a line, we can use the methods learned in Section [oneSampleMeansWithTDistribution] for the \\(t\\) distribution to create confidence intervals for regression parameters or to evaluate hypothesis tests. Don’t carelessly use the p-value from regression outputThe last column in regression output often lists p-values for one particular hypothesis: a two-sided test where the null value is zero. If a hypothesis test should be one-sided or a comparison is being made to a value other than zero, be cautious about using the software output to obtain the p-value. Examine Figure , which relates the Elmhurst College aid and student family income. How sure are you that the slope is statistically significantly different from zero? That is, do you think a formal hypothesis test would reject the claim that the true slope of the line should be zero? [overallAidIncomeInformalAssessmentOfRegressionLineSlope] While the relationship between the variables is not perfect, there is an evident decreasing trend in the data. This suggests the hypothesis test will reject the null claim that the slope is zero. Table [rOutputForIncomeAidLSRLineInInferenceSection] shows statistical software output from fitting the least squares regression line shown in Figure [elmhurstScatterWLSROnly]. Use this output to formally evaluate the following hypotheses. \\(H_0\\): The true coefficient for family income is zero. \\(H_A\\): The true coefficient for family income is not zero.138 rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 24.3193 &amp; 1.2915 &amp; 18.83 &amp; 0.0000 family_ income &amp; -0.0431 &amp; 0.0108 &amp; -3.98 &amp; 0.0002 [rOutputForIncomeAidLSRLineInInferenceSection] If conditions for fitting the regression line do not hold, then the methods presented here should not be applied. The standard error or distribution assumption of the point estimate – assumed to be normal when applying the \\(t\\) test statistic – may not be valid. If a model underestimates an observation, then the model estimate is below the actual. The residual, which is the actual observation value minus the model estimate, must then be positive. The opposite is true when the model overestimates the observation: the residual is negative.↩ (\\(+\\)) First compute the predicted value based on the model: \\[\\hat{y}_{+} = 41+0.59x_{+} = 41+0.59\\times 85.0 = 91.15\\] Then the residual is given by \\[e_{+} = y_{+} - \\hat{y}_{+} = 98.6-91.15=7.45\\]This was close to the earlier estimate of 7. (\\(\\triangle\\)) \\(\\hat{y}_{\\triangle} = 41+0.59x_{\\triangle} = 97.3\\). \\(e_{\\triangle} = y_{\\triangle} - \\hat{y}_{\\triangle} = -3.3\\), close to the estimate of -4.↩ Formally, we can compute the correlation for observations \\((x_1, y_1)\\), \\((x_2, y_2)\\), …, \\((x_n, y_n)\\) using the formula \\[\\begin{aligned} R = \\frac{1}{n-1}\\sum_{i=1}^{n} \\frac{x_i-\\bar{x}}{s_x}\\frac{y_i-\\bar{y}}{s_y}\\end{aligned}\\] where \\(\\bar{x}\\), \\(\\bar{y}\\), \\(s_x\\), and \\(s_y\\) are the sample means and standard deviations for each variable.↩ We’ll leave it to you to draw the lines. In general, the lines you draw should be close to most points and reflect overall trends in the data.↩ These data were sampled from a table of data for all freshman from the 2011 class at Elmhurst College that accompanied an article titled What Students Really Pay to Go to College published online by The Chronicle of Higher Education: chronicle.com/article/What-Students-Really-Pay-to-Go/131435↩ Larger family incomes are associated with lower amounts of aid, so the correlation will be negative. Using a computer, the correlation can be computed: -0.499.↩ There are applications where Criterion may be more useful, and there are plenty of other criteria we might consider. However, this book only applies the least squares criterion.↩ If you need help finding this location, draw a straight line up from the x-value of 100 (or thereabout). Then draw a horizontal line at 20 (or thereabout). These lines should intersect on the least squares line.↩ Apply Equation with the summary statistics from Table [summaryStatsOfSATGPAData] to compute the slope: \\[\\begin{aligned} b_1 = \\frac{s_y}{s_x} R = \\frac{5.46}{63.2}(-0.499) = -0.0431\\end{aligned}\\]↩ About \\(R^2 = (-0.97)^2 = 0.94\\) or 94% of the variation is explained by the linear model.↩ These data were collected in Fall 2009 and may be found at openintro.org.↩ We will provide two considerations. Each of these points would have very high leverage on any least-squares regression line, and years with such high unemployment may not help us understand what would happen in other years where the unemployment is only modestly high. On the other hand, these are exceptional cases, and we would be discarding important information if we exclude them from a final analysis.↩ We look in the second row corresponding to the family income variable. We see the point estimate of the slope of the line is -0.0431, the standard error of this estimate is 0.0108, and the \\(t\\) test statistic is -3.98. The p-value corresponds exactly to the two-sided test we are interested in: 0.0002. The p-value is so small that we reject the null hypothesis and conclude that family income and financial aid at Elmhurst College for freshman entering in the year 2011 are negatively correlated and the true slope parameter is indeed less than 0, just as we believed in Example [overallAidIncomeInformalAssessmentOfRegressionLineSlope].↩ "],
["multipleRegressionAndANOVA.html", "Chapter 7 Multiple and logistic regression 7.1 Introduction to multiple regression 7.2 Model selection 7.3 Checking model assumptions using graphs 7.4 Logistic regression", " Chapter 7 Multiple and logistic regression [multipleAndLogisticRegression] The principles of simple linear regression lay the foundation for more sophisticated regression methods used in a wide range of challenging settings. In Chapter [multipleAndLogisticRegression], we explore multiple regression, which introduces the possibility of more than one predictor, and logistic regression, a technique for predicting categorical outcomes with two possible categories. 7.1 Introduction to multiple regression Multiple regression extends simple two-variable regression to the case that still has one response but many predictors (denoted \\(x_1\\), \\(x_2\\), \\(x_3\\), …). The method is motivated by scenarios where many variables may be simultaneously connected to an output. We will consider Ebay auctions of a video game called Mario Kart for the Nintendo Wii. The outcome variable of interest is the total price of an auction, which is the highest bid plus the shipping cost. We will try to determine how total price is related to each characteristic in an auction while simultaneously controlling for other variables. For instance, all other characteristics held constant, are longer auctions associated with higher or lower prices? And, on average, how much more do buyers tend to pay for additional Wii wheels (plastic steering wheels that attach to the Wii controller) in auctions? Multiple regression will help us answer these and other questions. The data set includes results from 141 auctions.139 Four observations from this data set are shown in Table [marioKartDataMatrix], and descriptions for each variable are shown in Table [marioKartVariables]. Notice that the condition and stock photo variables are indicator variables. For instance, the variable takes value 1 if the game up for auction is new and 0 if it is used. Using indicator variables in place of category names allows for these variables to be directly used in regression. See Section [categoricalPredictorsWithTwoLevels] for additional details. Multiple regression also allows for categorical variables with many levels, though we do not have any such variables in this analysis, and we save these details for a second or third course. rrrrlr &amp; price &amp; cond_ new &amp; stock_ photo &amp; duration &amp; wheels 1 &amp; 51.55 &amp; 1 &amp; 1 &amp; 3 &amp; 1 2 &amp; 37.04 &amp; 0 &amp; 1 &amp; 7 &amp; 1 \\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) &amp;\\(\\vdots\\) 140 &amp; 38.76 &amp; 0 &amp; 0 &amp; 7 &amp; 0 141 &amp; 54.51 &amp; 1 &amp; 1 &amp; 1 &amp; 2 [marioKartDataMatrix] Variables and their descriptions for the data set. variable description price final auction price plus shipping costs, in US dollars a coded two-level categorical variable, which takes value when the game is new and if the game is used a coded two-level categorical variable, which takes value if the primary photo used in the auction was a stock photo and if the photo was unique to that auction duration the length of the auction, in days, taking values from 1 to 10 wheels the number of Wii wheels included with the auction (a Wii wheel is a plastic racing wheel that holds the Wii controller and is an optional but helpful accessory for playing Mario Kart) [marioKartVariables] 7.1.1 A single-variable model for the Mario Kart data Let’s fit a linear regression model with the game’s condition as a predictor of auction price. The model may be written as \\[\\begin{aligned} \\widehat{price} &amp;= 42.87 + 10.90\\times cond\\_\\hspace{0.3mm}new\\end{aligned}\\] Results of this model are shown in Table [singleVarModelsForPriceUsingCond] and a scatterplot for price versus game condition is shown in Figure [marioKartSingle]. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 42.8711 &amp; 0.8140 &amp; 52.67 &amp; 0.0000 cond_ new &amp; 10.8996 &amp; 1.2583 &amp; 8.66 &amp; 0.0000 &amp;&amp;&amp; [singleVarModelsForPriceUsingCond] Scatterplot of the total auction price against the game’s condition. The least squares line is also shown. [marioKartSingle] Examine Figure [marioKartSingle]. Does the linear model seem ?140 Interpret the coefficient for the game’s condition in the model. Is this coefficient significantly different from 0? Note that is a two-level categorical variable that takes value 1 when the game is new and value 0 when the game is used. So 10.90 means that the model predicts an extra $10.90 for those games that are new versus those that are used. (See Section [categoricalPredictorsWithTwoLevels] for a review of the interpretation for two-level categorical predictor variables.) Examining the regression output in Table [singleVarModelsForPriceUsingCond], we can see that the p-value for is very close to zero, indicating there is strong evidence that the coefficient is different from zero when using this simple one-variable model. 7.1.2 Including and assessing many variables in a model Sometimes there are underlying structures or relationships between predictor variables. For instance, new games sold on Ebay tend to come with more Wii wheels, which may have led to higher prices for those auctions. We would like to fit a model that includes all potentially important variables simultaneously. This would help us evaluate the relationship between a predictor variable and the outcome while controlling for the potential influence of other variables. This is the strategy used in multiple regression. While we remain cautious about making any causal interpretations using multiple regression, such models are a common first step in providing evidence of a causal connection. We want to construct a model that accounts for not only the game condition, as in Section [twoSingleVariableModelsForMarioKartData], but simultaneously accounts for three other variables: , duration, and wheels. \\[\\begin{aligned} \\widehat{\\textbf{price}} &amp;= \\beta_0 + \\beta_1\\times \\textbf{cond\\_\\hspace{0.3mm}new} + \\beta_2\\times \\textbf{stock\\_\\hspace{0.3mm}photo} \\notag \\\\ &amp;\\qquad\\ + \\beta_3 \\times \\textbf{duration} + \\beta_4 \\times \\textbf{wheels} \\notag \\\\ \\hat{y} &amp;= \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_4 x_4 \\label{eqForMultipleRegrOfTotalPrForAllPredictors}\\end{aligned}\\] In this equation, \\(y\\) represents the total price, \\(x_1\\) indicates whether the game is new, \\(x_2\\) indicates whether a stock photo was used, \\(x_3\\) is the duration of the auction, and \\(x_4\\) is the number of Wii wheels included with the game. Just as with the single predictor case, a multiple regression model may be missing important components or it might not precisely represent the relationship between the outcome and the available explanatory variables. While no model is perfect, we wish to explore the possibility that this one may fit the data reasonably well. We estimate the parameters \\(\\beta_0\\), \\(\\beta_1\\), …, \\(\\beta_4\\) in the same way as we did in the case of a single predictor. We select \\(b_0\\), \\(b_1\\), …, \\(b_4\\) that minimize the sum of the squared residuals: \\[\\begin{aligned} \\label{sumOfSqResInMultRegr} SSE = e_1^2 + e_2^2 + \\dots + e_{141}^2 = \\sum_{i=1}^{141} e_i^2 = \\sum_{i=1}^{141} \\left(y_i - \\hat{y}_i\\right)^2\\end{aligned}\\] Here there are 141 residuals, one for each observation. We typically use a computer to minimize the sum in Equation and compute point estimates, as shown in the sample output in Table [outputForMultipleRegrOutputForAllPredictors]. Using this output, we identify the point estimates \\(b_i\\) of each \\(\\beta_i\\), just as we did in the one-predictor case. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.2110 &amp; 1.5140 &amp; 23.92 &amp; 0.0000 cond_ new &amp; 5.1306 &amp; 1.0511 &amp; 4.88 &amp; 0.0000 stock_ photo &amp; 1.0803 &amp; 1.0568 &amp; 1.02 &amp; 0.3085 duration &amp; -0.0268 &amp; 0.1904 &amp; -0.14 &amp; 0.8882 wheels &amp; 7.2852 &amp; 0.5547 &amp; 13.13 &amp; 0.0000 &amp;&amp;&amp; [outputForMultipleRegrOutputForAllPredictors] A multiple regression model is a linear model with many predictors. In general, we write the model as \\[\\begin{aligned} \\hat{y} = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_k x_k %+ \\epsilon\\end{aligned}\\] when there are \\(k\\) predictors. We often estimate the \\(\\beta_i\\) parameters using a computer. [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients] Write out the model in Equation using the point estimates from Table [outputForMultipleRegrOutputForAllPredictors]. How many predictors are there in this model?141 What does \\(\\beta_4\\), the coefficient of variable \\(x_4\\) (Wii wheels), represent? What is the point estimate of \\(\\beta_4\\)?142 [computeMultipleRegressionResidualForMarioKart] Compute the residual of the first observation in Table using the equation identified in Guided Practice [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients].143 We estimated a coefficient for in Section [twoSingleVariableModelsForMarioKartData] of \\(b_1 = 10.90\\) with a standard error of \\(SE_{b_1} = 1.26\\) when using simple linear regression. Why might there be a difference between that estimate and the one in the multiple regression setting? [colinearityOfCondNewAndStockPhoto] If we examined the data carefully, we would see that some predictors are correlated. For instance, when we estimated the connection of the outcome price and predictor using simple linear regression, we were unable to control for other variables like the number of Wii wheels included in the auction. That model was biased by the confounding variable wheels. When we use both variables, this particular underlying and unintentional bias is reduced or eliminated (though bias from other confounding variables may still remain). Example [colinearityOfCondNewAndStockPhoto] describes a common issue in multiple regression: correlation among predictor variables. We say the two predictor variables are collinear (pronounced as co-linear) when they are correlated, and this collinearity complicates model estimation. While it is impossible to prevent collinearity from arising in observational data, experiments are usually designed to prevent predictors from being collinear. The estimated value of the intercept is 36.21, and one might be tempted to make some interpretation of this coefficient, such as, it is the model’s predicted price when each of the variables take value zero: the game is used, the primary image is not a stock photo, the auction duration is zero days, and there are no wheels included. Is there any value gained by making this interpretation?144 7.1.3 Adjusted \\(R^2\\) as a better estimate of explained variance We first used \\(R^2\\) in Section [fittingALineByLSR] to determine the amount of variability in the response that was explained by the model: \\[\\begin{aligned} R^2 = 1 - \\frac{\\text{variability in residuals}}{\\text{variability in the outcome}} = 1 - \\frac{Var(e_i)}{Var(y_i)}\\end{aligned}\\] where \\(e_i\\) represents the residuals of the model and \\(y_i\\) the outcomes. This equation remains valid in the multiple regression framework, but a small enhancement can often be even more informative. [computeUnadjustedR2ForAllPredictorsInMarioKart] The variance of the residuals for the model given in Guided Practice [computeMultipleRegressionResidualForMarioKart] is 23.34, and the variance of the total price in all the auctions is 83.06. Calculate \\(R^2\\) for this model.145 This strategy for estimating \\(R^2\\) is acceptable when there is just a single variable. However, it becomes less helpful when there are many variables. The regular \\(R^2\\) is actually a biased estimate of the amount of variability explained by the model. To get a better estimate, we use the adjusted \\(R^2\\). The is computed as \\[\\begin{aligned} R_{adj}^{2} = 1-\\frac{Var(e_i) / (n-k-1)}{Var(y_i) / (n-1)} = 1-\\frac{Var(e_i)}{Var(y_i)} \\times \\frac{n-1}{n-k-1}\\end{aligned}\\] where \\(n\\) is the number of cases used to fit the model and \\(k\\) is the number of predictor variables in the model. Because \\(k\\) is never negative, the adjusted \\(R^2\\) will be smaller – often times just a little smaller – than the unadjusted \\(R^2\\). The reasoning behind the adjusted \\(R^2\\) lies in the associated with each variance.146 There were \\(n=141\\) auctions in the data set and \\(k=4\\) predictor variables in the model. Use \\(n\\), \\(k\\), and the variances from Guided Practice [computeUnadjustedR2ForAllPredictorsInMarioKart] to calculate \\(R_{adj}^2\\) for the Mario Kart model.147 Suppose you added another predictor to the model, but the variance of the errors \\(Var(e_i)\\) didn’t go down. What would happen to the \\(R^2\\)? What would happen to the adjusted \\(R^2\\)? 148 7.2 Model selection The best model is not always the most complicated. Sometimes including variables that are not evidently important can actually reduce the accuracy of predictions. In this section we discuss model selection strategies, which will help us eliminate from the model variables that are less important. In this section, and in practice, the model that includes all available explanatory variables is often referred to as the full model. Our goal is to assess whether the full model is the best model. If it isn’t, we want to identify a smaller model that is preferable. 7.2.1 Identifying variables in the model that may not be helpful Table [outputForMultipleRegrOutputForAllPredictors2] provides a summary of the regression output for the full model for the auction data. The last column of the table lists p-values that can be used to assess hypotheses of the following form: \\(\\beta_i = 0\\) when the other explanatory variables are included in the model. \\(\\beta_i \\neq 0\\) when the other explanatory variables are included in the model. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.2110 &amp; 1.5140 &amp; 23.92 &amp; 0.0000 cond_ new &amp; 5.1306 &amp; 1.0511 &amp; 4.88 &amp; 0.0000 stock_ photo &amp; 1.0803 &amp; 1.0568 &amp; 1.02 &amp; 0.3085 duration &amp; -0.0268 &amp; 0.1904 &amp; -0.14 &amp; 0.8882 wheels &amp; 7.2852 &amp; 0.5547 &amp; 13.13 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp; [outputForMultipleRegrOutputForAllPredictors2] The coefficient of has a \\(t\\) test statistic of \\(T=4.88\\) and a p-value for its corresponding hypotheses (\\(H_0: \\beta_1 = 0\\), \\(H_A: \\beta_1 \\neq 0\\)) of about zero. How can this be interpreted? If we keep all the other variables in the model and add no others, then there is strong evidence that a game’s condition (new or used) has a real relationship with the total auction price. Is there strong evidence that using a stock photo is related to the total auction price? The \\(t\\) test statistic for is \\(T=1.02\\) and the p-value is about 0.31. After accounting for the other predictors, there is not strong evidence that using a stock photo in an auction is related to the total price of the auction. We might consider removing the variable from the model. Identify the p-values for both the duration and wheels variables in the model. Is there strong evidence supporting the connection of these variables with the total price in the model?149 There is not statistically significant evidence that either the stock photo or duration variables contribute meaningfully to the model. Next we consider common strategies for pruning such variables from a model. The adjusted \\(R^2\\) may be used as an alternative to p-values for model selection, where a higher adjusted \\(R^2\\) represents a better model fit. For instance, we could compare two models using their adjusted \\(R^2\\), and the model with the higher adjusted \\(R^2\\) would be preferred. This approach tends to include more variables in the final model when compared to the p-value approach. 7.2.2 Two model selection strategies Two common strategies for adding or removing variables in a multiple regression model are called backward-selection and forward-selection. These techniques are often referred to as stepwise model selection strategies, because they add or delete one variable at a time as they “step” through the candidate predictors. We will discuss these strategies in the context of the p-value approach. Alternatively, we could have employed an \\(R_{adj}^2\\) approach. The backward-elimination strategy starts with the model that includes all potential predictor variables. Variables are eliminated one-at-a-time from the model until only variables with statistically significant p-values remain. The strategy within each elimination step is to drop the variable with the largest p-value, refit the model, and reassess the inclusion of all variables. Results corresponding to the full model for the data are shown in Table [outputForMultipleRegrOutputForAllPredictors2]. How should we proceed under the backward-elimination strategy? [backwardEliminationExampleWMarioKartData] There are two variables with coefficients that are not statistically different from zero: and duration. We first drop the duration variable since it has a larger corresponding p-value, then we refit the model. A regression summary for the new model is shown in Table [outputForMultipleRegrOutputForAllPredictorsButDuration]. In the new model, there is not strong evidence that the coefficient for is different from zero, even though the p-value decreased slightly, and the other p-values remain very small. Next, we again eliminate the variable with the largest non-significant p-value, , and refit the model. The updated regression summary is shown in Table [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto]. In the latest model, we see that the two remaining predictors have statistically significant coefficients with p-values of about zero. Since there are no variables remaining that could be eliminated from the model, we stop. The final model includes only the and wheels variables in predicting the total auction price: \\[\\begin{aligned} \\hat{y} \\ &amp;= \\ b_0 + b_1x_1 + b_4x_4 \\\\ &amp;= \\ 36.78 + 5.58x_1 + 7.23x_4\\end{aligned}\\] where \\(x_1\\) represents and \\(x_4\\) represents wheels. An alternative to using p-values in model selection is to use the adjusted \\(R^2\\). At each elimination step, we refit the model without each of the variables up for potential elimination. For example, in the first step, we would fit four models, where each would be missing a different predictor. If one of these smaller models has a higher adjusted \\(R^2\\) than our current model, we pick the smaller model with the largest adjusted \\(R^2\\). We continue in this way until removing variables does not increase \\(R_{adj}^2\\). Had we used the adjusted \\(R^2\\) criteria, we would have kept the variable along with the and wheels variables. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.0483 &amp; 0.9745 &amp; 36.99 &amp; 0.0000 cond_ new &amp; 5.1763 &amp; 0.9961 &amp; 5.20 &amp; 0.0000 stock_ photo &amp; 1.1177 &amp; 1.0192 &amp; 1.10 &amp; 0.2747 wheels &amp; 7.2984 &amp; 0.5448 &amp; 13.40 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp;&amp;\\(df=137\\) [outputForMultipleRegrOutputForAllPredictorsButDuration] rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(\\(&gt;\\)\\(|\\)t\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; 36.7849 &amp; 0.7066 &amp; 52.06 &amp; 0.0000 cond_ new &amp; 5.5848 &amp; 0.9245 &amp; 6.04 &amp; 0.0000 wheels &amp; 7.2328 &amp; 0.5419 &amp; 13.35 &amp; 0.0000 &amp; &amp; &amp; &amp; &amp;&amp;\\(df=138\\) [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto] Notice that the p-value for changed a little from the full model (0.309) to the model that did not include the duration variable (0.275). It is common for p-values of one variable to change, due to collinearity, after eliminating a different variable. This fluctuation emphasizes the importance of refitting a model after each variable elimination step. The p-values tend to change dramatically when the eliminated variable is highly correlated with another variable in the model. The forward-selection strategy is the reverse of the backward-elimination technique. Instead of eliminating variables one-at-a-time, we add variables one-at-a-time until we cannot find any variables that present strong evidence of their importance in the model. Construct a model for the data set using the forward-selection strategy.[forwardEliminationExampleWMarioKartData] We start with the model that includes no variables. Then we fit each of the possible models with just one variable. That is, we fit the model including just the predictor, then the model including just the variable, then a model with just duration, and a model with just wheels. Each of the four models (yes, we fit four models!) provides a p-value for the coefficient of the predictor variable. Out of these four variables, the wheels variable had the smallest p-value. Since its p-value is less than 0.05 (the p-value was smaller than 2e-16), we add the Wii wheels variable to the model. Once a variable is added in forward-selection, it will be included in all models considered as well as the final model. Since we successfully found a first variable to add, we consider adding another. We fit three new models: (1) the model including just the and wheels variables (output in Table [outputForMultipleRegrOutputForAllPredictorsButDurationAndStockPhoto]), (2) the model including just the and wheels variables, and (3) the model including only the duration and wheels variables. Of these models, the first had the lowest p-value for its new variable (the p-value corresponding to was 1.4e-08). Because this p-value is below 0.05, we add the variable to the model. Now the final model is guaranteed to include both the condition and wheels variables. We must then repeat the process a third time, fitting two new models: (1) the model including the , , and wheels variables (output in Table [outputForMultipleRegrOutputForAllPredictorsButDuration]) and (2) the model including the duration, , and wheels variables. The p-value corresponding to in the first model (0.275) was smaller than the p-value corresponding to duration in the second model (0.682). However, since this smaller p-value was not below 0.05, there was not strong evidence that it should be included in the model. Therefore, neither variable is added and we are finished. The final model is the same as that arrived at using the backward-selection strategy. As before, we could have used the \\(R_{adj}^2\\) criteria instead of examining p-values in selecting variables for the model. Rather than look for variables with the smallest p-value, we look for the model with the largest \\(R_{adj}^2\\). What would the result of forward-selection be using the adjusted \\(R^2\\) approach? Using the forward-selection strategy, we start with the model with no predictors. Next we look at each model with a single predictor. If one of these models has a larger \\(R_{adj}^2\\) than the model with no variables, we use this new model. We repeat this procedure, adding one variable at a time, until we cannot find a model with a larger \\(R_{adj}^2\\). If we had done the forward-selection strategy using \\(R_{adj}^2\\), we would have arrived at the model including , , and wheels, which is a slightly larger model than we arrived at using the p-value approach and the same model we arrived at using the adjusted \\(R^2\\) and backwards-elimination. The backward-elimination strategy begins with the largest model and eliminates variables one-by-one until we are satisfied that all remaining variables are important to the model. The forward-selection strategy starts with no variables included in the model, then it adds in variables according to their importance until no other important variables are found. There is no guarantee that the backward-elimination and forward-selection strategies will arrive at the same final model using the p-value or adjusted \\(R^2\\) methods. If the backwards-elimination and forward-selection strategies are both tried and they arrive at different models, choose the model with the larger \\(R_{adj}^2\\) as a tie-breaker; other tie-break options exist but are beyond the scope of this book. It is generally acceptable to use just one strategy, usually backward-elimination with either the p-value or adjusted \\(R^2\\) criteria. However, before reporting the model results, we must verify the model conditions are reasonable. 7.3 Checking model assumptions using graphs Multiple regression methods using the model \\[\\begin{aligned} \\hat{y} &amp;= \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\cdots + \\beta_kx_k\\end{aligned}\\] generally depend on the following four assumptions: the residuals of the model are nearly normal, the variability of the residuals is nearly constant, the residuals are independent, and each variable is linearly related to the outcome. Simple and effective plots can be used to check each of these assumptions. We will consider the model for the auction data that uses the game condition and number of wheels as predictors. The plotting methods presented here may also be used to check the conditions for the models introduced in Chapter [linRegrForTwoVar]. Normal probability plot. A normal probability plot of the residuals is shown in Figure [mkDiagnosticNormalQuantilePlot]. While the plot exhibits some minor irregularities, there are no outliers that might be cause for concern. In a normal probability plot for residuals, we tend to be most worried about residuals that appear to be outliers, since these indicate long tails in the distribution of residuals. A normal probability plot of the residuals is helpful in identifying observations that might be outliers. [mkDiagnosticNormalQuantilePlot] Absolute values of residuals against fitted values. A plot of the absolute value of the residuals against their corresponding fitted values (\\(\\hat{y}_i\\)) is shown in Figure [mkDiagnosticEvsAbsF]. This plot is helpful to check the condition that the variance of the residuals is approximately constant. We don’t see any obvious deviations from constant variance in this example. Comparing the absolute value of the residuals against the fitted values (\\(\\hat{y}_i\\)) is helpful in identifying deviations from the constant variance assumption. [mkDiagnosticEvsAbsF] Residuals in order of their data collection. A plot of the residuals in the order their corresponding auctions were observed is shown in Figure [mkDiagnosticInOrder]. Such a plot is helpful in identifying any connection between cases that are close to one another, e.g. we could look for declining prices over time or if there was a time of the day when auctions tended to fetch a higher price. Here we see no structure that indicates a problem.150 Plotting residuals in the order that their corresponding observations were collected helps identify connections between successive observations. If it seems that consecutive observations tend to be close to each other, this indicates the independence assumption of the observations would fail. [mkDiagnosticInOrder] Residuals against each predictor variable. We consider a plot of the residuals against the variable and the residuals against the wheels variable. These plots are shown in Figure [mkDiagnosticEvsVariables]. For the two-level condition variable, we are guaranteed not to see any remaining trend, and instead we are checking that the variability doesn’t fluctuate across groups. In this example, when we consider the residuals against the wheels variable, we see some possible structure. There appears to be curvature in the residuals, indicating the relationship is probably not linear. In the two-level variable for the game’s condition, we check for differences in distribution shape or variability. For numerical predictors, we also check for trends or other structure. We see some slight bowing in the residuals against the wheels variable. [mkDiagnosticEvsVariables] It is necessary to summarize diagnostics for any model fit. If the diagnostics support the model assumptions, this would improve credibility in the findings. If the diagnostic assessment shows remaining underlying structure in the residuals, we should try to adjust the model to account for that structure. If we are unable to do so, we may still report the model but must also note its shortcomings. In the case of the auction data, we report that there may be a nonlinear relationship between the total price and the number of wheels included for an auction. This information would be important to buyers and sellers; omitting this information could be a setback to the very people who the model might assist. The truth is that no model is perfect. However, even imperfect models can be useful. Reporting a flawed model can be reasonable so long as we are clear and report the model’s shortcomings. Don’t report results when assumptions are grossly violated While there is a little leeway in model assumptions, don’t go too far. If model assumptions are very clearly violated, consider a new model, even if it means learning more statistical methods or hiring someone who can help. Confidence intervals for coefficients in multiple regression can be computed using the same formula as in the single predictor model: \\[\\begin{aligned} b_i \\ \\pm\\ t_{df}^{\\star}SE_{b_{i}}\\end{aligned}\\] where \\(t_{df}^{\\star}\\) is the appropriate \\(t\\) value corresponding to the confidence level and model degrees of freedom, \\(df=n-k-1\\). 7.4 Logistic regression In this section we introduce logistic regression as a tool for building models when there is a categorical response variable with two levels. Logistic regression is a type of generalized linear model (GLM) for response variables where regular multiple regression does not work very well. In particular, the response variable in these settings often takes a form where residuals look completely different from the normal distribution. GLMs can be thought of as a two-stage modeling approach. We first model the response variable using a probability distribution, such as the binomial or Poisson distribution. Second, we model the parameter of the distribution using a collection of predictors and a special form of multiple regression. In Section [logisticRegression] we will revisit the email data set from Chapter [introductionToData]. These emails were collected from a single email account, and we will work on developing a basic spam filter using these data. The response variable, spam, has been encoded to take value 0 when a message is not spam and 1 when it is spam. Our task will be to build an appropriate model that classifies messages as spam or not spam using email characteristics coded as predictor variables. While this model will not be the same as those used in large-scale spam filters, it shares many of the same features. 7.4.1 Email data The email data set was first presented in Chapter [introductionToData] with a relatively small number of variables. In fact, there are many more variables available that might be useful for classifying spam. Descriptions of these variables are presented in Table [emailVariables]. The spam variable will be the outcome, and the other 10 variables will be the model predictors. While we have limited the predictors used in this section to be categorical variables (where many are represented as indicator variables), numerical predictors may also be used in logistic regression. See the footnote for an additional discussion on this topic.151 Descriptions for 11 variables in the email data set. Notice that all of the variables are indicator variables, which take the value 1 if the specified characteristic is present and 0 otherwise. variable description spam Specifies whether the message was spam. An indicator variable for if more than one person was listed in the To field of the email. cc An indicator for if someone was CCed on the email. attach An indicator for if there was an attachment, such as a document or image. dollar An indicator for if the word “dollar” or dollar symbol ($) appeared in the email. winner An indicator for if the word “winner” appeared in the email message. inherit An indicator for if the word “inherit” (or a variation, like “inheritance”) appeared in the email. password An indicator for if the word “password” was present in the email. format Indicates if the email contained special formatting, such as bolding, tables, or links Indicates whether “Re:” was included at the start of the email subject. Indicates whether any exclamation point was included in the email subject. [emailVariables] 7.4.2 Modeling the probability of an event The outcome variable for a GLM is denoted by \\(Y_i\\), where the index \\(i\\) is used to represent observation \\(i\\). In the email application, \\(Y_i\\) will be used to represent whether email \\(i\\) is spam (\\(Y_i=1\\)) or not (\\(Y_i=0\\)). The predictor variables are represented as follows: \\(x_{1,i}\\) is the value of variable 1 for observation \\(i\\), \\(x_{2,i}\\) is the value of variable 2 for observation \\(i\\), and so on. Logistic regression is a generalized linear model where the outcome is a two-level categorical variable. The outcome, \\(Y_i\\), takes the value 1 (in our application, this represents a spam message) with probability \\(p_i\\) and the value 0 with probability \\(1-p_i\\). It is the probability \\(p_i\\) that we model in relation to the predictor variables. The logistic regression model relates the probability an email is spam (\\(p_i\\)) to the predictors \\(x_{1,i}\\), \\(x_{2,i}\\), …, \\(x_{k,i}\\) through a framework much like that of multiple regression: \\[\\begin{aligned} transformation(p_{i}) = \\beta_0 + \\beta_1x_{1,i} + \\beta_2 x_{2,i} + \\cdots \\beta_k x_{k,i} \\label{linkTransformationEquation}\\end{aligned}\\] We want to choose a transformation in Equation that makes practical and mathematical sense. For example, we want a transformation that makes the range of possibilities on the left hand side of Equation equal to the range of possibilities for the right hand side; if there was no transformation for this equation, the left hand side could only take values between 0 and 1, but the right hand side could take values outside of this range. A common transformation for \\(p_i\\) is the logit transformation, which may be written as \\[\\begin{aligned} logit(p_i) = \\log_{e}\\left( \\frac{p_i}{1-p_i} \\right)\\end{aligned}\\] The logit transformation is shown in Figure [logitTransformationFigureHoriz]. Below, we rewrite Equation using the logit transformation of \\(p_i\\): \\[\\begin{aligned} \\log_{e}\\left( \\frac{p_i}{1-p_i} \\right) = \\beta_0 + \\beta_1 x_{1,i} + \\beta_2 x_{2,i} + \\cdots + \\beta_k x_{k,i}\\end{aligned}\\] In our spam example, there are 10 predictor variables, so \\(k = 10\\). This model isn’t very intuitive, but it still has some resemblance to multiple regression, and we can fit this model using software. In fact, once we look at results from software, it will start to feel like we’re back in multiple regression, even if the interpretation of the coefficients is more complex. Values of \\(p_i\\) against values of \\(logit(p_i)\\). [logitTransformationFigureHoriz] Here we create a spam filter with a single predictor: . This variable indicates whether more than one email address was listed in the To field of the email. The following logistic regression model was fit using statistical software: \\[\\begin{aligned} \\log\\left( \\frac{p_i}{1-p_i} \\right) = -2.12 - 1.81\\times\\text{\\textbf{to\\_\\hspace{0.3mm}multiple}}\\end{aligned}\\] If an email is randomly selected and it has just one address in the To field, what is the probability it is spam? What if more than one address is listed in the To field? [logisticExampleWithToMultiple] If there is only one email in the To field, then takes value 0 and the right side of the model equation equals -2.12. Solving for \\(p_i\\): \\(\\frac{e^{-2.12}}{1 + e^{-2.12}} = 0.11\\). Just as we labeled a fitted value of \\(y_i\\) with a “hat” in single-variable and multiple regression, we will do the same for this probability: \\(\\hat{p}_i = 0.11\\). If there is more than one address listed in the To field, then the right side of the model equation is \\(-2.12 - 1.81\\times1 = -3.93\\), which corresponds to a probability \\(\\hat{p}_i = 0.02\\). Notice that we could examine -2.12 and -3.93 in Figure [logitTransformationFigureHoriz] to estimate the probability before formally calculating the value. To convert from values on the regression-scale (e.g. -2.12 and -3.93 in Example [logisticExampleWithToMultiple]), use the following formula, which is the result of solving for \\(p_i\\) in the regression model: \\[\\begin{aligned} p_i = \\frac{e^{\\beta_0 + \\beta_1 x_{1,i}+\\cdots+\\beta_k x_{k,i}}} {\\ 1\\ \\ +\\ \\ e^{\\beta_0 + \\beta_1 x_{1,i}+\\cdots+\\beta_k x_{k,i}}\\ }\\end{aligned}\\] As with most applied data problems, we substitute the point estimates for the parameters (the \\(\\beta_i\\)) so that we may make use of this formula. In Example [logisticExampleWithToMultiple], the probabilities were calculated as \\[\\begin{aligned} &amp;\\frac{\\ e^{-2.12}\\ }{\\ 1\\ +\\ e^{-2.12}\\ } = 0.11 &amp;&amp; \\frac{\\ e^{-2.12 - 1.81}\\ }{\\ 1\\ +\\ e^{-2.12 - 1.81}\\ } = 0.02\\end{aligned}\\] While the information about whether the email is addressed to multiple people is a helpful start in classifying email as spam or not, the probabilities of 11% and 2% are not dramatically different, and neither provides very strong evidence about which particular email messages are spam. To get more precise estimates, we’ll need to include many more variables in the model. We used statistical software to fit the logistic regression model with all ten predictors described in Table [emailVariables]. Like multiple regression, the result may be presented in a summary table, which is shown in Table [emailLogisticModelResults]. The structure of this table is almost identical to that of multiple regression; the only notable difference is that the p-values are calculated using the normal distribution rather than the \\(t\\) distribution. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; z value &amp; Pr(\\(&gt;\\)\\(|\\)z\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -0.8362 &amp; 0.0962 &amp; -8.69 &amp; 0.0000 to_ multiple &amp; -2.8836 &amp; 0.3121 &amp; -9.24 &amp; 0.0000 winner &amp; 1.7038 &amp; 0.3254 &amp; 5.24 &amp; 0.0000 format &amp; -1.5902 &amp; 0.1239 &amp; -12.84 &amp; 0.0000 re_ subj &amp; -2.9082 &amp; 0.3708 &amp; -7.84 &amp; 0.0000 exclaim_ subj &amp; 0.1355 &amp; 0.2268 &amp; 0.60 &amp; 0.5503 cc &amp; -0.4863 &amp; 0.3054 &amp; -1.59 &amp; 0.1113 attach &amp; 0.9790 &amp; 0.2170 &amp; 4.51 &amp; 0.0000 dollar &amp; -0.0582 &amp; 0.1589 &amp; -0.37 &amp; 0.7144 inherit &amp; 0.2093 &amp; 0.3197 &amp; 0.65 &amp; 0.5127 password &amp; -1.4929 &amp; 0.5295 &amp; -2.82 &amp; 0.0048 [emailLogisticModelResults] Just like multiple regression, we could trim some variables from the model using the p-value. Using backwards elimination with a p-value cutoff of 0.05 (start with the full model and trim the predictors with p-values greater than 0.05), we ultimately eliminate the , dollar, inherit, and cc predictors. The remainder of this section will rely on this smaller model, which is summarized in Table [emailLogisticReducedModel]. rrrrr &amp; &amp; &amp; &amp; &amp; Estimate &amp; Std. Error &amp; z value &amp; Pr(\\(&gt;\\)\\(|\\)z\\(|\\)) &amp; &amp; &amp; &amp; (Intercept) &amp; -0.8595 &amp; 0.0910 &amp; -9.44 &amp; 0.0000 to_ multiple &amp; -2.8372 &amp; 0.3092 &amp; -9.18 &amp; 0.0000 winner &amp; 1.7370 &amp; 0.3218 &amp; 5.40 &amp; 0.0000 format &amp; -1.5569 &amp; 0.1207 &amp; -12.90 &amp; 0.0000 re_ subj &amp; -3.0482 &amp; 0.3630 &amp; -8.40 &amp; 0.0000 attach &amp; 0.8643 &amp; 0.2042 &amp; 4.23 &amp; 0.0000 password &amp; -1.4871 &amp; 0.5290 &amp; -2.81 &amp; 0.0049 [emailLogisticReducedModel] Examine the summary of the reduced model in Table [emailLogisticReducedModel], and in particular, examine the row. Is the point estimate the same as we found before, -1.81, or is it different? Explain why this might be.152 Point estimates will generally change a little – and sometimes a lot – depending on which other variables are included in the model. This is usually due to colinearity in the predictor variables. We previously saw this in the Ebay auction example when we compared the coefficient of in a single-variable model and the corresponding coefficient in the multiple regression model that used three additional variables (see Sections [twoSingleVariableModelsForMarioKartData] and [includingAndAssessingManyVariablesInAModel]). Spam filters are built to be automated, meaning a piece of software is written to collect information about emails as they arrive, and this information is put in the form of variables. These variables are then put into an algorithm that uses a statistical model, like the one we’ve fit, to classify the email. Suppose we write software for a spam filter using the reduced model shown in Table [emailLogisticReducedModel]. If an incoming email has the word “winner” in it, will this raise or lower the model’s calculated probability that the incoming email is spam? [exampleForSpamAndWinner] The estimated coefficient of winner is positive (1.7370). A positive coefficient estimate in logistic regression, just like in multiple regression, corresponds to a positive association between the predictor and response variables when accounting for the other variables in the model. Since the response variable takes value 1 if an email is spam and 0 otherwise, the positive coefficient indicates that the presence of “winner” in an email raises the model probability that the message is spam. Suppose the same email from Example [exampleForSpamAndWinner] was in HTML format, meaning the format variable took value 1. Does this characteristic increase or decrease the probability that the email is spam according to the model?[exampleForSpamAndFormat] Since HTML corresponds to a value of 1 in the format variable and the coefficient of this variable is negative (-1.5569), this would lower the probability estimate returned from the model. 7.4.3 Practical decisions in the email application Examples [exampleForSpamAndWinner] and [exampleForSpamAndFormat] highlight a key feature of logistic and multiple regression. In the spam filter example, some email characteristics will push an email’s classification in the direction of spam while other characteristics will push it in the opposite direction. If we were to implement a spam filter using the model we have fit, then each future email we analyze would fall into one of three categories based on the email’s characteristics: The email characteristics generally indicate the email is not spam, and so the resulting probability that the email is spam is quite low, say, under 0.05. The characteristics generally indicate the email is spam, and so the resulting probability that the email is spam is quite large, say, over 0.95. The characteristics roughly balance each other out in terms of evidence for and against the message being classified as spam. Its probability falls in the remaining range, meaning the email cannot be adequately classified as spam or not spam. If we were managing an email service, we would have to think about what should be done in each of these three instances. In an email application, there are usually just two possibilities: filter the email out from the regular inbox and put it in a “spambox”, or let the email go to the regular inbox. The first and second scenarios are intuitive. If the evidence strongly suggests a message is not spam, send it to the inbox. If the evidence strongly suggests the message is spam, send it to the spambox. How should we handle emails in the third category?153 Suppose we apply the logistic model we have built as a spam filter and that 100 messages are placed in the spambox over 3 months. If we used the guidelines above for putting messages into the spambox, about how many legitimate (non-spam) messages would you expect to find among the 100 messages?154 Almost any classifier will have some error. In the spam filter guidelines above, we have decided that it is okay to allow up to 5% of the messages in the spambox to be real messages. If we wanted to make it a little harder to classify messages as spam, we could use a cutoff of 0.99. This would have two effects. Because it raises the standard for what can be classified as spam, it reduces the number of good emails that are classified as spam. However, it will also fail to correctly classify an increased fraction of spam messages. No matter the complexity and the confidence we might have in our model, these practical considerations are absolutely crucial to making a helpful spam filter. Without them, we could actually do more harm than good by using our statistical model. 7.4.4 Diagnostics for the email classifier There are two key conditions for fitting a logistic regression model: Each predictor \\(x_i\\) is linearly related to logit\\((p_i)\\) if all other predictors are held constant. Each outcome \\(Y_i\\) is independent of the other outcomes. The first condition of the logistic regression model is not easily checked without a fairly sizable amount of data. Luckily, we have 3,921 emails in our data set! Let’s first visualize these data by plotting the true classification of the emails against the model’s fitted probabilities, as shown in Figure [logisticModelPredict]. The vast majority of emails (spam or not) still have fitted probabilities below 0.5. The predicted probability that each of the 3,912 emails is spam is classified by their grouping, spam or not. Noise (small, random vertical shifts) have been added to each point so that points with nearly identical values aren’t plotted exactly on top of one another. This makes it possible to see more observations. [logisticModelPredict] This may at first seem very discouraging: we have fit a logistic model to create a spam filter, but no emails have a fitted probability of being spam above 0.75. Don’t despair; we will discuss ways to improve the model through the use of better variables in Section [improvingTheSetOfVariablesForASpamFilter]. We’d like to assess the quality of our model. For example, we might ask: if we look at emails that we modeled as having a 10% chance of being spam, do we find about 10% of them actually are spam? To help us out, we’ll borrow an advanced statistical method called natural splines that estimates the local probability over the region 0.00 to 0.75 (the largest predicted probability was 0.73, so we avoid extrapolating). All you need to know about natural splines to understand what we are doing is that they are used to fit flexible lines rather than straight lines. The curve fit using natural splines is shown in Figure [logisticModelSpline] as a solid black line. If the logistic model fits well, the curve should closely follow the dashed \\(y=x\\) line. We have added shading to represent the confidence bound for the curved line to clarify what fluctuations might plausibly be due to chance. Even with this confidence bound, there are weaknesses in the first model assumption. The solid curve and its confidence bound dips below the dashed line from about 0.1 to 0.3, and then it drifts above the dashed line from about 0.35 to 0.55. These deviations indicate the model relating the parameter to the predictors does not closely resemble the true relationship. The solid black line provides the empirical estimate of the probability for observations based on their predicted probabilities (confidence bounds are also shown for this line), which is fit using natural splines. A small amount of noise was added to the observations in the plot to allow more observations to be seen. [logisticModelSpline] We could evaluate the second logistic regression model assumption – independence of the outcomes – using the model residuals. The residuals for a logistic regression model are calculated the same way as with multiple regression: the observed outcome minus the expected outcome. For logistic regression, the expected value of the outcome is the fitted probability for the observation, and the residual may be written as \\[\\begin{aligned} e_i = Y_i - \\hat{p}_i\\end{aligned}\\] We could plot these residuals against a variety of variables or in their order of collection, as we did with the residuals in multiple regression. However, since the model will need to be revised to effectively classify spam and you have already seen similar residual plots in Section [multipleRegressionModelAssumptions], we won’t investigate the residuals here. 7.4.5 Improving the set of variables for a spam filter If we were building a spam filter for an email service that managed many accounts (e.g. Gmail or Hotmail), we would spend much more time thinking about additional variables that could be useful in classifying emails as spam or not. We also would use transformations or other techniques that would help us include strongly skewed numerical variables as predictors. Take a few minutes to think about additional variables that might be useful in identifying spam. Below is a list of variables we think might be useful: An indicator variable could be used to represent whether there was prior two-way correspondence with a message’s sender. For instance, if you sent a message to john@example.com and then John sent you an email, this variable would take value 1 for the email that John sent. If you had never sent John an email, then the variable would be set to 0. A second indicator variable could utilize an account’s past spam flagging information. The variable could take value 1 if the sender of the message has previously sent messages flagged as spam. A third indicator variable could flag emails that contain links included in previous spam messages. If such a link is found, then set the variable to 1 for the email. Otherwise, set it to 0. The variables described above take one of two approaches. Variable (1) is specially designed to capitalize on the fact that spam is rarely sent between individuals that have two-way communication. Variables (2) and (3) are specially designed to flag common spammers or spam messages. While we would have to verify using the data that each of the variables is effective, these seem like promising ideas. Table [emailTableOfSpamAnd] shows a contingency table for spam and also for the new variable described in (1) above. If we look at the 1,090 emails where there was correspondence with the sender in the preceding 30 days, not one of these message was spam. This suggests variable (1) would be very effective at accurately classifying some messages as not spam. With this single variable, we would be able to send about 28% of messages through to the inbox with confidence that almost none are spam. lrrrr &amp; &amp; &amp; &amp; &amp;&amp; Total &amp; &amp; &amp; &amp; &amp; 367 &amp; 0 &amp;&amp; 367 &amp; 2464 &amp; 1090 &amp;&amp; 3554 &amp; &amp; &amp; &amp; Total &amp; 2831 &amp; 1090 &amp;&amp; 3921 [emailTableOfSpamAnd] The variables described in (2) and (3) would provide an excellent foundation for distinguishing messages coming from known spammers or messages that take a known form of spam. To utilize these variables, we would need to build databases: one holding email addresses of known spammers, and one holding URLs found in known spam messages. Our access to such information is limited, so we cannot implement these two variables in this textbook. However, if we were hired by an email service to build a spam filter, these would be important next steps. In addition to finding more and better predictors, we would need to create a customized logistic regression model for each email account. This may sound like an intimidating task, but its complexity is not as daunting as it may at first seem. We’ll save the details for a statistics course where computer programming plays a more central role. For what is the extremely challenging task of classifying spam messages, we have made a lot of progress. We have seen that simple email variables, such as the format, inclusion of certain words, and other circumstantial characteristics, provide helpful information for spam classification. Many challenges remain, from better understanding logistic regression to carrying out the necessary computer programming, but completing such a task is very nearly within your reach. Diez DM, Barr CD, and Çetinkaya-Rundel M. 2012. openintro: OpenIntro data sets and supplemental functions. cran.r-project.org/web/packages/openintro.↩ Yes. Constant variability, nearly normal residuals, and linearity all appear reasonable.↩ \\(\\hat{y} = 36.21 + 5.13x_1 + 1.08x_2 - 0.03x_3 + 7.29x_4\\), and there are \\(k=4\\) predictor variables.↩ It is the average difference in auction price for each additional Wii wheel included when holding the other variables constant. The point estimate is \\(b_4 = 7.29\\).↩ \\(e_i = y_i - \\hat{y_i} = 51.55 - 49.62 = 1.93\\), where 49.62 was computed using the variables values from the observation and the equation identified in Guided Practice [eqForMultipleRegrOfTotalPrForAllPredictorsWithCoefficients].↩ Three of the variables (, , and wheels) do take value 0, but the auction duration is always one or more days. If the auction is not up for any days, then no one can bid on it! That means the total auction price would always be zero for such an auction; the interpretation of the intercept in this setting is not insightful.↩ \\(R^2 = 1 - \\frac{23.34}{83.06} = 0.719\\).↩ In multiple regression, the degrees of freedom associated with the variance of the estimate of the residuals is \\(n-k-1\\), not \\(n-1\\). For instance, if we were to make predictions for new data using our current model, we would find that the unadjusted \\(R^2\\) is an overly optimistic estimate of the reduction in variance in the response, and using the degrees of freedom in the adjusted \\(R^2\\) formula helps correct this bias.↩ \\(R_{adj}^2 = 1 - \\frac{23.34}{83.06}\\times \\frac{141-1}{141-4-1} = 0.711\\).↩ The unadjusted \\(R^2\\) would stay the same and the adjusted \\(R^2\\) would go down.↩ The p-value for the auction duration is 0.8882, which indicates that there is not statistically significant evidence that the duration is related to the total auction price when accounting for the other variables. The p-value for the Wii wheels variable is about zero, indicating that this variable is associated with the total auction price.↩ An especially rigorous check would use time series methods. For instance, we could check whether consecutive residuals are correlated. Doing so with these residuals yields no statistically significant correlations.↩ Recall from Chapter [linRegrForTwoVar] that if outliers are present in predictor variables, the corresponding observations may be especially influential on the resulting model. This is the motivation for omitting the numerical variables, such as the number of characters and line breaks in emails, that we saw in Chapter [introductionToData]. These variables exhibited extreme skew. We could resolve this issue by transforming these variables (e.g. using a log-transformation), but we will omit this further investigation for brevity.↩ The new estimate is different: -2.87. This new value represents the estimated coefficient when we are also accounting for other variables in the logistic regression model.↩ In this particular application, we should err on the side of sending more mail to the inbox rather than mistakenly putting good messages in the spambox. So, in summary: emails in the first and last categories go to the regular inbox, and those in the second scenario go to the spambox.↩ First, note that we proposed a cutoff for the predicted probability of 0.95 for spam. In a worst case scenario, all the messages in the spambox had the minimum probability equal to about 0.95. Thus, we should expect to find about 5 or fewer legitimate messages among the 100 messages placed in the spambox.↩ "],
["inferenceForCategoricalData.html", "Chapter 8 Inference for categorical data 8.1 Inference for a single proportion 8.2 Difference of two proportions 8.3 Testing for goodness of fit using chi-square (special topic) 8.4 Testing for independence in two-way tables (special topic)", " Chapter 8 Inference for categorical data Chapter [inferenceForCategoricalData] provides a more complete framework for statistical techniques suitable for categorical data. We’ll continue working with the normal model in the context of inference for proportions, and we’ll also encounter a new technique and distribution suitable for working with frequency and contingency tables in Sections [oneWayChiSquare] and [twoWayTablesAndChiSquare]. 8.1 Inference for a single proportion Before we get started, we’ll introduce a little terminology and notation. In the tappers-listeners study, one person tapped a tune on the table and the listener tried to guess the game. In this study, each game can be thought of as a trial. We could label each trial a success if the listener successfully guessed the tune, and we could label a trial a failure if the listener was unsuccessful. A single event that leads to an outcome can be called a trial. If the trial has two possible outcomes, e.g. heads or tails when flipping a coin, we typically label one of those outcome a success and the other a failure. The choice of which outcome is labeled a success and which a failure is arbitrary, and it will not impact the results of our analyses. When a proportion is recorded, it is common to use a 1 to represent a “success” and a 0 to represent a “failure” and then write down a key to communicate what each value represents. This notation is also convenient for calculations. For example, if we have 10 trials with 6 success (1’s) and 4 failures (0’s), the sample proportion can be computed using the mean of the zeros and ones: \\[\\begin{aligned} \\hat{p} = \\frac{\\ 1 + 1 + 1 + 1 + 1 + 1 + 0 + 0 + 0 + 0\\ }{10} = 0.6\\end{aligned}\\] Next we’ll take a look at when we can apply our normal distribution framework to the distribution of the sample proportion, \\(\\hat{p}\\). 8.1.1 When the sample proportion is nearly normal The sampling distribution for \\(\\hat{p}\\), taken from a sample of size \\(n\\) from a population with a true proportion \\(p\\), is nearly normal when the sample observations are independent and we expected to see at least 10 successes and 10 failures in our sample, i.e. \\(np\\geq10\\) and \\(n(1-p)\\geq10\\). This is called the success-failure condition. If these conditions are met, then the sampling distribution of \\(\\hat{p}\\) is nearly normal with mean \\(p\\) and standard error \\[\\begin{aligned} SE_{\\hat{p}} = \\sqrt{\\frac{\\ p(1-p)\\ }{n}} \\label{seOfPHat}\\end{aligned}\\] [ \\(\\hat{p}\\) sample proportion \\(p\\) population proportion] \\(\\hat{p}\\) sample proportion \\(p\\) population proportion Typically we do not know the true proportion, \\(p\\), so we substitute some value to check conditions and to estimate the standard error. For confidence intervals, usually \\(\\hat{p}\\) is used to check the success-failure condition and compute the standard error. For hypothesis tests, typically the null value \\(p_0\\) is used in place of \\(p\\). Examples are presented for each of these cases in Sections [confIntForPropSection] and [htForPropSection]. If data come from a simple random sample and consist of less than 10% of the population, then the independence assumption is reasonable. Or, for example, if the data come from an experiment where each user was randomly assigned to the treatment or control group and users do not interact, then the observations in each group are typically independent. 8.1.2 Confidence intervals for a proportion According to a New York Times / CBS News poll in June 2012, only about 44% of the American public approves of the job the Supreme Court is doing.155 This poll included responses of 976 randomly sampled adults. We want a confidence interval for the proportion of Americans who approve of the job the Supreme Court is doing. Our point estimate, based on a simple random sample of size \\(n = 976\\) from the NYTimes/CBS poll, is \\(\\hat{p} = 0.44\\). To use our confidence interval formula from Section [ConfidenceIntervals], we must first check whether the sampling distribution of \\(\\hat{p}\\) is nearly normal and calculate the standard error of the estimate. The data are based on a simple random sample and consist of far fewer than 10% of the U.S. population, so independence is confirmed. The sample size must also be sufficiently large, which is checked via the success-failure condition: there were approximately \\(976\\times \\hat{p}=429\\) “successes” and \\(976\\times (1-\\hat{p})=547\\) “failures” in the sample, both easily greater than 10. With the conditions met, we are assured that the sampling distribution of \\(\\hat{p}\\) is nearly normal. Next, a standard error for \\(\\hat{p}\\) is needed, and then we can employ the usual method to construct a confidence interval. [seOfPropOfAmericansJobApprovalOfSupremeCourt] Estimate the standard error of \\(\\hat{p}=0.44\\) using Equation . Because \\(p\\) is unknown and the standard error is for a confidence interval, use \\(\\hat{p}\\) in place of \\(p\\). 156 Construct a 95% confidence interval for \\(p\\), the proportion of Americans who approve of the job the Supreme Court is doing. Using the standard error estimate from Guided Practice [seOfPropOfAmericansJobApprovalOfSupremeCourt], the point estimate 0.44, and \\(z^{\\star} = 1.96\\) for a 95% confidence interval, the confidence interval can be computed as \\[\\begin{aligned} \\text{point estimate } \\ \\pm\\ z^{\\star}SE \\quad\\to\\quad 0.44 \\ \\pm\\ 1.96\\times 0.016 \\quad\\to\\quad (0.409, 0.471)\\end{aligned}\\] We are 95% confident that the true proportion of Americans who approve of the job of the Supreme Court (in June 2012) is between 0.409 and 0.471. At the time this poll was taken, we can say with high confidence that the job approval of the Supreme Court was below 50%. Verify the observations are independent and also verify the success-failure condition using \\(\\hat{p}\\) and \\(n\\). If the conditions are met, then the Central Limit Theorem applies, and the sampling distribution of \\(\\hat{p}\\) is well-approximated by the normal model. Construct the standard error using \\(\\hat{p}\\) in place of \\(p\\) and apply the general confidence interval formula. 8.1.3 Hypothesis testing for a proportion To apply the same normal distribution framework in the context of a hypothesis test for a proportion, the independence and success-failure conditions must also be satisfied. However, in a hypothesis test, the success-failure condition is checked using the null proportion: we verify \\(np_0\\) and \\(n(1-p_0)\\) are at least 10, where \\(p_0\\) is the null value. Deborah Toohey is running for Congress, and her campaign manager claims she has more than 50% support from the district’s electorate. Ms. Toohey’s opponent claimed that Ms. Toohey has less than 50%. Set up a hypothesis test to evaluate who is right.157 A newspaper collects a simple random sample of 500 likely voters in the district and estimates Toohey’s support to be 52%. Does this provide convincing evidence for the claim of Toohey’s manager at the 5% significance level? [TooheyInferenceExample] Because this is a simple random sample that includes fewer than 10% of the population, the observations are independent. In a one-proportion hypothesis test, the success-failure condition is checked using the null proportion, \\(p_0=0.5\\): \\(np_0 = n(1-p_0) = 500\\times 0.5 = 250 &gt; 10\\). With these conditions verified, the normal model may be applied to \\(\\hat{p}\\). Next the standard error can be computed. The null value is used again here, because this is a hypothesis test for a single proportion. \\[SE = \\sqrt{\\frac{p_0\\times (1-p_0)}{n}} = \\sqrt{\\frac{0.5\\times (1-0.5)}{500}} = 0.022\\] A picture of the normal model is shown in Figure [pValueForCampaignManagerClaimOfMoreThan50PercentSupport] with the p-value represented by both shaded tails. Based on the normal model, we can compute a test statistic as the Z score of the point estimate: \\[Z = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{0.52 - 0.50}{0.022} = 0.89\\] The right tail area is 0.1867, and the p-value is \\(2 \\times 0.1867 = 0.3734\\). Because the p-value is larger than 0.05, we do not reject the null hypothesis, and we do not find convincing evidence to support the campaign manager’s claim. Sampling distribution of the sample proportion if the null hypothesis is true for Example [TooheyInferenceExample]. The p-value for the test is shaded. [pValueForCampaignManagerClaimOfMoreThan50PercentSupport] Set up hypotheses and verify the conditions using the null value, \\(p_0\\), to ensure \\(\\hat{p}\\) is nearly normal under \\(H_0\\). If the conditions hold, construct the standard error, again using \\(p_0\\), and show the p-value in a drawing. Lastly, compute the p-value and evaluate the hypotheses. 8.1.4 Choosing a sample size when estimating a proportion Frequently statisticians find themselves in a position to not only analyze data, but to help others determine how to most effectively collect data and also how much data should be collected. We can perform sample size calculations that are helpful in planning a study. Our task will be to identify an appropriate sample size that ensures the margin of error \\(ME = z^{\\star} SE\\) will be no larger than some value \\(m\\). For example, we might be asked to find a sample size so the margin of error is no larger than \\(m = 0.04\\), in which case, we write \\[\\begin{aligned} z^{\\star} SE \\leq 0.04\\end{aligned}\\] Generally, we plug in a suitable value for \\(z^{\\star}\\) for the confidence level we plan to use, write in the formula for the standard error, and then solve for the sample size \\(n\\). In the case of a single proportion, we use \\(\\sqrt{p(1-p) / n\\ }\\) for the standard error (\\(SE\\)). If we are conducting a university survey to determine whether students support a $200 per year increase in fees to pay for a new football stadium, how big of a sample is needed to ensure the margin of error is less than 0.04 using a 95% confidence level? For a 95% confidence level, the value \\(z^{\\star}\\) corresponds to 1.96, and we can write the margin of error expression as follows: \\[\\begin{aligned} ME = z^{\\star}SE = 1.96\\times \\sqrt{\\frac{p(1-p)}{n}} \\leq 0.04\\end{aligned}\\] There are two unknowns in the equation: \\(p\\) and \\(n\\). If we have an estimate of \\(p\\), perhaps from a similar survey, we could use that value. If we have no such estimate, we must use some other value for \\(p\\). The margin of error for a proportion is largest when \\(p\\) is 0.5, so we typically use this worst case estimate if no other estimate is available: \\[\\begin{aligned} 1.96\\times \\sqrt{\\frac{0.5(1-0.5)}{n}} &amp;\\leq 0.04 \\\\ 1.96^2\\times \\frac{0.5(1-0.5)}{n} &amp;\\leq 0.04^2 \\\\ 1.96^2\\times \\frac{0.5(1-0.5)}{0.04^2} &amp;\\leq n \\\\ 600.25 &amp;\\leq n\\end{aligned}\\] We would need at least 600.25 participants, which means we need 601 participants or more, to ensure the sample proportion is within 0.04 of the true proportion with 95% confidence. Notice that in such calculations, we always round up for the sample size! As noted in the example, if we have an estimate of the proportion, we should use it in place of the worst case estimate of the proportion, 0.5. A manager is about to oversee the mass production of a new tire model in her factory, and she would like to estimate what proportion of these tires will be rejected through quality control. The quality control team has monitored the last three tire models produced by the factory, failing 1.7% of tires in the first model, 6.2% of the second model, and 1.3% of the third model. The manager would like to examine enough tires to estimate the failure rate of the new tire model to within about 2% with a 90% confidence level.158 There are three different failure rates to choose from. Perform the sample size computation for each separately, and identify three sample sizes to consider. The sample sizes vary widely. Which of the three would you suggest using? What would influence your choice? A recent estimate of Congress’ approval rating was 17%.159 If we were to conduct a new poll and wanted an estimate with a margin of error smaller than about 0.04 with 95% confidence, how big of a sample should we use?160 8.2 Difference of two proportions We would like to make conclusions about the difference in two population proportions (\\(p_1 - p_2\\)) using the normal model. In this section we consider three such examples. In the first, we compare the approval of the 2010 healthcare law under two different question phrasings. In the second application, a company weighs whether they should switch to a higher quality parts manufacturer. In the last example, we examine the cancer risk to dogs from the use of yard herbicides. In our investigations, we first identify a reasonable point estimate of \\(p_1 - p_2\\) based on the sample. You may have already guessed its form: \\(\\hat{p}_1 - \\hat{p}_2\\). Next, in each example we verify that the point estimate follows the normal model by checking certain conditions; as before, these conditions relate to independence of observations and checking for sufficiently large sample size. Finally, we compute the estimate’s standard error and apply our inferential framework. 8.2.1 Sample distribution of the difference of two proportions We must check two conditions before applying the normal model to \\(\\hat{p}_1 - \\hat{p}_2\\). First, the sampling distribution for each sample proportion must be nearly normal, and secondly, the samples must be independent. Under these two conditions, the sampling distribution of \\(\\hat{p}_1 - \\hat{p}_2\\) may be well approximated using the normal model. The difference \\(\\hat{p}_1 - \\hat{p}_2\\) tends to follow a normal model when each proportion separately follows a normal model, and the two samples are independent of each other. The standard error of the difference in sample proportions is \\[\\begin{aligned} SE_{\\hat{p}_1 - \\hat{p}_2} = \\sqrt{SE_{\\hat{p}_1}^2 + SE_{\\hat{p}_2}^2} = \\sqrt{\\frac{p_1(1-p_1)}{n_1} + \\frac{p_2(1-p_2)}{n_2}} \\label{seForDiffOfProp}\\end{aligned}\\] where \\(p_1\\) and \\(p_2\\) represent the population proportions, and \\(n_1\\) and \\(n_2\\) represent the sample sizes. 8.2.2 Intervals and tests for \\(p_1 -p_2\\) In the setting of confidence intervals, the sample proportions are used to verify the success-failure condition and also compute standard error, just as was the case with a single proportion. The way a question is phrased can influence a person’s response. For example, Pew Research Center conducted a survey with the following question:161 As you may know, by 2014 nearly all Americans will be required to have health insurance. [People who do not buy insurance will pay a penalty] while [People who cannot afford it will receive financial help from the government]. Do you approve or disapprove of this policy? For each randomly sampled respondent, the statements in brackets were randomized: either they were kept in the order given above, or the two statements were reversed. Table [pewPollResultsForRandomizedStatementOrdering] shows the results of this experiment. Create and interpret a 90% confidence interval of the difference in approval. p50mmc p13mmp14mmp16.5mmc &amp; &amp; Sample size (\\(n_i\\)) &amp; Approve law (%) &amp; Disapprove law (%) &amp; Other “people who cannot afford it will receive financial help from the government” is given second &amp; &amp; 771 &amp; 47 &amp; 49 &amp; 3 “people who do not buy it will pay a penalty” is given second &amp; &amp; 732 &amp; 34 &amp; 63 &amp; 3 [pewPollResultsForRandomizedStatementOrdering] First the conditions must be verified. Because each group is a simple random sample from less than 10% of the population, the observations are independent, both within the samples and between the samples. The success-failure condition also holds for each sample. Because all conditions are met, the normal model can be used for the point estimate of the difference in support, where \\(p_1\\) corresponds to the original ordering and \\(p_2\\) to the reversed ordering: \\[\\hat{p}_{1} - \\hat{p}_{2} = 0.47 - 0.34 = 0.13\\] The standard error may be computed from Equation using the sample proportions: \\[SE \\approx \\sqrt{\\frac{0.47(1-0.47)}{771} + \\frac{0.34(1-0.34)}{732}} = 0.025\\] For a 90% confidence interval, we use \\(z^{\\star} = 1.65\\): \\[\\text{point estimate} \\ \\pm\\ z^{\\star}SE \\quad \\to \\quad 0.13 \\ \\pm\\ 1.65 \\times 0.025 \\quad \\to \\quad (0.09, 0.17)\\] We are 90% confident that the approval rating for the 2010 healthcare law changes between 9% and 17% due to the ordering of the two statements in the survey question. The Pew Research Center reported that this modestly large difference suggests that the opinions of much of the public are still fluid on the health insurance mandate. [carWheelGearManufacturer] A remote control car company is considering a new manufacturer for wheel gears. The new manufacturer would be more expensive but their higher quality gears are more reliable, resulting in happier customers and fewer warranty claims. However, management must be convinced that the more expensive gears are worth the conversion before they approve the switch. If there is strong evidence of a more than 3% improvement in the percent of gears that pass inspection, management says they will switch suppliers, otherwise they will maintain the current supplier. Set up appropriate hypotheses for the test.162 The quality control engineer from Guided Practice [carWheelGearManufacturer] collects a sample of gears, examining 1000 gears from each company and finds that 899 gears pass inspection from the current supplier and 958 pass inspection from the prospective supplier. Using these data, evaluate the hypothesis setup of Guided Practice [carWheelGearManufacturer] using a significance level of 5%. First, we check the conditions. The sample is not necessarily random, so to proceed we must assume the gears are all independent; for this sample we will suppose this assumption is reasonable, but the engineer would be more knowledgeable as to whether this assumption is appropriate. The success-failure condition also holds for each sample. Thus, the difference in sample proportions, \\(0.958-0.899=0.059\\), can be said to come from a nearly normal distribution. The standard error can be found using Equation : \\[SE = \\sqrt{\\frac{0.958(1-0.958)}{1000} + \\frac{0.899(1-0.899)}{1000}} = 0.0114\\] In this hypothesis test, the sample proportions were used. We will discuss this choice more in Section [pooledHTForProportionsSection]. Next, we compute the test statistic and use it to find the p-value, which is depicted in Figure [gearsTwoSampleHTPValueQC]. \\[Z = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{0.059 - 0.03}{0.0114} = 2.54\\] Using the normal model for this test statistic, we identify the right tail area as 0.006. Since this is a one-sided test, this single tail area is also the p-value, and we reject the null hypothesis because 0.006 is less than 0.05. That is, we have statistically significant evidence that the higher quality gears actually do pass inspection more than 3% as often as the currently used gears. Based on these results, management will approve the switch to the new supplier. Distribution of the test statistic if the null hypothesis was true. The p-value is represented by the shaded area. [gearsTwoSampleHTPValueQC] 8.2.3 Hypothesis testing when \\(H_0: p_1=p_2\\) Here we use a new example to examine a special estimate of standard error when \\(H_0: p_1 = p_2\\). We investigate whether there is an increased risk of cancer in dogs that are exposed to the herbicide 2,4-dichlorophenoxyacetic acid (2,4-D). A study in 1994 examined 491 dogs that had developed cancer and 945 dogs as a control group.163 Of these two groups, researchers identified which dogs had been exposed to 2,4-D in their owner’s yard. The results are shown in Table [24DAndCancerInDogs]. Summary results for cancer in dogs and the use of 2,4-D by the dog’s owner. cancer no cancer 2,4-D 191 304 no 2,4-D 300 641 [24DAndCancerInDogs] Is this study an experiment or an observational study?164 [htFor24DAndCancerInDogs] Set up hypotheses to test whether 2,4-D and the occurrence of cancer in dogs are related. Use a one-sided test and compare across the cancer and no cancer groups.165 Are the conditions met to use the normal model and make inference on the results?[condFor24DAndCancerInDogsNormalInference] (1) It is unclear whether this is a random sample. However, if we believe the dogs in both the cancer and no cancer groups are representative of each respective population and that the dogs in the study do not interact in any way, then we may find it reasonable to assume independence between observations. (2) The success-failure condition holds for each sample. Under the assumption of independence, we can use the normal model and make statements regarding the canine population based on the data. In your hypotheses for Guided Practice [htFor24DAndCancerInDogs], the null is that the proportion of dogs with exposure to 2,4-D is the same in each group. The point estimate of the difference in sample proportions is \\(\\hat{p}_c - \\hat{p}_n = 0.067\\). To identify the p-value for this test, we first check conditions (Example [condFor24DAndCancerInDogsNormalInference]) and compute the standard error of the difference: \\[SE = \\sqrt{\\frac{p_c(1-p_c)}{n_c} + \\frac{p_n(1-p_n)}{n_n}}\\] In a hypothesis test, the distribution of the test statistic is always examined as though the null hypothesis is true, i.e. in this case, \\(p_c = p_n\\). The standard error formula should reflect this equality in the null hypothesis. We will use \\(p\\) to represent the common rate of dogs that are exposed to 2,4-D in the two groups: \\[SE = \\sqrt{\\frac{p(1-p)}{n_c} + \\frac{p(1-p)}{n_n}}\\] We don’t know the exposure rate, \\(p\\), but we can obtain a good estimate of it by pooling the results of both samples: \\[\\hat{p} = \\frac{\\text{\\# of ``successes&#39;&#39;}}{\\text{\\# of cases}} = \\frac{191 + 304}{191+300+304+641} = 0.345\\] This is called the pooled estimate of the sample proportion, and we use it to compute the standard error when the null hypothesis is that \\(p_1 = p_2\\) (e.g. \\(p_c = p_n\\) or \\(p_c - p_n = 0\\)). We also typically use it to verify the success-failure condition. When the null hypothesis is \\(p_1 = p_2\\), it is useful to find the pooled estimate of the shared proportion: \\[\\begin{aligned} \\hat{p} = \\frac{\\text{number of ``successes&#39;&#39;}}{\\text{number of cases}} = \\frac{\\hat{p}_1n_1 + \\hat{p}_2n_2}{n_1 + n_2}\\end{aligned}\\] Here \\(\\hat{p}_1n_1\\) represents the number of successes in sample 1 since \\[\\begin{aligned} \\hat{p}_1 = \\frac{\\text{number of successes in sample 1}}{n_1}\\end{aligned}\\] Similarly, \\(\\hat{p}_2n_2\\) represents the number of successes in sample 2. When the null hypothesis suggests the proportions are equal, we use the pooled proportion estimate (\\(\\hat{p}\\)) to verify the success-failure condition and also to estimate the standard error: \\[\\begin{aligned} SE = \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n_1} + \\frac{\\hat{p}(1-\\hat{p})}{n_2}} \\label{seOfDiffInPropUsingPooledEstimate}\\end{aligned}\\] [verifySEOfPooledEstimateOf24DWithCancerNoCancerDogs] Using Equation , \\(\\hat{p}=0.345\\), \\(n_1 = 491\\), and \\(n_2=945\\), verify the estimate for the standard error is \\(SE = 0.026\\). Next, complete the hypothesis test using a significance level of 0.05. Be certain to draw a picture, compute the p-value, and state your conclusion in both statistical language and plain language.166 8.3 Testing for goodness of fit using chi-square (special topic) In this section, we develop a method for assessing a null model when the data are binned. This technique is commonly used in two circumstances: Given a sample of cases that can be classified into several groups, determine if the sample is representative of the general population. Evaluate whether data resemble a particular distribution, such as a normal distribution or a geometric distribution. (Background on the geometric distribution is not necessary.) Each of these scenarios can be addressed using the same statistical test: a chi-square test. In the first case, we consider data from a random sample of 275 jurors in a small county. Jurors identified their racial group, as shown in Table [juryRepresentationAndCityRepresentationForRace], and we would like to determine if these jurors are racially representative of the population. If the jury is representative of the population, then the proportions in the sample should roughly reflect the population of eligible jurors, i.e. registered voters. ll ccc c ll Race &amp; &amp; White &amp; Black &amp; Hispanic &amp; Other &amp; &amp; Total Representation in juries &amp; &amp; 205 &amp; 26 &amp; 25 &amp; 19 &amp; &amp; 275 Registered voters &amp; &amp; 0.72 &amp; 0.07 &amp; 0.12 &amp; 0.09 &amp; &amp; 1.00 [juryRepresentationAndCityRepresentationForRace] While the proportions in the juries do not precisely represent the population proportions, it is unclear whether these data provide convincing evidence that the sample is not representative. If the jurors really were randomly sampled from the registered voters, we might expect small differences due to chance. However, unusually large differences may provide convincing evidence that the juries were not representative. A second application, assessing the fit of a distribution, is presented at the end of this section. Daily stock returns from the S&amp;P500 for the years 1990-2011 are used to assess whether stock activity each day is independent of the stock’s behavior on previous days. In these problems, we would like to examine all bins simultaneously, not simply compare one or two bins at a time, which will require us to develop a new test statistic. 8.3.1 Creating a test statistic for one-way tables Of the people in the city, 275 served on a jury. If the individuals are randomly selected to serve on a jury, about how many of the 275 people would we expect to be white? How many would we expect to be black? About 72% of the population is white, so we would expect about 72% of the jurors to be white: \\(0.72\\times 275 = 198\\). Similarly, we would expect about 7% of the jurors to be black, which would correspond to about \\(0.07\\times 275 = 19.25\\) black jurors. Twelve percent of the population is Hispanic and 9% represent other races. How many of the 275 jurors would we expect to be Hispanic or from another race? Answers can be found in Table [expectedJuryRepresentationIfNoBias]. ll ccc c ll Race &amp; &amp; White &amp; Black &amp; Hispanic &amp; Other &amp; &amp; Total Observed data &amp; &amp; 205 &amp; 26 &amp; 25 &amp; 19 &amp; &amp; 275 Expected counts &amp; &amp; 198 &amp; 19.25 &amp; 33 &amp; 24.75 &amp; &amp; 275 [expectedJuryRepresentationIfNoBias] The sample proportion represented from each race among the 275 jurors was not a precise match for any ethnic group. While some sampling variation is expected, we would expect the sample proportions to be fairly similar to the population proportions if there is no bias on juries. We need to test whether the differences are strong enough to provide convincing evidence that the jurors are not a random sample. These ideas can be organized into hypotheses: The jurors are a random sample, i.e. there is no racial bias in who serves on a jury, and the observed counts reflect natural sampling fluctuation. The jurors are not randomly sampled, i.e. there is racial bias in juror selection. To evaluate these hypotheses, we quantify how different the observed counts are from the expected counts. Strong evidence for the alternative hypothesis would come in the form of unusually large deviations in the groups from what would be expected based on sampling variation alone. 8.3.2 The chi-square test statistic In previous hypothesis tests, we constructed a test statistic of the following form: \\[\\frac{\\text{point estimate} - \\text{null value}}{\\text{SE of point estimate}}\\] This construction was based on (1) identifying the difference between a point estimate and an expected value if the null hypothesis was true, and (2) standardizing that difference using the standard error of the point estimate. These two ideas will help in the construction of an appropriate test statistic for count data. Our strategy will be to first compute the difference between the observed counts and the counts we would expect if the null hypothesis was true, then we will standardize the difference: \\[\\begin{aligned} Z_{1} = \\frac{\\text{observed white count} - \\text{null white count}} {\\text{SE of observed white count}}\\end{aligned}\\] The standard error for the point estimate of the count in binned data is the square root of the count under the null.167 Therefore: \\[\\begin{aligned} Z_1 = \\frac{205 - 198}{\\sqrt{198}} = 0.50\\end{aligned}\\] The fraction is very similar to previous test statistics: first compute a difference, then standardize it. These computations should also be completed for the black, Hispanic, and other groups: \\[\\begin{aligned} &amp;Black &amp;&amp; Hispanic &amp;&amp;Other \\\\ &amp; Z_2 = \\frac{26-19.25}{\\sqrt{19.25}}=1.54\\ \\ \\ \\ &amp;&amp; Z_3 = \\frac{25-33}{\\sqrt{33}}=-1.39\\ \\ \\ \\ &amp;&amp; Z_4 = \\frac{19-24.75}{\\sqrt{24.75}}=-1.16 \\\\\\end{aligned}\\] We would like to use a single test statistic to determine if these four standardized differences are irregularly far from zero. That is, \\(Z_1\\), \\(Z_2\\), \\(Z_3\\), and \\(Z_4\\) must be combined somehow to help determine if they – as a group – tend to be unusually far from zero. A first thought might be to take the absolute value of these four standardized differences and add them up: \\[\\begin{aligned} |Z_1| + |Z_2| + |Z_3| + |Z_4| = 4.58\\end{aligned}\\] Indeed, this does give one number summarizing how far the actual counts are from what was expected. However, it is more common to add the squared values: \\[\\begin{aligned} Z_1^2 + Z_2^2 + Z_3^2 + Z_4^2 = 5.89\\end{aligned}\\] Squaring each standardized difference before adding them together does two things: Any standardized difference that is squared will now be positive. Differences that already look unusual – e.g. a standardized difference of 2.5 – will become much larger after being squared. The test statistic \\(X^2\\)[ \\(X^2\\) chi-square test statistic] \\(X^2\\) chi-square test statistic , which is the sum of the \\(Z^2\\) values, is generally used for these reasons. We can also write an equation for \\(X^2\\) using the observed counts and null counts: The final number \\(X^2\\) summarizes how strongly the observed counts tend to deviate from the null counts. In Section [pValueForAChiSquareTest], we will see that if the null hypothesis is true, then \\(X^2\\) follows a new distribution called a chi-square distribution. Using this distribution, we will be able to obtain a p-value to evaluate the hypotheses. 8.3.3 The chi-square distribution and finding areas The chi-square distribution is sometimes used to characterize data sets and statistics that are always positive and typically right skewed. Recall the normal distribution had two parameters – mean and standard deviation – that could be used to describe its exact characteristics. The chi-square distribution has just one parameter called , which influences the shape, center, and spread of the distribution. [exerChiSquareDistributionDescriptionWithMoreDOF] Figure [chiSquareDistributionWithInceasingDF] shows three chi-square distributions. (a) How does the center of the distribution change when the degrees of freedom is larger? (b) What about the variability (spread)? (c) How does the shape change?168 Three chi-square distributions with varying degrees of freedom. [chiSquareDistributionWithInceasingDF] Figure [chiSquareDistributionWithInceasingDF] and Guided Practice [exerChiSquareDistributionDescriptionWithMoreDOF] demonstrate three general properties of chi-square distributions as the degrees of freedom increases: the distribution becomes more symmetric, the center moves to the right, and the variability inflates. Our principal interest in the chi-square distribution is the calculation of p-values, which (as we have seen before) is related to finding the relevant area in the tail of a distribution. To do so, a new table is needed: the chi-square table, partially shown in Table [chiSquareProbabilityTableShort]. A more complete table is presented in Appendix . Using this table, we identify a range for the area, and we examine a particular row for distributions with different degrees of freedom. One important quality of this table: the chi-square table only provides upper tail values. A section of the chi-square table. A complete table is listed in Appendix . Upper tail 0.3 0.2 0.1 0.05 0.02 0.01 0.005 0.001 df 2 2.41 5.99 7.82 9.21 10.60 13.82 3 &amp; 3.66 &amp; 4.64 &amp; &amp; 7.81 &amp; 9.84 &amp; 11.34 &amp; 12.84 &amp; 16.27 4 &amp; 4.88 &amp; 5.99 &amp; 7.78 &amp; 9.49 &amp; 11.67 &amp; 13.28 &amp; 14.86 &amp; 18.47 5 &amp; 6.06 &amp; 7.29 &amp; 9.24 &amp; 11.07 &amp; 13.39 &amp; 15.09 &amp; 16.75 &amp; 20.52 6 &amp; 7.23 &amp; 8.56 &amp; 10.64 &amp; 12.59 &amp; 15.03 &amp; 16.81 &amp; 18.55 &amp; 22.46 7 &amp; 8.38 &amp; 9.80 &amp; 12.02 &amp; 14.07 &amp; 16.62 &amp; 18.48 &amp; 20.28 &amp; 24.32 ******** [chiSquareProbabilityTableShort] Figure [chiSquareAreaAbove6Point25WithDF3] shows a chi-square distribution with 3 degrees of freedom and an upper shaded tail starting at 6.25. Use Table [chiSquareProbabilityTableShort] to estimate the shaded area.[chisquaredistexample01] This distribution has three degrees of freedom, so only the row with 3 degrees of freedom (df) is relevant. This row has been italicized in the table. Next, we see that the value – 6.25 – falls in the column with upper tail area 0.1. That is, the shaded upper tail of Figure [chiSquareAreaAbove6Point25WithDF3] has area 0.1. [arrayOfFigureAreasForChiSquareDistribution] We rarely observe the exact value in the table. For instance, Figure [chiSquareAreaAbove4Point3WithDF2] shows the upper tail of a chi-square distribution with 2 degrees of freedom. The bound for this upper tail is at 4.3, which does not fall in Table [chiSquareProbabilityTableShort]. Find the approximate tail area.[chisquaredistexample02] The cutoff 4.3 falls between the second and third columns in the 2 degrees of freedom row. Because these columns correspond to tail areas of 0.2 and 0.1, we can be certain that the area shaded in Figure [chiSquareAreaAbove4Point3WithDF2] is between 0.1 and 0.2. Figure [chiSquareAreaAbove5Point1WithDF5] shows an upper tail for a chi-square distribution with 5 degrees of freedom and a cutoff of 5.1. Find the tail area.[chisquaredistexample03] Looking in the row with 5 df, 5.1 falls below the smallest cutoff for this row (6.06). That means we can only say that the area is greater than 0.3. [ChiSquareDistGuidedPractice01] Figure [chiSquareAreaAbove11Point7WithDF7] shows a cutoff of 11.7 on a chi-square distribution with 7 degrees of freedom. Find the area of the upper tail.169 [ChiSquareDistGuidedPractice02] Figure [chiSquareAreaAbove10WithDF4] shows a cutoff of 10 on a chi-square distribution with 4 degrees of freedom. Find the area of the upper tail.170 [ChiSquareDistGuidedPractice03] Figure [chiSquareAreaAbove9Point21WithDF3] shows a cutoff of 9.21 with a chi-square distribution with 3 df. Find the area of the upper tail.171 8.3.4 Finding a p-value for a chi-square distribution In Section [chiSquareTestStatistic], we identified a new test statistic (\\(X^2\\)) within the context of assessing whether there was evidence of racial bias in how jurors were sampled. The null hypothesis represented the claim that jurors were randomly sampled and there was no racial bias. The alternative hypothesis was that there was racial bias in how the jurors were sampled. We determined that a large \\(X^2\\) value would suggest strong evidence favoring the alternative hypothesis: that there was racial bias. However, we could not quantify what the chance was of observing such a large test statistic (\\(X^2=5.89\\)) if the null hypothesis actually was true. This is where the chi-square distribution becomes useful. If the null hypothesis was true and there was no racial bias, then \\(X^2\\) would follow a chi-square distribution, with three degrees of freedom in this case. Under certain conditions, the statistic \\(X^2\\) follows a chi-square distribution with \\(k-1\\) degrees of freedom, where \\(k\\) is the number of bins. How many categories were there in the juror example? How many degrees of freedom should be associated with the chi-square distribution used for \\(X^2\\)? In the jurors example, there were \\(k=4\\) categories: white, black, Hispanic, and other. According to the rule above, the test statistic \\(X^2\\) should then follow a chi-square distribution with \\(k-1 = 3\\) degrees of freedom if \\(H_0\\) is true. Just like we checked sample size conditions to use the normal model in earlier sections, we must also check a sample size condition to safely apply the chi-square distribution for \\(X^2\\). Each expected count must be at least 5. In the juror example, the expected counts were 198, 19.25, 33, and 24.75, all easily above 5, so we can apply the chi-square model to the test statistic, \\(X^2=5.89\\). If the null hypothesis is true, the test statistic \\(X^2=5.89\\) would be closely associated with a chi-square distribution with three degrees of freedom. Using this distribution and test statistic, identify the p-value. The chi-square distribution and p-value are shown in Figure [jurorHTPValueShown]. Because larger chi-square values correspond to stronger evidence against the null hypothesis, we shade the upper tail to represent the p-value. Using the chi-square table in Appendix [chiSquareProbabilityTable] or the short table on page , we can determine that the area is between 0.1 and 0.2. That is, the p-value is larger than 0.1 but smaller than 0.2. Generally we do not reject the null hypothesis with such a large p-value. In other words, the data do not provide convincing evidence of racial bias in the juror selection. The p-value for the juror hypothesis test is shaded in the chi-square distribution with \\(df=3\\). [jurorHTPValueShown] Suppose we are to evaluate whether there is convincing evidence that a set of observed counts \\(O_1\\), \\(O_2\\), …, \\(O_k\\) in \\(k\\) categories are unusually different from what might be expected under a null hypothesis. Call the expected counts that are based on the null hypothesis \\(E_1\\), \\(E_2\\), …, \\(E_k\\). If each expected count is at least 5 and the null hypothesis is true, then the test statistic below follows a chi-square distribution with \\(k-1\\) degrees of freedom: \\[\\begin{aligned} X^2 = \\frac{(O_1 - E_1)^2}{E_1} + \\frac{(O_2 - E_2)^2}{E_2} + \\cdots + \\frac{(O_k - E_k)^2}{E_k}\\end{aligned}\\] The p-value for this test statistic is found by looking at the upper tail of this chi-square distribution. We consider the upper tail because larger values of \\(X^2\\) would provide greater evidence against the null hypothesis. There are three conditions that must be checked before performing a chi-square test: Independence. Each case that contributes a count to the table must be independent of all the other cases in the table. Sample size / distribution. Each particular scenario (i.e. cell count) must have at least 5 expected cases. Degrees of freedom We only apply the chi-square technique when the table is associated with a chi-square distribution with 2 or more degrees of freedom. Failing to check conditions may affect the test’s error rates. When examining a table with just two bins, pick a single bin and use the one-proportion methods introduced in Section [singleProportion]. 8.3.5 Evaluating goodness of fit for a distribution We can apply our new chi-square testing framework to the second problem in this section: evaluating whether a certain statistical model fits a data set. Daily stock returns from the S&amp;P500 for 1990-2011 can be used to assess whether stock activity each day is independent of the stock’s behavior on previous days. This sounds like a very complex question, and it is, but a chi-square test can be used to study the problem. We will label each day as or () depending on whether the market was up or down that day. For example, consider the following changes in price, their new labels of up and down, and then the number of days that must be observed before each day: lc ccc ccc ccc cc Change in price &amp; &amp; 2.52 &amp; -1.46 &amp; 0.51 &amp; -4.07 &amp; 3.36 &amp; 1.10 &amp; -5.46 &amp; -1.03 &amp; -2.99 &amp; 1.71 Outcome &amp; &amp; Up &amp; D &amp; Up &amp; D &amp; Up &amp; Up &amp; D &amp; D &amp; D &amp; Up Days to Up &amp; &amp; 1 &amp; - &amp; 2 &amp; - &amp; 2 &amp; 1 &amp; - &amp; - &amp; - &amp; 4 If the days really are independent, then the number of days until a positive trading day should follow a geometric distribution. The geometric distribution describes the probability of waiting for the \\(k^{th}\\) trial to observe the first success. Here each up day (Up) represents a success, and down (D) days represent failures. In the data above, it took only one day until the market was up, so the first wait time was 1 day. It took two more days before we observed our next trading day, and two more for the third day. We would like to determine if these counts (1, 2, 2, 1, 4, and so on) follow the geometric distribution. Table [sAndP500For1990To2011TimeToPosTrade] shows the number of waiting days for a positive trading day during 1990-2011 for the S&amp;P500. ll ccc ccc c ll Days &amp; &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7+ &amp; &amp; Total Observed &amp; &amp; 1532 &amp; 760 &amp; 338 &amp; 194 &amp; 74 &amp; 33 &amp; 17 &amp; &amp; 2948 [sAndP500For1990To2011TimeToPosTrade] We consider how many days one must wait until observing an day on the S&amp;P500 stock exchange. If the stock activity was independent from one day to the next and the probability of a positive trading day was constant, then we would expect this waiting time to follow a geometric distribution. We can organize this into a hypothesis framework: The stock market being up or down on a given day is independent from all other days. We will consider the number of days that pass until an day is observed. Under this hypothesis, the number of days until an day should follow a geometric distribution. The stock market being up or down on a given day is not independent from all other days. Since we know the number of days until an day would follow a geometric distribution under the null, we look for deviations from the geometric distribution, which would support the alternative hypothesis. There are important implications in our result for stock traders: if information from past trading days is useful in telling what will happen today, that information may provide an advantage over other traders. We consider data for the S&amp;P500 from 1990 to 2011 and summarize the waiting times in Table [sAndP500For1990To2011TimeToPosTrade2] and Figure [geomFitEvaluationForSP500For1990To2011]. The S&amp;P500 was positive on 53.2% of those days. ll ccc ccc c ll Days &amp; &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7+ &amp; &amp; Total Observed &amp; &amp; 1532 &amp; 760 &amp; 338 &amp; 194 &amp; 74 &amp; 33 &amp; 17 &amp; &amp; 2948 Geometric Model &amp; &amp; 1569 &amp; 734 &amp; 343 &amp; 161 &amp; 75 &amp; 35 &amp; 31 &amp; &amp; 2948 [sAndP500For1990To2011TimeToPosTrade2] Side-by-side bar plot of the observed and expected counts for each waiting time. [geomFitEvaluationForSP500For1990To2011] Because applying the chi-square framework requires expected counts to be at least 5, we have binned together all the cases where the waiting time was at least 7 days to ensure each expected count is well above this minimum. The actual data, shown in the Observed row in Table [sAndP500For1990To2011TimeToPosTrade2], can be compared to the expected counts from the Geometric Model row. The method for computing expected counts is discussed in Table [sAndP500For1990To2011TimeToPosTrade2]. In general, the expected counts are determined by (1) identifying the null proportion associated with each bin, then (2) multiplying each null proportion by the total count to obtain the expected counts. That is, this strategy identifies what proportion of the total count we would expect to be in each bin. Do you notice any unusually large deviations in the graph? Can you tell if these deviations are due to chance just by looking? It is not obvious whether differences in the observed counts and the expected counts from the geometric distribution are significantly different. That is, it is not clear whether these deviations might be due to chance or whether they are so strong that the data provide convincing evidence against the null hypothesis. However, we can perform a chi-square test using the counts in Table [sAndP500For1990To2011TimeToPosTrade2]. Table [sAndP500For1990To2011TimeToPosTrade2] provides a set of count data for waiting times (\\(O_1=1532\\), \\(O_2=760\\), …) and expected counts under the geometric distribution (\\(E_1=1569\\), \\(E_2=734\\), …). Compute the chi-square test statistic, \\(X^2\\).172 Because the expected counts are all at least 5, we can safely apply the chi-square distribution to \\(X^2\\). However, how many degrees of freedom should we use?173 If the observed counts follow the geometric model, then the chi-square test statistic \\(X^2=15.08\\) would closely follow a chi-square distribution with \\(df=6\\). Using this information, compute a p-value. [RejectGeomModelForSP500StockDataFor1990To2011] Figure [geomFitPValueForSP500For1990To2011] shows the chi-square distribution, cutoff, and the shaded p-value. If we look up the statistic \\(X^2=15.08\\) in Appendix [chiSquareProbabilityTable], we find that the p-value is between 0.01 and 0.02. In other words, we have sufficient evidence to reject the notion that the wait times follow a geometric distribution, i.e. trading days are not independent and past days may help predict what the stock market will do today. Chi-square distribution with 6 degrees of freedom. The p-value for the stock analysis is shaded. [geomFitPValueForSP500For1990To2011] In Example [RejectGeomModelForSP500StockDataFor1990To2011], we rejected the null hypothesis that the trading days are independent. Why is this so important? Because the data provided strong evidence that the geometric distribution is not appropriate, we reject the claim that trading days are independent. While it is not obvious how to exploit this information, it suggests there are some hidden patterns in the data that could be interesting and possibly useful to a stock trader. 8.4 Testing for independence in two-way tables (special topic) Google is constantly running experiments to test new search algorithms. For example, Google might test three algorithms using a sample of 10,000 google.com search queries. Table [googleSearchAlgorithmByAlgorithmOnly] shows an example of 10,000 queries split into three algorithm groups.174 The group sizes were specified before the start of the experiment to be 5000 for the current algorithm and 2500 for each test algorithm. ll ccc ll Search algorithm &amp; &amp; current &amp; test 1 &amp; test 2 &amp; &amp; Total Counts &amp; &amp; 5000 &amp; 2500 &amp; 2500 &amp; &amp; 10000 [googleSearchAlgorithmByAlgorithmOnly] What is the ultimate goal of the Google experiment? What are the null and alternative hypotheses, in regular words? The ultimate goal is to see whether there is a difference in the performance of the algorithms. The hypotheses can be described as the following: The algorithms each perform equally well. The algorithms do not perform equally well. In this experiment, the explanatory variable is the search algorithm. However, an outcome variable is also needed. This outcome variable should somehow reflect whether the search results align with the user’s interests. One possible way to quantify this is to determine whether (1) the user clicked one of the links provided and did not try a new search, or (2) the user performed a related search. Under scenario (1), we might think that the user was satisfied with the search results. Under scenario (2), the search results probably were not relevant, so the user tried a second search. Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals] provides the results from the experiment. These data are very similar to the count data in Section [oneWayChiSquare]. However, now the different combinations of two variables are binned in a two-way table. In examining these data, we want to evaluate whether there is strong evidence that at least one algorithm is performing better than the others. To do so, we apply a chi-square test to this two-way table. The ideas of this test are similar to those ideas in the one-way table case. However, degrees of freedom and expected counts are computed a little differently than before. ll ccc ll Search algorithm &amp; &amp; current &amp; test 1 &amp; test 2 &amp; &amp; Total No new search &amp; &amp; 3511 &amp; 1749 &amp; 1818 &amp; &amp; 7078 New search &amp; &amp; 1489 &amp; 751 &amp; 682 &amp; &amp; 2922 Total &amp; &amp; 5000 &amp; 2500 &amp; 2500 &amp; &amp; 10000 [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals] A one-way table describes counts for each outcome in a single variable. A two-way table describes counts for combinations of outcomes for two variables. When we consider a two-way table, we often would like to know, are these variables related in any way? That is, are they dependent (versus independent)? The hypothesis test for this Google experiment is really about assessing whether there is statistically significant evidence that the choice of the algorithm affects whether a user performs a second search. In other words, the goal is to check whether the search variable is independent of the algorithm variable. 8.4.1 Expected counts in two-way tables From the experiment, we estimate the proportion of users who were satisfied with their initial search (no new search) as \\(7078/10000 = 0.7078\\). If there really is no difference among the algorithms and 70.78% of people are satisfied with the search results, how many of the 5000 people in the “current algorithm” group would be expected to not perform a new search? [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch] About 70.78% of the 5000 would be satisfied with the initial search: \\[0.7078\\times 5000 = 3539\\text{ users}\\] That is, if there was no difference between the three groups, then we would expect 3539 of the current algorithm users not to perform a new search. [googleExampleComputingTheExpectedNumberOfNewAlgGroupWithNoNewSearch] Using the same rationale described in Example [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch], about how many users in each test group would not perform a new search if the algorithms were equally helpful?175 We can compute the expected number of users who would perform a new search for each group using the same strategy employed in Example [googleExampleComputingTheExpectedNumberOfCurrentGroupWithNoNewSearch] and Guided Practice [googleExampleComputingTheExpectedNumberOfNewAlgGroupWithNoNewSearch]. These expected counts were used to construct Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithExpectedCounts], which is the same as Table [googleSearchAlgorithmByAlgorithmAndPerformanceWithTotals], except now the expected counts have been added in parentheses. l lll lll lll l Search algorithm &amp; &amp;&amp; &amp;&amp; &amp; &amp; Total No new search &amp; 3511 &amp; &amp;&amp; 1749 &amp; &amp;&amp; 1818 &amp; &amp; &amp; 7078 New search &amp; 1489 &amp; &amp;&amp; 751 &amp; &amp;&amp; 682 &amp; &amp; &amp; 2922 Total &amp; 5000 &amp;&amp;&amp; 2500 &amp;&amp;&amp; 2500 &amp;&amp;&amp; 10000 [googleSearchAlgorithmByAlgorithmAndPerformanceWithExpectedCounts] The examples and guided practice above provided some help in computing expected counts. In general, expected counts for a two-way table may be computed using the row totals, column totals, and the table total. For instance, if there was no difference between the groups, then about 70.78% of each column should be in the first row: \\[\\begin{aligned} 0.7078\\times (\\text{column 1 total}) &amp;= 3539 \\\\ 0.7078\\times (\\text{column 2 total}) &amp;= 1769.5 \\\\ 0.7078\\times (\\text{column 3 total}) &amp;= 1769.5\\end{aligned}\\] Looking back to how the fraction 0.7078 was computed – as the fraction of users who did not perform a new search (\\(7078/10000\\)) – these three expected counts could have been computed as \\[\\begin{aligned} \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 1 total)} &amp;= 3539 \\\\ \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 2 total)} &amp;= 1769.5 \\\\ \\left(\\frac{\\text{row 1 total}}{\\text{table total}}\\right)\\text{(column 3 total)} &amp;= 1769.5\\end{aligned}\\] This leads us to a general formula for computing expected counts in a two-way table when we would like to test whether there is strong evidence of an association between the column variable and row variable. To identify the expected count for the \\(i^{th}\\) row and \\(j^{th}\\) column, compute $$i,j = $$ 8.4.2 The chi-square test for two-way tables The chi-square test statistic for a two-way table is found the same way it is found for a one-way table. For each table count, compute \\[\\begin{aligned} &amp;\\text{General formula}&amp; &amp;\\frac{(\\text{observed count } - \\text{ expected count})^2}{\\text{expected count}} \\\\ &amp;\\text{Row 1, Col 1}&amp; &amp;\\frac{(3511 - 3539)^2}{3539} = 0.222 \\\\ &amp;\\text{Row 1, Col 2}&amp; &amp;\\frac{(1749 - 1769.5)^2}{1769.5} = 0.237 \\\\ &amp; \\hspace{9mm}\\vdots &amp; &amp;\\hspace{13mm}\\vdots \\\\ &amp;\\text{Row 2, Col 3}&amp; &amp;\\frac{(682 - 730.5)^2}{730.5} = 3.220\\end{aligned}\\] Adding the computed value for each cell gives the chi-square test statistic \\(X^2\\): \\[X^2 = 0.222 + 0.237 + \\dots + 3.220 = 6.120\\] Just like before, this test statistic follows a chi-square distribution. However, the degrees of freedom are computed a little differently for a two-way table.176 For two way tables, the degrees of freedom is equal to \\[\\begin{aligned} df = \\text{(number of rows minus 1)}\\times \\text{(number of columns minus 1)}\\end{aligned}\\] In our example, the degrees of freedom parameter is \\[\\begin{aligned} df = (2-1)\\times (3-1) = 2\\end{aligned}\\] If the null hypothesis is true (i.e. the algorithms are equally useful), then the test statistic \\(X^2 = 6.12\\) closely follows a chi-square distribution with 2 degrees of freedom. Using this information, we can compute the p-value for the test, which is depicted in Figure [googleHTForDiffAlgPerformancePValue]. When applying the chi-square test to a two-way table, we use \\[df = (R-1)\\times (C-1)\\] where \\(R\\) is the number of rows in the table and \\(C\\) is the number of columns. When analyzing 2-by-2 contingency tables, use the two-proportion methods introduced in Section [differenceOfTwoProportions]. Computing the p-value for the Google hypothesis test. [googleHTForDiffAlgPerformancePValue] Compute the p-value and draw a conclusion about whether the search algorithms have different performances. Looking in Appendix [chiSquareProbabilityTable] on page , we examine the row corresponding to 2 degrees of freedom. The test statistic, \\(X^2=6.120\\), falls between the fourth and fifth columns, which means the p-value is between 0.02 and 0.05. Because we typically test at a significance level of \\(\\alpha=0.05\\) and the p-value is less than 0.05, the null hypothesis is rejected. That is, the data provide convincing evidence that there is some difference in performance among the algorithms. Table [pewResearchPollOnApprovalRatingsForChiSquareSectionExampleAndExercises] summarizes the results of a Pew Research poll.177 We would like to determine if there are actually differences in the approval ratings of Barack Obama, Democrats in Congress, and Republicans in Congress. What are appropriate hypotheses for such a test?[hypothesisTestSetupForPewResearchPollOnApprovalRatingsForChiSquareSection] There is no difference in approval ratings between the three groups. There is some difference in approval ratings between the three groups, e.g. perhaps Obama’s approval differs from Democrats in Congress. ll ccc ll &amp; &amp; &amp; &amp; &amp; &amp; Obama &amp; Democrats &amp; Republicans &amp; &amp; Total Approve &amp; &amp; 842 &amp; 736 &amp; 541 &amp; &amp; 2119 Disapprove &amp; &amp; 616 &amp; 646 &amp; 842 &amp; &amp; 2104 Total &amp; &amp; 1458 &amp; 1382 &amp; 1383 &amp; &amp; 4223 [pewResearchPollOnApprovalRatingsForChiSquareSectionExampleAndExercises] A chi-square test for a two-way table may be used to test the hypotheses in Example [hypothesisTestSetupForPewResearchPollOnApprovalRatingsForChiSquareSection]. As a first step, compute the expected values for each of the six table cells.178 Compute the chi-square test statistic.179 Because there are 2 rows and 3 columns, the degrees of freedom for the test is \\(df=(2-1)\\times (3-1) = 2\\). Use \\(X^2=106.4\\), \\(df=2\\), and the chi-square table on page to evaluate whether to reject the null hypothesis.180 nytimes.com/2012/06/08/us/politics/44-percent-of-americans-approve-of-supreme-court-in-new-poll.html↩ \\(SE = \\sqrt{\\frac{p(1-p)}{n}} \\approx \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}} = \\sqrt{\\frac{0.44(1-0.44)}{976}} = 0.016\\)↩ We should run a two-sided.\\(H_0\\): Ms. Toohey’s support is 50%. \\(p = 0.50\\). \\(H_A\\): Ms. Toohey’s support is either above or below 50%. \\(p \\neq 0.50\\).↩ (a) For the 1.7% estimate of \\(p\\), we estimate the appropriate sample size as follows: \\[\\begin{aligned} 1.65\\times \\sqrt{\\frac{p(1-p)}{n}} \\approx 1.65\\times \\sqrt{\\frac{0.017(1-0.017)}{n}} &amp;\\leq 0.02 \\qquad\\to\\qquad n \\geq 113.7\\end{aligned}\\] Using the estimate from the first model, we would suggest examining 114 tires (round up!). A similar computation can be accomplished using 0.062 and 0.013 for \\(p\\): 396 and 88. (b) We could examine which of the old models is most like the new model, then choose the corresponding sample size. Or if two of the previous estimates are based on small samples while the other is based on a larger sample, we should consider the value corresponding to the larger sample. (Answers will vary.)↩ www.gallup.com/poll/155144/Congress-Approval-June.aspx↩ We complete the same computations as before, except now we use \\(0.17\\) instead of \\(0.5\\) for \\(p\\): \\[\\begin{aligned} 1.96\\times \\sqrt{\\frac{p(1-p)}{n}} \\approx 1.96\\times \\sqrt{\\frac{0.17(1-0.17)}{n}} &amp;\\leq 0.04 \\qquad\\to\\qquad n \\geq 338.8\\end{aligned}\\] A sample size of 339 or more would be reasonable.↩ www.people-press.org/2012/03/26/public-remains-split-on-health-care-bill-opposed-to-mandate/. Sample sizes for each polling group are approximate.↩ \\(H_0\\): The higher quality gears will pass inspection no more than 3% more frequently than the standard quality gears. \\(p_{highQ} - p_{standard} = 0.03\\). \\(H_A\\): The higher quality gears will pass inspection more than 3% more often than the standard quality gears. \\(p_{highQ} - p_{standard} &gt; 0.03\\).↩ Hayes HM, Tarone RE, Cantor KP, Jessen CR, McCurnin DM, and Richardson RC. 1991. Case-Control Study of Canine Malignant Lymphoma: Positive Association With Dog Owner’s Use of 2, 4-Dichlorophenoxyacetic Acid Herbicides. Journal of the National Cancer Institute 83(17):1226-1231.↩ The owners were not instructed to apply or not apply the herbicide, so this is an observational study. This question was especially tricky because one group was called the control group, which is a term usually seen in experiments.↩ Using the proportions within the cancer and no cancer groups may seem odd. We intuitively may desire to compare the fraction of dogs with cancer in the 2,4-D and no 2,4-D groups, since the herbicide is an explanatory variable. However, the cancer rates in each group do not necessarily reflect the cancer rates in reality due to the way the data were collected. For this reason, computing cancer rates may greatly alarm dog owners. \\(H_0\\): the proportion of dogs with exposure to 2,4-D is the same in “cancer” and “no cancer” dogs, \\(p_c - p_n = 0\\). \\(H_A\\): dogs with cancer are more likely to have been exposed to 2,4-D than dogs without cancer, \\(p_c - p_n &gt; 0\\).↩ Compute the test statistic: \\[\\begin{aligned} Z = \\frac{\\text{point estimate} - \\text{null value}}{SE} = \\frac{0.067 - 0}{0.026} = 2.58\\end{aligned}\\] We leave the picture to you. Looking up \\(Z=2.58\\) in the normal probability table: 0.9951. However this is the lower tail, and the upper tail represents the p-value: \\(1-0.9951 = 0.0049\\). We reject the null hypothesis and conclude that dogs getting cancer and owners using 2,4-D are associated.↩ Using some of the rules learned in earlier chapters, we might think that the standard error would be \\(np(1-p)\\), where \\(n\\) is the sample size and \\(p\\) is the proportion in the population. This would be correct if we were looking only at one count. However, we are computing many standardized differences and adding them together. It can be shown – though not here – that the square root of the count is a better way to standardize the count differences.↩ (a) The center becomes larger. If we look carefully, we can see that the center of each distribution is equal to the distribution’s degrees of freedom. (b) The variability increases as the degrees of freedom increases. (c) The distribution is very strongly skewed for \\(df=2\\), and then the distributions become more symmetric for the larger degrees of freedom \\(df=4\\) and \\(df=9\\). We would see this trend continue if we examined distributions with even more larger degrees of freedom.↩ The value 11.7 falls between 9.80 and 12.02 in the 7 df row. Thus, the area is between 0.1 and 0.2.↩ The area is between 0.02 and 0.05.↩ Between 0.02 and 0.05.↩ \\(X^2=\\frac{(1532-1569)^2}{1569} + \\frac{(760-734)^2}{734} + \\cdots + \\frac{(17-31)^2}{31} = 15.08\\)↩ There are \\(k=7\\) groups, so we use \\(df=k-1=6\\).↩ Google regularly runs experiments in this manner to help improve their search engine. It is entirely possible that if you perform a search and so does your friend, that you will have different search results. While the data presented in this section resemble what might be encountered in a real experiment, these data are simulated.↩ We would expect \\(0.7078*2500 = 1769.5\\). It is okay that this is a fraction.↩ Recall: in the one-way table, the degrees of freedom was the number of cells minus 1.↩ See the Pew Research website: www.people-press.org/2012/03/14/romney-leads-gop-contest-trails-in-matchup-with-obama. The counts in Table [pewResearchPollOnApprovalRatingsForChiSquareSectionExampleAndExercises] are approximate.↩ The expected count for row one / column one is found by multiplying the row one total (2119) and column one total (1458), then dividing by the table total (4223): \\(\\frac{2119\\times 1458}{3902} = 731.6\\). Similarly for the first column and the second row: \\(\\frac{2104\\times 1458}{4223} = 726.4\\). Column 2: 693.5 and 688.5. Column 3: 694.0 and 689.0↩ For each cell, compute \\(\\frac{(\\text{obs} - \\text{exp})^2}{exp}\\). For instance, the first row and first column: \\(\\frac{(842-731.6)^2}{731.6} = 16.7\\). Adding the results of each cell gives the chi-square test statistic: \\(X^2 = 16.7 + \\cdots + 34.0 = 106.4\\).↩ The test statistic is larger than the right-most column of the \\(df=2\\) row of the chi-square table, meaning the p-value is less than 0.001. That is, we reject the null hypothesis because the p-value is less than 0.05, and we conclude that Americans’ approval has differences among Democrats in Congress, Republicans in Congress, and the president.↩ "]
]
